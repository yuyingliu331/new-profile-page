EmailHrdPage=function(){};EmailHrdPage.prototype={disabledButtonClass:"disabledButton",emailButtonClass:"",inUseEmailAddressClass:"inUseEmailAddress",notInUseEmailAddressClass:"notInUseEmailAddress",outlineClass:"outlined",hoveringKey:"hovering",pressedKey:"pressed",enterKeyCode:13,clearedEmailAddress:false,emailAddress:null,federationProvider:null,authorizationService:null,authorizationServiceHeader:"AuthorizationService",tokenService:null,tokenServiceHeader:"TokenService",accelerated:"accelerated",fpParam:"fpEnabled",idpParam:"idp",hrdModeParam:"hm",hrdModeParamValueLicensing:"1",hrdModeParamValueLicensingNotify:"2",hrdModeParamValueAddService:"6",hrdModeParamValueOpenFromWeb:"7",hrdModeParamValueOpenFromTenant:"11",msAccountIdpParamValue:"live",platformParam:"p",platformParamValueiPhone:"2",platformParamValueAndroid:"4",platformParamValueMac:"7",platformParamValueWac:"11",platformParamValueManchester:"3",orgIdIdpParamValue:"org",versionParam:"Ver",requestPending:false,isScrollStop:false,onKeyDown:function(a){a.which==27&&cancelDialog()},findAccount:function(a){return a.find(".account").first()},setAccountOutline:function(b){if(!EmailHrdPage.isMac()){var a=this.findAccount(b);a.addClass(this.outlineClass)}},resetAccountOutline:function(a){var b=this;if(!a.is(":focus")&&!a.data(b.hoveringKey)&&!a.data(b.pressedKey)){var c=b.findAccount(a);c.removeClass(b.outlineClass)}},getBodyColor:function(){return $("body").css("background-color")},setPressedColor:function(c){var a="background-color",b=this.findAccount(c);b.css(a,pressedColor);b.css(a).replace(/\s/g,"")!=pressedColor&&this.setAccountOutline(c)},resetPressedColor:function(a){var c="background-color",b=this,d=b.findAccount(a);if(a.is(":focus"))d.css(c,focusColor);else if(a.data(b.hoveringKey))d.css(c,hoverColor);else d.css(c,b.getBodyColor());b.resetAccountOutline(a)},showEmailValidationError:function(){$("#invalidEmailError").show();if(EmailHrdPage.isWac()){$("#emailHelperText").hide();$("#accountLookupErrors").show()}},hideEmailValidationError:function(){$("#invalidEmailError").hide();EmailHrdPage.isWac()&&$("#accountLookupErrors").hide()},isMobile:function(){var a=EmailHrdPage.GetQueryStringArray();return a[EmailHrdPage.platformParam]==EmailHrdPage.platformParamValueiPhone||a[EmailHrdPage.platformParam]==EmailHrdPage.platformParamValueAndroid},isIPhone:function(){var a=EmailHrdPage.GetQueryStringArray();return a[EmailHrdPage.platformParam]==EmailHrdPage.platformParamValueiPhone},isMac:function(){var a=EmailHrdPage.GetQueryStringArray();return a[EmailHrdPage.platformParam]==EmailHrdPage.platformParamValueMac},isManchester:function(){var a=EmailHrdPage.GetQueryStringArray();return a[EmailHrdPage.platformParam]==EmailHrdPage.platformParamValueManchester},isAppleDevice:function(){return EmailHrdPage.isManchester()||EmailHrdPage.isIPhone()},isWac:function(){var a=EmailHrdPage.GetQueryStringArray();return a[EmailHrdPage.platformParam]==EmailHrdPage.platformParamValueWac},isEmailSupported:function(){var a=document.createElement("input");a.setAttribute("type","email");var b=a.type==="email";delete a;return b},isValidInput:function(){var a=$.trim($("#emailAddress").val());if(!a||a.indexOf(" ")!=-1||a===OOUI["L_EmailHrd_TypeEmailAddress"]||a===OOUI["L_EmailHrd_TypeEmailAddress2"]||EmailHrdPage.isWac()&&a===OOUI["L_EmailHrd_WacAccountLookupSearchBoxExample"])return false;return true},isEmail:function(){var a=$.trim($("#emailAddress").val()),b=a?a.indexOf("@"):-1;if(!EmailHrdPage.isValidInput()||b<1||b==a.length-1||a.indexOf(".",b+1)==-1)return false;return true},getDomainWithoutTLD:function(){if(!EmailHrdPage.isEmail())return null;var a=$.trim($("#emailAddress").val()),b=a?a.indexOf("@"):-1;return a.substring(b+1,a.indexOf(".",b+1))},isAccelerated:function(){var a=EmailHrdPage.GetQueryStringArray();return a[EmailHrdPage.accelerated]==1&&a[EmailHrdPage.hrdModeParam]!=1&&a[EmailHrdPage.hrdModeParam]!=2&&a[EmailHrdPage.hrdModeParam]!=4},isFirstPartyMsaDomain:function(){var a=EmailHrdPage.getDomainWithoutTLD();if(a==null)return false;switch(a.toLowerCase()){case "live":case "live-int":case "hotmail":case "hotmail-int":case "outlook":case "outlook-int":return true;default:return false}},GetQueryStringArray:function(){var b={},e=window.location.search.substring(1);if(e.length>0)for(var d=e.split("&"),c=0;c<d.length;c++){var a=d[c].split("=");if(a.length==2)b[a[0]]=a[1];else if(a.length==1)b[a[0]]=a[0]}return b},GetVer:function(){var a=EmailHrdPage.GetQueryStringArray();return a[EmailHrdPage.versionParam]},showProgressArea:function(a){EmailHrdPage.isMac()&&EmailHrdPage.GetVer()==14&&$("#emailButton").text(OOUI[a]);if(EmailHrdPage.isMac()||EmailHrdPage.isManchester()||EmailHrdPage.isIPhone())$("#emailAddressSpinner").css("display","inline");else if(EmailHrdPage.isWac())$("#emailInProgress").show();else{$("#progressArea .spinnerText").text(OOUI[a]);$("#progressArea").css("visibility","visible")}},hideProgressArea:function(){EmailHrdPage.isMac()&&EmailHrdPage.GetVer()==14&&$("#emailButton").text(OOUI["L_EmailHrd_Link_Next"]);(EmailHrdPage.isMac()||EmailHrdPage.isManchester()||EmailHrdPage.isIPhone())&&$("#emailAddressSpinner").css("display","none");if(EmailHrdPage.isWac())$("#emailInProgress").hide();else $("#progressArea").css("visibility","hidden")},startGetFederationProviderRequest:function(b){if(typeof b==="undefined"||!b)return;var d=EmailHrdPage.GetQueryStringArray();if(d[EmailHrdPage.idpParam]==EmailHrdPage.msAccountIdpParamValue){federationProvider=null;EmailHrdPage.startGetIdpRequest(b)}var a=getFederationProviderServiceUrl,c=b.indexOf("@");if(c==-1)return;var e=b.substring(c+1);if(a.indexOf("?")==-1)a=a+"?";else a=a+"&";a=a+"domain="+encodeURIComponent(e);$.ajax({url:a,cache:false,error:EmailHrdPage.onGetIdpError,success:function(d,a,c){EmailHrdPage.onGetFederationProviderSuccess(d,a,c,b)},timeout:getFederationProviderServiceTimeout,headers:{"X-CorrelationId":getCorrelationId}})},startGetIdpRequest:function(e){var a=getIdpServiceUrl,c=EmailHrdPage.GetQueryStringArray(),b=c[EmailHrdPage.hrdModeParam];if(!b)b="0";var d=c[EmailHrdPage.idpParam];if(a.indexOf("?")==-1)a=a+"?";else a=a+"&";a=a+"hm="+encodeURIComponent(b);a=a+"&emailAddress="+encodeURIComponent(e);if(d)a=a+"&idp="+encodeURIComponent(d);EmailHrdPage.requestPending=true;$.ajax({url:a,cache:false,error:EmailHrdPage.onGetIdpError,success:EmailHrdPage.onGetIdpSuccess,timeout:getIdpServiceTimeout,headers:{"X-CorrelationId":getCorrelationId}})},setDescription:function(a){$("#descText").text(OOUI[a])},setTitleHeader:function(a){$("H1").text(OOUI[a])},displaySplitter:function(){if(EmailHrdPage.isWac()){$("#accountLookupBothResponse").show();$("#signInResponseBothMSA").focus()}else{$("#splitter").show();$(".desc").addClass("splitterDesc");$("#content").addClass("splitterContent")}(EmailHrdPage.isMac()||EmailHrdPage.isAppleDevice())&&EmailHrdPage.resetTabIndex()},onGetIdpError:function(a){EmailHrdPage.requestPending=false;EmailHrdPage.hideProgressArea();if(a&&(a.status=="404"||a.status=="502")){EmailHrdPage.isWac()&&$("#accountLookupErrors").show();$("#networkError").show()}else if(EmailHrdPage.isWac()){$("#accountLookupBothResponse").show();$("#signInResponseBothMSA").focus()}else{EmailHrdPage.setDescription("L_EmailHrd_SelectAccountType");if(EmailHrdPage.isManchester())$("H1").hide();else EmailHrdPage.setTitleHeader("L_EmailHrd_Header_Need_Help");$("#emailButton").attr("class",EmailHrdPage.emailButtonClass);$("#emailEntry").hide();EmailHrdPage.displaySplitter()}},displayNotFoundMessage:function(){var b="#accountLookupErrors",a=EmailHrdPage.GetQueryStringArray();if(a[EmailHrdPage.idpParam]==EmailHrdPage.orgIdIdpParamValue&&a[EmailHrdPage.hrdModeParam]==EmailHrdPage.hrdModeParamValueAddService||a[EmailHrdPage.hrdModeParam]==EmailHrdPage.hrdModeParamValueLicensing||a[EmailHrdPage.hrdModeParam]==EmailHrdPage.hrdModeParamValueLicensingNotify||a[EmailHrdPage.hrdModeParam]==EmailHrdPage.hrdModeParamValueOpenFromWeb||a[EmailHrdPage.hrdModeParam]==EmailHrdPage.hrdModeParamValueOpenFromTenant){EmailHrdPage.isWac()&&$(b).show();$("#noAccountError").show()}else{EmailHrdPage.isWac()&&$(b).show();$("#noAccountSignUpError").show()}},displayBothFoundMessage:function(){if(!EmailHrdPage.isWac()){EmailHrdPage.setDescription(supportPhone?"L_EmailHrd_SelectAccount2":"L_EmailHrd_SelectAccount");if(EmailHrdPage.isManchester())$("H1").hide();else EmailHrdPage.setTitleHeader("L_EmailHrd_Header_Need_Help");$("#emailEntry").hide()}EmailHrdPage.displaySplitter()},displayGuardrailMessage:function(){EmailHrdPage.setDescription(supportPhone?"L_EmailHrd_AccountServiceMismatch2":"L_EmailHrd_AccountServiceMismatch")},displayUpdatesRequiredMessage:function(){var a="#emailButton";EmailHrdPage.requestPending=false;EmailHrdPage.setDescription("L_EmailHrd_Description_UpdatesRequired");EmailHrdPage.setTitleHeader("L_EmailHrd_Header_UpdatesRequired");$(".error").hide();$(a).attr("class",EmailHrdPage.emailButtonClass);$(a).text(OOUI["L_EmailHrd_Link_DownloadNow"]);$(a).unbind("click");$(a).click(function(){window.external.LaunchUrl(fpUpdateUrl,true)});$("#emailAddressSpinner").css("display","none");$("#progressArea").css("visibility","hidden");$("#emailAddressContainer").hide()},onGetFederationProviderSuccess:function(a,e,b,c){EmailHrdPage.authorizationService=b.getResponseHeader(EmailHrdPage.authorizationServiceHeader);EmailHrdPage.tokenService=b.getResponseHeader(EmailHrdPage.tokenServiceHeader);if(typeof a==="undefined"||!a){EmailHrdPage.onGetIdpError();return}switch(a){case "Global":EmailHrdPage.federationProvider=null;EmailHrdPage.startGetIdpRequest(c);break;case "Error":EmailHrdPage.requestPending=false;EmailHrdPage.onGetIdpError();break;default:EmailHrdPage.requestPending=false;var d=EmailHrdPage.GetQueryStringArray();if(d[EmailHrdPage.fpParam]=="1"){EmailHrdPage.federationProvider=a;if(EmailHrdPage.isWac()){$("#accountLookupResponse").show();$("#accountLookupResponseOrgId").show();$("#signInResponseOrgId").focus();EmailHrdPage.hideProgressArea()}else orgIdSignIn()}else EmailHrdPage.displayUpdatesRequiredMessage()}},onGetIdpSuccess:function(b){var i="#signInResponseMSA",h="#accountLookupResponseMSA",g="#accountLookupResponseHeader",c="#accountLookupResponse",f="L_EmailHrd_RedirectingToSignIn";EmailHrdPage.requestPending=false;$("#emailButton").attr("class",EmailHrdPage.emailButtonClass);var a;if(EmailHrdPage.isMac())a=f;else a="L_EmailHrd_AccountFoundRedirecting";if(!b){EmailHrdPage.onGetIdpError();return}var d;if(b.indexOf(",")==-1)d=b;else d=b.split(",")[0];switch(d){case "MSAccount":if(EmailHrdPage.isWac()){EmailHrdPage.hideProgressArea();$(c).show();$(g).show();$(h).show();$(i).focus()}else{EmailHrdPage.showProgressArea(a);msAccountSignIn()}break;case "OrgId":if(EmailHrdPage.isWac()){EmailHrdPage.hideProgressArea();$(c).show();$("#accountLookupResponseOrgId").show();$("#signInResponseOrgId").focus()}else{EmailHrdPage.showProgressArea(a);orgIdSignIn()}break;case "Neither":if(EmailHrdPage.isAccelerated()&&!EmailHrdPage.isFirstPartyMsaDomain())msAccountSignUp();else{EmailHrdPage.hideProgressArea();EmailHrdPage.displayNotFoundMessage()}break;case "Both":EmailHrdPage.hideProgressArea();var e=EmailHrdPage.GetQueryStringArray();if(e[EmailHrdPage.idpParam]==EmailHrdPage.msAccountIdpParamValue)msAccountSignIn();else if(e[EmailHrdPage.idpParam]==EmailHrdPage.orgIdIdpParamValue)orgIdSignIn();else EmailHrdPage.displayBothFoundMessage();break;case "Guardrail":EmailHrdPage.hideProgressArea();EmailHrdPage.displayGuardrailMessage();break;case "MSAccountNonEmail":if(EmailHrdPage.isWac()){EmailHrdPage.hideProgressArea();$(c).show();$(g).hide();$(h).show();$(i).focus()}else{EmailHrdPage.showProgressArea(f);msAccountSignIn()}break;case "Error":case "Throttled":case "HIPValidationFailed":default:EmailHrdPage.onGetIdpError()}},resetErrors:function(){$("#invalidEmailError").hide();$("#accountLookupErrors").hide();$("#noAccountSignUpError").hide();$("#noAccountError").hide();$("#networkError").hide();EmailHrdPage.emailAddress=null},resetWacResults:function(){$("#accountLookupResponse").hide();$("#accountLookupResponseMSA").hide();$("#accountLookupResponseOrgId").hide();$("#accountLookupBothResponse").hide();EmailHrdPage.resetErrors()},resetTabIndex:function(){var a=1;$("input,select,a,button").each(function(){var b="tabindex",c=this;if(c.type!="hidden"&&c.offsetHeight){var d=$(c);d.attr(b,a);a++}else c.removeAttribute(b)})},backToWacLandingPage:function(){var a="aria-hidden";EmailHrdPage.resetWacResults();EmailHrdPage.resetErrors();EmailHrdPage.hideProgressArea();$("#emailHelperText").show();$("#accountLookup").attr(a,"true").hide();$("#landingPage").attr(a,"false").show();$("#signInMSA").focus()},onEmailAddressSubmitted:function(){var d="class",c="#emailButton",g="L_EmailHrd_LookingForAccount",f="#emailHelperText",e="aria-invalid",b="#emailAddress";EmailHrdPage.resetErrors();EmailHrdPage.isWac()&&EmailHrdPage.resetWacResults();if(!EmailHrdPage.requestPending){var a=$.trim($(b).val());if(EmailHrdPage.isEmail()){$(b).removeAttr(e);$(f).hide();EmailHrdPage.emailAddress=a;EmailHrdPage.showProgressArea(g);EmailHrdPage.emailButtonClass=$(c).attr(d);EmailHrdPage.hideEmailValidationError();!EmailHrdPage.isManchester()&&$(c).attr(d,EmailHrdPage.disabledButtonClass);EmailHrdPage.startGetFederationProviderRequest(a)}else if(supportPhone&&EmailHrdPage.isValidInput()){$(b).removeAttr(e);$(f).hide();EmailHrdPage.emailAddress=a;EmailHrdPage.showProgressArea(g);EmailHrdPage.emailButtonClass=$(c).attr(d);!EmailHrdPage.isManchester()&&$(c).attr(d,EmailHrdPage.disabledButtonClass);EmailHrdPage.federationProvider=null;EmailHrdPage.startGetIdpRequest(a)}else{EmailHrdPage.showEmailValidationError();$(b).attr(e,"true")}}},clearEmailAddress:function(){var a="#emailAddress";if(!EmailHrdPage.clearedEmailAddress&&!EmailHrdPage.isValidInput()){EmailHrdPage.clearedEmailAddress=true;$(a).val("");$(a).removeClass(EmailHrdPage.notInUseEmailAddressClass);$(a).addClass(EmailHrdPage.inUseEmailAddressClass);$("#emailAddressSearchBox").removeClass("notInUseEmailAddressSearchBox")}},getContextInformation:function(){try{if(typeof window.external.GetContextInfo!="undefined")return window.external.GetContextInfo()}catch(a){window.console&&console.log(a.message)}return null},setDescriptionForContext:function(){var d="string",b=null,j=EmailHrdPage.GetQueryStringArray(),h=j[EmailHrdPage.hrdModeParam];if(!h)h="0";if(h==EmailHrdPage.hrdModeParamValueOpenFromWeb){var i=EmailHrdPage.getContextInformation();if(i!==b){var a=jQuery.parseJSON(i),f=true;if(typeof a.knownUrl==="boolean")f=a.knownUrl;var g=b;if(typeof a.title===d&&a.title!=="")g=a.title;var c=b;if(typeof a.friendlyUrl===d&&a.friendlyUrl!=="")c=a.friendlyUrl;var e=b;if(typeof a.url===d&&a.url!=="")e=a.url;if(g!=b)EmailHrdPage.setDescriptionText(f,g,c,e);else c!=b&&EmailHrdPage.setDescriptionText(f,c,b,e)}}},setDescriptionText:function(g,f,c,d){if(!g)f=EmailHrdPage.getFriendlyTextForPath(d);var a;if(EmailHrdPage.validateUrlScheme(d))a=$("<a/>");else a=$("<span/>");var e="descContext";a.attr({id:e}).text(String.format("{0}",f));typeof c==="string"&&c!==""&&a.attr({title:c});var b=decodeURIComponent(String.format('"{0}"',a.outerHTML()));if(g)b=String.format(OOUI.L_EmailHrd_Description_OpenFromWebWithContextKnown3,b);else b=String.format(OOUI.L_EmailHrd_Description_OpenFromWebWithContextUnknown,b);$("#descText").html(b);EmailHrdPage.setClickableUrlForElement(d,"#"+e)},setClickableUrlForElement:function(b,e){var c="function",d=$(e);EmailHrdPage.validateUrlScheme(b)&&typeof launchUrl===c&&d.click(function(){launchUrl(b)});var a;if(typeof getLaunchUrlHref===c)a=getLaunchUrlHref(b);else a="javascript:void(0)";d.attr({href:a})},validateUrlScheme:function(a){var b=/^(https?|ftp|file|mailto):\/\//i;if(typeof a==="string"&&a.length!=0&&b.test(a))return true;return false},getFriendlyTextForPath:function(b){if(typeof b!=="string"||!EmailHrdPage.validateUrlScheme(b))return b;var a=EmailHrdPage.getOnenoteNotebookFriendlyText(b);if(a.isRemapped)return a.path;a=EmailHrdPage.getCommonFileFriendlyText(b);if(a.isRemapped)return a.path;a=EmailHrdPage.getFallbackFriendlyText(b);if(a.isRemapped)return a.path;return b},stripSchemaFromUrl:function(b){var a=/^(?:(?:https?|ftp|file|mailto):\/\/)?(.*)$/i;return EmailHrdPage.matchRegexAndReturnFirstResult(b,a)},stripQueryParamsFromUrl:function(b){var a=/^([^?#]*)(?:(?:\?|\#)?[^?#]*)?$/i;return EmailHrdPage.matchRegexAndReturnFirstResult(b,a)},getFileExtension:function(b){var a=/\.([^.]*)$/i;return EmailHrdPage.matchRegexAndReturnFirstResult(b,a)},matchRegexAndReturnFirstResult:function(c,d){var a=null;if(c==a)return a;var b=c.match(d);if(b!=a)return b[1];return a},extractLastItemFromPath:function(c){var a=c.split("/"),b=1;if(a.length>0){if(a[a.length-b]=="")b++;return a[a.length-b]}return null},tryRemoveLastItemFromPath:function(b){var a=b.split("/");a.length>1&&a.splice(a.length-1,1);return a.join("/")},getCommonFileFriendlyText:function(c){var a=EmailHrdPage.stripQueryParamsFromUrl(EmailHrdPage.stripSchemaFromUrl(c)),d=EmailHrdPage.getFileExtension(EmailHrdPage.extractLastItemFromPath(a)),b=null;if(d!==null)b=EmailHrdPage.extractLastItemFromPath(a);return EmailHrdPage.getRemappedPathObject(b,c)},getOnenoteNotebookFriendlyText:function(c){var a=EmailHrdPage.stripQueryParamsFromUrl(EmailHrdPage.stripSchemaFromUrl(c)),b=null,d=EmailHrdPage.getFileExtension(EmailHrdPage.extractLastItemFromPath(a));if(d==="one")b=EmailHrdPage.extractLastItemFromPath(EmailHrdPage.tryRemoveLastItemFromPath(a));return EmailHrdPage.getRemappedPathObject(b,c)},getFallbackFriendlyText:function(a){var b=EmailHrdPage.stripQueryParamsFromUrl(EmailHrdPage.stripSchemaFromUrl(a));return EmailHrdPage.getRemappedPathObject(b,a)},getRemappedPathObject:function(b,c){var a={};if(b!==null&&typeof b==="string"){a.isRemapped=true;a.path=b}else{a.isRemapped=false;a.path=c}return a},setWacEventHandlers:function(){var f="emailAddressHover",e="emailAddressSearchBoxHover",l="#emailAddressSearchButtonIcon",d="hover",c="default",a="src",k="#headerBackArrowImage",b="#emailAddress",j=$("#signInMSA").click(msAccountSignIn),i=$("#signInOrgId").click(orgIdSignIn);if(j.size()===1&&i.size()===1){var g=i.width(),h=j.width();if(g>h)j.width(g);else g<h&&i.width(h)}$("#ancNotSure").click(function(){var a="aria-hidden";$("#landingPage").attr(a,"true").hide();$("#accountLookup").attr(a,"false").show();$(b).focus()});$("#signInResponseMSA").add("#signInResponseBothMSA").click(msAccountSignIn);$("#signInResponseOrgId").add("#signInResponseBothOrgId").click(orgIdSignIn);if(!isRtl){$(k).attr(a,Base64Icons.BackArrow).data(c,Base64Icons.BackArrow).data(d,Base64Icons.BackArrowHover);$(l).attr(a,Base64Icons.HrdMagnifyingGlass)}else{$(k).attr(a,Base64Icons.BackArrowRTL).data(c,Base64Icons.BackArrowRTL).data(d,Base64Icons.BackArrowRTLHover);$(l).attr(a,Base64Icons.HrdMagnifyingGlassRTL)}$("#emailInProgressImg").attr(a,Base64Icons.HrdProgress);$("#headerBackArrow").click(EmailHrdPage.backToWacLandingPage).hover(function(){var c=$(this),b=c.find("img");b.attr(a,b.data(d))},function(){var d=$(this),b=d.find("img");b.attr(a,b.data(c))});var n=supportPhone?OOUI.L_EmailHrd_WacAccountNotFoundTryAgainOrSignUp2:OOUI.L_EmailHrd_WacAccountNotFoundTryAgainOrSignUp,m=String.format(n,$("#noAccountSignUpErrorLink").outerHTML());$("#noAccountSignUpError").html(m);$("#emailAddressSearchBox").hover(function(){if(!EmailHrdPage.clearedEmailAddress){$(this).addClass(e);$(b).addClass(f)}},function(){if(!EmailHrdPage.clearedEmailAddress){$(this).removeClass(e);$(b).removeClass(f)}})},postMessage:function(a){if(typeof a==="string")a=$.parseJSON(a);if(EmailHrdPage.emailAddress!==null&&a.op==="ShowNext"&&(a.nextScreen==="0"||a.nextScreen==="3"))a["emailAddress"]=EmailHrdPage.emailAddress;parent.postMessage(JSON.stringify(a),"*")},initPage:function(){var a="background-color",e="#msLink,#orgIdLink",b=false,d="#emailAddress",f="#emailButton",c=true;EmailHrdPage.postMessage('{"op":"OnReady","calcHeightPx":"'+($("#content").outerHeight(c)+50)+'"}');$("input:text").attr("autocomplete","off");EmailHrdPage.isWac()&&EmailHrdPage.setWacEventHandlers();EmailHrdPage.setDescriptionForContext();$(f).click(EmailHrdPage.onEmailAddressSubmitted).keydown(function(a){a.which==EmailHrdPage.enterKeyCode&&EmailHrdPage.onEmailAddressSubmitted()});if(EmailHrdPage.isEmailSupported()&&$(d).length>0)$(d)[0].type="email";$(d).click(EmailHrdPage.clearEmailAddress).mousedown(function(a){a.button===2&&EmailHrdPage.clearEmailAddress()}).keydown(function(a){EmailHrdPage.clearEmailAddress();a.which==EmailHrdPage.enterKeyCode&&$(f).click()}).bind("touchstart",function(){EmailHrdPage.clearEmailAddress()}).focus(function(){EmailHrdPage.isScrollStop=c}).blur(function(){EmailHrdPage.isScrollStop=b});$("#msLink").keydown(function(a){a.which==EmailHrdPage.enterKeyCode&&msAccountSignIn()});$("#orgIdLink").keydown(function(a){a.which==EmailHrdPage.enterKeyCode&&orgIdSignIn()});if(styleChangesEnabled){$(e).hover(function(){var b=this;$(b).data(EmailHrdPage.hoveringKey,c);if(!$(b).is(":focus")){var d=EmailHrdPage.findAccount($(b));d.css(a,hoverColor);d.css(a).replace(/\s/g,"")!=hoverColor&&EmailHrdPage.setAccountOutline($(b))}},function(){var c=this;$(c).data(EmailHrdPage.hoveringKey,b);$(c).data(EmailHrdPage.pressedKey,b);var d=EmailHrdPage.findAccount($(c));if($(c).is(":focus"))d.css(a,focusColor);else{d.css(a,EmailHrdPage.getBodyColor());EmailHrdPage.resetAccountOutline($(c))}});$(e).focus(function(){if(!$(this).data(EmailHrdPage.pressedKey)){var b=EmailHrdPage.findAccount($(this));b.css(a,focusColor);b.css(a).replace(/\s/g,"")!=focusColor&&EmailHrdPage.setAccountOutline($(this))}});$(e).blur(function(){var b=this,c=EmailHrdPage.findAccount($(b));if($(b).data(EmailHrdPage.pressedKey))c.css(a,pressedColor);else if($(b).data(EmailHrdPage.hoveringKey))c.css(a,hoverColor);else c.css(a,EmailHrdPage.getBodyColor());EmailHrdPage.resetAccountOutline($(b))});$(e).mousedown(function(){$(this).data(EmailHrdPage.pressedKey,c);EmailHrdPage.setPressedColor($(this))});$(e).mouseup(function(){$(this).data(EmailHrdPage.pressedKey,b);EmailHrdPage.resetPressedColor($(this))});$(e).keydown(function(a){if(a.which==EmailHrdPage.enterKeyCode){$(this).data(EmailHrdPage.pressedKey,c);EmailHrdPage.setPressedColor($(this))}});$(e).keyup(function(a){if(a.which==EmailHrdPage.enterKeyCode){$(this).data(EmailHrdPage.pressedKey,b);EmailHrdPage.resetPressedColor($(this))}})}if(shouldSetFocus){$(".signInButton").focus();$("#msLink").focus();$(d).focus();EmailHrdPage.isWac()&&$("#signInMSA").focus()}if(!EmailHrdPage.isWac()&&($(d).val()!=OOUI["L_EmailHrd_TypeEmailAddress"]||$(d).val()!=OOUI["L_EmailHrd_TypeEmailAddress2"])){$(d).removeClass(EmailHrdPage.notInUseEmailAddressClass);$(d).addClass(EmailHrdPage.inUseEmailAddressClass)}if(EmailHrdPage.isAppleDevice()&&!EmailHrdPage.isIPhone()){$(document).bind("touchmove",function(a){a.preventDefault()});$(window).scroll(function(){!EmailHrdPage.isScrollStop&&$(window).scrollTop(0)})}if(EmailHrdPage.isMac()||EmailHrdPage.isAppleDevice()){$(f).removeAttr("href");$(".accountLink").removeAttr("href");EmailHrdPage.resetTabIndex()}$(document).keydown(EmailHrdPage.onKeyDown)}};var Base64Icons={BackArrow:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHVSURBVFhHxZdNSgNBEEZzmniW4AWCB1DcK64VXIrgUgSXIrgVcS3iOuJePYG5QTuv4Wtr+mfSyUycxYNMVVfX19XVnZmJc25UssYSL69v7vrm1u0fHDaRkwR8EMd1kTXGMOl0upMk7OLo+MQt3j+a8PycImsUrHg22w2TIgIxd/cPjbs99me59D4Sx0LwxeNF1ggXl1dhEkTkkpYgYRxfqkZigNOz8xDMRLG/FpLO53t+HqqXE9F6AKt8nVV3oaZFxOfXd2P687UGPj49D55cqBJsh7WHH+ybGq5P2Uuwcp0ke1TDAIxS2NW1QHUYC6W9zaE4YpQjOKVuVek3TS5UZVXBG7X3VlkOm5yJ4oaqwVaaZ29U53Np8JxjiOTAAjUP1fNGdahtDotU900ulM8vCoP2n6vXDgSbfF1U5hhd135uDAqIGwpB8m1CSYBuWr/1GBSQ6+htVCAR0LUFMHQPJFuwqglhSBFJE9YcQxhCRPYY1l5E0Pcm1CLUH8GhPiCBbCX6iCAxcdru4LDKVlVhUyTcVjo4MUjdKH/HMOoLidCJGFJE9SuZGPWlVNhKULZ1qkE/xfGlk5IYLKN+mFiYWB1cC4lr7oessQQVQcy/f5xuDzf5BXiRa2eWHX53AAAAAElFTkSuQmCC",BackArrowHover:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAH2SURBVFhHxZexUgJBDIZ5c3iG4xWwwworbNRCx0ItdCzURh0EbOQN1vt35l9z2eS4wz0tvoI/2SSbzS4wCiH8K6bo8fr2Hm5u78JicRImk0kGbECva8MUNQg6nU7NpB7L5WnYbD/r5XZMYooEO57NjlJQFIFi7h8ea3PuDxsS60K0n8QUweXVdQqCIrykHnq9141MAGfnF2kxAml7V5B0Pj+OcdA9q4jGByAr77trDw4tivja7Wrpx9ZwfHp+KZ6csBM4Dqk3nDhwv2m7B3bOmySvanKAaFVoge7AF3hna8F1WEMtGVndvtYfmpywy+xCFHn2sjILmRyB9EB1QXc6ipz8tkejRHLCOOheFDihcjgkrLpEcsB82FQUeP54eqUjkMn7wjZr+FwjdhS4QA8UCqLtELwC+NLi6KPABdZED9GBrIC2IwClZyA7gn1DCEoWkQ1hl2sIShXBGOkadn2IgH4J15ttLdu+FtwE5yMZOAdIQM1DFlFVVVh9rGvZ9tVwLTebDLqyoUB85OG8mcYhvo4BZ01usuEw5A8SeWzIQz1zZJUli5DJdXcbjqTUj1IgN4S42t74IJELcWZ9uwF/zhTwNpIJkr5/TKDDzisNsN574oEpanRQyXg8NnUWq2NpTNEDO0FQ+edUFgAd9rYda0zx7wijb45b03H3oWWgAAAAAElFTkSuQmCC",BackArrowRTL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHvSURBVFhHxZdPSkMxEId7mnqW4gWKB1DcK64VXIrgUgSXIrgVcS3iWnGvnsDe4Pm+wC9Ok3nvJX0tXXyhmfyZX2YmaTtpmmaruMYurm9uG5i0y1L2Dw7D2MvrWzvVX+/hGi3vH5/N0fFJ5rCP6XQniEn38nCN8LtYZI7pszFj6fy7+4cwhnPNn812ByPiGjk1i7XRxeWV67QLxKTr0zkiM+Bcp5jP9xr66ZxScCwRp2fnrSmfs9T5+v6JzikqO7YqREMivEgsdRQ2Tm7tY7EiHp+eW9P/WPyg60UEiITs60Lp4JC2nkKDQaFHrQb7sLVSsg4firC9oqHR6ZmggRJqRSgVrJEtNJ6yUkiX1g+JsJFWLYRTaHHNXbfUiNDjphsRwzK28lMRXdFUuuUvGlCmSRa7aS2eCJ5mxlQH8Xp0vVRjBED6XWBTTn+jArwIZAKGUlBKaQ1kKVhHEZY6Bx04FuHYa1jjHLJrSKMNhhan1L6E7kNEo7AghH4Jtc5B6Vb+ITRWWclGq4APL9JxgqKAEPIq+7ro/ToWUriVHyTAyZWKrfwkA1tcRIJ+OqcUhR2KfpQKnCodUl7zRnDqdH06R7hGwKEeDUGfYvXE4JQxRQ8QsdIfEwvRSIUMgQh71fpwjV2wqa5rysb+nG6WZvIHzDVrZzvZLhEAAAAASUVORK5CYII=",BackArrowRTLHover:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHsSURBVFhHxZc9UsMwEIVzc/sM9hVCF6pQhQYoyFAABQwF0AATktAkNxB+mnliLa1sKbaH4vNYq599uysp8cwY86+oxhj3D48GlGUZsFxe2L6Pz69mqD5fQzVKdvsfs1pdqk5j1HVtxfhraahG4jtGO7bw0/OL7YNzjp/Pz3ozohoRNSZzodv1XWMOx8WAmNT5gQHOGcVicW7Q9sekAscUcXV905jCMa3G4Xh0zrGpZN+pIBsUoWWi1WDaELm0D0WKeH17b0x/fe6FxwsZQCZoHwuWA0FKu3th6qGWti7kXkmdxwzLk2QfjN5X10euCJYCc2izD01ZKigX56eIoGDuBRsFJ3NQLjkieLnxRLi0DN35vohYNllu+nMGKOMgiVw0F00Ermb0cR+44xG7qYYIAP5vgV/ySQVoGQgE9JUgldQ9EJRgjE2Y6hwwYLcJhx7DHOcgOIZ4cIG+yT7b3T77Og4uImlMWYBsvremqqos5yw36w/sg3VBJtgxBVqmg07WZmx43P0g3QtqggEgpxQpMPUg+ocEUOWYIqRzLbutBsCN2DUhBxlQ0p9SIieiZrnZwHjuKdAViGoEuDLlIjg62L0xMbCjX94LmH/Sh4nEX1RSFIVqp1h/LQ3VqIFIsCi+F+hICpjs43RazOwXRobTccIvOBcAAAAASUVORK5CYII=",HrdMagnifyingGlass:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAC2SURBVDhPpZK7EYUgEEWtljGjB2JSKrEGCyAkpZF9HmZW+TgPR4Oj7r17YVEXEfnErQg5ZwkhiDHmhBq97mtCyr7vZ8g5J977clcNX3uHMDvQZK2VlNIhXR41Or5O0oRBx+7DCjo+fdRDAybj9nqNHofnwcTgzL1eg/93gU8T6DuIMR5l68H0HWzbVhrWdR0WmX6F+vsrjPvoP+jDTKLHUahv/8Q+XO8wo1zehqFc3obhVnyOLD+KEt2xHm4EJQAAAABJRU5ErkJggg==",HrdMagnifyingGlassRTL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAC4SURBVDhPpVKxDcQgDMy0iI4dqGmZhBkYgJKWRfx/lswbi5CXUpyD7w5jiC8ieoUlGWNQzpmccxPIwWufxlzUWuemGCOllPgrHHTxanDACTCFEKj3/qV+BuTgoe864SBt280C8NDhsxoHiGhXCxZyHctzgIA7a8EC+rHAqw6e3qC1dn6D01/AZu8966WURQPm4mkOBHYe5gK4m0ScrDldZClwgu5QF9ma72CLgNsaT9BFkG9N/4OuD9oi3bGjid1IAAAAAElFTkSuQmCC",HrdProgress:"data:image/gif;base64,R0lGODlhGAAYAIABAJmZmf///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQFCgABACwAAAAAGAAYAAACHYyPCZDtt9abMNIrr968+w+G4kiW5omm6sq27lYAACH5BAUKAAEALBQABgAEAAQAAAIFDGCnl1EAIfkEBQoAAQAsFAAOAAQABAAAAgUMYKeXUQAh+QQFCgABACwOABQABAAEAAACBQxgp5dRACH5BAUKAAEALAYAFAAEAAQAAAIFDGCnl1EAIfkEBQoAAQAsAAAOAAQABAAAAgUMYKeXUQAh+QQFCgABACwAAAYABAAEAAACBQxgp5dRACH5BAkKAAEALAYAAAAMAAQAAAILDBCperfb0GNyhgIAIfkECQoAAQAsAAAAABgAGAAAAh2MHwDI3aqcZHDNmyzevPsPhuJIluaJpurKtu47FgAh+QQJCgABACwAAAAAGAAYAAACMowfAMjdqpxkcM2bLN687+hRUIhUZKmd6sq2HhhG5luNtJx2sMs/ecaZGYQTIrH42x0KACH5BAkKAAEALAAAAAAYABgAAAIwjB8AyN2qnGRwzZss3rzv6FFQiFRkqZ3qyrYeqJrxuMLujWdPOsmG36P9hBfb0FEAACH5BAkKAAEALAAAAAAYABgAAAIqjB8AyN2qnGRwzZss3rzv6FFQiFRkqZ3qyrYeqJrxuMLujWesfPJ9iikAACH5BAkKAAEALAAAAAAYABgAAAImjB8AyN2qnGRwzZss3rzv6FFQiFRkqZ3qyrYeqJrxuMLujef6PhUAIfkECQoAAQAsAAAAABgAGAAAAiOMHwDI3aqcZHDNmyzevO/oUVCIVGSpnerKtu4Lx/JM1zZWAAAh+QQJCgABACwAAAAAGAAYAAACHYwfAMjdqpxkcM2bLN68+w+G4kiW5omm6sq27jsWADs="},dirHtml=$("html").attr("dir"),isRtl=dirHtml!==null&&dirHtml.toLowerCase()==="rtl",EmailHrdPage=new EmailHrdPage;$(document).ready(EmailHrdPage.initPage);jQuery.fn.outerHTML=function(a){return a?this.before(a).remove():jQuery("<p>").append(this.eq(0).clone()).html()}
