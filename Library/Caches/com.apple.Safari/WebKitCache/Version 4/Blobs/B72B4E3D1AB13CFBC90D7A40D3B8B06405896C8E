try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.attachments.filepicker.viewmodels.js'] = (new Date()).getTime();
Type.registerNamespace("_am");_am.G=function(){};_am.G.prototype={a:function(n){return new _am.A(n,"groupId_"+n)}};_am.z=function(){};_am.z.registerInterface("_am.z");_am.y=function(){};_am.y.registerInterface("_am.y");_am.A=function(n,t){_am.A.initializeBase(this);this.e=n;this.d=t};_am.A.prototype={e:null,d:null,a:function(){return this.d},b:function(){return!1},c:function(n){return n}};_am.H=function(n,t,i,r,u){_am.H.initializeBase(this,[n,null,null,r]);var f=this;this.E(new _j.g(function(){u(t,i)},_a.a.c))};_am.d=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.gm=Function.createDelegate(this,this.ib);this.gn=Function.createDelegate(this,this.ic);_am.d.initializeBase(this,[n,t,i,r,u,f,e,o,s,l,a]);this.bF=h;this.cG();c&&this.gl(c.Response)};_am.d.b=function(){return"AttachmentNotification"+(_a.c.a().h()+_ff.o.a(0,1e3)).toString()};_am.d.prototype={bF:null,r:null,c:!1,fz:function(){return this.cm()?!0:_at.a.prototype.fz.call(this)},cm:function(){return _dg.b.isInstanceOfType(this.bm)||_dg.c.isInstanceOfType(this.bm)&&_y.E.isInstanceOfType(this.bm.c)&&!this.bm.c.e()},dU:function(){if(this.cm()){var n;return _dg.b.isInstanceOfType(this.bm)&&!_j.i.a(n=this.bm.bj.AttachmentPreviewUrl)?n:this.bo()?this.bw+"&isImagePreview=True":null}else return _at.a.prototype.dU.call(this)},fy:function(){var n;return _dg.b.isInstanceOfType(this.bm)&&!_j.i.a(n=this.bI)?n:null},ea:function(){return this.cm()?null:_at.a.prototype.ea.call(this)},ck:function(){return this.cm()?null:_at.a.prototype.ck.call(this)},U:function(){return this.cm()?null:_at.a.prototype.U.call(this)},l:function(){this.r||(this.r=_am.d.b());return this.r},eR:function(){return"AttachmentProviderItemViewModel"},dd:function(){return _dg.b.isInstanceOfType(this.bm)||_at.a.prototype.dd.call(this)},ed:function(n){if(_dg.b.isInstanceOfType(this.bm)||_dg.c.isInstanceOfType(this.bm)&&_y.E.isInstanceOfType(this.bm.c))if(_dg.c.isInstanceOfType(this.bm)){_j.e.a(_am.d.a,"Uploading attachment from attachment data provider.");this.ia(this.bm.c)}else if(_y.E.isInstanceOfType(this.bm.c)){_j.e.a(_am.d.a,"Sharing attachment from attachment data provider.");this.ie(this.bm.c)}else{_j.e.a(_am.d.a,"Uploading local file to attachment data provider so it can be shared.");_at.a.prototype.ed.call(this,n)}else{_j.e.c(_am.d.a,"Unsupported upload type.");n(null)}},eb:function(){var n=0;if(_dg.b.isInstanceOfType(this.bm)){var i,t;(t=_db.k.c(this.bm,i={val:n}),n=i.val,t)||(n=this.fA()?10:this.bq.b?3:6)}else n=_at.a.prototype.eb.call(this);return n},cG:function(){var n=!!this.bo()&&!!this.bo().bj.AttachLongPathName;n&&this.jN(_db.k.g(this.bo(),this.bF));if(this.cb&&this.dd()&&this.bm.bj.AttachmentId&&n&&!this.bo().q()){var t=_at.G.a(this.bn);this.dv(this.cb.b(this.bo().bj.ProviderType,this.bm.bj.AttachmentId.Id,this.bo().bj.AttachLongPathName,t));this.ha()&&this.dv(this.bw+"&isDocumentPreview=True");return}_at.a.prototype.cG.call(this)},fi:function(n,t){_at.a.prototype.fi.call(this,n,t);if(t==="AttachLongPathName"){this.cG();this.et("HoverText")}else t==="Name"&&this.et("HoverText")},dt:function(n){this.D();var t=null;if(this.bn.c()){if(this.bX&&this.bX.a(this.bn.c(),"AttachmentGetOneDriveUploadFolderProps")){t=_at.h.d(this.bn.c());if(!t){var u=this;var f=function(t){var i=t.i;_j.e.a(_am.d.a,String.format("Getting upload folder id succeeded. Id: {0}",i));u.cs(n,i)};var i=this;var r=function(t){_j.e.a(_am.d.a,"Getting upload folder id failed");i.cs(n,null)};this.id(this.bn.c(),f,r);return}}}else t=_at.h.d("PersonalOneDriveKey");this.cs(n,t)},gj:function(){this.D();this.c=!1;this.eo.a()},hc:function(){if(!_j.i.a(this.ci)){this.hZ();this.cv(this.cI,this.ci,!1)}},hW:function(n){if(n.Item){var u=!1;var r=this.bm.c;r&&_y.E.isInstanceOfType(r)&&(u=r.j());var i=n.Item;var t;var f=(t=new _db.d,t.q(i.Name),t.r(i.Size),t.B(""),t.o(i.AttachmentProviderId),t.p(_g.p.toString(i.ProviderType)),t.u(i.Location),t.t(i.Id),t.v(i.ParentId),t.z(i.ProviderEndpointUrl),t.A(i.Thumbnail?i.Thumbnail.Url:null),t.y(i.Preview?i.Preview.Url:null),t.s(this.c),t.x(u),t.w(!1),t);this.bm.c=f}},eN:function(){this.fV(!this.bA&&this.bs.t()&&_dg.b.isInstanceOfType(this.bm)&&!this.bm.bj.AttachmentId&&!this.bm.c)},ia:function(n){this.D();this.c=!0;_j.e.a(_am.d.a,"Submitting action CreateAttachmentFromAttachmentDataProviderAction.");this.bm.b()&&(this.bW=this.bn.I(this.bm.bj.Name,0,0));var t=new _ao.j(this.bn.b(),n.c(),n.f(),n.k(),this.l(),this.bn.c(),n.g(),n.l(),this.bE(),this.cK(),this.bm.b());t.e(this.C);this.bG.a(t)},ie:function(n){this.c=!1;var t=new _at.I(this.bn.b(),n.c(),n.f(),n.k(),this.bn.c(),n.g(),n.l(),this.bE(),n.h(),n.n(),n.i(),this.cK());t.d(this.gn);t.e(this.gm);this.bG.a(t)},ic:function(n){var i=n.l;var t=this.gl(i);t&&this.cv(1,t,!0);this.cx(n)},ib:function(n){this.dO(n);this.cx(null)},id:function(n,t,i){var r=new _at.h(n);r.d(t);r.e(i);this.bG.a(r)},cs:function(n,t){_j.e.a(_am.d.a,"Submitting action CreateReferenceAttachmentFromLocalFileAction with folderID: "+t);this.c=!1;var i=new _ao.k(this.bn.b(),this.bm.bj.Name,n,t,this.l(),this.bn.c(),this.bE(),this.bH?this.bH.a():n.length,this.cr,this.bQ,this.cK());i.d(this.eU);i.e(this.C);this.bG.a(i)}};_am.B=function(n,t,i,r,u){this.e=n;this.d=t;this.g=i;this.f=r;this.c=u};_am.B.prototype={e:null,d:null,g:null,f:null,c:null,h:0,a:function(n,t,i,r,u,f,e,o){!this.c.d.h()&&++this.h<=3&&this.g.b();var s=_at.o.a(this.f,this.c,u);return new _am.d(n,t,i,r,u,f,e,o,this.e,this.d,null,s,this.c)},b:function(n,t,i,r,u,f,e,o,s){var h=_at.o.a(this.f,this.c,u);return new _am.d(n,t,i,r,u,e,o,s,this.e,this.d,f,h,this.c)}};_am.j=function(n,t,i,r,u){this.d=Function.createDelegate(this,this.i);this.e=Function.createDelegate(this,this.f);_am.j.initializeBase(this);this.a=n;this.c=i;this.b=u;if(r.a()==="TouchNarrow")this.eg(this.g());else{var f=_y.f.a(_ufp.A.Z,this.ef);this.ee(_y.k.a(this,[f],null))}this.a.d.i.e(this.e);this.a.d.apcl("BreadCrumbs",this.d)};_am.j.prototype={a:null,c:null,b:null,n:function(){return 1},h:function(){if(!this.a.d.i)return null;for(var t=this.a.d.i,r=t.x.length,i=new _j.k,n=1;n<=2&&r-n>=0;n++)i.t(0,t.x[t.x.length-n]);return i},ep:function(){this.a.v(null);_y.hO.prototype.ep.call(this)},f:function(n,t){this.et("BreadCrumbs")},i:function(n,t){this.f(null,null)},g:function(){var n=this.b.b();n.d(_ufp.A.BQ);if(this.c.b()){n.a(this.b.a(_y.b.b(),_y.b.b(),this.ef,""));n.e(3)}else n.a(this.b.a(_y.b.a(),_y.b.a(),this.ef,""));return n}};_am.k=function(n,t,i,r,u){this.d=Function.createDelegate(this,this.i);this.e=Function.createDelegate(this,this.f);_am.k.initializeBase(this);this.a=n;this.c=i;this.b=u;if(r.a()==="TouchNarrow")this.eg(this.g());else{var f=_y.f.a(_ufp.A.Z,this.ef);this.ee(_y.k.a(this,[f],null))}this.a.d.h.e(this.e);this.a.d.apcl("BreadCrumbs",this.d)};_am.k.prototype={a:null,c:null,b:null,n:function(){return 1},h:function(){if(!this.a.d.h)return null;for(var t=this.a.d.h,r=t.x.length,i=new _j.k,n=1;n<=2&&r-n>=0;n++)i.t(0,t.x[t.x.length-n]);return i},ep:function(){this.a.t(null);_y.hO.prototype.ep.call(this)},f:function(n,t){this.et("BreadCrumbs")},i:function(n,t){this.f(null,null)},g:function(){var n=this.b.b();n.d(_ufp.A.BQ);if(this.c.b()){n.a(this.b.a(_y.b.b(),_y.b.b(),this.ef,""));n.e(3)}else n.a(this.b.a(_y.b.a(),_y.b.a(),this.ef,""));return n}};_am.f=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this.cb=Function.createDelegate(this,this.cD);this.bz=Function.createDelegate(this,this.cE);_am.f.initializeBase(this,[n,t,i,u,f,e,o,s,h,c,l,a,v,y,p]);this.bA=r;this.d.bH(this.bz);this.bC=h;this.Q=w};_am.f.prototype={bA:null,bh:null,bg:null,bi:null,cd:!1,bC:null,Q:null,dQ:function(){return this.cd},bB:function(){this.bh||(this.bh=new _j.g(this.cb,_a.a.c));return this.bh},bj:function(){return null},cc:function(){return null},l:function(){if(!this.bg){var n=_y.f.a(_ufp.A.Z,this.bB());this.bg=_y.k.a(this,[n],null)}return this.bg},bG:function(){return null},z:function(){this.bi||(this.bi=this.cC());return this.bi},n:function(){return 1},cU:function(){this.ce()},t:function(){_am.b.prototype.t.call(this);this.ce();this.d.Y(null);this.d.ba(null)},bn:function(){return!1},E:function(){_am.b.prototype.E.call(this);var n=!!this.d.c||this.k||this.D||this.o;this.S&&n&&this.S.d(this.bA.e())},cD:function(){this.bm.a()},ce:function(){this.bb(!1);this.P(!1);this.O(!1);this.v(null)},cE:function(){this.cB();this.d.cr(this.bz)},cC:function(){var n=this.Q.b();n.d(_ufp.A.d);if(this.bC.b()){n.a(this.Q.a(_y.b.b(),_y.b.b(),this.bB(),""));n.e(3)}else n.a(this.Q.a(_y.b.a(),_y.b.a(),this.bB(),""));return n}};_am.i=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.bV=Function.createDelegate(this,this.cB);this.bA=Function.createDelegate(this,this.cC);_am.i.initializeBase(this,[n,t,i,u,f,e,o,s,h,c,l,a,v]);this.bB=r;this.d.bm(this.bA);this.bD=h;this.N=y};_am.i.prototype={bB:null,be:null,bd:null,bf:null,bW:!1,bD:null,N:null,dQ:function(){return this.bW},bC:function(){this.be||(this.be=new _j.g(this.bV,_a.a.c));return this.be},bj:function(){return null},cc:function(){return null},l:function(){if(!this.bd){var n=_y.f.a(_ufp.A.Z,this.bC());this.bd=_y.k.a(this,[n],null)}return this.bd},bG:function(){return null},z:function(){this.bf||(this.bf=this.cA());return this.bf},n:function(){return 1},cU:function(){this.bX()},A:function(){_am.c.prototype.A.call(this);this.bX();this.d.I(null);this.d.K(null)},bn:function(){return!1},x:function(){_am.c.prototype.x.call(this);var n=!!this.d.c||this.h||this.v||this.m;this.Q&&n&&this.Q.d(this.bB.e())},cB:function(){this.bl.a()},bX:function(){this.ba(!1);this.L(!1);this.K(!1);this.t(null)},cC:function(){this.cz();this.d.bD(this.bA)},cA:function(){var n=this.N.b();n.d(_ufp.A.d);if(this.bD.b()){n.a(this.N.a(_y.b.b(),_y.b.b(),this.bC(),""));n.e(3)}else n.a(this.N.a(_y.b.a(),_y.b.a(),this.bC(),""));return n}};_am.b=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.cg=Function.createDelegate(this,this.dc);this.cn=Function.createDelegate(this,this.dF);this.co=Function.createDelegate(this,this.cA);this.cm=Function.createDelegate(this,this.cz);this.cl=Function.createDelegate(this,this.dD);this.ci=Function.createDelegate(this,this.df);this.cj=Function.createDelegate(this,this.dg);this.cf=Function.createDelegate(this,this.t);this.bF=Function.createDelegate(this,this.dj);this.bE=Function.createDelegate(this,this.dh);this.ck=Function.createDelegate(this,this.di);this.ch=Function.createDelegate(this,this.dd);this.bH=Function.createDelegate(this,this.dH);this.bD=Function.createDelegate(this,this.cG);this.bJ=Function.createDelegate(this,this.dI);_am.b.initializeBase(this);this.d=n;this.d.apcl("SelectedDataProvider",this.bJ);this.d.apcl("AttachmentDataProviders",this.bD);this.d.apcl("IsOneDriveProGroupsView",this.bH);if(t){var p=this;t.a(function(n){p.dv(n)})}this.bN=i;this.cw=r;this.bw=u;this.bU=!!f&&f.a().c().Enabled;this.T=!!f&&f.a().b().Enabled;this.bT=!!f&&f.a().dS().Enabled;this.W=e;this.x=f;this.bP=o;this.s=s;this.F=h;this.r=c;this.bL=l;this.bY=y;this.C=a.a();this.I=v;this.dk(r)};_am.b.a=function(n){return Math.floor(n/1024).toString()};_am.b.prototype={bN:null,W:null,bU:!1,bT:!1,s:null,F:null,x:null,bY:null,d:null,T:!1,g:null,S:null,R:null,G:null,bR:null,A:null,bd:null,bc:null,bm:null,N:null,e:null,U:!1,Y:null,Z:null,bt:null,bp:null,L:null,bZ:null,f:null,bk:null,br:null,bl:null,M:null,cw:null,bw:null,o:!1,bu:null,D:!1,bV:!1,bo:!1,bX:null,ba:null,bv:null,bs:null,k:!1,X:null,bP:null,bq:null,bW:!1,m:null,j:null,q:null,r:null,bL:null,C:null,bO:!1,I:null,be:!1,h:0,dm:function(n){if(this.h!==n){this.h=n;this.ex("ShouldHideSecondaryDataProviders","LeftButtonText")}return n},dp:function(n){if(this.j!==n){this.j=n;this.e.bu(this.j);this.dB();this.bp.a()}return n},cO:function(){return this.C.v()},cN:function(){return this.C.u()},cR:function(){return this.h?_ufp.A.d:_ufp.A.u},v:function(n){if(this.d.c===n)return n;this.d.G(n);this.E();this.et("SelectedDataProvider");return n},cX:function(){return this.s.c()?this.s.b():this.F.a()==="TouchNarrow"?!0:this.s.e()||this.s.b()},cW:function(){return this.F.a()==="TouchNarrow"?!1:!this.s.e()&&!this.s.b()},du:function(n){if(this.N!==n){this.N=n;this.et("SelectAttachmentDataProviderItemCommand")}return n},bK:null,dw:function(n){if(this.bs!==n){this.bs=n;this.et("ShowCurrentGroupDocumentsCommand")}return n},ds:function(n){if(this.Y!==n){this.Y=n;this.et("OpenLocalComputerFilePickerCommand")}return n},dt:function(n){if(this.Z!==n){this.Z=n;this.et("OpenLocalComputerImageFilePickerCommand")}return n},dx:function(n){if(this.bt!==n){this.bt=n;this.et("ShowFilePickerCommand")}return n},dr:function(n){if(this.bp!==n){this.bp=n;this.et("OnLocalFilesSelectedCommand")}return n},dq:function(n){if(this.L!==n){this.L=n;this.et("OnCloudFilesSelectedCommand")}return n},dy:function(n){if(this.bu!==n){this.bu=n;this.et("ShowGroupsCommand")}return n},dz:function(n){if(this.bv!==n){this.bv=n;this.et("ShowRecentDocumentsCommand")}return n},dn:function(n){if(this.e!==n){this.e=n;this.eE("AttachmentWellViewModel","ShowGroupsAsDataProviderEnabled","HideGroupsButton")}return n},cQ:function(){return this.F.c()},O:function(n){if(this.o!==n){this.o=n;this.et("IsGroupsSelected")}return n},cu:function(){return this.o&&!this.m},cP:function(){return!this.bU||!this.J()||!this.y()},P:function(n){if(this.D!==n){this.D=n;this.et("IsRecentDocumentsSelected")}return n},bb:function(n){if(this.k!==n){this.k=n;this.et("IsCurrentGroupSelected")}return n},dv:function(n){if(this.g===n)return n;this.g=n;this.et("SelectedModernGroupProvider");return n},J:function(){return this.e?!this.e.c()||!!this.W&&this.W.a(this.e.c(),"AttachmentShowGroups"):!0},bx:function(){return 1},w:function(){return this.x&&this.x.a().I().Enabled?this.ch:null},bI:function(){return this.S},V:function(n){this.S=n;return n},p:function(){return this.R},i:function(n){this.R=n;return n},by:function(){return!0},bn:function(){return!0},y:function(){if(this.X)return this.X;var t=this.d.d;if(!t)return null;for(var i=this.T?1:0,n=0;n<t.x.length;n++)if(t.x[n].a.a()===i){this.X=t.x[n];return this.X}return null},bQ:function(){return!!this.d.c&&Object.getType(this.d.c)===_am.r},a:function(n,t,i,r,u,f,e){_a.b.a(n,"attachmentWellViewModel");_a.b.a(r,"onPopupViewModelRequested");_am.a.a=e===1;this.d.bt(e);this.dn(n);this.bo=f;if(this.bW!==this.J()||this.h!==e){this.U=!1;this.O(!1);this.P(!1);_at.n.b()}var s=e!==this.h;this.dm(e);this.q=r;if(this.s.a()&&!this.s.o()&&!this.F.c()){var o=this.F;this.q=o.z||(o.z=Function.createDelegate(o,o.K));_a.b.a(this.q,"onPopupViewModelRequested_owaShellPopUpAsPanel")}this.bW=this.J();this.M=t;this.de(i||f);this.f.F=this.d.bp=!!n.c();this.q&&this.q(this);this.bq=u;this.d.bm(u);this.d.d&&this.d.d.x.length?s&&this.d.cq():this.d.b();this.e.w()||this.f.Z(this.e.c(),this.d,this.W);this.I.D(u);this.g&&this.g.a()&&this.e.bq(this.g.a().bj.DisplayName)},c:function(){if(!this.bV){this.bV=!0;this.d.cm()}},b:function(n,t){var i=this.I.y(n);i&&i.e(t[i.N()],t,this.ck,this.d.be)},ew:function(){this.d.rpcl("SelectedDataProvider",this.bJ);this.d.rpcl("AttachmentDataProviders",this.bD);this.d.rpcl("IsOneDriveProGroupsView",this.bH);var n;_a.i.a(n={val:this.L}),this.L=n.val;this.f&&this.f.P(this.bE);this.d&&this.d.bM(this.bF);_a.iX.prototype.ew.call(this)},E:function(){if(this.d.c){this.bb(!1);this.P(!1);this.O(!1);this.m=null;this.et("IsMailboxDataProvider")}},cU:function(){},cS:function(){if(this.M){this.M.j=this.cI();_a.d.a(this.M);this.M=null}},cV:function(){},cT:function(){},t:function(){if(this.R){this.d&&this.d.e&&this.d.e.f();this.R()}},cB:function(){var n=this.d.d;if(!n||!n.x.length){this.bP.a(_a.v,new _a.v([this.d.bl()],0,null,0,!1,null,null,this.C.y(),this.bq,null));return!1}return!0},de:function(n){if(this.U)this.d.f&&this.d.f.bg();else{this.bm=new _j.g(this.cf,_a.a.c);this.bZ=new _j.g(this.cj,_a.a.c);var s=this;this.G=new _j.g(function(){s.cq(!0)},_a.a.c);this.bR=new _j.g(this.ci,_a.a.c);var h=this;this.A=new _j.g(function(){h.bM(!0)},_a.a.c);this.bd=new _j.g(this.cl,_a.a.c);var t=this;this.bc=new _j.g(function(){t.bQ()?t.cF():t.bM(!1)},_a.a.c);var e=this;this.bK=new _j.g(function(){e.dl(e.q)},_a.a.c);var f=this;this.du(new _j.g(function(){f.cx(f.q)},_a.a.c));var u=this;this.dx(new _j.g(function(){u.dE(u.q)},_a.a.c));var i=this;this.dr(new _j.g(function(){i.f.b=_a.d.b(_a.a.c,"AttachmentsFilePickerSelectLocalFiles");i.bf(!0,i.q)},_a.a.c));var r=this,o=this;this.dq(new _j.v(function(){r.f.b=_a.d.b(_a.a.c,"AttachmentsFilePickerSelectCloudFile");r.bf(!1,r.q)},_a.a.c,this.d,"SelectedAttachmentsChanged",function(){return o.cr()}));this.dw(new _j.g(this.cm,_a.a.c));this.dz(new _j.g(this.co,_a.a.c));this.dy(new _j.g(this.cn,_a.a.c));this.J()||this.T?this.cy():this.dC();this.f=this.bN.e();this.f.O(this.bE);this.d.L=this.I;this.d.m(this.bF);this.U=!0}this.bO=n;this.bc.c(!n);this.bd.c(!n);if(this.k&&this.bn()){this.k=!1;this.cz()}},dk:function(n){n&&!_g.k.b&&n.a("AttachmentOperationCorrelationIdNotification",_a.a.c,"AttachmentsFilePickerPanelViewModel",this.cg,0)},dc:function(n){var t=n;t?this.bw&&this.bw.d(t.CorrelationId,t.SharePointCallName,t.Exception):_j.e.c(_a.a.c,"HandleCorrelationIdNotification: The notification payload is null.")},dh:function(){this.bl&&this.bl()},cs:function(n,t,i){var r;return r=new _db.d,r.q(n.bj.Name),r.r(n.bj.Size),r.B(""),r.o(t),r.p(_g.p.toString(n.e())),r.u(n.bj.Location),r.t(n.bj.Id),r.v(n.bj.ParentId),r.z(n.bj.ProviderEndpointUrl),r.A(n.bj.Thumbnail?n.bj.Thumbnail.Url:null),r.y(n.bj.Preview?n.bj.Preview.Url:null),r.s(i),r.x(!n.bj.Size),r.w(n.a()===1),r},bM:function(n){var t=null;if(this.e){this.e.V(this.h===1);this.e.p(_a.d.b(_a.a.c,"AttachmentsFilePickerSelectDestination"));var r=this.d.c?this.d.c.a.bj.Id:this.y().a.bj.Id;t=[];if(this.d.e){var i=this;this.d.e.p(function(u){var f=i.cs(u,r,n);Array.add(t,f)})}this.dA(n);this.e.R(new _h.bP(t))}this.t();this.f.e();this.cK(t);this.cL();if(this.f.c){this.bS()?this.r.b().D(n?1:2):this.r.b().C(n?1:2);this.ca()}},cF:function(){if(this.d.e){this.bM(!0);var n=this;this.d.e.p(function(t){var r=n.cs(t,n.y().a.bj.Id,!1);var i=new _dg.c;i.f(new _g.bp(r.k()));i.g(!1);i.e(r.b());i.h(r.a());var u=n.e.ba(i,!1,!1);n.e.E(u);n.e.bs(new _g.g(r.l()));n.e.Z(u,(_a.c.a().h()+_ff.o.a(0,1e6)).toString())})}this.t();this.f.e()},dA:function(n){this.e.o(n?this.h?"AttachmentsFilePickerAttachCloudImageFile":"AttachmentsFilePickerAttachCloudFile":"AttachmentsFilePickerShareCloudFile");this.e.z(this.da());this.e.A(this.e.x()?this.f.c:!1);this.e.y(this.cv())},cv:function(){return this.d.c&&this.d.c.a?_g.p.toString(this.d.c.a.a()):this.o||this.k?"Group":this.D?"RecentFiles":"Unknown"},da:function(){return this.d.c&&this.d.c.a?this.d.c.k():this.o||this.k?"Group files":"Unknown"},cL:function(){this.d.c&&this.d.c.a&&this.d.c.f(this.d.f.by)},cK:function(n){if(n){for(var u=_a.d.b(_a.a.c,"AttachmentsFilePickerFileSelection"),t=new _a.o,r=new Sys.StringBuilder,i=0;i<n.length;i++){var f=_a.bh.a(n[i].b());r.append(f);r.append(";")}t.a("C",n.length);t.b("T",r.toString());t.b("DP",this.cv());u.j=t.toString();_a.d.a(u)}},dl:function(n){if(this.cr()){this.f.b=_a.d.b(_a.a.c,"AttachmentsFilePickerSelectCloudFile");this.bf(!1,this.q)}else this.cx(n)},cx:function(n){if(this.d.e&&this.d.e.x.length===1){var t=this.d.e.x[0];if(t.a()){if(t.a()===1||t.a()===2){var f=t.bj.Id;var i=null;if(t.a()===2){i=this.d.e.x[0].bj.PagingMetadata;this.m=i.GroupSmtpAddress}else if(this.m){if(i){if(!_gg.E.isInstanceOfType(i))throw Error.invalidOperation(String.format("GroupsPagingMetadata is NULL. To expand subsequent folders within a Group, a non-null GroupsPagingMetadata is needed. GroupAddress: {0}, FolderName:{1}",this.m,t.bj.Name));}else i=new _gg.E;i.GroupSmtpAddress=this.m;f=String.format("{0}_{1}",this.m,f)}else this.m=null;this.d.y();var u=this.d.c?this.d.c.c():null;var r=this.d.c;if(this.k||this.o){r=this.y();u=new _gg.F;u.Type=3}this.d.t(new _ao.a(f,t.bj.Location,t.bj.Name,u,t.bj.ProviderEndpointUrl,r?r.a:null),!0,this.d.c?this.d.c.t():null,i)}}else{this.f.b=_a.d.b(_a.a.c,"AttachmentsFilePickerSelectCloudFile");this.bf(!1,n)}}},dE:function(n){var t=this;this.e.f(this.h===1,this.h===1?this.Z:this.Y,function(i,r,u){t.f.b=_a.d.b(_a.a.c,"AttachmentsFilePickerSelectLocalFiles");t.bk=i;t.br=r;t.bl=u;t.bf(!0,n)})},bf:function(n,t){if(this.h===1){this.e.s(!1);n?this.G.a():this.A.a();return}this.dG(n);this.e.s(!1);if(this.be&&this.G.b&&!this.bo){this.f.W(this.bR);this.be=!1}else{this.f.W(null);this.be=!1}var u=n?this.G:this.A;var r=n?this.bd:this.bc;var i=this.cZ(n,this.bS());if(u.b&&(i===1||!this.r.h().ReferenceAttachmentsEnabled)){u.a();return}var f=!!this.d.c&&!!this.d.c.a&&this.d.c.a.bj.IsThirdPartyProvider;this.bc.c(!this.bO&&(this.d.c?this.d.c.i():!0));if(r.b&&(i===2||!this.r.h().ClassicAttachmentsEnabled)){r.a();return}this.f.T(u);this.f.Y(r);this.f.S(n);this.f.R(this.bS());this.f.d=this.cH(n);this.f.U(this.cM());this.f.X(this.db());this.f.Q(!!this.x&&this.x.a().bc().Enabled&&!i&&!f&&!this.bQ());this.f.s(!!i);this.e.s(!0);t(this.f)},cM:function(){return this.d.c?this.d.c.p:this.C},dB:function(){if(this.j&&this.bT){for(var n=0;n<this.j.b();n++){var t=this.j.a(n);if(!_at.f.k(t.b()))return}this.be=!0}},cH:function(n){return n?!!this.j&&this.j.b()>1:!!this.d.e&&this.d.e.x.length>1},cZ:function(n,t){return n?this.r.b().bj.AttachOrShareLocalFiles:t?this.r.b().bj.AttachOrShareGroupsFiles:this.r.b().bj.AttachOrShareCloudFiles},dG:function(n){this.f.a.r();if(n&&_a.k.a().N)this.ct(!0,this.G,this.j.b());else if(this.d.e){this.cJ(this.A);this.A.b&&this.ct(!1,this.A,this.d.e.x.length)}if(n&&this.e&&this.e.w()){this.bd.c(!1);this.f.a.a(10216,this.K().p())}this.bo&&this.f.a.a(10204,this.K().p())},cY:function(n){var i=0;if(n)for(var t=0;t<this.j.b();t++)i+=this.j.a(t).a();else if(this.d.e){var r=this;this.d.e.p(function(n){var t=n;i+=t.bj.Size})}return i},cJ:function(n){if(this.d.U){n.c(!1);this.f.a.a(10205,this.K().p())}else if(this.d.bo){n.c(!1);this.f.a.a(11030,this.K().p())}else n.c(!0)},ct:function(n,t,i){if(this.x&&this.x.a().be().Enabled&&this.s.n()){var r=this.cY(n);var u=this.e.bh();if(r>u*1024){t.c(!1);var e=i===1?10200:10201;this.f.a.a(e,_am.b.a(u),this.K().p())}else if(r>5242880){var f=i===1?10202:10203;this.f.a.a(f,_am.b.a(r/1024),this.K().p());t.c(!0)}else t.c(!0)}},K:function(){return this.d.c?this.d.c.p:this.C},db:function(){return!this.e.c()||!this.g||!this.g.a()?null:this.g.a().bj.DisplayName},cp:function(){this.e.z("Computer");this.e.y("");this.e.A(this.e.x()?this.f.c:!1)},df:function(){this.e.V(!0);this.cq(!1)},cq:function(n){this.e.p(_a.d.b(_a.a.c,"AttachmentsFilePickerSelectDestination"));n&&this.e.o(this.h?"AttachmentsFilePickerAttachLocalImageFile":"AttachmentsFilePickerAttachLocalFile");this.cp();this.bk?this.bk():this.e.h().b&&this.e.h().a();this.t();this.f.e();if(this.f.c){this.r.b().q(1);this.ca()}},dD:function(){if(this.cB()){this.e.p(_a.d.b(_a.a.c,"AttachmentsFilePickerSelectDestination"));this.e.o("AttachmentsFilePickerShareLocalFile");this.cp();this.br?this.br():this.e.l()&&this.e.l().b&&this.e.l().a();this.t();this.f.e();if(this.f.c){this.r.b().q(2);this.ca()}}},ca:function(){_h.f.a(this.r.b().c(),this.bL);this.e.bv();this.f.s(!1)},dF:function(){if(!this.cu()){if(!this.o){this.bb(!1);this.P(!1);this.O(!0);this.v(null)}this.d.n();this.d.cD(this.y().a);this.d.bQ();this.E()}},dC:function(){this.ba=new _ao.a("AttachmentsDataProvider_RecentDocuments","",_ufp.A.T,null,null,null);this.ba.a=!0;this.bX=new _ao.f(new(_h.ds.$$(_ao.f))(this.ba));this.bn()&&this.cA()},cA:function(){if(!this.D){this.bb(!1);this.O(!1);this.P(!0);this.m=null;this.v(null);this.d.Y(this.ba);this.d.ba(this.bX);this.d.n();this.d.cp();this.E()}},cz:function(){if((!this.k||!this.d.g.a)&&this.g&&this.g.a()){this.bb(!0);this.P(!1);this.O(!1);this.v(null);var i=new _gg.F;i.Type=3;var n=new _gg.E;n.GroupSmtpAddress=this.g.a().bj.SmtpAddress;this.m=n.GroupSmtpAddress;var t=new _ao.a(this.g.a().bj.SmtpAddress,"",this.g.a().bj.DisplayName,i,null,this.y().a);t.a=!0;this.d.t(t,!0,null,n);this.d.n();this.E()}},cI:function(){var n=new _a.o;n.a("W",this.e.c()?1:0);return n.toString()},dH:function(n,t){this.d.w&&(this.m=null)},cG:function(n,t){this.et("HideGroupsButton");this.U&&this.cy()},cy:function(){(this.T||this.J())&&!this.d.c&&this.bn()&&!this.k&&!this.o&&this.v(this.y())},dI:function(n,t){this.E();this.et("SelectedDataProvider")},cr:function(){return this.d.e&&this.d.e.x.length>0?!this.d.c||!this.d.c.a.bj.AllowFolderSharing||this.h===1?!this.d.U:!0:!1},bS:function(){return this.o||this.k},di:function(n){this.d.bS(n);this.d.bm(this.bq);this.v(n)},dj:function(n){this.d.c===n&&this.v(this.y())},dg:function(){this.t();this.bY.a("/options/attachmentoptions")},dd:function(n,t,i){if(!t){this.t();return!0}return!1}};_am.c=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.cg=Function.createDelegate(this,this.dh);this.ce=Function.createDelegate(this,this.df);this.cf=Function.createDelegate(this,this.dg);this.ca=Function.createDelegate(this,this.cF);this.bF=Function.createDelegate(this,this.dk);this.cj=Function.createDelegate(this,this.dD);this.ck=Function.createDelegate(this,this.cy);this.ci=Function.createDelegate(this,this.cx);this.ch=Function.createDelegate(this,this.dB);this.cb=Function.createDelegate(this,this.cH);this.cd=Function.createDelegate(this,this.A);this.bY=Function.createDelegate(this,this.cD);this.bZ=Function.createDelegate(this,this.cE);this.bH=Function.createDelegate(this,this.dF);this.bE=Function.createDelegate(this,this.cI);this.bJ=Function.createDelegate(this,this.dG);_am.c.initializeBase(this);this.d=n;this.d.apcl("SelectedDataProvider",this.bJ);this.d.apcl("AttachmentDataProviders",this.bE);this.d.apcl("IsOneDriveProGroupsView",this.bH);if(t){var v=this;t.a(function(n){v.du(n)})}this.bL=i;this.ct=r;this.bz=u;this.bP=!!f&&f.a().c().Enabled;this.T=!!f&&f.a().b().Enabled;this.W=e;this.s=f;this.bm=o;this.q=s;this.G=h;this.o=c;this.O=l;this.R=a;this.C=a.a();this.dl(r);this.bq=new Array(3)};_am.c.a=function(n){return Math.floor(n/1024).toString()};_am.c.prototype={bL:null,W:null,bP:!1,q:null,G:null,s:null,d:null,T:!1,g:null,Q:null,P:null,bh:null,y:null,bb:null,M:null,bl:null,J:null,bg:null,e:null,U:!1,Y:null,bu:null,bo:null,F:null,f:null,bi:null,bs:null,bk:null,I:null,ct:null,bz:null,m:!1,bv:null,v:!1,bQ:!1,bN:!1,bS:null,Z:null,bw:null,bt:null,h:!1,X:null,bm:null,bp:null,bR:!1,k:null,r:null,j:null,o:null,O:null,C:null,br:null,bM:!1,R:null,bq:null,dp:function(n){if(this.r!==n){this.r=n;this.e.bu(this.r);this.bo.a()}return n},cW:function(){return this.C.v()},cR:function(){return this.C.u()},t:function(n){if(this.d.c===n)return n;this.d.L(n);this.x();this.et("SelectedDataProvider");return n},cZ:function(){return this.q.c()?this.q.b():this.G.a()==="TouchNarrow"?!0:this.q.e()||this.q.b()},cY:function(){return this.G.a()==="TouchNarrow"?!1:!this.q.e()&&!this.q.b()},dn:function(n){if(this.bg!==n){this.bg=n;this.et("AddDropboxProviderCommand")}return n},bK:null,cP:function(){return this.s.a().bF().Enabled&&!this.di()},dt:function(n){if(this.J!==n){this.J=n;this.et("SelectAttachmentDataProviderItemCommand")}return n},dv:function(n){if(this.bt!==n){this.bt=n;this.et("ShowCurrentGroupDocumentsCommand")}return n},ds:function(n){if(this.Y!==n){this.Y=n;this.et("OpenLocalComputerFilePickerCommand")}return n},dw:function(n){if(this.bu!==n){this.bu=n;this.et("ShowFilePickerCommand")}return n},dr:function(n){if(this.bo!==n){this.bo=n;this.et("OnLocalFilesSelectedCommand")}return n},dq:function(n){if(this.F!==n){this.F=n;this.et("OnCloudFilesSelectedCommand")}return n},dx:function(n){if(this.bv!==n){this.bv=n;this.et("ShowGroupsCommand")}return n},dy:function(n){if(this.bw!==n){this.bw=n;this.et("ShowRecentDocumentsCommand")}return n},cw:function(n){if(this.e!==n){this.e=n;this.eE("AttachmentWellViewModel","ShowGroupsAsDataProviderEnabled","HideGroupsButton")}return n},K:function(n){if(this.m!==n){this.m=n;this.et("IsGroupsSelected")}return n},cq:function(){return this.m&&!this.k},cX:function(){return!this.bP||!this.E()||!this.D()},L:function(n){if(this.v!==n){this.v=n;this.et("IsRecentDocumentsSelected")}return n},ba:function(n){if(this.h!==n){this.h=n;this.et("IsCurrentGroupSelected")}return n},du:function(n){if(this.g===n)return n;this.g=n;this.et("SelectedModernGroupProvider");return n},E:function(){return this.e?!this.e.c()||!!this.W&&this.W.a(this.e.c(),"AttachmentShowGroups"):!0},bx:function(){return 1},w:function(){return null},bI:function(){return this.Q},V:function(n){this.Q=n;return n},p:function(){return this.P},i:function(n){this.P=n;return n},by:function(){return!0},bn:function(){return!0},D:function(){if(this.X)return this.X;var t=this.d.g;if(!t)return null;for(var i=this.T?1:0,n=0;n<t.x.length;n++)if(t.x[n].a.a()===i){this.X=t.x[n];return this.X}return null},a:function(n,t,i,r,u,f,e){_a.b.a(n,"attachmentWellViewModel");_a.b.a(r,"onPopupViewModelRequested");this.cw(n);this.bN=f;if(this.bR!==this.E()){this.U=!1;this.K(!1);this.L(!1);_at.n.b()}this.j=r;if(this.q.a()&&!this.q.o()&&!this.G.c()){var o=this.G;this.j=o.z||(o.z=Function.createDelegate(o,o.K));_a.b.a(this.j,"onPopupViewModelRequested_owaShellPopUpAsPanel")}this.bR=this.E();this.I=t;this.dj(i||f);this.f.F=this.d.T=!!n.c();this.j&&this.j(this);this.bp=u;this.d.g&&this.d.g.x.length||this.d.b();this.e.w()||this.f.Z(this.e.c(),this.d,this.W);this.da();this.g&&this.g.a()&&this.e.bq(this.g.a().bj.DisplayName)},c:function(){if(!this.bQ){this.bQ=!0;this.d.bB()}},b:function(n,t){var r=t.code;if(!r){this.bT(_g.p.toString(n));_j.e.c(_a.a.c,_g.p.toString(n)+" oAuth code not returned in the redirect page.");return}var i=new _ao.c(n,r,this.br);i.d(this.bZ);i.e(this.bY);this.O.a(i)},x:function(){if(this.d.c){this.ba(!1);this.L(!1);this.K(!1);this.k=null}},cU:function(){},cS:function(){if(this.I){this.I.j=this.cL();_a.d.a(this.I);this.I=null}},cV:function(){},cT:function(){this.cw(null);this.j=null},A:function(){this.P&&this.P()},cz:function(){var n=this.d.g;if(!n||!n.x.length){this.bm.a(_a.v,new _a.v([this.d.S()],0,null,0,!1,null,null,this.C.y(),this.bp,null));return!1}return!0},dj:function(n){if(this.U)this.d.e&&this.d.e.bg();else{this.bl=new _j.g(this.cd,_a.a.c);this.bh=new _j.g(this.cb,_a.a.c);var o=this;this.y=new _j.g(function(){o.cm(!0)},_a.a.c);this.bb=new _j.g(this.ch,_a.a.c);var s=this;this.M=new _j.g(function(){s.cm(!1)},_a.a.c);var f=this;this.bK=new _j.g(function(){f.dm(f.j)},_a.a.c);var u=this;this.dt(new _j.g(function(){u.cu(u.j)},_a.a.c));var r=this;this.dw(new _j.g(function(){r.dC(r.j)},_a.a.c));var t=this;this.dr(new _j.g(function(){t.f.b=_a.d.b(_a.a.c,"AttachmentsFilePickerSelectLocalFiles");t.bc(!0,t.j)},_a.a.c));var i=this,e=this;this.dq(new _j.v(function(){i.f.b=_a.d.b(_a.a.c,"AttachmentsFilePickerSelectCloudFile");i.bc(!1,i.j)},_a.a.c,this.d,"SelectedAttachmentsChanged",function(){return e.cn()}));this.dv(new _j.g(this.ci,_a.a.c));this.dy(new _j.g(this.ck,_a.a.c));this.dx(new _j.g(this.cj,_a.a.c));this.E()||this.T?this.cv():this.dA();this.f=this.bL.e();this.f.O(this.bF);this.U=!0}this.bM=n;this.M.c(!n);this.bb.c(!n);if(this.h&&this.bn()){this.h=!1;this.cx()}this.dn(new _j.g(this.ca,_a.a.c))},ew:function(){this.d.rpcl("SelectedDataProvider",this.bJ);this.d.rpcl("AttachmentDataProviders",this.bE);this.d.rpcl("IsOneDriveProGroupsView",this.bH);var n;_a.i.a(n={val:this.F}),this.F=n.val;this.f&&this.f.P(this.bF);_a.iX.prototype.ew.call(this)},da:function(){this.s.a().bF().Enabled&&this.cr(2)},cr:function(n){var t=new _ao.d(n);t.d(this.cf);t.e(this.ce);this.O.a(t)},cG:function(n,t,i){this.br=window.location.protocol+"//"+window.location.host+window.location.pathname+"ADPOAuthRedirect.html";var r=n;r=_a.A.a(r,"client_id",t);r=_a.A.a(r,"redirect_uri",this.br);r=_a.A.a(r,"response_type","code");this.cp(_g.p.toString(i),"AttachmentsAddDataProvider");_a.Z.a(r,600,600,!0)},dg:function(n){var t=n;this.bq[t.c]=t.g.ProviderAppKey},df:function(n){_j.e.b(_a.a.c,"GetNewAttachmentDataProviderCreationInfoAction failed")},cF:function(){var i="https://www.dropbox.com/1/oauth2/authorize";var n=this.bq[2];if(_j.i.a(n)){this.cr(2);var t=_g.p.toString(2);this.bT(t);return}this.cG(i,n,2)},dl:function(n){n&&!_g.k.b&&n.a("AttachmentOperationCorrelationIdNotification",_a.a.c,"AttachmentsFilePickerPanelViewModel",this.cg,0)},dh:function(n){var t=n;t?this.bz&&this.bz.d(t.CorrelationId,t.SharePointCallName,t.Exception):_j.e.c(_a.a.c,"HandleCorrelationIdNotification: The notification payload is null.")},dk:function(){this.bk&&this.bk()},cK:function(n,t,i){var r;return r=new _db.d,r.q(n.bj.Name),r.r(n.bj.Size),r.B(""),r.o(t),r.p(_g.p.toString(n.e())),r.u(n.bj.Location),r.t(n.bj.Id),r.v(n.bj.ParentId),r.z(n.bj.ProviderEndpointUrl),r.A(n.bj.Thumbnail?n.bj.Thumbnail.Url:null),r.y(n.bj.Preview?n.bj.Preview.Url:null),r.s(i),r.x(!n.bj.Size),r.w(n.a()===1),r},cm:function(n){var t=null;if(this.e){this.e.V(!1);this.e.p(_a.d.b(_a.a.c,"AttachmentsFilePickerSelectDestination"));var r=this.d.c?this.d.c.a.bj.Id:this.D().a.bj.Id;t=[];if(this.d.d){var i=this;this.d.d.p(function(u){var f=i.cK(u,r,n);Array.add(t,f)})}this.dz(n);this.e.R(new _h.bP(t))}this.A();this.f.e();this.cN(t);this.cO();if(this.f.c){this.bO()?this.o.b().D(n?1:2):this.o.b().C(n?1:2);this.bU()}},dz:function(n){this.e.o(n?"AttachmentsFilePickerAttachCloudFile":"AttachmentsFilePickerShareCloudFile");this.e.z(this.dd());this.e.A(this.e.x()?this.f.c:!1);this.e.y(this.cs())},cs:function(){return this.d.c&&this.d.c.a?_g.p.toString(this.d.c.a.a()):this.m||this.h?"Group":this.v?"RecentFiles":"Unknown"},dd:function(){if(this.d.c&&this.d.c.a){var i=!this.d.c.a.a()||this.d.c.a.a()===1;if(i){var t=this.d.c.c().Type;switch(t){case 0:return"My files";case 4:return"Recent";case 1:return"Shared with me";case 3:return"Group files"}}var n=this.d.c.a.a()===2;if(n)return"My files"}return this.m||this.h?"Group files":"Unknown"},cO:function(){if(this.d.c&&this.d.c.a){var i=!this.d.c.a.a()||this.d.c.a.a()===1;if(i){var t=this.d.c.c().Type;t||this.d.R("AttachmentsFilePickerMyFiles")}var n=this.d.c.a.a()===2;n&&this.d.R("AttachmentsFilePickerMyFiles")}},cN:function(n){if(n){for(var u=_a.d.b(_a.a.c,"AttachmentsFilePickerFileSelection"),t=new _a.o,r=new Sys.StringBuilder,i=0;i<n.length;i++){var f=_a.bh.a(n[i].b());r.append(f);r.append(";")}t.a("C",n.length);t.b("T",r.toString());t.b("DP",this.cs());u.j=t.toString();_a.d.a(u)}},cp:function(n,t){var r=_a.d.b(_a.a.c,t);var i=new _a.o;i.b("DP",n);r.j=i.toString();_a.d.a(r)},dm:function(n){if(this.cn()){this.f.b=_a.d.b(_a.a.c,"AttachmentsFilePickerSelectCloudFile");this.bc(!1,this.j)}else this.cu(n)},cu:function(n){if(this.d.d&&this.d.d.x.length===1){var t=this.d.d.x[0];if(t.a()){if(t.a()===1||t.a()===2){var f=t.bj.Id;var i=null;if(t.a()===2){i=this.d.d.x[0].bj.PagingMetadata;this.k=i.GroupSmtpAddress}else if(this.k){if(i){if(!_gg.E.isInstanceOfType(i))throw Error.invalidOperation(String.format("GroupsPagingMetadata is NULL. To expand subsequent folders within a Group, a non-null GroupsPagingMetadata is needed. GroupAddress: {0}, FolderName:{1}",this.k,t.bj.Name));}else i=new _gg.E;i.GroupSmtpAddress=this.k;f=String.format("{0}_{1}",this.k,f)}else this.k=null;this.d.t();var u=this.d.c?this.d.c.c():null;var r=this.d.c;if(this.h||this.m){r=this.D();u=new _gg.F;u.Type=3}this.d.q(new _ao.a(f,t.bj.Location,t.bj.Name,u,t.bj.ProviderEndpointUrl,r?r.a:null),!0,i)}}else{this.f.b=_a.d.b(_a.a.c,"AttachmentsFilePickerSelectCloudFile");this.bc(!1,n)}}},dC:function(n){var t=this;this.e.f(!1,this.Y,function(i,r,u){t.f.b=_a.d.b(_a.a.c,"AttachmentsFilePickerSelectLocalFiles");t.bi=i;t.bs=r;t.bk=u;t.bc(!0,n)})},bc:function(n,t){this.dE(n);this.e.s(!1);var u=n?this.bh:this.y;var r=n?this.bb:this.M;var i=this.dc(n,this.bO());if(u.b&&(i===1||!this.o.h().ReferenceAttachmentsEnabled)){u.a();return}var f=!!this.d.c&&!!this.d.c.a&&this.d.c.a.bj.IsThirdPartyProvider;f?this.M.c(!1):this.M.c(!this.bM);if(r.b&&(i===2||!this.o.h().ClassicAttachmentsEnabled)){r.a();return}this.f.T(u);this.f.Y(r);this.f.S(n);this.f.R(this.bO());this.f.d=this.cJ(n);this.f.U(this.cQ());this.f.X(this.de());this.f.Q(!!this.s&&this.s.a().bc().Enabled&&!i&&!f);this.f.s(!!i);this.e.s(!0);t(this.f)},cQ:function(){return this.d.c?this.R.c(this.d.c.a.a()):this.C},cJ:function(n){return n?!!this.r&&this.r.b()>1:!!this.d.d&&this.d.d.x.length>1},dc:function(n,t){return n?this.o.b().bj.AttachOrShareLocalFiles:t?this.o.b().bj.AttachOrShareGroupsFiles:this.o.b().bj.AttachOrShareCloudFiles},dE:function(n){this.f.a.r();if(n&&_a.k.a().N)this.co(!0,this.bh,this.r.b());else if(this.d.d){this.cM(this.y);this.y.b&&this.co(!1,this.y,this.d.d.x.length)}if(n&&this.e&&this.e.w()){this.bb.c(!1);this.f.a.a(10216,this.S())}this.bN&&this.f.a.a(10204,this.S())},db:function(n){var i=0;if(n)for(var t=0;t<this.r.b();t++)i+=this.r.a(t).a();else if(this.d.d){var r=this;this.d.d.p(function(n){var t=n;i+=t.bj.Size})}return i},cM:function(n){if(this.d.G){n.c(!1);this.f.a.a(10205,this.S())}else n.c(!0)},co:function(n,t,i){if(this.s&&this.s.a().be().Enabled&&this.q.n()){var r=this.db(n);var u=this.e.bh();if(r>u*1024){t.c(!1);var e=i===1?10200:10201;this.f.a.a(e,_am.c.a(u),this.S())}else if(r>5242880){var f=i===1?10202:10203;this.f.a.a(f,_am.c.a(r/1024),this.S());t.c(!0)}else t.c(!0)}},de:function(){return!this.e.c()||!this.g||!this.g.a()?null:this.g.a().bj.DisplayName},cl:function(){this.e.z("Computer");this.e.y("");this.e.A(this.e.x()?this.f.c:!1)},cH:function(){this.e.p(_a.d.b(_a.a.c,"AttachmentsFilePickerSelectDestination"));this.e.o("AttachmentsFilePickerAttachLocalFile");this.cl();this.bi?this.bi():this.e.h().b&&this.e.h().a();this.A();this.f.e();if(this.f.c){this.o.b().q(1);this.bU()}},dB:function(){if(this.cz()){this.e.p(_a.d.b(_a.a.c,"AttachmentsFilePickerSelectDestination"));this.e.o("AttachmentsFilePickerShareLocalFile");this.cl();this.bs?this.bs():this.e.l()&&this.e.l().b&&this.e.l().a();this.A();this.f.e();if(this.f.c){this.o.b().q(2);this.bU()}}},bU:function(){_h.f.a(this.o.b().c(),this.O);this.e.bv();this.f.s(!1)},dD:function(){if(!this.cq()){if(!this.m){this.ba(!1);this.L(!1);this.K(!0);this.t(null)}this.d.p();this.d.bI(this.D().a);this.d.bk();this.x()}},dA:function(){this.Z=new _ao.a("AttachmentsDataProvider_RecentDocuments","",_ufp.A.T,null,null,null);this.Z.a=!0;this.bS=new _ao.f(new(_h.ds.$$(_ao.f))(this.Z));this.bn()&&this.cy()},cy:function(){if(!this.v){this.ba(!1);this.K(!1);this.L(!0);this.k=null;this.t(null);this.d.I(this.Z);this.d.K(this.bS);this.d.p();this.d.bC();this.x()}},cx:function(){if((!this.h||!this.d.f.a)&&this.g&&this.g.a()){this.ba(!0);this.L(!1);this.K(!1);this.t(null);var i=new _gg.F;i.Type=3;var n=new _gg.E;n.GroupSmtpAddress=this.g.a().bj.SmtpAddress;this.k=n.GroupSmtpAddress;var t=new _ao.a(this.g.a().bj.SmtpAddress,"",this.g.a().bj.DisplayName,i,null,this.D().a);t.a=!0;this.d.q(t,!0,n);this.d.p();this.x()}},cL:function(){var n=new _a.o;n.a("W",this.e.c()?1:0);return n.toString()},dF:function(n,t){this.d.s&&(this.k=null)},cI:function(n,t){this.et("HideGroupsButton");this.U&&this.cv()},cv:function(){(this.T||this.E())&&!this.d.c&&this.bn()&&!this.h&&!this.m&&this.t(this.D())},dG:function(n,t){this.x();this.et("SelectedDataProvider")},cn:function(){return this.d.d&&this.d.d.x.length>0?this.d.c&&this.d.c.a.bj.AllowFolderSharing?!0:!this.d.G:!1},bO:function(){return this.m||this.h},cE:function(n){var i=n;var t=new _am.e(i.g,this.d.P);this.d.g.a(t);this.t(t);this.et("AddDropboxProviderEnabled");this.cp(_g.p.toString(t.a.a()),"AttachmentsAddDataProviderSuccessful")},cD:function(n){var t=null;if(_ao.d.isInstanceOfType(n)){t=_g.p.toString(n.c);_j.e.b(_a.a.c,"GetNewAttachmentDataProviderCreationInfoAction failed")}else if(_ao.c.isInstanceOfType(n)){t=_g.p.toString(n.c);_j.e.b(_a.a.c,"AddNewAttachmentDataProviderAction failed")}this.bT(t)},bT:function(n){var i="";var t=this.R.f(n);t&&(i=t.p());this.bm.a(_a.v,new _a.v([_ufp.A.O],0,null,0,!1,null,null,_j.i.c(_ufp.A.BJ,i),this.bp,null))},di:function(){for(var n=0;n<this.d.g.x.length;n++)if(this.d.g.x[n].a.a()===2)return!0;return!1},S:function(){return this.R.a().p()}};_am.l=function(){this.c=Function.createDelegate(this,this.g);this.a=new _a.bG(1e3);_j.e.f||this.f()};_am.l.prototype={a:null,b:!0,f:function(){this.e();this.b=!1},e:function(){this.a.c()},d:function(n,t,i){if(this.b){var r=new _am.l.a;r.b=n;r.d=t;r.c=_a.c.d(_a.c.a());r.a=i;this.a.b(r)}},g:function(n){for(var t=new Sys.StringBuilder,r=0;r<this.a.a.length;r++){var i=this.a.d(r);t.append("\nSharePoint call name: "+i.d);t.append(", Time: "+i.c);t.append(", Correlation Id: "+i.b);_j.i.a(i.a)||t.append(", Exception: "+i.a);n&&t.appendLine("<BR>")}return new _a.bT("Attachments file picker diagnostics data:",t.toString())}};_am.l.a=function(){};_am.l.a.prototype={c:null,d:null,b:null,a:null};function AttachmentsFilePickerViewModelsComponent(){}AttachmentsFilePickerViewModelsComponent.$$cctor=function(){_a.u.a().a(AttachmentsFilePickerViewModelsComponent)};AttachmentsFilePickerViewModelsComponent.onOAuthFinished=function(n){var r=_a.A.b(n);var i=r.provider;if(_j.i.a(i)){var u=r.state;if(!_j.i.a(u)){var t=JsonParser.deserialize(u);t&&"provider"in t&&(i=t.provider)}}var f=_j.t.b(_g.p,i);AttachmentsFilePickerViewModelsComponent.a.b(f,r)};AttachmentsFilePickerViewModelsComponent.prototype={a:function(n,t,i){var u=i.d().a().L().Enabled;if(u){var y=this;n.b(_am.z,function(){return new _am.u(n.a(_a.t),n.a(_j.j),n.a(_a.f),i)}).a();var v=this;n.b(_am.n,function(){return new _am.n(n.a(_a.t),i.a(),n.a(_a.f),n.a(_at.j),n.a(_j.j),n.a(_am.z),!0)}).b(_am.y).a();var a=this;n.b(_am.m,function(){return _am.m.a(n.a(_a.t),n.a(_j.j),n.a(_a.f),n.a(_g.e),n.a(_am.z),n.a(_am.n))}).a()}else{var p=this;n.b(_am.s,function(){return new _am.s(n.a(_a.t),i.a(),n.a(_a.f),n.a(_at.j))}).b(_am.y).a()}var r=null;if(i.d().a().c().Enabled)if(i.a()==="Mouse"){var k=this;r=new(AttachmentsFilePickerViewModelsComponent.b.$$(_y.fP))(function(){var t=n.a(_y.s);return t?t.g:null})}else r=n.c(IModernGroupsNavigationFactory);if(i.a()==="TouchNarrow")if(u){var b=this;n.b(_am.j,function(){return new _am.j(n.f(_am.f).e(),n.a(_a.C),n.a(_j.n),n.a(_y.a),i.a()==="TouchNarrow"?n.a(_y.q):null)});var w=this;n.b(_am.f,function(){return new _am.f(n.a(_am.n),r,n.f(_am.g),n.f(_am.j),n.a(_no.c),n.a(_am.l),n.a(_a.f),n.a(_a.bt),n.a(_j.j),n.a(_j.n),n.a(_y.a),n.a(_g.e),n.a(_a.t),n.a(_at.j),n.a(_am.m),n.a(_a.Y),i.a()==="TouchNarrow"?n.a(_y.q):null)}).b(IAttachmentsFilePickerPanelViewModel).a()}else{var f=this;n.b(_am.k,function(){return new _am.k(n.f(_am.i).e(),n.a(_a.C),n.a(_j.n),n.a(_y.a),i.a()==="TouchNarrow"?n.a(_y.q):null)});var o=this;n.b(_am.i,function(){return new _am.i(n.a(_am.s),r,n.f(_am.g),n.f(_am.k),n.a(_no.c),n.a(_am.l),n.a(_a.f),n.a(_a.bt),n.a(_j.j),n.a(_j.n),n.a(_y.a),n.a(_g.e),n.a(_a.t),n.a(_at.j),i.a()==="TouchNarrow"?n.a(_y.q):null)}).b(IAttachmentsFilePickerPanelViewModel).a()}else if(u){var e=this;n.b(_am.b,function(){return new _am.b(n.a(_am.n),r,n.f(_am.g),n.a(_no.c),n.a(_am.l),n.a(_a.f),n.a(_a.bt),n.a(_j.j),n.a(_j.n),n.a(_y.a),n.a(_g.e),n.a(_a.t),n.a(_at.j),n.a(_am.m),n.a(_a.Y))}).b(IAttachmentsFilePickerPanelViewModel).a()}else{var c=this;n.b(_am.c,function(){return new _am.c(n.a(_am.s),r,n.f(_am.g),n.a(_no.c),n.a(_am.l),n.a(_a.f),n.a(_a.bt),n.a(_j.j),n.a(_j.n),n.a(_y.a),n.a(_g.e),n.a(_a.t),n.a(_at.j))}).b(IAttachmentsFilePickerPanelViewModel).a()}var l=this;n.b(_am.g,function(){return new _am.g(i.a(),n.a(_a.t),n.a(_j.n),n.a(_y.a),n.a(_a.C),i.a()==="TouchNarrow"?n.a(_y.q):null)});var s=this;n.b(_am.B,function(){var u=n.a(_g.a).bj.AttachmentPolicy;var r=n.a(_g.a).i();var t=_at.o.b(i);return new _am.B(u,r,n.a(_am.y),t?n.a(IDownloadAuthenticatorFactory):null,n.a(_at.x))}).b(IAttachmentProviderItemViewModelFactory);var h=this;n.b(_am.l,function(){return new _am.l}).a();AttachmentsFilePickerViewModelsComponent.a=n.a(IAttachmentsFilePickerPanelViewModel)},b:function(){return null}};AttachmentsFilePickerViewModelsComponent.b=function(n){AttachmentsFilePickerViewModelsComponent.b.$$(this.$$gta["AttachmentsFilePickerViewModelsComponent.b"].T).initializeBase(this,[n])};AttachmentsFilePickerViewModelsComponent.b.$$=function(n){var u=AttachmentsFilePickerViewModelsComponent.__tc=AttachmentsFilePickerViewModelsComponent.__tc||{};var t="b"+"$"+n.getName().replace(/\./g,"_");if(!u[t]){var r=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];AttachmentsFilePickerViewModelsComponent.b.apply(this,t)};var h=_j.H;r.registerClass("AttachmentsFilePickerViewModelsComponent."+t,h,_j.cc.$$(n));var o={"AttachmentsFilePickerViewModelsComponent.b":{T:n},ctor:AttachmentsFilePickerViewModelsComponent.b};var c=h.prototype.$$gta;for(var l in c){var s={key:l,value:c[l]};o[s.key]=s.value}r.prototype.$$gta=o;var f=AttachmentsFilePickerViewModelsComponent.b.prototype;for(var e in f){var i={key:e,value:f[e]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return u[t]};AttachmentsFilePickerViewModelsComponent.b.prototype={d:function(){return!1},a:function(n){n&&n(this.e())},b:function(n){this.a(n)}};_am.g=function(n,t,i,r,u,f){this.M=Function.createDelegate(this,this.bh);this.N=Function.createDelegate(this,this.bi);this.v=Function.createDelegate(this,this.bk);_am.g.initializeBase(this);this.r=n;this.I=t;this.t=i;this.K=r;this.k=f;this.bl(new _db.i);var e=this;this.J=new _j.g(function(){e.e();e.eB("AttachmentCanceled")},_a.a.c);this.r==="TouchNarrow"&&this.eg(this.ba())};_am.g.prototype={J:null,r:0,I:null,t:null,K:null,a:null,m:null,A:null,E:null,G:null,g:!1,y:!1,x:!1,q:null,c:!1,b:null,D:null,h:null,j:null,F:!1,o:!1,C:null,f:null,k:null,O:function(n){this.ey("AttachmentCanceled",n)},P:function(n){this.ez("AttachmentCanceled",n)},T:function(n){if(this.A!==n){this.A=n;this.et("AttachCommand")}return n},W:function(n){if(this.E!==n){this.E=n;this.et("InsertPictureInlineCommand")}return n},Y:function(n){if(this.G!==n){this.G=n;this.et("ShareCommand")}return n},d:!1,bg:function(){return this.g?this.q?_ufp.A.k:this.d?_u.n.EX:_u.n.Br:this.d?String.format(_ufp.A.f,this.f.p()):String.format(_ufp.A.BG,this.f.p())},bf:function(){return this.d?_ufp.A.s:_ufp.A.BH},bd:function(){return this.d?_u.n.Js:_u.n.ME},bc:function(){return this.d?_ufp.A.P:_ufp.A.BZ},bl:function(n){if(this.a!==n){this.a=n;this.et("InfoBarViewModel")}return n},S:function(n){if(this.g!==n){this.g=n;this.et("AreLocalFiles")}return n},R:function(n){if(this.y!==n){this.y=n;this.et("AreGroupFiles")}return n},Q:function(n){if(this.x!==n){this.x=n;this.et("AllowSettingAttachOrSharePreference")}return n},X:function(n){if(this.q!==n){this.q=n;this.et("ModernGroupDisplayName")}return n},s:function(n){if(this.c===n)return n;this.c=n;this.et("PersistAttachOrShareOption");return n},be:function(){this.C||(this.C=new _at.L(!1));return this.C},bx:function(){return this.r==="Mouse"?!this.t.a()||this.t.o()||this.K.c()?0:1:4},w:function(){return null},p:function(){return this.m},i:function(n){this.m=n;return n},by:function(){return!0},L:function(n){if(this.D!==n){this.D=n;this.et("EmailAttachmentsFolderName")}return n},e:function(){this.m&&this.m()},cS:function(){_y.hO.prototype.cS.call(this);if(this.b){this.b.j=this.bb();_a.d.a(this.b);this.b=null}},n:function(){return this.r==="TouchNarrow"?1:0},U:function(n){if(this.f===n)return n;this.f=n;this.et("DataProviderInfo");return n},Z:function(n,t,i){this.j=n;this.h=t;this.o=!n||!!i&&i.a(n,"AttachmentGetOneDriveUploadFolderProps");var u=this.j||"PersonalOneDriveKey";var r=this.o?_at.h.e(u):_at.q.b(u);if(_j.i.a(r)){this.L(_ufp.A.X);if(n&&(!i||!i.a(n,"AttachmentGetOneDriveUploadFolderName")))return;_j.i.a(this.j)||t.apcl("AttachmentDataProviders",this.v)}else this.L(r)},bk:function(n,t){if(this.h.a()&&this.h.a().x.length){var i;i=this.o?new _at.h(this.j):new _at.q(this.j);i.d(this.N);i.e(this.M);this.I.a(i)}},bi:function(n){var t=this.o?n.g:n.g;_j.i.a(t)&&(t=_ufp.A.X);this.L(t);this.h.rpcl("AttachmentDataProviders",this.v)},bh:function(n){this.h.rpcl("AttachmentDataProviders",this.v)},bb:function(){var n=new _a.o;n.a("W",this.F?1:0);return n.toString()},ba:function(){var n=this.k.b();n.d(_ufp.A.R);if(this.t.b()){n.a(this.k.a(_y.b.b(),_y.b.b(),this.ef,""));n.e(3)}else n.a(this.k.a(_y.b.a(),_y.b.a(),this.ef,""));return n}};_am.t=function(n,t,i,r,u,f){this.I=Function.createDelegate(this,this.O);_am.t.initializeBase(this,[3,n,t,i,r,u,f]);this.v(new _j.g(this.I,_a.a.c));var s=this;this.a.apcl("AttachmentDataProviders",function(){s.y()});var o=this;this.a.z(function(){o.y()});var e=this;this.a.m(function(){e.y()})};_am.t.b=function(){return _fm.e.a("box_grey.png")};_am.t.a=function(){return _fm.e.a("box_dark.png")};_am.t.prototype={p:null,l:function(){return _am.t.b()},k:function(){return _am.t.a()},j:function(){return this.f()&&!this.b.b().bj.AttachmentsFilePickerHideAddBox},f:function(){return this.h.a().ey().Enabled&&!this.t(this.c)&&this.b.h().BoxAttachmentsEnabled},e:function(n,t,i,r){var u=t.state;if(this.p===u){this.p=null;_am.h.prototype.e.call(this,n,t,i,r)}else this.d()},s:function(){return this.E()},o:function(n){this.b.b().bf(n);return!!_h.f.a(this.b.b().c(),this.g)},y:function(){this.ex("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},O:function(){var i="https://app.box.com/api/oauth2/authorize";var n=this.m;if(_j.i.a(n)){this.n();this.d();return}this.p=this.r();var t={state:this.p};this.q(i,n,"code",t)}};_am.m=function(){this.k=Function.createDelegate(this,this.G);_am.m.initializeBase(this)};_am.m.a=function(n,t,i,r,u,f){var e=new _am.m;e.j(new _am.I(n,t,i,r,u,f));e.j(new _am.t(n,t,i,r,u,f));e.j(new _am.v(n,t,i,r,u,f));e.j(new _am.x(n,t,i,r,u,f));i&&i.a().cz().Enabled&&e.j(new _am.w(n,t,i,r,u,f));return e};_am.m.prototype={I:function(n){n.i.a();this.bq("SelectedDataProviderCreator");return n},j:function(n){n.P(this.k);_j.k.prototype.a.call(this,n)},E:function(n){this.bu("NewDataProviderCreated",n)},D:function(n){var t=this;this.p(function(t){var i=t;i.U(n)})},y:function(n){var t=null;var i=this;this.p(function(i){var r=i;r.c===n&&(t=r)});t||_j.e.c(_a.a.c,_j.i.c("{0} data provider creator does not exist",n));return t},G:function(n){this.bO("NewDataProviderCreated",n)}};_am.h=function(n,t,i,r,u,f,e){this.K=Function.createDelegate(this,this.S);this.L=Function.createDelegate(this,this.T);this.J=Function.createDelegate(this,this.Q);this.M=Function.createDelegate(this,this.V);_am.h.initializeBase(this);this.c=n;this.g=t;this.A=i;this.h=r;this.b=u;this.z=f;this.a=e;this.w=_at.j.a(this.c);this.G=new _j.g(this.M,_a.a.c)};_am.h.prototype={i:null,G:null,g:null,h:null,b:null,z:null,a:null,m:null,x:null,F:null,A:null,w:null,D:function(){return _j.i.c(_ufp.A.z,this.w.p())},N:function(){return"code"},c:0,P:function(n){this.ey("OnDataProviderCreated",n)},v:function(n){if(this.i!==n){this.i=n;this.et("AddDataProviderCommand")}return n},U:function(n){this.F=n;this.n()},e:function(n,t,i,r){if(!n){this.d();_j.e.c(_a.a.c,_j.i.c("{0} oAuth code not returned in the redirect page.",_g.p.toString(this.c)));return}var u=new _ao.c(this.c,n,this.x);var f=this;u.d(function(n){f.R(n,i,r)});u.e(this.J);this.g.a(u)},n:function(){var n=new _ao.d(this.c);n.d(this.L);n.e(this.K);this.g.a(n)},s:function(){return _j.i.c("{0}//{1}{2}ADPOAuthRedirect.html?provider={3}",window.location.protocol,window.location.host,window.location.pathname,_g.p.toString(this.c))},E:function(){var i=window.location.host==="exchangelabs.live-int.com"?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";var t=_j.i.c("{0}//{1}{2}ADPOAuthRedirect.html",window.location.protocol,window.location.host,window.location.pathname);var n=encodeURIComponent(_j.i.c("provider={0}&url={1}",_g.p.toString(this.c),t));return _j.i.c("{0}/ADPRedirect.aspx?{1}",i,n)},q:function(n,t,i,r){this.x=this.s();var u=n;u=_a.A.a(u,"client_id",t);u=_a.A.a(u,"redirect_uri",this.x);u=_a.A.a(u,"response_type",i);if(r)for(var o=Object.keys(r),s=o.length,f=0;f<s;++f){var e=o[f];u=_a.A.a(u,e,r[e])}this.C(_g.p.toString(this.c),"AttachmentsAddDataProvider");_a.Z.a(u,600,600,!0)},d:function(){var n=this.w.p();this.W(_ufp.A.O,_j.i.c(_ufp.A.BJ,n))},W:function(n,t){this.A.a(_a.v,new _a.v([t],0,null,0,!1,null,null,n,this.F,null))},t:function(n){if(this.a&&this.a.d)for(var t=0;t<this.a.d.x.length;t++)if(this.a.d.x[t].a.a()===n)return!0;return!1},r:function(){for(var i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),r=i.length-1,n=new Sys.StringBuilder("owa_csrf_token_"),t=0;t<16;t++)n.append(i[Math.round(Math.random()*r)]);return n.toString()},R:function(n,t,i){var u=n;var r=this.z.a(u.g,i);t(r);this.eC("OnDataProviderCreated",r);this.ex("AddDataProviderEnabled","AddDataProviderEnabledInOptions");this.C(_g.p.toString(r.a.a()),"AttachmentsAddDataProviderSuccessful")},Q:function(n){var t=null;if(_ao.d.isInstanceOfType(n)){t=_g.p.toString(n.c);_j.e.b(_a.a.c,"GetNewAttachmentDataProviderCreationInfoAction failed")}else if(_ao.c.isInstanceOfType(n)){t=_g.p.toString(n.c);this.C(t,"AttachmentsAddDataProviderFailed");_j.e.b(_a.a.c,"AddNewAttachmentDataProviderAction failed")}this.d()},V:function(){this.o(!0)||_j.e.c(_a.a.c,_j.i.c("Failed to persist the configuration for removing '{0}' placeholder",this.D()));this.ex("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},T:function(n){var t=n;t.c===this.c&&(this.m=t.g.ProviderAppKey)},S:function(n){_j.e.b(_a.a.c,"GetNewAttachmentDataProviderCreationInfoAction failed")},C:function(n,t){var r=_a.d.b(_a.a.c,t);var i=new _a.o;i.b("DP",n);r.j=i.toString();_a.d.a(r)}};_am.v=function(n,t,i,r,u,f){this.I=Function.createDelegate(this,this.O);_am.v.initializeBase(this,[2,n,t,i,r,u,f]);this.v(new _j.g(this.I,_a.a.c));var s=this;this.a.apcl("AttachmentDataProviders",function(){s.y()});var o=this;this.a.z(function(){o.y()});var e=this;this.a.m(function(){e.y()})};_am.v.b=function(){return _fm.e.a("dropbox_grey.png")};_am.v.a=function(){return _fm.e.a("dropbox_dark.png")};_am.v.prototype={p:null,l:function(){return _am.v.b()},k:function(){return _am.v.a()},j:function(){return this.f()&&!this.b.b().bj.AttachmentsFilePickerHideAddDropbox},f:function(){return this.h.a().bF().Enabled&&!this.t(this.c)&&this.b.h().DropboxAttachmentsEnabled},e:function(n,t,i,r){var u=t.state;if(this.p===u){this.p=null;_am.h.prototype.e.call(this,n,t,i,r)}else this.d()},o:function(n){this.b.b().bg(n);return!!_h.f.a(this.b.b().c(),this.g)},y:function(){this.ex("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},O:function(){var i="https://www.dropbox.com/1/oauth2/authorize";var n=this.m;if(_j.i.a(n)){this.n();this.d();return}this.p=this.r();var t={state:this.p};this.q(i,n,"code",t)}};_am.w=function(n,t,i,r,u,f){this.I=Function.createDelegate(this,this.O);_am.w.initializeBase(this,[6,n,t,i,r,u,f]);this.v(new _j.g(this.I,_a.a.c));var s=this;this.a.apcl("AttachmentDataProviders",function(){s.y()});var o=this;this.a.z(function(){o.y()});var e=this;this.a.m(function(){e.y()})};_am.w.b=function(){return _fm.e.a("facebook.png")};_am.w.a=function(){return _fm.e.a("facebook.png")};_am.w.prototype={p:null,N:function(){return"access_token"},l:function(){return _am.w.b()},k:function(){return _am.w.a()},j:function(){return this.f()&&!this.b.b().bj.AttachmentsFilePickerHideAddFacebook},f:function(){return this.h.a().cz().Enabled&&!this.t(this.c)},e:function(n,t,i,r){var u=t.state;if(this.p===u){this.p=null;_am.h.prototype.e.call(this,n,t,i,r)}else this.d()},s:function(){return this.E()},o:function(n){this.b.b().bh(n);return!!_h.f.a(this.b.b().c(),this.g)},y:function(){this.ex("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},O:function(){var t=this.m;if(_j.i.a(t)){this.n();this.d();return}this.p=this.r();var n={state:this.p};n.scope=String.format("{0},{1}","user_photos","email");this.q("https://www.facebook.com/dialog/oauth",t,"token",n)}};_am.x=function(n,t,i,r,u,f){this.I=Function.createDelegate(this,this.O);_am.x.initializeBase(this,[5,n,t,i,r,u,f]);this.v(new _j.g(this.I,_a.a.c));var s=this;this.a.apcl("AttachmentDataProviders",function(){s.y()});var o=this;this.a.z(function(){o.y()});var e=this;this.a.m(function(){e.y()})};_am.x.b=function(){return _fm.e.a("gdrive_grey.png")};_am.x.a=function(){return _fm.e.a("gdrive_dark.png")};_am.x.prototype={p:null,l:function(){return _am.x.b()},k:function(){return _am.x.a()},j:function(){return this.f()&&!this.b.b().bj.AttachmentsFilePickerHideAddGDrive},f:function(){return this.h.a().bH().Enabled&&!this.t(this.c)},e:function(n,t,i,r){var u=t.state;if(!_j.i.a(u)){var e=JsonParser.deserialize(u);var f=e.state;if(this.p===f){this.p=null;_am.h.prototype.e.call(this,n,t,i,r);return}}this.d()},s:function(){var n=window.location.host==="exchangelabs.live-int.com"?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";return _j.i.c("{0}/ADPRedirect.aspx",n)},o:function(n){this.b.b().bi(n);return!!_h.f.a(this.b.b().c(),this.g)},y:function(){this.ex("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},O:function(){var r="https://accounts.google.com/o/oauth2/auth";var n=this.m;if(_j.i.a(n)){this.n();this.d();return}this.p=this.r();var u=_j.i.c("{0}//{1}{2}ADPOAuthRedirect.html",window.location.protocol,window.location.host,window.location.pathname);var t={state:this.p,provider:_g.p.toString(this.c),url:u};var i={state:JsonParser.serialize(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent"};this.q(r,n,"code",i)}};_am.I=function(n,t,i,r,u,f){this.I=Function.createDelegate(this,this.O);_am.I.initializeBase(this,[1,n,t,i,r,u,f]);this.v(new _j.g(this.I,_a.a.c));var s=this;this.a.apcl("AttachmentDataProviders",function(){s.y()});var o=this;this.a.z(function(){o.y()});var e=this;this.a.m(function(){e.y()})};_am.I.prototype={p:null,l:function(){return _fm.a.S},k:function(){return _fm.a.S},j:function(){return this.f()&&!this.b.b().bj.AttachmentsFilePickerHideAddOneDriveConsumer},f:function(){return this.h.a().eI().Enabled&&!this.h.a().b().Enabled&&!this.t(this.c)},e:function(n,t,i,r){var u=t.state;if(this.p===u){this.p=null;_am.h.prototype.e.call(this,n,t,i,r)}else this.d()},s:function(){return this.E()},o:function(n){this.b.b().bv(n);return!!_h.f.a(this.b.b().c(),this.g)},y:function(){this.ex("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},O:function(){var i="https://login.live.com/oauth20_authorize.srf";var n=this.m;if(_j.i.a(n)){this.n();this.d();return}this.p=this.r();var t={scope:"wl.basic onedrive.readwrite wl.offline_access",state:this.p};this.q(i,n,"code",t)}};_am.p=function(n){this.i=Function.createDelegate(this,this.A);_am.p.initializeBase(this);this.a=0;this.e=0;this.d=n;this.d.apcl("IsSortingSupported",this.i)};_am.p.a=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_am.p.b=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.f,"ms-fcl-nd-b")};_am.p.c=function(){return _fm.b.a(_fm.a.y,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_am.p.d=function(){return _fm.b.a(_fm.a.y,_fm.WebfontSizes.a.f,"ms-fcl-nd-b")};_am.p.prototype={d:null,a:0,b:0,c:0,e:0,r:function(){return this.g(0,this.a)},o:function(){return this.g(2,this.b)},u:function(){return this.g(1,this.c)},q:function(){return this.f(0,this.a)},n:function(){return this.f(2,this.b)},t:function(){return this.f(1,this.c)},s:function(){return this.d.i?this.a?_ufp.A.J:_ufp.A.BY:null},p:function(){return this.d.i?this.b?_ufp.A.M:_ufp.A.p:null},v:function(){return this.d.i?this.c?_ufp.A.q:_ufp.A.m:null},l:function(n){if(this.a!==n){this.a=n;this.eE("NameHeaderImageId","NameHeaderHoveredImageId","NameHeaderToolTip")}return n},k:function(n){if(this.b!==n){this.b=n;this.eE("LastModifiedHeaderImageId","LastModifiedHeaderHoveredImageId","LastModifiedHeaderToolTip")}return n},m:function(n){if(this.c!==n){this.c=n;this.eE("SizeHeaderImageId","SizeHeaderHoveredImageId","SizeHeaderToolTip")}return n},w:function(n){if(this.e!==n){this.e=n;this.j()}return n},z:function(n){if(this.e===n)return this.y(n);else{var t=this.x(n);this.w(n);return t}},x:function(n){var t=0;switch(n){case 0:this.l(0);t=this.a;break;case 1:this.m(1);t=this.c;break;case 2:this.k(1);t=this.b;break;default:break}return t},y:function(n){var t=0;switch(n){case 0:this.l(this.h(this.a));t=this.a;break;case 1:this.m(this.h(this.c));t=this.c;break;case 2:this.k(this.h(this.b));t=this.b;break;default:break}return t},h:function(n){switch(n){case 0:n=1;break;case 1:n=0;break;default:break}return n},g:function(n,t){return this.d.i&&this.e===n?t?_am.p.a():_am.p.c():null},f:function(n,t){return this.d.i&&this.e===n?t?_am.p.b():_am.p.d():null},A:function(n,t){this.j()},j:function(){this.eA(["NameHeaderImageId","NameHeaderHoveredImageId","LastModifiedHeaderImageId","LastModifiedHeaderHoveredImageId","SizeHeaderImageId","SizeHeaderHoveredImageId","NameHeaderToolTip","LastModifiedHeaderToolTip","SizeHeaderToolTip"])}};_am.q=function(n){this.l=Function.createDelegate(this,this.S);_am.q.initializeBase(this);this.b=_am.a.c;this.h=_am.a.b;this.a=n;this.a.apcl("IsSortingSupported",this.l)};_am.q.a=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_am.q.b=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.f,"ms-fcl-nd-b")};_am.q.c=function(){return _fm.b.a(_fm.a.y,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_am.q.d=function(){return _fm.b.a(_fm.a.y,_fm.WebfontSizes.a.f,"ms-fcl-nd-b")};_am.q.prototype={a:null,b:0,d:0,f:0,c:0,g:0,e:0,h:0,C:function(){return this.j(0,this.b)},y:function(){return this.j(2,this.d)},J:function(){return this.j(1,this.f)},v:function(){return this.j(3,this.c)},M:function(){return this.j(4,this.g)},F:function(){return this.j(5,this.e)},A:function(){return this.i(0,this.b)},x:function(){return this.i(2,this.d)},I:function(){return this.i(1,this.f)},u:function(){return this.i(3,this.c)},L:function(){return this.i(4,this.g)},E:function(){return this.i(5,this.e)},D:function(){return this.a.h?this.b?_ufp.A.J:_ufp.A.BY:null},z:function(){return this.a.h?this.d?_ufp.A.M:_ufp.A.p:null},K:function(){return this.a.h?this.f?_ufp.A.q:_ufp.A.m:null},w:function(){return this.a.h?this.c?_ufp.A.J:_ufp.A.BY:null},N:function(){return this.a.h?this.g?_ufp.A.J:_ufp.A.BY:null},G:function(){return this.a.h?this.e?_ufp.A.M:_ufp.A.p:null},p:function(n){if(this.b!==n){this.b=n;this.eE("NameHeaderImageId","NameHeaderHoveredImageId","NameHeaderToolTip")}return n},o:function(n){if(this.d!==n){this.d=n;this.eE("LastModifiedHeaderImageId","LastModifiedHeaderHoveredImageId","LastModifiedHeaderToolTip")}return n},r:function(n){if(this.f!==n){this.f=n;this.eE("SizeHeaderImageId","SizeHeaderHoveredImageId","SizeHeaderToolTip")}return n},n:function(n){if(this.c!==n){this.c=n;this.eE("FromHeaderImageId","FromHeaderHoveredImageId","FromHeaderToolTip")}return n},s:function(n){if(this.g!==n){this.g=n;this.eE("SubjectHeaderImageId","SubjectHeaderHoveredImageId","SubjectHeaderToolTip")}return n},q:function(n){if(this.e!==n){this.e=n;this.eE("ReceivedDateHeaderImageId","ReceivedDateHeaderHoveredImageId","ReceivedDateHeaderToolTip")}return n},O:function(n){if(this.h!==n){this.h=n;this.m()}return n},R:function(n){return this.h===n?this.Q(n):0},t:function(n,t){this.O(n);this.P(n,t)},P:function(n,t){switch(n){case 0:this.p(t);break;case 1:this.r(t);break;case 2:this.o(t);break;case 3:this.n(t);break;case 4:this.s(t);break;case 5:this.q(t);break;default:break}},Q:function(n){var t=0;switch(n){case 0:this.p(this.k(this.b));t=this.b;break;case 1:this.r(this.k(this.f));t=this.f;break;case 2:this.o(this.k(this.d));t=this.d;break;case 3:this.n(this.k(this.c));t=this.c;break;case 4:this.s(this.k(this.g));t=this.g;break;case 5:this.q(this.k(this.e));t=this.e;break;default:break}return t},k:function(n){switch(n){case 0:n=1;break;case 1:n=0;break;default:break}return n},j:function(n,t){return this.a.h&&this.h===n?t?_am.q.a():_am.q.c():null},i:function(n,t){return this.a.h&&this.h===n?t?_am.q.b():_am.q.d():null},S:function(n,t){this.m()},m:function(){this.eA(["NameHeaderImageId","NameHeaderHoveredImageId","NameHeaderToolTip","LastModifiedHeaderImageId","LastModifiedHeaderHoveredImageId","LastModifiedHeaderToolTip","SizeHeaderImageId","SizeHeaderHoveredImageId","SizeHeaderToolTip","FromHeaderImageId","FromHeaderHoveredImageId","FromHeaderToolTip","SubjectHeaderImageId","SubjectHeaderHoveredImageId","SubjectHeaderToolTip","ReceivedDateHeaderImageId","ReceivedDateHeaderHoveredImageId","ReceivedDateHeaderToolTip"])}};_am.s=function(n,t,i,r){this.ba=Function.createDelegate(this,this.bu);this.N=Function.createDelegate(this,this.br);this.Z=Function.createDelegate(this,this.bs);this.Q=Function.createDelegate(this,this.bf);this.M=Function.createDelegate(this,this.bq);this.O=Function.createDelegate(this,this.bw);this.bd=Function.createDelegate(this,this.bA);this.bb=Function.createDelegate(this,this.bx);this.bc=Function.createDelegate(this,this.by);this.P=Function.createDelegate(this,this.bz);_am.s.initializeBase(this);this.D=n;this.h=new _j.k;this.V=t;this.bi(new _j.k);this.i=!1;this.o=!1;this.w=new _j.g(this.bc,_a.a.c);this.v=new _j.g(this.bb,_a.a.c);this.x=new _j.g(this.bd,_a.a.c);this.w.c(!1);this.v.c(!1);this.x.c(!1);this.A=r};_am.s.prototype={g:null,c:null,f:null,h:null,l:null,D:null,A:null,e:null,r:!1,k:null,j:null,C:null,E:null,s:!1,F:null,m:null,V:0,T:!1,d:null,w:null,v:null,x:null,y:null,i:!1,o:!1,G:!1,a:function(){return this.g},bE:function(n){if(this.g!==n){this.g=n;this.et("AttachmentDataProviders")}return n},I:function(n){if(this.f!==n){this.f=n;this.bJ();this.bH(this.bn());this.bF(new _am.p(this));this.et("CurrentFolder")}return n},bF:function(n){if(this.y!==n){this.y=n;this.et("CurrentFolderSortInfo")}return n},J:function(n){if(this.r!==n){this.r=n;this.et("IsDataInProgress");this.X()}return n},K:function(n){if(this.e===n)return n;if(this.e){this.e.cp(this.O);this.e.du(this.M)}this.e=n;if(this.e){this.e.ce(this.O);this.e.dY(this.M);this.e.bC?this.J(!0):this.n(null)}this.et("ItemsTable");return n},L:function(n){if(this.c!==n){var t=this.c;this.c=n;this.c&&(this.c.d||this.c.e(this.c.h()));t&&t.e(null);this.X();this.Y();this.et("SelectedDataProvider")}return n},bi:function(n){if(this.d!==n){this.d&&this.d.g(this.Q);this.d=n;this.d&&this.d.e(this.Q);this.bf(null,null);this.et("SelectedAttachmentDataProviderItems")}return n},n:function(n){if(this.C!==n){this.C=n;this.et("InfoMessage")}return n},bg:function(n){if(this.l!==n){this.l=n;if(this.l&&this.f!==n){this.t();this.q(this.l,!0)}this.et("BreadCrumbsSelectedItem")}return n},bH:function(n){if(this.s===n)return n;this.s=n;this.et("IsOneDriveProGroupsView");return n},bh:function(n){if(this.i!==n){this.i=n;this.bK();this.et("IsSortingSupported")}return n},bj:function(n){if(this.o!==n){this.o=n;this.et("ShouldShowSizeHeader")}return n},bp:function(){if(!this.E){var t=this,n=this;this.E=new _y.bh(new _am.G,function(n){return _gg.m.isInstanceOfType(n)?n.bj.GroupCategory:""},function(n){return n},"")}return this.E},S:function(){return this.V==="Mouse"?this.A.a().w():this.A.a().x()},bm:function(n){this.ey("OnDataProvidersLoadedEvent",n)},bD:function(n){this.ez("OnDataProvidersLoadedEvent",n)},bG:function(n){this.G=n;this.et("IsAnyFolderSelected");return n},b:function(){this.j=_a.d.b(_a.a.c,"AttachmentsFilePickerGetDataProviders");this.p();var n=new _at.n(2);n.d(this.Z);n.e(this.N);this.D.a(n)},q:function(n,t,i){this.be(n,t,t,i,!1,null)},W:function(n){if(!this.f){_j.e.b(_a.a.c,"CurrentFolder is null when ReExpandCurrentFolderWithSortColumn");return}var t=new _gg.K;t.SortColumn=n;t.SortOrder=this.y.z(n);this.be(this.f,!1,!0,null,!0,t);this.bo(n,t.SortOrder)},bo:function(n,t){var r=_a.d.b(_a.a.c,"AttachmentsFilePickerSort");var i=new _a.o;i.a("C",n);i.a("O",t);r.j=i.toString();_a.d.a(r)},be:function(n,t,i,r,u,f){if(n===this.m){this.bk();return}if(!f){f=new _gg.K;f.SortColumn=0;f.SortOrder=0}var s=new _ao.i(n,n.d,f,n.c,n.b,r,u,0);var h=this;var e=_h.c.b(s,_h.h.a(),function(n){return new _ao.h(n)});if(t){this.p();this.I(n)}i&&this.K(e);var o=50;e.bs&&e.bs.x.length>0&&(o=e.bs.x.length);e.n(new _h.n(0,o),null,null,null);i&&this.X()},bk:function(){this.I(this.m);this.K(this.F);this.Y();if(this.e){this.t("AttachmentsFilePickerGetGroups");this.e.bg();this.J(!0)}},bC:function(){if(this.e){this.t("AttachmentsFilePickerGetRecentItems");this.e.bg();this.J(!0)}},bB:function(){this.j=_a.d.b(_a.a.c,"AttachmentsFilePickerGetDataProvidersPreload");var n=new _at.n(2);n.d(this.ba);n.e(this.N);this.D.a(n)},bI:function(n){if(!this.m||!this.F){this.m=new _ao.a("AttachmentsDataProvider_Groups","",_ufp.A.BO,null,null,n);this.m.a=!0;this.F=new _ao.e(new(_h.ds.$$(_ao.e))(this.m))}},t:function(n){n||(n="AttachmentsFilePickerChangeFolder");if(this.k){var t=this.k;t.k="Abandoned";t.j=this.z();_a.d.a(this.k);this.k=null}this.k=_a.d.b(_a.a.c,n)},p:function(){this.d.f()},bz:function(n){this.L(n);this.p();this.U(n,null);this.Y()},U:function(n,t){if(n)if(t)this.q(new _ao.a(n.a.bj.Id,"",t.DisplayName,t,null,n.a),!1);else{this.t("AttachmentsFilePickerLoadRootFolder");var i=n.c()?n.c().DisplayName:n.a.bj.DisplayName;this.q(new _ao.a(n.a.bj.Id,"",i,n.c(),null,n.a),!0)}},bJ:function(){if(this.f){if(this.l!==this.f||!this.h.x.length||this.h.x[this.h.x.length-1]!==this.f){var n=this.h.l(this.f);if(n>=0&&n<this.h.x.length-1)this.h.s(n+1,this.h.x.length-(n+1));else if(this.f.a||this.c&&this.f.Id===this.c.a.bj.Id){this.h.f();this.h.a(this.f)}else this.h.a(this.f);this.bg(this.f)}}else this.h.f()},bw:function(n,t){this.J(this.e.bC);if(!this.r&&this.k){this.k.j=this.z();_a.d.a(this.k);this.k=null;if(this.c&&this.c.a&&(!this.c.a.a()||this.c.a.a()===1)){var r=this.c.c().Type;var i=null;r===4?i="AttachmentsFilePickerRecentFiles":r===1&&(i="AttachmentsFilePickerSharedWithMeFiles");_j.i.a(i)||this.R(i)}}},R:function(n){var i=_a.d.b(_a.a.c,n);var t=new _a.o;t.a("N",this.e.by);t.b("DP",this.bt());i.j=t.toString();_a.d.a(i)},bt:function(){return this.c&&this.c.a?_g.p.toString(this.c.a.a()):"Unknown"},bq:function(n,t){if(this.e.bK){var r,f;var u=this.e.cb;switch(u.g){case 2:r=_ufp.A.H;f="AccessDenied";break;case 4:r=_ufp.A.B;f="NotFound";break;default:r=_ufp.A.C;f=_at.k.c(u);break}this.n(r);if(this.k){var i=this.k;i.k=u.N();i.m=f;i.l=u.M();i.j=this.z();_a.d.a(i);this.k=null}}},bl:function(n){var s=n;var c=s.c;if(c.length<=0)(!this.g||this.g.x.length<=0)&&this.n(this.S());else{for(var f=new _j.k,h=new _at.F,o=c,l=o.length,r=0;r<l;++r){var t=o[r];var e=!1;if(this.g)for(var u=0;u<this.g.x.length;u++){var i=this.g.x[u];if(i.a.bj.Id===t.bj.Id){i.n(t);f.a(i);e=!0;break}}e||f.a(new _am.e(t,this.P));h.b(t.a(),!0)}this.bE(f);this.A.g(h);this.g.w(this.c)||this.L(null)}if(this.j){this.j.l=s.M();this.j.j=this.z();_a.d.a(this.j);this.j=null}this.eD("OnDataProvidersLoadedEvent",this,null)},bs:function(n){this.bl(n)},bu:function(n){this.bl(n);if(this.g)for(var t,u=0;u<this.g.x.length;u++){t=this.g.x[u];if(!t.a.a()||t.a.a()===1){var r=t.a.b().a(t.a.bj.DefaultScopeIndex);r.Type!==4&&this.U(t,r);if(r.Type)for(var i=0;i<t.a.b().b();i++){var f=t.a.b().a(i);if(!f.Type){this.U(t,t.a.b().a(i));break}}break}}},br:function(n){this.L(null);this.n(this.S());if(this.j){this.j.k=n?n.N():null;this.j.l=n?n.M():null;this.j.j=this.z();_a.d.a(this.j);this.j=null}this.eD("OnDataProvidersLoadedEvent",this,null)},X:function(){if(this.r){this.n(null);return}this.e&&(this.e.bs&&this.e.bs.x.length?this.n(null):this.C||this.n(_ufp.A.n))},bn:function(){return this.f&&this.f.Id==="AttachmentsDataProvider_Groups"?!0:!!this.c&&!!this.c.c()&&this.c.c().__type===_gg.F._dataContractName&&this.c.c().Type===3&&this.h.x.length===1},z:function(){var n=new _a.o;n.a("W",this.T?1:0);return n.toString()},bf:function(n,t){var r=!1;if(this.d)for(var i=0;i<this.d.x.length;i++){var u=this.d.x[i];if(!this.bv(u)){r=!0;break}}this.bG(r);this.et("SelectedAttachmentsChanged")},bv:function(n){return!n.a()||_gg.v.isInstanceOfType(n)},Y:function(){this.f&&this.f.Id==="AttachmentsDataProvider_Groups"?this.bj(!0):this.bj(!!this.c&&!!this.c.c()&&this.c.c().__type===_gg.F._dataContractName&&!this.c.c().Type);_j.e.a(_a.a.c,"ShouldShowSizeHeader = {0}",this.o);this.f&&this.f.Id==="AttachmentsDataProvider_Groups"?this.bh(!1):this.bh(this.o);_j.e.a(_a.a.c,"IsSortingSupported = {0}",this.i)},bK:function(){_j.e.a(_a.a.c,"UpdateSortingCommands with IsSortingSupported={0}",this.i);this.w.c(this.i);this.x.c(this.i);this.v.c(this.i)},by:function(){this.W(0)},bx:function(){this.W(2)},bA:function(){this.W(1)}};_am.n=function(n,t,i,r,u,f,e){this.bA=Function.createDelegate(this,this.ca);this.bc=Function.createDelegate(this,this.bY);this.bz=Function.createDelegate(this,this.bZ);this.bf=Function.createDelegate(this,this.bL);this.bg=Function.createDelegate(this,this.cj);this.bd=Function.createDelegate(this,this.ce);this.bE=Function.createDelegate(this,this.ch);this.bG=Function.createDelegate(this,this.cl);this.bB=Function.createDelegate(this,this.cd);this.bF=Function.createDelegate(this,this.ck);this.bC=Function.createDelegate(this,this.cf);this.bD=Function.createDelegate(this,this.cg);this.be=Function.createDelegate(this,this.ci);_am.n.initializeBase(this);this.M=n;this.i=new _j.k;this.br=t;this.bk=i;this.bO(new _j.k);this.bj=u;this.bi=f;this.bv=e;this.h=!1;this.r=!1;this.I=!1;this.K=!1;this.r=!1;this.J=!0;this.C=new _j.g(this.bD,_a.a.c);this.A=new _j.g(this.bC,_a.a.c);this.D=new _j.g(this.bF,_a.a.c);this.O=new _j.g(this.bB,_a.a.c);this.Q=new _j.g(this.bG,_a.a.c);this.P=new _j.g(this.bE,_a.a.c);this.C.c(!1);this.A.c(!1);this.D.c(!1);this.s=r};_am.n.prototype={d:null,V:null,X:null,c:null,g:null,i:null,o:null,bj:null,M:null,s:null,bi:null,f:null,v:!1,k:null,j:null,F:null,S:null,w:!1,T:null,p:null,br:0,bp:!1,e:null,C:null,A:null,D:null,O:null,Q:null,P:null,l:null,h:!1,J:!1,r:!1,I:!1,K:!1,bb:!1,U:!1,bo:!1,bv:!1,R:null,W:null,bs:null,N:0,bk:null,bh:null,bt:function(n){this.N!==n&&(this.N=n);return n},L:null,a:function(){return this.d},ct:function(n){if(this.d!==n){this.d=n;this.et("AttachmentDataProviders");this.by(n)}return n},cx:function(n){if(this.V!==n){this.V=n;this.et("PrimaryDataProviders")}return n},cy:function(n){if(this.X!==n){this.X=n;this.et("SecondaryDataProviders")}return n},Y:function(n){if(this.g!==n){this.g=n;this.cE();this.cw(this.bU());this.cu(new _am.q(this));this.et("CurrentFolder")}return n},cu:function(n){if(this.l!==n){this.l&&this.l.dispose();this.l=n;this.et("CurrentFolderSortInfo")}return n},Z:function(n){if(this.v!==n){this.v=n;this.et("IsDataInProgress");this.bw()}return n},ba:function(n){if(this.f===n)return n;if(this.f){this.f.cp(this.bd);this.f.du(this.R)}this.f=n;if(this.f){var i=this.c;var t=this;this.R=function(n,r){t.bX(i)};this.f.ce(this.bd);this.f.dY(this.R);this.f.bC?this.Z(!0):this.q(null)}this.et("ItemsTable");return n},G:function(n){if(this.c!==n){var t=this.c;this.c=n;if(this.c){this.bt(this.c.bf());this.c.V(!0);this.c.d||this.c.v(this.c.O());this.c.apcl("AttachmentItemsFilterBy",this.bg)}if(t){t.V(!1);t.v(null);t.rpcl("AttachmentItemsFilterBy",this.bg)}this.bw();this.bx();this.et("SelectedDataProvider")}return n},bO:function(n){if(this.e!==n){this.e&&this.e.g(this.bf);this.e=n;this.e&&this.e.e(this.bf);this.bL(null,null);this.et("SelectedAttachmentDataProviderItems")}return n},q:function(n){if(this.F!==n){this.F=n;this.et("InfoMessage")}return n},bN:function(n){if(this.o!==n){this.o=n;if(this.o&&this.g!==n){this.y();this.t(this.o,!0,this.c?this.c.t():null)}this.et("BreadCrumbsSelectedItem")}return n},cw:function(n){if(this.w===n)return n;this.w=n;this.et("IsOneDriveProGroupsView");return n},bu:function(n){if(this.h!==n){this.h=n;this.cG();this.et("IsSortingSupported")}return n},cA:function(n){if(this.J!==n){this.J=n;this.et("ShouldShowModifiedHeader")}return n},bP:function(n){if(this.r!==n){this.r=n;this.et("ShouldShowSizeHeader")}return n},cz:function(n){if(this.I!==n){this.I=n;this.et("ShouldShowFromHeader")}return n},cC:function(n){if(this.K!==n){this.K=n;this.et("ShouldShowSubjectHeader")}return n},cB:function(n){if(this.bb!==n){this.bb=n;this.et("ShouldShowReceivedDateHeader")}return n},bW:function(){if(!this.S){var t=this,n=this;this.S=new _y.bh(new _am.G,function(n){return _gg.m.isInstanceOfType(n)?n.bj.GroupCategory:""},function(n){return n},"")}return this.S},bl:function(){return this.br==="Mouse"?this.s.a().w():this.s.a().x()},bH:function(n){this.ey("OnDataProvidersLoadedEvent",n)},cr:function(n){this.ez("OnDataProvidersLoadedEvent",n)},cv:function(n){this.U=n;this.et("IsAnyFolderSelected");return n},bI:function(){var n=this.bJ();return n?n.t():!1},z:function(n){this.ey("DataProviderAddedToDPFilesViewModel",n)},m:function(n){this.ey("DataProviderRemovedFromDPFilesViewModel",n)},bM:function(n){this.ez("DataProviderRemovedFromDPFilesViewModel",n)},bS:function(n){this.d.a(n);this.by(this.d);this.eC("DataProviderAddedToDPFilesViewModel",n)},cs:function(n){this.d.n(n,!0);this.by(this.d);this.eC("DataProviderRemovedFromDPFilesViewModel",n)},bm:function(n){this.bs=n;if(this.d){var t=this;this.d.p(function(i){var r=i;r.e()&&r.bb(n,function(n){t.cs(n)})})}},b:function(){this.j=_a.d.b(_a.a.c,"AttachmentsFilePickerGetDataProviders");this.n();var n=new _at.n(2);n.d(this.bz);n.e(this.bc);this.M.a(n)},cq:function(){if(!this.d){_j.e.b(_a.a.c,"Failed to ReloadFirstPrimaryDataProvider since AttachmentDataProviders is still null");return}this.n();for(var n,t=0;t<this.d.x.length;t++){n=this.d.x[t];if(n.a.a()===1){this.c===n?this.bq(n,null):this.G(n);break}}},t:function(n,t,i,r){this.bn(n,t,t,r,!1,i)},x:function(n){if(!this.g){_j.e.b(_a.a.c,"CurrentFolder is null when ReExpandCurrentFolderWithSortColumn");return}var t=new _gg.K;t.SortColumn=n;t.SortOrder=this.l.R(n);this.bn(this.g,!0,!0,null,!0,t);this.bV(n,t.SortOrder)},co:function(){this.n();this.bn(this.g,!1,!0,null,!0,this.bh)},bV:function(n,t){var r=_a.d.b(_a.a.c,"AttachmentsFilePickerSort");var i=new _a.o;i.a("C",n);i.a("O",t);r.j=i.toString();_a.d.a(r)},bn:function(n,t,i,r,u,f){if(n===this.p){this.bQ();return}if(f)this.l&&this.l.t(f.SortColumn,f.SortOrder);else{f=new _gg.K;f.SortColumn=_am.a.b;f.SortOrder=_am.a.c}if(t){this.n();this.Y(n);this.bh=f}var s=new _ao.i(n,n.d,f,n.c,n.b,r,u,this.N);var h=this;var e=_h.c.b(s,_h.h.a(),function(n){return new _ao.h(n)});i&&this.ba(e);var o=50;e.bs&&e.bs.x.length>0&&(o=e.bs.x.length);e.n(new _h.n(0,o),null,null,null);i&&this.bw()},bQ:function(){this.Y(this.p);this.ba(this.T);this.bx();if(this.f){this.y("AttachmentsFilePickerGetGroups");this.f.bg();this.Z(!0)}},cp:function(){if(this.f){this.y("AttachmentsFilePickerGetRecentItems");this.f.bg();this.Z(!0)}},cm:function(){this.j=_a.d.b(_a.a.c,"AttachmentsFilePickerGetDataProvidersPreload");var n=new _at.n(2);n.d(this.bA);n.e(this.bc);this.M.a(n)},cD:function(n){if(!this.p||!this.T){this.p=new _ao.a("AttachmentsDataProvider_Groups","",_ufp.A.BO,null,null,n);this.p.a=!0;this.T=new _ao.e(new(_h.ds.$$(_ao.e))(this.p))}},y:function(n){n||(n="AttachmentsFilePickerChangeFolder");if(this.k){var t=this.k;t.k="Abandoned";t.j=this.E();_a.d.a(this.k);this.k=null}this.k=_a.d.b(_a.a.c,n)},n:function(){this.e.f()},ci:function(n){this.G(n);this.n();this.bq(n,null);this.bx()},bq:function(n,t){if(n)if(t)this.t(new _ao.a(n.a.bj.Id,"",t.DisplayName,t,null,n.a),!1,n.t());else{this.y("AttachmentsFilePickerLoadRootFolder");var i=n.c()?n.c().DisplayName:n.a.bj.DisplayName;this.t(new _ao.a(n.a.bj.Id,"",i,n.c(),null,n.a),!0,n.t())}},cE:function(){if(this.g){if(this.o!==this.g||!this.i.x.length||this.i.x[this.i.x.length-1]!==this.g){var n=this.i.l(this.g);if(n>=0&&n<this.i.x.length-1)this.i.s(n+1,this.i.x.length-(n+1));else if(this.g.a||this.c&&this.g.Id===this.c.a.bj.Id){this.i.f();this.i.a(this.g)}else this.i.a(this.g);this.bN(this.g)}}else this.i.f()},cc:function(n){return n.a.bj.IsThirdPartyProvider||_am.r.isInstanceOfType(n)},by:function(n){var r=new _j.k;var t=new _j.k;var i=this;n.p(function(n){var u=n;i.cc(u)?t=i.bT(t,u):r.a(u)});this.cx(r);this.cy(t)},bT:function(n,t){for(var i=0;i<n.x.length;i++){var r=n.x[i];if(r.a.bj.DisplayName.localeCompare(t.a.bj.DisplayName)>0){n.t(i,t);return n}}n.a(t);return n},ce:function(n,t){this.Z(this.f.bC);if(!this.v&&this.k){this.k.j=this.E();_a.d.a(this.k);this.k=null;this.c&&this.c.f(this.f.by)}},bX:function(n){if(this.f.bK){var u,r;var t=this.f.cb;switch(t.g){case 2:u=_ufp.A.H;r="AccessDenied";break;case 4:u=_ufp.A.B;r="NotFound";break;default:u=_ufp.A.C;r=_at.k.c(t);break}if(t.g===2&&n.e()){var f=this;this.W=function(t){if(t===n){f.bM(f.W);f.cn(n)}};this.m(this.W);n.D.a()}this.q(u);if(this.k){var i=this.k;i.k=t.N();i.m=r;i.l=t.M();i.j=this.E();_a.d.a(i);this.k=null}}},bR:function(n){var l=n;var c=l.c;if(c.length<=0)(!this.d||this.d.x.length<=0)&&!this.bk.a().cg().Enabled&&this.q(this.bl());else{for(var o=new _j.k,s=new _at.F,h=c,a=h.length,u=0;u<a;++u){var i=h[u];var r=!1;if(this.d)for(var e=0;e<this.d.x.length;e++){var f=this.d.x[e];if(f.a.bj.Id===i.bj.Id){f.bg(i);o.a(f);r=!0;break}}var t=null;if(!r){t=this.bi.a(i,this.be);t&&o.a(t)}(t||r)&&s.b(i.a(),!0)}this.ct(o);this.s.g(s);this.d.w(this.c)||this.G(null)}if(this.j){this.j.l=l.M();this.j.j=this.E();_a.d.a(this.j);this.j=null}this.eD("OnDataProvidersLoadedEvent",this,null)},bZ:function(n){this.bR(n)},ca:function(n){this.bR(n);if(this.d&&this.bv)for(var t,r=0;r<this.d.x.length;r++){t=this.d.x[r];if(t.n()){for(var u=t.l(),i=0;i<u.d.length;i++)this.bq(t,u.d[i]);break}}},bY:function(n){this.G(null);this.q(this.bl());if(this.j){this.j.k=n?n.N():null;this.j.l=n?n.M():null;this.j.j=this.E();_a.d.a(this.j);this.j=null}this.eD("OnDataProvidersLoadedEvent",this,null)},bw:function(){if(this.v){this.q(null);return}this.f&&(this.f.bs&&this.f.bs.x.length?this.q(null):this.F||this.q(_ufp.A.n))},bU:function(){return this.g&&this.g.Id==="AttachmentsDataProvider_Groups"?!0:!!this.c&&!!this.c.c()&&this.c.c().__type===_gg.F._dataContractName&&this.c.c().Type===3&&this.i.x.length===1},E:function(){var n=new _a.o;n.a("W",this.bp?1:0);return n.toString()},bL:function(n,t){var u=!1,r=!1;if(this.e)for(var i=0;i<this.e.x.length;i++){var f=this.e.x[i];this.bK(f)||(u=!0);this.cb(f)&&(r=!0);if(u&&r)break}this.cv(u);this.bo=r;this.et("SelectedAttachmentsChanged")},bK:function(n){return!n.a()||_gg.v.isInstanceOfType(n)},cb:function(n){return this.bK(n)&&_j.i.a(_a.bh.a(n.bj.Name))},bx:function(){this.g&&this.g.Id==="AttachmentsDataProvider_Groups"?this.bP(!0):this.c&&this.bP(this.c.o());_j.e.a(_a.a.c,"ShouldShowSizeHeader = {0}",this.r);this.g&&this.g.Id==="AttachmentsDataProvider_Groups"?this.bu(!1):this.c?this.bu(this.c.h()):this.bu(!1);_j.e.a(_a.a.c,"IsSortingSupported = {0}",this.h);this.c&&this.cF()},cF:function(){var n=this.bJ();if(n){this.cz(n.z());this.cC(n.C());this.cB(n.B());this.cA(n.A())}},cG:function(){_j.e.a(_a.a.c,"UpdateSortingCommands with IsSortingSupported={0}",this.h);this.C.c(this.h);this.D.c(this.h);this.A.c(this.h);this.O.c(this.h);this.Q.c(this.h);this.P.c(this.h)},cn:function(n){if(this.L){var u=n.a.a();var t=this.L.y(u);if(t&&t.j()){var r=n.p.p();var f=this;var i=function(n,i){n&&t.i.a()};this.bj.a(_a.v,new _a.v([_j.i.c(_ufp.A.BD,r)],0,i,1,!1,null,null,_ufp.A.D,this.bs,null))}}},cg:function(){this.x(0)},cf:function(){this.x(2)},ck:function(){this.x(1)},cd:function(){this.x(3)},cl:function(){this.x(4)},ch:function(){this.x(5)},bJ:function(){return this.c?this.s.c(this.c.a.a()):null},cj:function(n,t){this.bt(this.c.q);this.co()}};_am.e=function(n,t){_am.e.initializeBase(this);this.a=n;this.j(this.g());this.f=t};_am.e.prototype={a:null,d:null,b:null,f:null,n:function(n){if(this.a!==n){this.a=n;this.j(this.g());this.d&&this.e(this.h());this.et("DataProviderModel")}return n},j:function(n){if(this.b===n)return n;this.b=n;this.ex("DataProviderPivots","DataProviderPivotsArray");return n},k:function(){return this.b.d()},e:function(n){if(this.d&&n&&this.d.b===n.b&&this.d.c===n.c)return n;this.d=n;this.d&&this.f&&this.f(this);this.ex("SelectedPivot","SelectedPivotIndex");return n},l:function(){return!this.b||!this.a?-1:!this.d&&this.a?this.i():this.b.l(this.d)},o:function(n){this.e(this.b.x[n]);return n},h:function(){return this.b?this.m():null},c:function(){return this.b?this.d.a:null},g:function(){var t=this.a.b();if(!t||!t.b())return null;for(var r=new _j.k,n=0;n<t.b();n++){var i=t.a(n);if(i&&i.Type!==4){var f=String.format("{0} {1}",this.a.bj.DisplayName,this.a.b().a(n).AriaLabel);var u=String.format(_ufp.A.BN,f);r.a(new _ff.f(t.a(n).DisplayName,t.a(n),u))}}return r},m:function(){if(!this.a.a())for(var t=this.a.b().a(this.i()),n=0;n<this.b.x.length&&t;n++)if(this.b.x[n].b===t.DisplayName)return this.b.x[n];return this.b.x[this.a.bj.DefaultScopeIndex]},i:function(){if(!this.a.a())for(var n=0;n<this.a.b().b();n++)if(!this.a.b().a(n).Type)return n;return this.a.bj.DefaultScopeIndex}};_am.o=function(n,t){this.a=n;this.b=t};_am.o.prototype={a:null,b:0};_am.C=function(n,t,i,r,u,f){_am.C.initializeBase(this,[n,t,i,r,u,f])};_am.C.a=function(){return _fm.e.a("box.png")};_am.C.prototype={g:function(){return _am.C.a()},i:function(){return!0},e:function(){return!0},j:function(){return!1},f:function(n){this.r("AttachmentsFilePickerMyFiles",n)},n:function(){return!1},l:function(){return new _j.q},o:function(){return!0},h:function(){return!0},k:function(){return"Files"}};_am.a=function(n,t,i,r,u,f){this.K=Function.createDelegate(this,this.bc);this.L=Function.createDelegate(this,this.bd);this.M=Function.createDelegate(this,this.be);_am.a.initializeBase(this);this.a=n;this.F=i;this.U(this.G());this.E=t;this.p=_at.j.a(this.a.a());this.I=r;this.w=u;this.J=!!u&&u.a().I().Enabled&&!!f&&f.e().b("15.01.0484.000");this.D=new _j.g(this.M,_a.a.c);this.q=0;this.s=1;this.J&&this.bk()};_am.a.prototype={z:!1,a:null,d:null,b:null,E:null,D:null,A:null,I:null,F:null,w:null,C:null,J:!1,m:null,s:0,q:0,Z:function(){return!_am.a.a&&!!this.m},j:function(){return!0},x:function(){return 0},y:function(){return!1},t:function(){var n=new _gg.K;n.SortColumn=_am.a.b;n.SortOrder=_am.a.c;return n},e:function(){return!1},p:null,V:function(n){if(this.z!==n){this.z=n;this.et("IsSelected")}return n},bg:function(n){if(this.a!==n){this.a=n;this.U(this.G());this.d&&this.v(this.O());this.et("DataProviderModel")}return n},U:function(n){if(this.b===n)return n;this.b=n;this.ex("DataProviderPivots","DataProviderPivotsArray");return n},X:function(){return this.b.d()},v:function(n){if(this.d&&n&&this.d.b===n.b&&this.d.c===n.c)return n;this.d=n;this.d&&this.E&&this.E(this);this.ex("SelectedPivot","SelectedPivotIndex");return n},Y:function(){return!this.b||!this.a?-1:!this.d&&this.a?this.Q():this.b.l(this.d)},bi:function(n){this.v(this.b.x[n]);return n},O:function(){return this.b?this.ba():null},c:function(){return this.b?this.d.a:null},T:function(n){if(this.q!==n){this.q=n;this.et("AttachmentItemsFilterBy")}return n},bh:function(n){if(this.m!==n){this.m=n;this.ex("ShouldShowItemsFilterByContextMenu","ItemsFilterByContextMenu")}return n},bb:function(n,t){this.C=n;this.A=t},bf:function(){_am.a.a?this.T(1):this.W(1,0,!0);return this.q},bd:function(n){var t=n;if(t.c&&this.A){this.N("RemoveAttachmentDataProviderSuccessful");this.A(this)}else this.S()},S:function(){this.N("RemoveAttachmentDataProviderFailed");this.bj()},R:function(){return null},r:function(n,t){var r=_a.d.b(_a.a.c,n);var i=new _a.o;i.a("N",t);i.b("DP",this.P());r.j=i.toString();_a.d.a(r)},N:function(n){var i=_a.d.b(_a.a.c,n);var t=new _a.o;t.b("DP",this.P());i.j=t.toString();_a.d.a(i)},bj:function(){!this.C;var n=this.p.p();this.I.a(_a.v,new _a.v([_j.i.c(_ufp.A.j,n)],0,null,0,!1,null,null,_ufp.A.r,this.C,null))},be:function(){var n=new _ao.n(this.a.bj.Id);n.d(this.L);var t=this;n.e(function(n){t.S()});this.F.a(n)},P:function(){return this.a?_g.p.toString(this.a.a()):"Unknown"},G:function(){var t=this.a.b();if(!t||!t.b())return null;for(var i=new _j.k,n=0;n<t.b();n++){var u=_j.i.c("{0} {1}",this.a.bj.DisplayName,this.a.b().a(n).AriaLabel);var r=_j.i.c(_ufp.A.BN,u);i.a(new _ff.f(t.a(n).DisplayName,t.a(n),r))}return i},ba:function(){if(!this.a.a())for(var t=this.a.b().a(this.Q()),n=0;n<this.b.x.length&&t;n++)if(this.b.x[n].b===t.DisplayName)return this.b.x[n];return this.b.x[this.a.bj.DefaultScopeIndex]},Q:function(){if(!this.a.a())for(var n=0;n<this.a.b().b();n++)if(!this.a.b().a(n).Type)return n;return this.a.bj.DefaultScopeIndex},bk:function(){var t=this.R();if(t){var i=new _fm.f(new Array(0));i.p.a(new _fm.n(_ufp.A.V));for(var n=0;n<t.length;n++){var r=t[n].b;i.p.a(new _am.H(t[n].a,n+1,r,!n,this.K))}this.bh(i)}},bc:function(n,t){this.W(n,t,!1)},W:function(n,t,i){if(this.s!==n){var u=this.m.p.x[this.s];u.k(!1);this.s=n;if(i){var r=this.m.p.x[this.s];r.k(!0)}}this.T(t)}};_am.u=function(n,t,i,r){this.b=n;this.d=t;this.e=i;this.c=r};_am.u.prototype={b:null,d:null,e:null,c:null,a:function(n,t){var i=n.a();switch(i){case 0:return new _am.L(n,t,this.b,this.d,this.e,this.c);case 1:return new _am.J(n,t,this.b,this.d,this.e,this.c);case 2:return new _am.D(n,t,this.b,this.d,this.e,this.c);case 3:return new _am.C(n,t,this.b,this.d,this.e,this.c);case 5:return new _am.F(n,t,this.b,this.d,this.e,this.c);case 4:return new _am.r(n,t,this.b,this.d,this.e,this.c);case 6:return new _am.E(n,t,this.b,this.d,this.e,this.c)}_j.e.b(_am.u.a,String.format("This data provider is not a defined AttachmentDataProviderType in the client code. Provider type = {0}",i));return null}};_am.D=function(n,t,i,r,u,f){_am.D.initializeBase(this,[n,t,i,r,u,f])};_am.D.a=function(){return _fm.e.a("dropbox.png")};_am.D.prototype={g:function(){return _am.D.a()},i:function(){return!0},e:function(){return!0},j:function(){return!1},f:function(n){this.r("AttachmentsFilePickerMyFiles",n)},n:function(){return!1},l:function(){return new _j.q},o:function(){return!0},h:function(){return!0},k:function(){return"My files"}};_am.E=function(n,t,i,r,u,f){_am.E.initializeBase(this,[n,t,i,r,u,f])};_am.E.a=function(){return _fm.e.a("facebook.png")};_am.E.prototype={g:function(){return _am.E.a()},i:function(){return!1},e:function(){return!0},x:function(){return 2},y:function(){return!0},f:function(n){this.r("AttachmentsFilePickerMyFiles",n)},n:function(){return!1},l:function(){return new _j.q},o:function(){return!1},h:function(){return!1},k:function(){return"Photos"},j:function(){return!!this.b}};_am.F=function(n,t,i,r,u,f){_am.F.initializeBase(this,[n,t,i,r,u,f])};_am.F.a=function(){return _fm.e.a("gdrive.png")};_am.F.prototype={g:function(){return _am.F.a()},i:function(){return!0},e:function(){return!0},j:function(){return!1},f:function(n){this.r("AttachmentsFilePickerMyFiles",n)},n:function(){return!1},l:function(){return new _j.q},o:function(){return!0},h:function(){return!0},k:function(){return"Files"}};_am.r=function(n,t,i,r,u,f){_am.r.initializeBase(this,[n,t,i,r,u,f])};_am.r.a=function(){return _fm.e.a("recent-attachments_32x32.png")};_am.r.prototype={g:function(){return _am.r.a()},i:function(){return!1},e:function(){return!1},x:function(){return 1},f:function(n){this.r("AttachmentsFilePickerMyFiles",n)},n:function(){return!1},l:function(){return new _j.q},o:function(){return!0},h:function(){return!0},k:function(){return"Files"},j:function(){return!1},t:function(){var n=new _gg.K;n.SortColumn=5;n.SortOrder=1;return n},R:function(){var n=new Array(5);n[0]=new _am.o(_ufp.A.W,0);n[1]=new _am.o(_ufp.A.v,2);n[2]=new _am.o(_ufp.A.I,3);n[3]=new _am.o(_ufp.A.BX,4);n[4]=new _am.o(_ufp.A.BS,5);return n}};_am.J=function(n,t,i,r,u,f){_am.J.initializeBase(this,[n,t,i,r,u,f])};_am.J.prototype={e:function(){return!!this.w&&!this.w.a().b().Enabled},h:function(){return!1},j:function(){return!1},y:function(){return!0}};_am.K=function(n,t,i,r,u,f){_am.K.initializeBase(this,[n,t,i,r,u,f])};_am.K.prototype={g:function(){return _fm.a.S},i:function(){return!0},f:function(n){var i=this.c().Type;var t=null;i?i===4?t="AttachmentsFilePickerRecentFiles":i===1&&(t="AttachmentsFilePickerSharedWithMeFiles"):t="AttachmentsFilePickerMyFiles";_j.i.a(t)||this.r(t,n)},n:function(){return!0},l:function(){var i=new _j.q;var t=this.a.b().a(this.a.bj.DefaultScopeIndex);t.Type!==4&&i.c(t);if(t.Type)for(var n=0;n<this.a.b().b();n++){var r=this.a.b().a(n);if(!r.Type){i.c(r);break}}return i},o:function(){return!!this.c()&&this.c().__type===_gg.F._dataContractName&&!this.c().Type},h:function(){return!0},k:function(){var n=this.c().Type;switch(n){case 0:return"My files";case 4:return"Recent";case 1:return"Shared with me";case 3:return"Group files"}return"Unknown"},G:function(){var t=this.a.b();if(!t||!t.b())return null;for(var i=new _j.k,n=0;n<t.b();n++)if(t.a(n).Type!==4){var u=_j.i.c("{0} {1}",this.a.bj.DisplayName,this.a.b().a(n).AriaLabel);var r=_j.i.c(_ufp.A.BN,u);i.a(new _ff.f(t.a(n).DisplayName,t.a(n),r))}return i}};_am.L=function(n,t,i,r,u,f){_am.L.initializeBase(this,[n,t,i,r,u,f])};_am.A.registerClass("_am.A",_a.bB,_fm.m);_am.H.registerClass("_am.H",_fm.h);_am.d.registerClass("_am.d",_at.B);_am.B.registerClass("_am.B",null,IAttachmentProviderItemViewModelFactory);_am.j.registerClass("_am.j",_y.hO);_am.k.registerClass("_am.k",_y.hO);_am.b.registerClass("_am.b",_a.bB,IAttachmentsFilePickerPanelViewModel,_bc.j,_bc.o,_bc.r,_a.iN,_j.bq,Sys.IDisposable,_y.bf);_am.f.registerClass("_am.f",_am.b,_y.z,_bc.r,_a.iN,_j.bq,Sys.IDisposable,_y.dw);_am.c.registerClass("_am.c",_a.bB,IAttachmentsFilePickerPanelViewModel,_bc.j,_bc.o,_bc.r,_a.iN,_j.bq,Sys.IDisposable,_y.bf);_am.i.registerClass("_am.i",_am.c,_y.z,_bc.r,_a.iN,_j.bq,Sys.IDisposable,_y.dw);_am.l.registerClass("_am.l");AttachmentsFilePickerViewModelsComponent.registerClass("AttachmentsFilePickerViewModelsComponent",null,_a.ib,_j.ce);_am.g.registerClass("_am.g",_y.hO,_bc.j,_bc.o,_bc.r,_a.iN,_j.bq,Sys.IDisposable);_am.h.registerClass("_am.h",_a.bB);_am.t.registerClass("_am.t",_am.h);_am.m.registerClass("_am.m",_j.k);_am.v.registerClass("_am.v",_am.h);_am.w.registerClass("_am.w",_am.h);_am.x.registerClass("_am.x",_am.h);_am.I.registerClass("_am.I",_am.h);_am.p.registerClass("_am.p",_a.iX);_am.q.registerClass("_am.q",_a.iX);_am.s.registerClass("_am.s",_a.bB,_am.y,_a.iN,_j.bq,Sys.IDisposable);_am.n.registerClass("_am.n",_a.bB,_am.y,_a.iN,_j.bq,Sys.IDisposable);_am.e.registerClass("_am.e",_a.bB);_am.a.registerClass("_am.a",_a.bB);_am.C.registerClass("_am.C",_am.a);_am.D.registerClass("_am.D",_am.a);_am.E.registerClass("_am.E",_am.a);_am.F.registerClass("_am.F",_am.a);_am.r.registerClass("_am.r",_am.a);_am.K.registerClass("_am.K",_am.a);_am.J.registerClass("_am.J",_am.K);_am.L.registerClass("_am.L",_am.K);_am.d.a=_a.a.c;AttachmentsFilePickerViewModelsComponent.a=null;AttachmentsFilePickerViewModelsComponent.$$cctor();_am.a.b=2;_am.a.c=1;_am.a.a=!1;_am.u.a=_a.a.c;
window.scriptsLoaded['microsoft.owa.attachments.filepicker.viewmodels.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.attachments.filepicker.viewmodels.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
