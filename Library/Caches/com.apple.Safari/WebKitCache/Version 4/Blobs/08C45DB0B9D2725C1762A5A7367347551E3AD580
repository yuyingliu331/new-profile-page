try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.controls.richtexteditor.js'] = (new Date()).getTime();
Type.registerNamespace("_zy");_zy.e=function(n){this.a=n};_zy.e.prototype={a:null,b:function(){var i=getCookie("AppcacheVer");var n=null;var t=!1;if(i&&(n=i.split(":")).length===2&&this.a!==n[0]){this.a=n[0];t=!0}_j.e.b(_a.a.p,"Current RTE script version: {0}",this.a);return t}};_zy.b=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this.mw=Function.createDelegate(this,this.qh);this.mx=Function.createDelegate(this,this.qi);this.my=Function.createDelegate(this,this.qk);this.nj=Function.createDelegate(this,this.ql);this.nk=Function.createDelegate(this,this.qs);this.nl=Function.createDelegate(this,this.nN);this.np=Function.createDelegate(this,this.rg);this.ms=Function.createDelegate(this,this.pR);this.mv=Function.createDelegate(this,this.nJ);this.mr=Function.createDelegate(this,this.ny);this.mu=Function.createDelegate(this,this.qe);this.mq=Function.createDelegate(this,this.oJ);this.la=Function.createDelegate(this,this.qp);this.kZ=Function.createDelegate(this,this.qo);this.kY=Function.createDelegate(this,this.qn);this.kX=Function.createDelegate(this,this.qm);this.kW=Function.createDelegate(this,this.qj);this.lb=Function.createDelegate(this,this.qr);this.kT=Function.createDelegate(this,this.nt);this.mt=Function.createDelegate(this,this.pV);this.kU=Function.createDelegate(this,this.nu);this.kV=Function.createDelegate(this,this.nG);this.no=Function.createDelegate(this,this.rb);this.nm=Function.createDelegate(this,this.qZ);this.nn=Function.createDelegate(this,this.ra);this.iV=-1;_zy.b.initializeBase(this,[n,o,e,s,v,y,p,l,w]);this.lt=i.a();this.cz=t;this.ln=r;this.nq=u;this.lk=f;this.hM=-1;this.hR=h;this.fr=c;this.gy=t.r()&&a.a();this.cM(!0)};_zy.b.e=function(n){if(n){var i=n.rangeCount;if(i===1)return n.getRangeAt(0)}return null};_zy.b.prototype={nW:null,ns:null,iU:null,jq:null,iQ:null,hv:null,ci:null,gv:"",hB:"",ju:!0,hC:null,iO:null,jk:null,jB:null,iP:null,jn:null,iY:null,iT:null,iS:null,iL:null,iK:null,iM:null,jz:null,jy:null,jx:null,jl:null,jr:null,jA:null,jp:null,jm:null,iN:null,jC:null,jv:null,lf:null,cp:null,dk:null,jo:null,eM:null,eN:null,bR:null,cP:null,hN:null,hD:!1,ls:!1,je:!1,lr:!1,hG:!1,hJ:!1,hE:!1,hH:!1,jb:!1,ja:!1,jc:!1,jj:!1,ji:!1,jh:!1,jf:!1,jg:!1,le:!1,nw:!1,hu:!1,hA:!1,ht:!1,nZ:!1,gx:!1,iR:!1,jd:!1,eK:null,jt:null,js:null,dC:null,lt:null,hQ:null,dD:null,ln:null,nq:null,lk:null,cz:null,hM:0,hP:null,eJ:null,hI:!1,gz:null,hK:null,hL:null,hR:null,hO:!1,fr:null,eO:null,gy:!1,iZ:!1,gw:!1,oY:function(){if(!this.iO){var n=this;this.iO=new _j.g(function(){n.ex(null)},this.F())}return this.iO},pf:function(){if(!this.jk){var n=this;this.jk=new _j.g(function(){n.eA(null)},this.F())}return this.jk},pG:function(){if(!this.jB){var n=this;this.jB=new _j.g(function(){n.eI(null)},this.F())}return this.jB},oZ:function(){this.iP||(this.iP=new _j.g(this.hg,this.F()));return this.iP},pk:function(){this.jn||(this.jn=new _j.g(this.hi,this.F()));return this.jn},pe:function(){this.iY||(this.iY=new _j.g(this.fG,this.F()));return this.iY},pb:function(){this.iT||(this.iT=new _j.g(this.hh,this.F()));return this.iT},pa:function(){this.iS||(this.iS=new _j.g(this.kc,this.F()));return this.iS},oV:function(){this.iL||(this.iL=new _j.g(this.iq,this.F()));return this.iL},oU:function(){this.iK||(this.iK=new _j.g(this.ip,this.F()));return this.iK},oW:function(){this.iM||(this.iM=new _j.g(this.ir,this.F()));return this.iM},pF:function(){this.jz||(this.jz=new _j.g(this.kE,this.F()));return this.jz},pE:function(){this.jy||(this.jy=new _j.g(this.kg,this.F()));return this.jy},pD:function(){this.jx||(this.jx=new _j.g(this.kf,this.F()));return this.jx},pg:function(){this.jl||(this.jl=new _j.g(this.kd,this.F()));return this.jl},pm:function(){this.jr||(this.jr=new _j.g(this.ke,this.F()));return this.jr},pH:function(){if(!this.jA){var n=this;this.jA=new _j.g(function(){n.cN(null)},this.F())}return this.jA},pl:function(){if(!this.jp){var n=this;this.jp=new _j.g(function(){n.de(null)},this.F())}return this.jp},ph:function(){this.jm||(this.jm=new _j.g(this.nn,this.F()));return this.jm},oX:function(){this.iN||(this.iN=new _j.g(this.nm,this.F()));return this.iN},pI:function(){this.jC||(this.jC=new _j.g(this.kF,this.F()));return this.jC},pC:function(){this.jv||(this.jv=new _j.g(this.no,this.F()));return this.jv},qF:function(n){if(this.iV!==n){this.iV=n;this.bq("FormatBarTabIndex")}return n},hx:function(){return this.ev(_zy.b.d)},qE:function(n){this.eu(_zy.b.d,n);return n},hw:function(){return this.ev(_zy.b.b)},qy:function(n){this.eu(_zy.b.b,n);return n},qS:function(n){this.dB(n,null);return n},qT:function(n){this.fm(n,null);return n},qC:function(n){this.eF(n,null);return n},qD:function(n){this.eH(n,null);return n},pd:function(){if(!this.ci){this.ci=new _j.k;this.ci.a("8");this.ci.a("9");this.ci.a("10");this.ci.a("11");this.ci.a("12");this.ci.a("14");this.ci.a("16");this.ci.a("18");this.ci.a("20");this.ci.a("22");this.ci.a("24");this.ci.a("26");this.ci.a("28");this.ci.a("36");this.ci.a("48");this.ci.a("72")}return this.ci},pc:function(){if(!this.hv){this.hv=new _j.k;for(var n=0;n<_cmc.a.a.length;++n)this.hv.a(_cmc.a.a[n][0])}return this.hv},hy:function(){if(!this.hN){var n=this.bZ();try{this.hN=n?n.contentWindow:null}catch(t){_j.e.c(this.F(),"RTEWindow: Got exception - {0}",t.message)}}return this.hN},nP:function(n){if(n!==this.hD){this.hD=n;this.bt("IsBoldApplied","DefaultFontFlags")}return n},nV:function(n){if(n!==this.ls){this.ls=n;this.bq("ShowBusy")}return n},nR:function(n){if(n!==this.je){this.je=n;this.bq("IsFormatBarHidden")}return n},nS:function(n){if(n!==this.hG){this.hG=n;this.bt("IsItalicApplied","DefaultFontFlags")}return n},nU:function(n){if(n!==this.hJ){this.hJ=n;this.bt("IsUnderlineApplied","DefaultFontFlags")}return n},nQ:function(n){if(n!==this.hE){this.hE=n;this.bq("IsBulletApplied")}return n},nT:function(n){if(n!==this.hH){this.hH=n;this.bq("IsNumberApplied")}return n},qK:function(n){if(n!==this.jb){this.jb=n;this.bq("IsAlignLeftApplied")}return n},qJ:function(n){if(n!==this.ja){this.ja=n;this.bq("IsAlignCenterApplied")}return n},qL:function(n){if(n!==this.jc){this.jc=n;this.bq("IsAlignRightApplied")}return n},qR:function(n){if(n!==this.jj){this.jj=n;this.bq("IsSuperscriptApplied")}return n},qQ:function(n){if(n!==this.ji){this.ji=n;this.bq("IsSubscriptApplied")}return n},qP:function(n){if(n!==this.jh){this.jh=n;this.bq("IsStrikeThroughApplied")}return n},qN:function(n){if(n!==this.jf){this.jf=n;this.bq("IsLeftToRightApplied")}return n},qO:function(n){if(n!==this.jg){this.jg=n;this.bq("IsRightToLeftApplied")}return n},qB:function(n){if(n!==this.hu){this.hu=n;this.bq("CanUndo")}return n},qG:function(n){if(n!==this.hA){this.hA=n;this.bq("ImageSelected")}return n},qA:function(n){if(n!==this.ht){this.ht=n;this.bq("CanRedo")}return n},bX:function(n){if(this.gx!==n){this.gx=n;this.gx||this.bo(!1);this.bq("IsMoreButtonsPopUpShown")}return n},qM:function(n){if(this.jd!==n){this.jd=n;this.bq("IsCultureRtl")}return n},qz:function(n){if(this.iR!==n){this.iR=n;this.bq("CanEditTable")}return n},lo:function(n){if(this.gv!==n){this.gv=n;this.bq("InsertLinkDialogUrl")}return n},nO:function(n){if(this.hB!==n){this.hB=n;this.bq("InsertAltTextDialogText")}return n},dl:function(){return this.ev(_zy.b.g)},qI:function(n){this.eu(_zy.b.g,n);return n},dv:function(){return this.ev(_zy.b.f)},qH:function(n){this.eu(_zy.b.f,n);return n},nA:function(){var i="";if(this.eL()){_j.e.a(this.F(),"RteHtml: Get html");var o=_j.m.a(this.F(),2,"SRTE.Get_RteHtml");var h=this.bZ();var e=this.hy().document.body;var f=new _cmc.H(this,e);this.ih(f);var s=this.bv().find("span[id^='OWAZWSPSpan']");s.contents().unwrap();this.gE()&&this.qv();var n="";if(this.lg()){n=this.x().GetEditableRegionHtml(this.bv().get(0),!1);_j.e.a(this.F(),"Get RteHtml: get HTML from the engine. ")}else{n=this.bv()[0].innerHTML;_j.e.a(this.F(),"Get RteHtml: fall back to get mail content directly. ")}this.bk.l()&&(n=n.replace(_zz.i.a,"$1$4"));var u=!1;var r=this.bv()[0];if(!!(!!r.children&r.children.length>0)){var t=r.children[0];t.tagName&&t.tagName.toLowerCase()==="div"&&t.id&&t.id.toLowerCase()==="divtagdefaultwrapper"&&(u=!0)}u||(n=String.format('<div id="{0}" style="{1}">{2}</div>',"divtagdefaultwrapper",this.iW().e(),n));i=String.format('<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">{0}</head><body {1}>{2}</body></html>','<style type="text/css" style="display:none;"><!-- P {margin-top:0;margin-bottom:0;} --></style>',this.nz(),n);this.jS(f);this.gE()&&this.nr();h=null;_j.m.b(o)}_j.e.a(this.F(),"RteHtml: Get html, length of html = {0}",i.length);return i},lp:function(n){if(this.eL()){var c=_j.m.a(this.F(),2,"SRTE.Set_RteHtml");_j.e.a(this.F(),"RteHtml: Set html, length = {0}",n?n.length:0);var l=this.iX();var r=this.bv();var h=this.bU();var t;var o;this.nL(n,o={val:t}),t=o.val;r.empty();if(t){var f=t.contents();if(f&&f.length>0){var i=t.attr("style");var u=t.attr("dir");var s=r.attr("style");if((!u||_j.i.b(u))&&(!i||_j.i.b(i))||u===h.attr("dir")&&this.nH(i,s))r.append(f);else{_j.e.a(this.F(),"Set RteHtml: add body container to carry assigned content style and direction");var e=$("<div />");u&&e.attr("dir",u);i&&e.attr("style",i);e.append(f);r.append(e)}}}else{_j.e.a(this.F(),"AppendContent: Append whole content since cannot extract body section from the content");r.append(n)}this.gO(new _cmc.G(this,this.be()));_j.m.b(c)}return n},iW:function(){this.hC||(this.hC=new _cmc.y(null));return this.hC},gF:function(){this.dN();var n=new _zz.bw;n.b=1;n.e=this.cf();return n},pi:function(){return this.eN.L().offset().left},pj:function(){return this.eN.L().offset().top+this.eN.L().outerHeight()+1},ib:function(){return this.ln},nz:function(){var n="ltr";this.cz.i()&&(n="rtl");return'dir="'+n+'"'},bv:function(){if(this.da()){var i=this.bZ();var t=$(i.contentWindow.document.body);return t.children("#MicrosoftOWAEditorRegion")}else return null},da:function(){var t=!1;try{var n=this.bZ();n&&n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.body&&n.contentWindow.document.documentElement&&(t=!0)}catch(i){_j.e.b(this.F(),"Error accessing iframe: {0}, Callstack: {1}",i.message,i.stack)}return t},eL:function(){var n=this.bv();return!!n&&n.length===1},ld:!1,gE:function(){return this.ld},im:function(n){this.ld=n;return n},lc:!1,gi:function(){return this.lc},gn:function(n){this.lc=n;return n},cT:function(){return!1},cX:function(n){return n},bg:function(){return"SRTE"},ma:function(){this.dE()},mb:function(n){this.lm(n)},ml:function(n){var t=this.x();if(null!==t){t.MoveCursorMarkersToNode(n);this.dE()}},jP:function(n){if(this.bk.a()){var t=this.hy();if(t)return t.clipboardData;else{_j.e.d(this.F(),Error.format("GetClipboardData: Null iframe window instance"),"Iframe window instance should not be null in GetClipboardData");return null}}else return _zz.p.prototype.jP.call(this,n)},bM:function(){return _zz.p.prototype.bM.call(this)},cc:function(n){if(this.bM()!==n){_zz.p.prototype.cc.call(this,n);this.bc&&this.fg()}return n},bo:function(n){_j.e.a(this.F(),"Focus: Focus in RTE");if(this.ca()&&!this.dd()){this.oS(n);this.qF(-1)}},eQ:function(){},fJ:function(n,t){var u=0;var f=0;var i=this.bZ();if(i){var r=i.getBoundingClientRect();u=r.top;f=r.left}n.val=u;t.val=f},oM:function(){this.cx().c();this.dp(this.nW);this.dp(this.ns);this.dp(this.iU);this.dp(this.jq);this.dp(this.iQ);this.mc();this.rf();this.re();this.oL();var n=this.bZ();if(n)try{null!==n.contentWindow&&(n.contentWindow.onerror=null);n.src="about:blank"}catch(t){}this.hN=null;this.nv();this.bR&&this.bR.J(!0)},rd:function(){_j.e.a(this.F(),"Initialize: load SRTE.");this.cu&&this.cu.a||(this.cY=new _cmc.d(this.F(),"MailComposeRTEInit",!1));this.cx().k("SRTE");this.bR.J(!1);this.nN();this.pT()},fd:function(n){_j.e.a(this.F(),"ExecuteCall: CallContext type = {0}",Object.getType(n).toString());if(_cmc.K.isInstanceOfType(n))this.me(n);else if(_cmc.s.isInstanceOfType(n)){var t=n;t.a?t.a(this.qc()):this.rc()}else if(_y.cM.isInstanceOfType(n)){var i=n;this.lp(i.a())}else _zz.i.prototype.fd.call(this,n)},gJ:function(n){var u=this.nE();if(n.b==="text"){var t;var r,i;i=_a.y.a(u,r={val:t}),t=r.val,i;n.a=t}else n.a=u},gH:function(n){var u=this.nA();if(n.b==="text"){var t;var r,i;i=_a.y.a(u,r={val:t}),t=r.val,i;n.a=t}else n.a=u},ex:function(n){if(this.bc){this.jw();this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"BoldContent: Bold content");var t=this;this.bd(function(){t.x().Bold()},"Bold",!0,n)}this.bX(!1)}},eA:function(n){if(this.bc){this.jw();this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"ItalicContent: Italic content");var t=this;this.bd(function(){t.x().Italic()},"Italic",!0,n)}this.bX(!1)}},eI:function(n){if(this.bc){this.jw();this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"UnderlineContent: Underline content");this.nV(!0);var t=this;this.bd(function(){t.x().Underline()},"Underline",!0,n);this.nV(!1)}this.bX(!1)}},ey:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"BulletContent: Bullet content");var n=this;this.bd(function(){n.x().BulletedList()},"Bullets",!1,null)}this.bX(!1)}},eE:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"NumberContent: Numbering content");var n=this;this.bd(function(){n.x().NumberedList()},"Numbering",!1,null)}this.bX(!1)}},du:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"IncreaseIndent: Increase indent");var n=this;this.bd(function(){n.x().IncreaseIndent()},"Indent",!1,null)}this.bX(!1)}},dj:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"DecreaseIndent: Decrease indent");var n=this;this.bd(function(){n.x().DecreaseIndent()},"Outdent",!1,null)}this.bX(!1)}},fh:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"ClearFormat: Clear format");var n=this;this.bd(function(){n.x().ClearFormatting()},"ClearFormat",!1,null)}this.bX(!1)}},et:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"AlignLeft: Align left");var n=this;this.bd(function(){n.x().Align(0)},"AlignLeft",!1,null)}this.bX(!1)}},es:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"AlignCenter: Align center");var n=this;this.bd(function(){n.x().Align(2)},"AlignCenter",!1,null)}this.bX(!1)}},ew:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"AlignRight: Align right");var n=this;this.bd(function(){n.x().Align(1)},"AlignRight",!1,null)}this.bX(!1)}},fp:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"Superscript: Super script");var n=this;this.bd(function(){n.x().Superscript()},"Superscript",!0,null)}this.bX(!1)}},fo:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"Subscript: Sub script");var n=this;this.bd(function(){n.x().Subscript()},"Subscript",!0,null)}this.bX(!1)}},fn:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"StrikeThrough: StrikeThrough text");var n=this;this.bd(function(){n.x().StrikeThrough()},"StrikeThrough",!0,null)}this.bX(!1)}},fk:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"LeftToRight: Set left to right");var n=this;this.bd(function(){n.x().SetDirection(!0)},"LeftToRight",!1,null)}this.bX(!1)}},fl:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"RightToLeft: Set right to left");var n=this;this.bd(function(){n.x().SetDirection(!1)},"RightToLeft",!1,null)}this.bX(!1)}},cN:function(n){var t=!1;if(this.bc&&null!==this.x()){_j.e.a(this.F(),"Undo: Undo text");this.bo(!1);t=_zz.p.prototype.cN.call(this,n);if(t){this.bk.a()&&this.ri();this.bw(1);this.bW();this.cx().b("Undo");n&&_zz.bb.a("Undo",n)}}this.bX(!1);return t},de:function(n){var t=!1;if(this.bc&&null!==this.x()){_j.e.a(this.F(),"Redo: Redo text");this.bo(!1);t=_zz.p.prototype.de.call(this,null);if(t){this.bw(1);this.cx().b("Redo");n&&_zz.bb.a("Redo",n)}}this.bX(!1);return t},nG:function(){if(this.bc){this.bo(!1);if(null!==this.x()&&!_j.i.a(this.gv)){var t=_zz.e.k(this.gv);var n=this.nE();_j.e.a(this.F(),"InsertLink: Insert link");var r=this.x().CreateLinkOptions(t,_j.i.b(n)?t:n);var i=this;this.bd(function(){i.x().InsertOrUpdateLink(r)},"ManualLink",!1,null)}this.nu();this.bX(!1)}},fi:function(n){if(this.x()&&!this.le&&!_j.i.b(n)){this.lo(n);this.nG()}},pV:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"InsertAltText: Insert image alt text");var n=this;this.bd(function(){n.x().SetImageAlt(n.hB)},"AddImageAltText",!1,null)}this.nt();this.bX(!1)}},fq:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"UnLink: Remove link");var n=this;this.bd(function(){n.x().RemoveLink()},"RemoveLink",!1,null)}this.bX(!1)}},rb:function(){this.bt("MoreButtonsPopupXPosition","MoreButtonsPopupYPosition");this.bX(!0);this.eM.S()},gp:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableMergeAbove: Table merge above");var n=this;this.bd(function(){n.x().MergeAbove()},"TableMergeAbove",!1,null)}}},gq:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableMergeBelow: Table merge below");var n=this;this.bd(function(){n.x().MergeBellow()},"TableMergeBelow",!1,null)}}},gr:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableMergeLeft: Table merge left");var n=this;this.bd(function(){n.x().MergeLeft()},"TableMergeLeft",!1,null)}}},gs:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableMergeRight: Table merge right");var n=this;this.bd(function(){n.x().MergeRight()},"TableMergeRight",!1,null)}}},fU:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableInsertLeft: Table insert left");var n=this;this.bd(function(){n.x().InsertColumnLeft()},"TableInsertLeft",!1,null)}}},fV:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableInsertRight: Table insert right");var n=this;this.bd(function(){n.x().InsertColumnRight()},"TableInsertRight",!1,null)}}},fS:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableInsertAbove: Table insert above");var n=this;this.bd(function(){n.x().InsertRowAbove()},"TableInsertAbove",!1,null)}}},fT:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableInsertBelow: Table insert below");var n=this;this.bd(function(){n.x().InsertRowBelow()},"TableInsertBelow",!1,null)}}},gt:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableSplitHorizontal: Table split horizontally");var n=this;this.bd(function(){n.x().SplitHorizontal()},"TableSplitHorizontally",!1,null)}}},gu:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableSplitVertical: Table split vertically");var n=this;this.bd(function(){n.x().SplitVertical()},"TableSplitVertically",!1,null)}}},fR:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableDeleteRow: Table delete row");var n=this;this.bd(function(){n.x().DeleteRow()},"TableDeleteRow",!1,null)}}},fQ:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableDeleteColumn: Table delete column");var n=this;this.bd(function(){n.x().DeleteColumn()},"TableDeleteColumn",!1,null)}}},fN:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableApplyLightLines: Table apply light lines");var n=this;this.bd(function(){n.x().SetTableStyle("lightlines",!0)},"TableStyleLightLines",!1,null)}}},fM:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableApplyLightBands: Table apply light bands");var n=this;this.bd(function(){n.x().SetTableStyle("lightbands",!0)},"TableStyleLightBands",!1,null)}}},fL:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableApplyGridStyle: Table apply grid style");var n=this;this.bd(function(){n.x().SetTableStyle("grid",!0)},"TableStyleGrid",!1,null)}}},fP:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableClearStyle: Table clear style");var n=this;this.bd(function(){n.x().SetTableStyle("clear",!0)},"TableStyleClear",!1,null)}}},fO:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableApplyTwoTones: Table apply two tones");var n=this;this.bd(function(){n.x().SetTableStyle("twotones",!0)},"TableStyleTwoTones",!1,null)}}},fK:function(){if(this.bc){this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"TableApplyDefaultStyle: Table apply defualt style");var n=this;this.bd(function(){n.x().SetTableStyle("default",!0)},"TableStyleDefault",!1,null)}}},ra:function(){_j.e.a(this.F(),"ShowInsertLinkDialog: Show insert link dialog");var n=new _bc.l;_y.y.isInstanceOfType(this.W())&&n.F(this.W().c());this.qI(n);this.dl().q(_nbs.a.no);this.lo("");this.dl().n.a(new _ff.d(new _j.g(this.kV,this.F()),_u.P.V,null,!0));this.dl().n.a(new _ff.d(new _j.g(this.kU,this.F()),_u.R.BC,null));this.dl().A(new _j.g(this.kU,this.F()));this.dl().bu(new _j.g(this.kV,this.F()));this.dl().s(this);this.dl().f(!0)},qZ:function(){_j.e.a(this.F(),"ShowInsertAltTextDialog: Show insert image alt text dialog");var n=new _bc.l;_y.y.isInstanceOfType(this.W())&&n.F(this.W().c());this.qH(n);this.dv().q(_nbs.a.nr);this.nO(this.iJ());this.dv().n.a(new _ff.d(new _j.g(this.mt,this.F()),_u.P.V,null,!0));this.dv().n.a(new _ff.d(new _j.g(this.kT,this.F()),_u.R.BC,null));this.dv().A(new _j.g(this.kT,this.F()));this.dv().s(this);this.dv().f(!0)},fH:function(){if(this.bc&&null!==this.x()){_j.e.a(this.F(),"DeleteTable: Delete table");var n=this;this.bd(function(){n.x().DeleteTable()},"TableDeleteTable",!1,null)}},fm:function(n,t){if(this.bc){n&&this.bo(!1);this.jt=n;if(null!==this.x()){_j.e.a(this.F(),"SetForegroundColor: Set foreground color");var i=this;this.bd(function(){i.x().SetColor(!1,i.jt,!1)},"ForeColor",!0,t);this.bq("SelectedForeColor")}}},dB:function(n,t){if(this.bc){n&&this.bo(!1);this.js=n;if(null!==this.x()){_j.e.a(this.F(),"SelectedBackColor: Set background color");var i=this;this.bd(function(){i.x().SetColor(!0,i.js,!1)},"BackColor",!0,t)}}},eF:function(n,t){if(this.bc){n&&this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"FontName: Set font name");var i=this;this.bd(function(){i.x().SetFontFamily(i.pJ(n),!1)},"FontFamily",!0,t)}if(this.eK!==n){this.eK=n;this.bq("FontName")}this.bX(!1)}},eH:function(n,t){if(this.bc){this.dC&&this.bo(!1);if(null!==this.x()){_j.e.a(this.F(),"FontSize: Set font size");var i=this;this.bd(function(){i.x().SetFontSizeStyleValue(n+"pt")},"FontSize",!0,t)}if(this.dC!==n){this.dC=n;this.bq("FontSize")}this.bX(!1)}},hr:function(n,t,i){if(this.bc&&this.x()){this.bo(!1);var r=this;this.bd(function(){r.x().InsertTable(n,t)},i,!1,null)}},nu:function(){this.dl()&&this.dl().p&&this.dl().f(!1)},nt:function(){this.dv()&&this.dv().p&&this.dv().f(!1)},by:function(){var i=new _j.q;if(!this.bk.k()){var r=this;i.c(this.cS(4,"A",new _j.g(function(){r.qx()},this.F())))}var n=new _fc.g;n.a(i.j());var t=_zz.i.prototype.by.call(this);return t?t.concat(n):[n]},oG:function(){var n=this.bZ();if(this.da()){this.dD=new _zy.b.n(n.contentWindow.document.documentElement);this.dD.D(this.by());this.dD.eD(this.bR);this.dD.bp()}},oH:function(){var n=this.fs();this.cC&&n?this.cC.i(n.documentElement):_j.e.b(this.F(),"Editor - BindHtml5Droppable's iframeElement.ContentWindow.Document.DocumentElement is not accessible or no droppable behavior attached.")},re:function(){var n=this.fs();this.cC&&n?this.cC.p(n.documentElement):_j.e.b(this.F(),"Editor - UnbindHtml5Droppable's iframeElement.ContentWindow.Document.DocumentElement is not accessible or no droppable behavior attached.")},qo:function(n){if(!this.er(n)){var t=new _a.bz(n);!t.g()||n.which!==39&&n.which!==37||t.l()||t.j()||this.oN()}},qm:function(n){if(null!==this.x()&&!this.er(n)){var i=new _a.bz(n);var t=i.a();var s=t===(this.bk.f()?0:229);var o=!1;if(!this.gw&&_zz.e.d(this.bP())&&(t===46||t===8||s)){this.bC(!0);o=!0}this.gw=s||this.gw&&(i.g()||i.j());(t===46||t===8||s&&this.gw)&&(o=!0);o&&this.hW(0);if(t!==9||i.j()){if(t===8){_j.e.a(this.F(),"OnKeyDownOnContentEditableArea: handling BACKSPACE");if(this.x().get_IsCursorValid()){this.lq(i.a());var f=this.x().GetCursorParentElement();if(this.hF(f,"BLOCKQUOTE")&&this.x().get_IsSelectionEmpty())for(var u=0;u<f.childNodes.length;u++){var h=f.childNodes[u];if(this.qd(h))continue;else if(h.id==="ms-rterangecursor-start"){this.dj();this.dL(n);break}else break}}}else if(t===46){_j.e.a(this.F(),"OnKeyDownOnContentEditableArea: handling DELETE");this.x().get_IsCursorValid()&&this.lq(i.a())}else if(t===_ff.i.a||t===_ff.i.b||t===38||t===40){_j.e.a(this.F(),"OnKeyDownOnContentEditableArea: handling Arrow (LEFT, RIGHT, UP, DOWN)");this.bk.a()&&this.x().get_IsCursorValid()&&this.lq(i.a())}}else{_j.e.a(this.F(),"OnKeyDownOnContentEditableArea: handling TAB");if(this.x().get_IsCursorValid()){var r=this.x().GetCursorParentElement();var e=!0;if(this.hF(r,"LI"))return;else if(this.hF(r,"BLOCKQUOTE")||this.hF(r,"OL")||this.hF(r,"UL")){this.ig(!0);i.g()?this.dj():this.du()}else{this.ig(!1);if(i.g()){var l=this.dz(8);e=l.b()}else if(this.cZ.a().f().Enabled){this.jV();e=!0}else{var c=$("<span>&nbsp;&nbsp;&nbsp;&nbsp;</span>");this.dE();this.x().InsertNodeBeforeCursor(c.get(0).firstChild);this.dE()}}e&&this.dL(n)}}}},qn:function(n){if(null!==this.x()){this.nF();var i=new _a.bz(n);var t=i.a();if(_zz.e.g(n)){(_zz.e.d(this.bP())||t===13||t===32&&this.mk())&&this.bC(!0);this.bw(0)}}},qp:function(n){this.mj(n);this.gw=!1},oN:function(){var n=this.cy();var t=!1;if(n.focusOffset>n.anchorOffset){if(n.focusOffset-n.anchorOffset==1&&n.anchorNode.hasChildNodes()&&n.anchorNode.childNodes.length>n.anchorOffset&&n.anchorNode.childNodes[n.anchorOffset].nodeName==="IMG"){n.anchorNode.childNodes[n.anchorOffset].click();t=!0}}else if(n.anchorOffset>n.focusOffset&&n.anchorOffset-n.focusOffset==1&&n.focusNode.hasChildNodes()&&n.focusNode.childNodes.length>n.focusOffset&&n.focusNode.childNodes[n.focusOffset].nodeName==="IMG"){n.focusNode.childNodes[n.focusOffset].click();t=!0}!t&&this.bk.a()&&(!n.focusNode.hasChildNodes()&&n.focusNode.nextSibling&&n.focusNode.nextSibling.nodeName==="IMG"?n.focusNode.nextSibling.click():!n.anchorNode.hasChildNodes()&&n.anchorNode.nextSibling&&n.anchorNode.nextSibling.nodeName==="IMG"?n.anchorNode.nextSibling.click():n.anchorNode.hasChildNodes()&&n.anchorNode.childNodes.length>n.anchorOffset&&n.anchorNode.childNodes[n.anchorOffset].nodeName==="IMG"?n.anchorNode.childNodes[n.anchorOffset].click():n.focusNode.hasChildNodes()&&n.focusNode.childNodes.length>n.focusOffset&&n.focusNode.childNodes[n.focusOffset].nodeName==="IMG"&&n.focusNode.childNodes[n.focusOffset].click())},oI:function(){_j.e.a(this.F(),"BindRichTextEditorEvents: BindRichTextEditorEvents.");var n=this.bU();if(n){_a.bn.d(n[0]);n.bind("keyup",this.lb);n.attr("aria-label",this.cr)}if(this.eL()){this.bv().bind("focus",this.kW);this.bv().bind("keydown",this.kX);this.bv().bind("keypress",this.kY);this.bv().bind("keyup",this.kZ);this.bv().bind("mousedown",this.la);this.bv().bind("mousemove",this.cj);this.bv().bind("mouseup",this.cj);this.bv().bind("mouseleave",this.cj);this.bv().bind("paste",this.cj);this.bv().delegate("A","mouseover",this.hk);if(this.gi()){this.bv().bind("copy",this.cQ);this.bv().bind("cut",this.cQ);this.bv().bind("dragstart",this.cQ)}else this.bv().bind("cut",this.hj)}},rf:function(){_j.e.a(this.F(),"UnbindRichTextEditorEvents: UnbindEditorBodyEventHandlers.");var n=this.bU();if(n){n.unbind("keyup",this.lb);_a.bn.a&&_a.bn.a.j(n[0])}if(this.eL()){this.bv().unbind("focus",this.kW);this.bv().unbind("keydown",this.kX);this.bv().unbind("keypress",this.kY);this.bv().unbind("keyup",this.kZ);this.bv().unbind("mousedown",this.la);this.bv().unbind("mousemove",this.cj);this.bv().unbind("mouseup",this.cj);this.bv().unbind("mouseleave",this.cj);this.bv().unbind("paste",this.cj);this.bv().undelegate("A","mouseover",this.hk);if(this.gi()){this.bv().unbind("copy",this.cQ);this.bv().unbind("cut",this.cQ);this.bv().unbind("dragstart",this.cQ)}else this.bv().unbind("cut",this.hj)}},qr:function(n){var i=new _a.bz(n);var t=i.a();t===46||t===8?this.pQ(n):(t===_ff.i.a||t===_ff.i.b||t===38||t===40)&&this.pP(n);this.nF()},bU:function(){var n=this.lj();return n?$(n):null},lj:function(){if(this.da()){var n=this.bZ();return n.contentWindow.document.body}else return null},be:function(){var n=this.bv();return n&&n.length>0?n.get(0):null},g:function(){this.kK();this.x().ForceUpdateCursorMarkersToCurrentSelection();return new _zz.bY(this.be().innerHTML)},h:function(n){this.be().innerHTML=n.b;this.ob()},cy:function(){var n=null;var t=this.fs();t&&(n=t.getSelection());if(!n&&this.hy()){_j.e.b(this.F(),"GetSelection: executing fallback path to get selection from window.");n=this.hy().getSelection();n||_j.e.b(this.F(),"GetSelection: fallback path to get selection from window is not successful.")}return n},ce:function(n){var t=this.cy();if(t){t.removeAllRanges();t.addRange(n);this.x()&&this.x().ForceUpdateCursorMarkersToCurrentSelection();return!0}return!1},fs:function(){if(this.da()){var n=this.bZ();return n.contentWindow.document}else{_j.e.b(this.F(),"GetDocument: IFrameElement is null");return null}},pX:function(n,t){for(var e=this.fs(),f=t.get(),o=f.length,i=0;i<o;++i){var u=f[i];n.collapse(!1);if(n.insertNode){var r=e.importNode(u,!0);n.insertNode(r);n.setStartAfter(r)}else n.pasteHTML&&n.pasteHTML(u.innerHTML)}},lm:function(n){null!==this.x()&&this.x().MoveCursorMarkersBeforeNode(n)},dE:function(){null!==this.x()&&this.x().UpdateCursorMarkersToCurrentSelection()},ob:function(){var r=this.bZ();var u=r.contentDocument.getElementById("ms-rterangecursor-start");var i=r.contentDocument.getElementById("ms-rterangecursor-end");if(u&&i){var n=this.co();n.setEndBefore(i);n.setStartAfter(u);var t=this.cy();t.removeAllRanges();t.addRange(n);this.x().ForceUpdateCursorMarkersToCurrentSelection()}},I:function(){_j.e.a(this.F(),"OnApplyTemplate: OnApplyTemplate");_j.c.prototype.I.call(this);if(this.C){this.lf=this.C.a("FontNameOptions");if(!this.lf)throw Error.invalidOperation("A control bar with ID FontNameOptions is required for the editor to work.");this.cp=this.C.a("EditorFormatBar");if(!this.cp)throw Error.invalidOperation("A format bar with ID EditorFormatBar is required for the editor to work.");var t=this;this.cp.L().keydown(function(n){var r=!1;n.altKey&&(r=n.altKey);var i=!1;n.ctrlKey&&(i=n.ctrlKey);r&&!i&&n.which===75&&t.bo(!1)});this.jo=this.C.a("PasteModeMenuStyleElement");if(!this.jo)throw Error.invalidOperation("A object with ID PasteModeMenuStyleElement is required for the editor to work.");this.dk=this.C.a("ClickableArea");if(!this.dk)throw Error.invalidOperation("A clickable area with ID ClickableArea is required for the editor to work.");var i=this;this.dk.L().focus(function(){i.bL(!1)});this.dk.bi(32);this.eN=this.C.a("MoreDropDownButton");if(!this.eN)throw Error.invalidOperation("A button with ID MoreDropDownButton is required for the editor to work.");this.eM=this.C.a("MoreButtonsPopup");if(!this.eM)throw Error.invalidOperation("A popup with ID MoreButtonsPopup is required for the editor to work.");this.bR=this.C.a("EditorBody");if(!this.bR)throw Error.invalidOperation("A body with ID EditorBody is required for the editor to work.");this.bR.bT(2);var n=this;this.bR.L().blur(function(){n.bk.a()&&(n.ju=!0);n.jw()});this.bR.bi(524288);this.bk.a()&&this.bR.L().bind("focusin",this.mq);this.bR.L().load(this.mu);this.cP=this.C.a("EditorWrapper");if(!this.cP)throw Error.invalidOperation("A body with ID EditorWrapper is required for the editor to work.");this.cp.L()[0].id="EditorFormatBar";this.bZ().id="EditorBody";this.eM.L()[0].id="MoreButtonsPopup"}},M:function(){_j.e.a(this.F(),"OnDeactivate: Deactivation");this.ij(new _cmc.P(this));this.oM();_zz.p.prototype.M.call(this);this.df(!1)},P:function(){_j.c.prototype.P.call(this);this.y("RichTextEditorView")},dN:function(){this.bc&&this.cE(this.nA())},G:function(){_zz.i.prototype.G.call(this);this.rd()},bF:function(){this.Y()&&this.bB();_j.c.prototype.bF.call(this)},br:function(){_j.e.a(this.F(),"InternalDispose: InternalDispose");if(this.bR){this.bR.L().unbind("focusin");this.bR.L().unbind("load");this.bR.L().unbind("blur");this.bR.cB(524288);this.nv();this.bR=null}if(this.cp){this.cp.L().unbind("keydown");this.cp=null}if(this.dk){this.dk.L().unbind("focus");this.dk=null}_zz.p.prototype.br.call(this)},ny:function(){_j.e.a(this.F(),"FinalizeRichTextEditorInitialization: FinalizeRichTextEditorInitialization.");var r=!1;this.hO&&this.eL()&&this.lg()&&(r=!0);if(r){var u=_j.m.a(this.F(),2,"SRTE.FinalizeRichTextEditorInitialization");this.iZ=!0;this.pS();this.qX();this.qM(this.cz.i());this.qY();if(this.gE()){_j.e.a(this.F(),"ApplyPrintRestriction: Applied printing restriction with no print stylesheet.");this.nr()}this.cr&&this.bR.R(this.cr);this.bR.L().attr("aria-role","textbox");var n=this.cu;var t=null;if(n)if(n.b===2){_j.e.a(this.F(),"Content transitioned through CED (from Water)");t=n.l}else{_j.e.a(this.F(),"Content transitioned through string (PlainTextEditor)");this.lp(n.m())}else if(this.cf()){_j.e.a(this.F(),"Loading content from Content.");this.lp(this.cf())}else _j.e.a(this.F(),"No Content. Editor starts with empty content.");this.cn()||this.ka(new _zz.bE(this,t));var f=this.bZ();this.gO(new _cmc.G(this,this.be()));this.oI();this.oG();this.oH();this.nY();this.cf()||n||this.qt();n?n.k(null):this.pW();if(this.cY){this.cY.b();this.cY=null}n&&n.b===2&&n.f&&this.ob();var i=this.fs();this.bk.a()&&i&&i.execCommand("AutoUrlDetect",!1,!1);this.df(!0);if(n){n.j?n.j():this.cn().a();n=null}this.cu=null;_j.m.b(u)}else{this.dp(this.iU);this.iU=this.hR.a(this.F(),"RichTextEditor.FinalizeRichTextEditorInitialization",this.mr,100)}},oL:function(){try{var n=this.x();if(n){n.RemoveEventHandlers();n.set_TableApplyStyleToElementCallback(null);n.RemoveAsIsPasteMode();n.RemoveCleanPasteMode();n.RemovePlainTextPasteMode();n.set_DefaultPasteModeResolver(null)}}catch(t){}this.eO&&this.da()&&this.eO.Dispose();this.eO=null;this.eJ&&this.da()&&this.eJ.Dispose();this.eJ=null},nv:function(){try{if(this.dD){this.dD.D(null);this.dD.dispose();this.dD=null}this.hO=!1}catch(n){_j.e.a(this.F(),"DisposeiframeDocUIObject: Exception in disposing iframe - {0}",n.message)}},pS:function(){_j.e.a(this.F(),"HookUpEditorEngine: Hook up editor engine");try{if(this.da()){var f=this.bZ();var u=f.contentWindow;this.eO=null;var n=null;n=new u.RTE.RichTextEditorEngineFacade;n.Load();this.eO=n;_j.e.a(this.F(),"HookUpEditorEngine: Engine is hooked up")}else throw Error.format("Iframe is not accessible in HookUpEditorEngine!");}catch(e){_j.e.d(this.F(),e,"HookUpEditorEngine: Exception in hooking up engine "+e.message)}var i=this.x();this.pU();var t=this.hz(_zy.c.p());t.className+=" ms-owa-paste-option-icon";var r=this.hz(_b.j.b());r.className+=" ms-owa-paste-option-icon";this.eJ=i.CreateEditorUIServices(_nbs.a.nP,t,r);this.eJ.set_LogErrorCallBackFunction(this.mv);this.eJ.set_PasteCompletionCallBackFunction(this.ms);this.eJ.set_OnUpdateFormatBar(this.np);i.set_TableApplyStyleToElementCallback(_zy.b.a.c)},nx:function(n){if(this.cY){this.cY.d(n,null);this.cY=null}else if(this.cu&&this.cu.a){this.cu.k(n);this.cu=null}},oJ:function(n){if(this.ju){this.ju=!1;this.dp(this.iQ);var t=this;this.iQ=_j.o.a().a(this.F(),"RichTextEditor.CallFocusForIE",function(){t.bL(!1)},50)}},oT:function(){if(this.da()){var n=this.bZ().contentWindow;n&&n.focus()}},oS:function(n){_j.e.a(this.F(),"FocusOnRte: FocusOnRte");var t=this.x();if(null!==t){this.oT();this.nM();if(this.iZ){t.SetInitialFocus();this.iZ=!1}(this.bk.h()||this.bk.k())&&!this.bk.g()&&t.ForceUpdateCursorMarkersToCurrentSelection();this.dE();var i=this.be();i&&this.be().focus()}},qw:function(n){if(n){_j.e.a(this.F(),"RemovePStyles: RemovePStyles");return n.replace(_zy.b.i,"$1").replace(_zy.b.j,"")}else return n},nL:function(n,t){_j.e.a(this.F(),"ProcessContent: Process content to extract head and body from html fragment");n=this.qw(n);t.val=$(_zz.n.b(n,null));if(t.val){var i=t.val.find('div[id^="Signature"]');i&&i.length>0&&this.kO(t.val)}},nE:function(){var n=null;if(!this.cO())return null;if(null!==this.x()){var t=this.x().GetCurrentStateNode();t&&(n=this.bk.a()&&Number.parseInvariant($.browser.version)<=8?t.nodeValue:this.x().get_SelectedHtml())}return n},pZ:function(){return this.bk.a()&&document.documentMode===11},qa:function(){return this.bk.a()&&Number.parseInvariant($.browser.version)<=8},rc:function(){_j.e.a(this.F(),"StoreSelectionAndSelectionStartForInsertApis: StoreSelectionAndSelectionStartForInsertApis");var t=this.cy();var n=_zy.b.e(t);n&&(this.hQ=n.cloneRange())},qc:function(){_j.e.a(this.F(),"IsRangeChangedAfterInsertApis: IsRangeChangedAfterInsertApis");var r=this.cy();var n=_zy.b.e(r);if(n&&this.hQ){var i=n.compareBoundaryPoints(0,this.hQ);var t=n.compareBoundaryPoints(2,this.hQ);return!!i||!!t}else return!1},jw:function(){try{var t=this.cy();var n=_zy.b.e(t);n&&(this.hP=n.cloneRange())}catch(i){_j.e.c(this.F(),"StoreSelection: Got exception - {0}",i.message)}},nM:function(){try{if(this.hP){var n=this.cy();n.removeAllRanges();n.addRange(this.hP);this.hP=null}}catch(t){_j.e.c(this.F(),"StoreSelection: Got exception - {0}",t.message)}},nY:function(){if(this.da()){var n=this.bZ();var i=this.ca()&&!_j.i.a(this.cs)?this.cs:"-1";var t=parseInt(i);n.tabIndex=t;if(t!==-1&&this.bk.a()){n.tabIndex=1e4;n.contentWindow.document.documentElement.tabIndex=-1;n.contentWindow.document.body.tabIndex=t;n.contentWindow.document.body.style.outline="none"}}},bP:function(){var n=this.cy();return n&&n.rangeCount>0?n.getRangeAt(0):null},ez:function(){var t=_zz.i.prototype.ez.call(this);var n=this.nC();var i=null;t&&n&&(i=new _zz.bf(t.c+n.top,t.b+n.top,t.a+n.left));return i},fD:function(){var n=this.nC();var t=_j.w.a(this.z);var i=null;if(n&&t){var u=t.documentElement.clientHeight;var r=t.documentElement.clientWidth;i=new _cmc.S(Math.max(0,n.top),Math.min(r,n.right),Math.min(u,n.bottom),Math.max(0,n.left))}return i},hp:function(){var n=this.lj();return n?new _y.dM(n.scrollTop):null},hs:function(n,t,i){var f=n.getBoundingClientRect();var r=this.lj();var e=r?r.getBoundingClientRect():null;if(f&&e&&r){var o=f.bottom+i-e.top;var u=r.scrollTop+(o-r.clientHeight);t&&t.a>u&&(u=t.a);u=Math.min(u,r.scrollHeight-r.clientHeight);r.scrollTop!==u&&(r.scrollTop=u)}else _j.e.b(this.F(),"[RichTextEditor: ScrollIntoView] - failed to obtain client rect, scroll does not happen")},co:function(){var t=this.fs();var n=null;if(t){_j.e.a(this.F(),"CreateRange: Creating range from editor document");n=t.createRange()}else{_j.e.b(this.F(),"CreateRange: iframe document is null, creating range from current document");n=document.createRange()}return n},cw:function(n){var t=this.fs();return t?t.createElement(n):null},gG:function(){return!0},nF:function(){this.hI=!1;this.hK=null;this.gz=null;this.hL=null},lq:function(n){if(!_b.g.c()){_j.e.a(this.F(),"RTE: Skipping SetEventVariablesOnContentEditableAreaKeyDown because previews are disabled");return}if(null===this.x()){_j.e.a(this.F(),"RTE: Skipping SetEventVariablesOnContentEditableAreaKeyDown because engine is inaccessible.");return}this.hI=this.x().get_StartMarker().nextSibling===this.x().get_EndMarker();this.x().get_EndMarker().nextSibling&&_b.g.a(this.x().get_EndMarker().nextSibling.id,"LPBorder")?this.gz=this.x().get_EndMarker().nextSibling:this.x().get_StartMarker().previousSibling&&_b.g.a(this.x().get_StartMarker().previousSibling.id,"LPBorder")&&(this.hK=this.x().get_StartMarker().previousSibling);n===8&&(this.hL=this.oQ(this.x().get_StartMarker()))},oQ:function(n){var r=null;if(null!==this.x())for(var e=this.bk.h(),u=this.x().CreateDOMTreePosition(n,0),f=0;f<5;f++){if(!u.MoveToPreviousElement())break;var t=u.GetCurrentNode();if(!t||!t.tagName)break;var i=t.tagName.toUpperCase();if(i!=="P"&&i!=="BR"){if(_b.g.a(t.id,"LPBorder")){r=t;break}if(i!=="DIV"||!e)break}}return r},pQ:function(n){if(!_b.g.c()){_j.e.a(this.F(),"RTE: Skipping HandleDeleteBackspaceOnKeyUpForPreview because previews are disabled");return}if(this.bk){var t=this.oR();if(t)if(this.hI&&!this.gz)this.oP(t,n);else{var i=!!this.hL&&this.hL===t;this.nK(t,i)}}},pP:function(n){if(!_b.g.c()){_j.e.a(this.F(),"RTE: Skipping HandleArrowKeyOnKeyUpForPreview because previews are disabled");return}if(null===this.x()){_j.e.a(this.F(),"RTE: Skipping HandleArrowKeyOnKeyUpForPreview because engine is inaccessible");return}if(this.bk&&this.bk.a()){var t=null;var f=new _a.bz(n);var r=f.a();var u=this.lh();u&&(t=_b.g.b(u));if(t){t.parentNode&&t.parentNode.nodeName.toUpperCase()==="P"&&t.parentNode.children.length===1&&(t=t.parentNode);var e=r===40;this.nK(t,e)}if(!this.hI)return;var i=null;r===_ff.i.b&&this.gz?i=this.gz:r===_ff.i.a&&this.hK&&(i=this.hK);if(i&&this.cO()){this.x().MoveCursorMarkersToNode(i);this.dE();this.dw.a(_a.V,new _a.V(_nbs.a.Bv+i.innerText.replace(_nbs.a.YQ,""),!1))}}},oR:function(){var n=this.lh();return n?_b.g.b(n):null},oP:function(n,t){if(null!==this.x()){this.dL(t);var r=this.x().CreateDOMTreePosition(n,0);r.MoveToPreviousElement();var i=r.GetCurrentNode();this.md(n);if(i){this.x().MoveCursorMarkersAfterNode(i);this.dE()}}},nK:function(n,t){t?null!==this.x()&&this.x().MoveCursorMarkersAfterNode(n):this.lm(n);this.dE()},ri:function(){if(!_b.g.c()){_j.e.a(this.F(),"RTE: Skipping link preview bind because previews are disabled");return}this.rh(this.bv().find("[id^='LPBorder']"))},rh:function(n){for(var i=0;n&&i<n.length;++i){var t=n[i];t.previousSibling.tagName==="P"&&$(t.previousSibling).remove();var r=t.parentNode;r&&r.tagName!=="P"&&$(t).wrap("<p></p>")}},qd:function(n){return n.nodeValue&&n.nodeValue.length===1&&n.nodeValue.charAt(0)==="​"?!0:!1},nH:function(n,t){if(!n||_j.i.b(n))return!0;for(var s=this.nB(n),a=this.nB(t),e=s,l=e.length,i=0;i<l;++i){for(var c=e[i],u=!1,f=a,o=f.length,r=0;r<o;++r){var h=f[r];if(c===h){u=!0;break}}if(!u)return!1}return!0},nB:function(n){var t=null;if(n){t=n.split(";");for(var i=0;i<t.length;++i)t[i]=t[i].trim()}return t},qt:function(){_j.e.a(this.F(),"PreserveParagraph: Preserve and add P tag to workaround invisible text bug in IE");var i="<P><BR></P>";var t=this.bv();if(!this.cu){var n=this.li(t,_zy.b.c);if(n&&(!n.children().length||n.children()[0].tagName!=="P")){_j.e.a(this.F(),"PreserveParagraph: inserting P under default style span.");this.fe(i,!0,!1)}else if(!n&&(!t.children().length||t.children()[0].tagName!=="P")){_j.e.a(this.F(),"PreserveParagraph: inserting P under content editable div.");this.fe(i,!0,!1)}}},hF:function(n,t){while(n&&n.tagName!==t&&n.tagName!=="BODY")n=n.parentNode;return!!n&&n.tagName===t},qV:function(n){if(this.eK!==n){this.eK=n;this.bq("FontName")}},qW:function(n){if(this.dC!==n){this.dC=n;this.bq("FontSize")}},pY:function(){var t=_j.m.a(this.F(),2,"SRTE.InternalInitializeHtmlEditorAreaStep1");_j.e.a(this.F(),"InternalInitializeHtmlEditorAreaStep1: InternalInitializeHtmlEditorAreaStep1.");this.eO=null;this.qf(this.lt);this.qV(this.iW().a);this.qW(this.iW().b);var n=this.bZ();this.gy?this.nI(n,!0):this.bk.f()?this.nX(n):this.ll();_j.m.b(t)},nX:function(n){n.src="about:blank";var t=this;$(n).one("load",function(){t.ll()})},nI:function(n,t){var r=_j.m.a(this.F(),2,"SRTE.LoadRTEFrameFromAppcache");var u=this.cz.x(this.fr.a)+"/"+"blank.html";n.src=u;var i=this;$(n).one("load",function(){try{i.qq(t)}catch(r){_j.e.b(i.F(),"Rte frame failed to load, Exception: {0}",r.message);i.nX(n)}});_j.m.b(r)},qq:function(n){var t=this.bZ();var i=t.contentWindow;n&&_j.z.a(i.rteFrameLoadedFromAppcache)&&this.fr.b()?this.nI(t,!1):this.ll()},nN:function(){if(this.da())this.pY();else{this.dp(this.jq);this.jq=_j.o.a().a(this.F(),"RichTextEditor.RetryInitializeHtmlEditorArea",this.nl,100)}},ll:function(){var a=_j.m.a(this.F(),2,"SRTE.InternalInitializeHtmlEditorAreaStep2");_j.e.a(this.F(),"InternalInitializeHtmlEditorAreaStep2: InternalInitializeHtmlEditorAreaStep2.");this.hO=!1;var v=this.bZ();var n=v.contentWindow;var l=this.bk;var k=l.a();var r=this.jo.L();var w=r.css("border-top-color");var y=r.css("font-family");var h=r.css("color");var o=r.css("background-color");var f="11pt";this.bk.a()?f="12pt":this.bk.f()&&(f="10pt");n.document.open();n.document.writeln('<!DOCTYPE html PUBLIC " -// W3C// DTD XHTML 1.0 Transitional// EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">');n.document.writeln('<html style="height:94%" xmlns="http://www.w3.org/1999/xhtml">');n.document.writeln("<head>");n.document.writeln('<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">');n.document.writeln('<meta http-equiv="X-UA-Compatible" content="IE=10">');n.document.writeln('<meta name="referrer" content="never" />');n.document.writeln('<style type="text/css" style="display:none;"><!-- P {margin-top:0;margin-bottom:0;} --></style>');n.document.writeln('<style type="text/css" title="OWADoNotSendStyle" style="display:none;">.ms-cui-menu {background-color:#ffffff;border:1px '+w+" solid;font-family:"+y+";font-size:"+f+";color:"+h+";z-index: 1000;} "+".ms-cui-menusection-title {display:none;} "+".ms-cui-ctl {vertical-align:text-top;text-decoration:none;color:"+h+";} "+".ms-cui-ctl-on {background-color:"+o+";opacity: 0.8;} "+".ms-cui-img-cont-float {display:inline-block;margin-top:2px} "+".ms-cui-smenu-inner {padding-top:0px;} "+"."+"ms-owa-paste-option-icon"+" {margin: 0px 6px 0px 6px;vertical-align:middle!important;padding-bottom: 2px;display:inline-block;} "+".ms-rtePasteFlyout-option:hover {background-color:"+o+" !important;opacity:1 !important;} "+".ms-rtePasteFlyout-option {padding:8px 4px 8px 4px;outline:none;} .ms-cui-menusection {float:left; width:85px;height:24px;overflow:hidden}"+this.pO(this.nD())+_b.g.k()+this.pN(this.nD())+".wf-size-x20 {font-size: 20px!important;}"+"#OwaReferenceAttachments {display: none;}"+"</style>");n.document.writeln(this.pM());n.document.writeln("</head>");n.document.writeln('<body spellcheck="false" style="height:100%;margin:0px 0px 0px 0px;" '+this.nz()+' class="'+_b.g.j(this.qa())+'">');n.document.writeln("</body>");n.document.writeln("</html>");n.document.close();var p=this;n.addEventListener("error",function(n){var t=n;p.qg(t.message,t.filename,t.lineno,t.colno,t.error);return!0},!1);var i=this.cu;if(i&&i.b===2){var u=i.f.clone();u.css("overflow","");u.css("display","");u.css("height","100%");var e=u[0];e.id="MicrosoftOWAEditorRegion";e.className="ms-rtestate-write";n.document.body.appendChild(e);if(this.bM()===1&&i.i>0){this.cP.L().height(i.i);this.bR.L().height(i.i)}}else{var b=$('<div spellcheck="true" aria-label="'+_nbs.a.Op+'" id="'+"MicrosoftOWAEditorRegion"+'" class="ms-rtestate-write" useinlinestyle="true" contenteditable="'+'" role="textbox" style="'+"height:100%;border-style:hidden; outline:none;"+this.iW().e()+'" rtedirty="false"></div>');n.document.body.appendChild(b.get(0))}this.db()&&this.bR.bE(this.db());this.bR.L().css("box-sizing","border-box");var c=new _zy.h(this.cz.o(),this.cz.J(),this.cz.K(),this.dw,this.bk,this.hR,!1,n,this.cz,this.fr,this.gy);c.b(_zy.b.k,null);var s=new _zy.g(this.cz,this.hR,this.bk.d(),n,this.fr,this.gy);var t=this;s.e(_zy.b.h,!1,function(){var n=t.bZ();if(n&&n.contentWindow===s.j){t.hO=!0;t.ny()}else if(t.Y()){t.nx("IframeInaccessibleOnScriptLoadCallback");_j.e.d(t.F(),Error.create("Iframe inaccessible after script loader callback"),"InternalInitializeHtmlEditorAreaStep2: Iframe should be accessible after callback from RTE script loader.")}else t.nx("EditorDeactivatedOnScriptLoadCallback")},!1);_j.m.b(a)},qg:function(n,t,i,r,u){var f=t||"Unknown file";_j.e.d(_a.a.cS,u,String.format("{0} at {1}:{2}:{3} inside the RTE",n,f,i,r));return!0},pM:function(){var r="";var n=this.bZ();if(n&&n.ownerDocument){var u=n.ownerDocument.getElementsByTagName("head");if(u.length>0)for(var f=u[0],i=f.getElementsByTagName("style"),t=0;t<i.length;t++)r+='<style title="OWADoNotSendStyle">'+i[t].innerHTML+"</style>"}return r},pN:function(n){return".notIE8 .wf-owa-triangle-down-small:before {content:'\\e052';}.ie8 .wf-owa-triangle-down-small:before { content:'\\e052';}.ie8 .wf-owa-triangle-down-small {color:#666666/*$WFGreyColor*/;}"},pO:function(n){return"@font-face {  font-family: 'Office365Icons';  src: url('"+n+"/styles/fonts/office365icons.eot?#iefix') format('embedded-opentype'),"+"  url('"+n+"/styles/fonts/office365icons.woff') format('woff'),"+"  url('"+n+"/styles/fonts/office365icons.ttf') format('truetype'),"+"  url('"+n+"/styles/fonts/office365icons.svg#Office365Icons') format('svg'); "+"  font-weight: normal;"+"  font-style: normal;"+"}"+"[class^='ms-Icon--']:before, [class*=' ms-Icon--']:before {"+"  font-family: 'Office365Icons';"+"  font-style: normal;"+"  font-weight: normal;"+"  speak: none;"+"  display: inline-block;"+"  text-decoration: inherit;"+"  text-align: center;"+"  font-variant: normal;"+"  text-transform: none;"+"  line-height: 1;"+"}"+"[class^='ms-Icon--'], [class*=' ms-Icon--'] {"+"  display: inline-block;"+"  line-height: 1;"+"}"},nD:function(){return this.gy?this.cz.w(this.fr.a):this.cz.p()},li:function(n,t){if(!n)return null;for(var i=null,f=t,o=f.length,r=0;r<o;++r){var s=f[r];var u=n.children("#"+s);if(u&&u.length>0){i=u;break}}var e=this.li(i,t);e&&(i=e);return i},gM:function(n,t){t||(n=$("<div/>").text(n).html());this.bv().html($("<div>"+n+"</div>").html());var i=this;this.bv().each(function(n,t){i.ep(new _cmc.t(i,t))})},fe:function(n,t,i){var u=this.li(this.bv(),_zy.b.c);t||(n=$("<div/>").text(n).html());var r=$("<div>"+n+"</div>").contents();u?u.prepend(r):this.bv().prepend(r);this.ep(new _cmc.t(this,r.get(0)));this.bw(0)},fE:function(n,t,i,r,u,f){_j.e.a(this.F(),"InsertContentAtSelection: InsertContentAtSelection");t||(n=$("<div/>").text(n).html());var o=$("<div>"+n+"</div>").contents();var a=o.find('div[id^="Signature"]');a&&a.length>0&&this.kO(o);this.bo(!1);if(this.bk.a()&&Number.parseInvariant($.browser.version)<=8){if(this.cO()){_j.e.a(this.F(),"InsertElementAtSelection: Insert content at selection for IE8 and below");if(null!==this.x())for(var l=o.get(),y=l.length,h=0;h<y;++h){var v=l[h];this.x().InsertNodeAtCursor(v)}}}else{var e=this.bP();if(e){!e.collapsed&&r&&e.deleteContents();var p=e.cloneRange();this.pX(e,o);var s=this.cy();if(s){s.removeAllRanges();if(u){e.collapse(!1);s.addRange(e)}else s.addRange(p)}this.x().ForceUpdateCursorMarkersToCurrentSelection();var c=this;o.each(function(n,t){c.ep(new _cmc.t(c,t))})}}this.bw(0)},gK:function(n,t,i,r){var b=this.iX();var h=this.bv();var p=this.bU();var f;var y;this.nL(n,y={val:f}),f=y.val;if(f){var e=f.contents();if(e&&e.length>0){var o=f.attr("style");var s=f.attr("dir");var w=h.attr("style");if(!i&&((!s||_j.i.b(s))&&(!o||_j.i.b(o))||s===p.attr("dir")&&this.nH(o,w))){h.append(e);var v=this;e.each(function(n,t){v.ep(new _cmc.t(v,t))})}else{_j.e.a(this.F(),"InsertContentAtEnd: Append content to body section");var u=$("<div />");s&&u.attr("dir",s);o&&u.attr("style",o);if(i){_j.e.a(this.F(),"InsertContentAtEnd: Apply color since keepOriginalFormat is true");var l=!1;if(this.cP){var c=this.cP.L().get(0);if(c){u.css("color",$(c).css("color"));l=!0}}l||_j.e.c(this.F(),"InsertContentAtEnd: $ItemTextColor isn't applied to original message.")}u.append(e);h.append(u);this.ep(new _cmc.t(this,u.get(0)))}}}else{_j.e.a(this.F(),"InsertContentAtEnd: Append whole content since cannot extract body section from the content");h.append(n);var a=this;h.each(function(n,t){a.ep(new _cmc.t(a,t))})}this.bw(0)},pW:function(){_j.e.a(this.F(),"InsertCursorMarkersToTopMostFocusableNode: InsertCursorMarkersToTopMostFocusableNode.");var t=this.x();if(null!==t&&this.eL()){this.qu();t.ClearCanvasRange();var n=this.mf();n&&(n.hasChildNodes()?this.lm(n.firstChild):t.MoveCursorMarkersToChildren(n));if(this.pZ()){var i=this.bv().find("#ms-rterangecursor-start");i.before('<span id="OWAZWSPSpan">&#8203;</span>')}}},qu:function(){if(this.eL()){var n=this.bv().find("#ms-rterangecursor-start");n.contents().unwrap();n=this.bv().find("#ms-rterangecursor-end");n.contents().unwrap()}},qf:function(n){this.hC=new _cmc.y(n)},hz:function(n){var t=new _fc.d(document.createElement("span"),this.hm,this.hl);t.a(n);return t.L()[0]},qs:function(n){if(n.getElementsByTagName("o:p").length>0){_j.e.a(this.F(),"PasteModeResolver: Resolved to PasteClean (since seeing 'o:p')");return"PasteClean"}if(n.querySelectorAll)for(var r=n.querySelectorAll("p, h1, h2, h3, b, i, u, table"),t=0;t<r.length;t++){var u=r[t];var i=u.getAttribute("style");if(i&&i.indexOf("mso-")>-1){_j.e.a(this.F(),"PasteModeResolver: Resolved to PasteClean (since seeing 'mso-')");return"PasteClean"}}_j.e.a(this.F(),"PasteModeResolver: Resolved to PasteAsIs (as default fallback)");return"PasteAsIs"},pU:function(){var n=this.x();if(null!==n){_j.e.a(this.F(),"InitializePasteManger: InitializePasteManger.");n.CreateAsIsPasteMode(this.hz(_zy.c.n()),_nbs.a.ji);n.CreateCleanPasteMode(this.hz(_zy.c.o()),_nbs.a.li);n.CreatePlainTextPasteMode(this.hz(_zy.c.q()),_nbs.a.gF);n.set_DefaultPasteModeResolver(this.nk)}},pT:function(){_j.e.a(this.F(),"InitializeColorPickers: InitializeColorPickers.");if(!this.hx()){this.qE(new _b.N(_zy.d.d,_zy.d.c,"RichTextEditorView.ColorMenuItemTemplate",this.nj));this.hx().apcl("IsShown",this.my)}if(!this.hw()){this.qy(new _b.N(_zy.d.a,_zy.d.b,"RichTextEditorView.ColorMenuItemTemplate",this.mx));this.hw().apcl("IsShown",this.mw)}},kI:function(){this.dB(_zy.d.a[0],"Shortcut")},qk:function(n,t){this.hx().q()&&this.hx().a(this.jt)},ql:function(n,t){var i=n;this.qT(i.o.toString())},qh:function(n,t){this.hw().q()&&this.hw().a(this.js)},qi:function(n,t){var i=n;this.qS(i.o.toString())},nJ:function(n){_j.e.d(this.F(),n,"Editor engine exception: "+n.message+". Stack is "+n.stack)},rg:function(){if(this.bc)try{if(null!==this.x()&&this.ca()){_j.e.a(this.F(),"UpdateFormatBar: Update format bar.");var t=this.x().GetFontFamily();t.startsWith("'")&&t.endsWith("'")&&(t=t.substring(1,t.length-1));this.eK=_cmc.a.i(t);var i=this.x().GetFontSize();this.dC=this.oO(i);this.nP(this.x().get_IsBoldApplied());this.nS(this.x().get_IsItalicApplied());this.nU(this.x().get_IsUnderlineApplied());this.nQ(this.x().get_IsBulletApplied());this.nT(this.x().get_IsNumberApplied());if(this.cn()){this.qB(this.cn().c());this.qA(this.cn().b())}this.qG(this.oK());this.qU();var n=new _cmc.bf;n.u=this.eK;n.v=this.dC;n.o=this.hD;n.p=this.hG;n.q=this.hJ;n.n=this.hA;n.w=n.n?this.iJ():"";n.r=this.iR;n.s=this.ht;n.t=this.hu;n.z="";n.x=this.hE;n.y=this.hH;this.kS(n)}}catch(r){}},oO:function(n){if(n.endsWith("px")){n=n.substring(0,n.length-2);if(this.hM===-1){var t=document.createElement("SPAN");t.style.height="100pt";t.style.position="absolute";document.body.appendChild(t);this.hM=t.offsetHeight/100;t.parentNode.removeChild(t)}return Math.round(Number.parseInvariant(n)/this.hM).toString()}else if(n.endsWith("pt")){var i=n.substring(0,n.length-2);return Math.round(Number.parseInvariant(i)).toString()}return n},oK:function(){if(!this.x())return!1;this.bk.a()&&this.nM();var t=this.x().get_IsImageSelected();var n=!1;var i=this.cy();if(t&&i){var r=$(i.focusNode);var u=this;r.children().each(function(i,r){var f=$(r);var u=f.attr("id");u==="ms-rterangecursor-start"?n=!0:u==="ms-rterangecursor-end"&&(n=!1);n&&f.hasClass("EmojiInsert")&&(t=!1)})}return t},pR:function(n){this.cn().a();this.cx().b(n)},qU:function(){var t=null;if(_b.g.c()){var n=this.lh();n&&(t=_b.g.b(n))}this.qz(!t&&null!==this.x()&&this.x().get_IsEditingTable())},lh:function(){return this.cO()?this.x().GetCursorParentElement():null},cO:function(){try{if(null===this.x()||!this.x().CurrentEditableRegion()||!this.x().get_IsCursorValid())return!1}catch(n){this.nJ(n);return!1}return!0},dd:function(){var i=!1;var n=this.bZ();if(n&&n.ownerDocument&&n.ownerDocument.activeElement===n){var t=this.hy();i=t?this.qb(t.document.activeElement)&&this.cO():!1}return i},qb:function(n){var t=!1;var u=$(n);var i=this.bv();if(i){var r=u.closest(i);t=!!r.length}_j.e.a(this.F(),"[RichTextEditor: IsElementInsideContentEditableDiv] - Element {0} inside CED",t?"is":"is not");return t},qX:function(){var t=this.bZ();var n=t?t.contentWindow:null;if(n){var i=n;i.InlineImageLoader=window.self.InlineImageLoader}},qY:function(){this.lr=!1;this.dk.J(!0);this.cp.J(!0);this.eN.J(!0)},qe:function(n){_j.e.a(this.F(),"LoadInlineImages: LoadInlineImages");var t=n.target;if(!this.eL()){_j.e.b(this.F(),"LoadInlineImages: LoadInlineImages is invoked with a null document");return}_j.e.a(this.F(),"LoadInlineImages: LoadInlineImages loads contents");this.lk.A($(t).contents())},qj:function(n){_j.e.a(this.F(),"OnFocusOnRte: OnFocusOnRte");this.gP(new _cmc.I(this))},qx:function(){_j.e.a(this.F(),"SelectAll: SelectAll");if(null!==this.x()){this.x().SelectAll();this.dE()}},bZ:function(){return this.bR&&this.bR.L()?this.bR.L().get(0):null},lg:function(){var t=!1;try{if(this.da()){var n=this.bZ();n.contentWindow&&n.contentWindow.RTE&&n.contentWindow.RTE.RichTextEditorEngineFacade&&n.contentWindow.RTE.DomHelper&&(t=!0)}}catch(i){}return t},x:function(){return this.lg()?this.eO:null},iX:function(){try{if(this.da()){var t=this.bZ();var n=t.contentWindow.document.getElementsByTagName("Head");if(n&&n.length>0)return $(n[0])}}catch(i){return null}return null},pL:function(){var t=null;var n=this.iX();n.length>0&&(t=n.find("#owaPrintStyle"));return t},nr:function(){_j.e.a(this.F(),"AddNoPrintStyle: AddNoPrintStyle");var t=this.iX();if(t.length>0){var n=t.find("#owaPrintStyle");if(!n.length){n=$('<style type="text/css" media="print" id="owaPrintStyle" style="display:none;">BODY {display:none;visibility:hidden;}</style>');n.appendTo(t)}}},qv:function(){var n=this.pL();n.length>0&&n.remove()},pJ:function(n){for(var t=0;t<_cmc.a.a.length;++t)if(_cmc.a.a[t][0]===n)return _cmc.a.a[t][1];return n},ca:function(){return _zz.p.prototype.ca.call(this)},cM:function(n){if(_zz.p.prototype.ca.call(this)!==n){_zz.p.prototype.cM.call(this,n);this.bc&&this.nY()}return n},jM:function(){var t=this.cP?this.cP.L():null;var n=t?t.get(0):null;return!!n&&!!n.offsetParent},gR:function(){var ct=!this.bM()||this.bM()===1||this.bM()===4;_j.e.a(this.F(),"RichTextEditor: Resizing editor DOM element.");var o=this.cP?this.cP.L():null;var k=o?o.get(0):null;var ut=_j.m.a(this.F(),2,"SRTE.ResizeEditorDomElement");if(this.lr){var e=this.bU();if(e&&e.length===1&&e[0].offsetWidth>0){this.nR(!0);this.cp.J(!1);var w=this.eM.L().children();var n=this.cp.L().children();if(this.cz.i())for(var p=0;p<n.length;++p){var ft=n[p];var tt=$(ft);tt.css("float","left");tt.css("clear","none")}if(w.length>0){for(var c=0;c<w.length;++c){var st=w[c];var b=$(st);b.css("float","left");b.css("clear","none");this.cp.L().append(b)}this.eM.L().empty()}var v=!1;n=this.cp.L().children();if(n.length>0){var s=!1;var f=-1;this.cz.i()&&this.cp.L().css("float","left");for(var h=0;h<n.length;++h){var i=n[h];var a=$(i);f===-1&&(f=i.offsetTop);!s&&Math.abs(f-i.offsetTop)>10&&(s=!0);if(i.offsetLeft+i.offsetWidth>e[0].offsetWidth-50||s){a.css("float","none");a.css("clear","both");this.eM.L().append(a);v=!0}f=i.offsetTop}this.cz.i()&&this.cp.L().css("float","right");n=this.cp.L().children();if(this.cz.i())for(var l=0;l<n.length;++l){var ot=n[l];var nt=$(ot);nt.css("float","right");nt.css("clear","none")}}this.nR(!1);this.eN.J(!(this.nZ&&v));this.bt("MoreButtonsPopupXPosition","MoreButtonsPopupYPosition");this.gx&&this.bX(v)}}var t=-1;var g=_b.C.a(this.cP.L().css("height"));var u=!1;if(this.bM())if(this.bM()===4){var ht=this.pK();var et=this.dk.bm()?0:this.dk.L().height();var rt=String.format("calc({0} - {1}{2})","100%",ht+et,"px");this.cP.L().height(rt);this.bR.L().height("100%")}else{t=o.offsetParent().height()+_b.C.a(o.offsetParent().css("padding-top"))-k.offsetTop;for(var r=k.parentNode;r&&r!==k.offsetParent;){var y=$(r);t=t-_b.C.a(y.css("padding-bottom"))-_b.C.a(y.css("margin-bottom"))-_b.C.a(y.css("border-bottom-width"));r=r.parentNode}var it;this.oa(t,g,it={val:u}),u=it.val}else{t=this.dH;var d;this.oa(t,g,d={val:u}),u=d.val}u&&this.gQ(new _cmc.J(this));_j.m.b(ut)},oa:function(n,t,i){i.val=!1;n=Math.max(this.cR,n);if(n>0&&n!==t){this.cP.L().height(n);i.val=!0;this.bk.a()&&this.hm.a()==="TouchWide"?this.bR.L().height(n-4):this.bR.L().height(n)}},pK:function(){return!this.cp||this.cp.bm()?0:this.cp.L().height()},nC:function(){var n=this.bZ();return n?n.getBoundingClientRect():null}};_zy.b.a=function(){};_zy.b.a.c=function(n,t){_j.e.a(_a.a.p,"OWAApplyStyleToElement: OWAApplyStyleToElement.");var r=_zy.b.a.b(t);if(r){var i="";n.getAttributeNode("style")&&n.getAttributeNode("style").specified&&(i+=n.getAttributeNode("style").value);var u=i+r;n.setAttribute("style",u)}};_zy.b.a.b=function(n){if(!_zy.b.a.a){var i=_zy.b.a.a={};var t="border-collapse:collapse; border: 1px solid rgb(198, 198, 198);";var r="background-color: rgba(255, 255, 255, 0.85);";i["ms-rteTable-default"]=t;i["ms-rteTableOddRow-default"]=t+r;i["ms-rteTableEvenRow-default"]=t+r;i["ms-rteTableOddCol-default"]=t;i["ms-rteTableEvenCol-default"]=t;t="border-collapse:collapse; border: 1px solid rgb(171, 171, 171);";var f="background-color: rgb(216, 216, 216);";i["ms-rteTable-grid"]=t;i["ms-rteTableOddRow-grid"]=t+f;i["ms-rteTableEvenRow-grid"]=t+r;i["ms-rteTableOddCol-grid"]=t;i["ms-rteTableEvenCol-grid"]=t;t="border-collapse:collapse; border: 1px solid transparent;";i["ms-rteTable-lightlines"]=t;i["ms-rteTableOddRow-lightlines"]=t+r;i["ms-rteTableEvenRow-lightlines"]=t+r;t="border-collapse:collapse; border-top-color: transparent; border-bottom-color: rgb(146, 192, 224); border-left-color: transparent; border-right-color: transparent; border-top-width: 1px; border-bottom-width: 1px; border-top-style: solid; border-bottom-style: solid;";i["ms-rteTableOddCol-lightlines"]=t;i["ms-rteTableEvenCol-lightlines"]=t;t="border-collapse:collapse; border: 1px solid transparent;";i["ms-rteTable-twotones"]=t;i["ms-rteTableOddRow-twotones"]=t+"background-color: rgb(192, 228, 255);";i["ms-rteTableEvenRow-twotones"]=t+r;i["ms-rteTableOddCol-twotones"]=t;i["ms-rteTableEvenCol-twotones"]=t;t="border-collapse:collapse; border: 1px solid transparent;";i["ms-rteTable-lightbands"]=t;i["ms-rteTableOddRow-lightbands"]=t+f;i["ms-rteTableEvenRow-lightbands"]=t+r;i["ms-rteTableOddCol-lightbands"]=t;i["ms-rteTableEvenCol-lightbands"]=t;t="border-collapse:collapse; border: 1px solid transparent;";i["ms-rteTable-clear"]=t;i["ms-rteTableOddRow-clear"]=t+r;i["ms-rteTableEvenRow-clear"]=t+r;i["ms-rteTableOddCol-clear"]=t;i["ms-rteTableEvenCol-clear"]=t}var u=_zy.b.a.a[n];return u?u.toString():null};_zy.b.n=function(n){_zy.b.n.initializeBase(this,[n])};_zy.b.n.prototype={gW:function(){return!0}};_zy.f=function(n,t,i,r,u){_zy.f.initializeBase(this,[n,t,i,r,u])};_zy.f.prototype={s:function(){return _zz.E.prototype.s.call(this)},cc:function(n){_zz.E.prototype.cc.call(this,n);var t=window.top.document.getElementById("EditorBody");this.v=$(t);return n},p:function(n,t){this.d&&this.d.bC(!0);_zz.E.prototype.p.call(this,n,t)},bV:function(n,t){var u="<span id=medina-mark>​</span>";this.w(u);var i=this.a().find("#medina-mark");var r=i.position();n.val=r.left;t.val=r.top;i.remove()},dp:function(n){return!!n&&n.nodeType===1&&!_j.i.a(n.id)&&(n.id==="ms-rterangecursor-start"||n.id==="ms-rterangecursor-end")}};_zy.d=function(){};_zy.g=function(n,t,i,r,u,f){_zy.g.initializeBase(this,[n,t,i,r]);this.u=n;this.t=u;this.v=f};_zy.g.prototype={u:null,v:!1,t:null,A:function(n,t,i){return this.v?this.u.x(this.t.a)+"/"+n:this.k+n}};_zy.h=function(n,t,i,r,u,f,e,o,s,h,c){_zy.h.initializeBase(this,[n,t,i,u,f,e,o]);this.j=s;this.o=h;this.p=c};_zy.h.prototype={j:null,p:!1,o:null,f:function(n){var t;t=n.type==="Sprite"||n.type==="HighResolution"?"/images/0/"+n.name:"/styles/0/"+n.name;return this.p?this.j.w(this.o.a)+t:this.j.p()+t}};function RichTextEditorComponent(){}RichTextEditorComponent.$$cctor=function(){_a.u.a().a(RichTextEditorComponent)};RichTextEditorComponent.prototype={a:function(n,t,i){var r=this;n.b(_zy.e,function(){return new _zy.e(i.h())}).a()},b:function(){return null}};_zy.c=function(){};_zy.c.d=function(){return _fm.e.a("insertunorderedlist.png")};_zy.c.e=function(){return _fm.e.a("createlink.png")};_zy.c.f=function(){return _fm.e.a("forecolor.png")};_zy.c.s=function(){return _fm.e.a("removeformat.png")};_zy.c.a=function(){return _fm.e.a("backcolor.png")};_zy.c.h=function(){return _fm.e.a("indent.png")};_zy.c.i=function(){return _fm.e.a("insertorderedlist.png")};_zy.c.r=function(){return _fm.e.a("redo.png")};_zy.c.w=function(){return _fm.e.a("undo.png")};_zy.c.t=function(){return _fm.e.a("strikethrough.png")};_zy.c.g=function(){return _fm.e.a("alttext.png")};_zy.c.v=function(){return _fm.e.a("superscript.png")};_zy.c.u=function(){return _fm.e.a("subscript.png")};_zy.c.m=function(){return _fm.e.a("outdent.png")};_zy.c.b=function(){return _fm.e.a("blockdirltr.png")};_zy.c.c=function(){return _fm.e.a("blockdirrtl.png")};_zy.c.x=function(){return _fm.e.a("unlink.png")};_zy.c.j=function(){return _fm.e.a("justifycenter.png")};_zy.c.k=function(){return _fm.e.a("justifyleft.png")};_zy.c.l=function(){return _fm.e.a("justifyright.png")};_zy.c.n=function(){return _fm.e.a("pasteasis_20x20x32.png")};_zy.c.q=function(){return _fm.e.a("pasteplaintext_20x20x32.png")};_zy.c.o=function(){return _fm.e.a("pasteclean_20x20x32.png")};_zy.c.p=function(){return _fm.e.a("pasteoptions_16x16x4.png")};_zy.a=function(){};_zy.a.$$cctor=function(){_zy.a._I()};_zy.a.be=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span autoid=\"_zy_g\"></span> </div><div> <span autoid=\"_zy_h\"></span> </div><div> <ul class='_zy_i'> <li class='ms-font-m'> <span></span> <input autoid=\"_zy_j\" class='_zy_k'/> </li> </ul> </div><div> <ul class='_zy_i'> <li class='ms-font-m'> <input autoid=\"_zy_l\" class='_zy_l'/> </li> </ul> </div><div>  <div></div> </div><div> <div> <div autoid=\"_zy_m\" class='_zy_3 ms-bg-color-white'></div> </div> </div><div> <div class='_zy_4 border-color-transparent'></div> </div><div> <button autoid=\"_zy_n\" type='button'></button> </div><div> <div autoid=\"_zy_0\" class='_zy_7'> <div class='_zy_e'> <div autoid=\"_zy_1\" class='_zy_f'></div> </div> <div class='_zy_e'> <div autoid=\"_zy_2\" class='_zy_g'></div> </div> <div class='_zy_e'> <button autoid=\"_zy_3\" type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary _zy_9'></button> <button autoid=\"_zy_4\" type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary _zy_a'></button> <button autoid=\"_zy_5\" type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary _zy_b'></button> </div> <div class='_zy_e'> <button autoid=\"_zy_6\" type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> <button autoid=\"_zy_7\" type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_e'> <button type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> <button type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_e'> <button autoid=\"_zy_8\" type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> <button autoid=\"_zy_9\" type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_e'> <button type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_e'> <button type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> <button type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> <button type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_e'> <button autoid=\"_zy_a\" type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> <button type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_e'> <button type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> <button type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_e'> <button autoid=\"_zy_b\" type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> <button autoid=\"_zy_c\" type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_e'> <button type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> <button type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_e'> <button type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> <button type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary'></button> </div> </div> <button autoid=\"_zy_d\" type='button' class='_zy_8 border-color-transparent ms-font-color-neutralSecondary _zy_c'></button> <div class='_zy_d ms-bg-color-white'></div> <div autoid=\"_zy_e\" class='_zy_6'></div> <div class='ms-font-weight-regular ms-font-color-neutralPrimary ms-bg-color-themeLight ms-border-color-neutralTertiary'></div> <div autoid=\"_zy_f\"> <iframe></iframe> </div>   <div autoid=\"_zy_i\"></div>  <div autoid=\"_zy_k\"></div>    </div><div> <div></div> <div></div> </div>";_j.h.a().appendChild(n);return n};_zy.a.P=function(n){return n.W()};_zy.a.bZ=function(n){return n.gv};_zy.a.J=function(n){return n.b};_zy.a.bY=function(n){return n.hB};_zy.a.bs=function(n){return n.t};_zy.a.bj=function(n){return n.w()};_zy.a.bp=function(n){return n.p};_zy.a.j=function(n){return n.X};_zy.a.x=function(n){return _fce.m.isInstanceOfType(n)?n.l:null};_zy.a.y=function(n){return _fce.m.isInstanceOfType(n)?n.n:null};_zy.a.bu=function(n){return n.o};_zy.a.bz=function(n){return n.bD()};_zy.a.N=function(n){return n.u()};_zy.a.bx=function(n){return n.m};_zy.a.bh=function(n){return n.q};_zy.a.bw=function(n){return n.l};_zy.a.O=function(n){return n.d()};_zy.a.bq=function(n){return n.s};_zy.a.br=function(n){return n.v};_zy.a.cD=function(n){return n.bk};_zy.a.by=function(n){return n.b()};_zy.a.U=function(n){return n.je};_zy.a.bT=function(n){return n.pc()};_zy.a.bS=function(n){return n.eK};_zy.a.D=function(n){return n.b()};_zy.a.c=function(n){return n.iV};_zy.a.bV=function(n){return n.pd()};_zy.a.bU=function(n){return n.dC};_zy.a.bK=function(n){return n.oY()};_zy.a.cd=function(n){return n.hD};_zy.a.g=function(n){return n.q()};_zy.a.co=function(n){return n.pf()};_zy.a.cf=function(n){return n.hG};_zy.a.cA=function(n){return n.pG()};_zy.a.cn=function(n){return n.hJ};_zy.a.bL=function(n){return n.oZ()};_zy.a.ce=function(n){return n.hE};_zy.a.ct=function(n){return n.pk()};_zy.a.ci=function(n){return n.hH};_zy.a.bP=function(n){return n.pb()};_zy.a.T=function(n){return n.jd};_zy.a.bX=function(n){return n.pe()};_zy.a.m=function(n){return n.X};_zy.a.R=function(n){return _zy.b.isInstanceOfType(n)?n.hw():null};_zy.a.L=function(n){return n.q()};_zy.a.u=function(n){return n.j()};_zy.a.S=function(n){return _zy.b.isInstanceOfType(n)?n.hx():null};_zy.a.bO=function(n){return n.pa()};_zy.a.bH=function(n){return n.oV()};_zy.a.cb=function(n){return n.jb};_zy.a.bG=function(n){return n.oU()};_zy.a.ca=function(n){return n.ja};_zy.a.bI=function(n){return n.oW()};_zy.a.cc=function(n){return n.jc};_zy.a.bR=function(n){return n.nw};_zy.a.cq=function(n){return n.ph()};_zy.a.bQ=function(n){return n.le};_zy.a.cC=function(n){return n.pI()};_zy.a.cz=function(n){return n.pF()};_zy.a.cm=function(n){return n.jj};_zy.a.cy=function(n){return n.pE()};_zy.a.cl=function(n){return n.ji};_zy.a.cx=function(n){return n.pD()};_zy.a.ck=function(n){return n.jh};_zy.a.bJ=function(n){return n.oX()};_zy.a.bW=function(n){return n.hA};_zy.a.cp=function(n){return n.pg()};_zy.a.cg=function(n){return n.jf};_zy.a.cv=function(n){return n.pm()};_zy.a.cj=function(n){return n.jg};_zy.a.cB=function(n){return n.pH()};_zy.a.bN=function(n){return n.hu};_zy.a.cu=function(n){return n.pl()};_zy.a.bM=function(n){return n.ht};_zy.a.cw=function(n){return n.pC()};_zy.a.ch=function(n){return n.gx};_zy.a.s=function(n){return n.d()};_zy.a.cr=function(n){return _zy.b.isInstanceOfType(n)?n.pi():null};_zy.a.cs=function(n){return _zy.b.isInstanceOfType(n)?n.pj():null};_zy.a.bC=function(n){return n.cs};_zy.a.k=function(n){return n.dl()};_zy.a.Y=function(n){return n.p};_zy.a.ba=function(n){return n.w};_zy.a.V=function(n){return n.o};_zy.a.cX=function(n){return n.K};_zy.a.W=function(n){return n.x};_zy.a.X=function(n){return n.n};_zy.a.Z=function(n){return n.z};_zy.a.l=function(n){return n.dv()};_zy.a.bD=function(n){return n.a};_zy.a.bE=function(n){return n.e()};_zy.a.bF=function(n,t){n.a(t)};_zy.a.I=function(n,t){n.a(t)};_zy.a.cH=function(n,t){n.lo(t)};_zy.a.K=function(n,t){n.c(t)};_zy.a.cG=function(n,t){n.nO(t)};_zy.a.bt=function(n,t){n.n(t)};_zy.a.bl=function(n,t){n.be(t)};_zy.a.bk=function(n,t){n.bk(t)};_zy.a.q=function(n,t){n.k=t};_zy.a.bB=function(n,t){n.b(t)};_zy.a.b=function(n,t){n.bn(t)};_zy.a.bv=function(n,t){n.k(t)};_zy.a.bi=function(n,t){n.v(t)};_zy.a.e=function(n,t){n.bb(t)};_zy.a.bf=function(n,t){n.bc(t)};_zy.a.bg=function(n,t){n.b=t};_zy.a.F=function(n,t){n.c(t)};_zy.a.cE=function(n,t){n.qC(t)};_zy.a.G=function(n,t){n.d(t)};_zy.a.E=function(n,t){n.A(t)};_zy.a.cF=function(n,t){n.qD(t)};_zy.a.r=function(n,t){n.k(t)};_zy.a.cL=function(n,t){n.nP(t)};_zy.a.h=function(n,t){n.o(t)};_zy.a.d=function(n,t){n.A(t)};_zy.a.cN=function(n,t){n.nS(t)};_zy.a.cV=function(n,t){n.nU(t)};_zy.a.f=function(n,t){n.l(t)};_zy.a.cM=function(n,t){n.nQ(t)};_zy.a.cQ=function(n,t){n.nT(t)};_zy.a.w=function(n,t){n.c(t)};_zy.a.M=function(n,t){n.r(t)};_zy.a.v=function(n,t){n.i(t)};_zy.a.cJ=function(n,t){n.qK(t)};_zy.a.cI=function(n,t){n.qJ(t)};_zy.a.cK=function(n,t){n.qL(t)};_zy.a.n=function(n,t){n.p(t)};_zy.a.cU=function(n,t){n.qR(t)};_zy.a.cT=function(n,t){n.qQ(t)};_zy.a.cS=function(n,t){n.qP(t)};_zy.a.cO=function(n,t){n.qN(t)};_zy.a.cR=function(n,t){n.qO(t)};_zy.a.cP=function(n,t){n.bX(t)};_zy.a.t=function(n,t){n.a(t)};_zy.a.bn=function(n,t){n.a(t)};_zy.a.bo=function(n,t){n.b(t)};_zy.a.Q=function(n,t){n.ba(t)};_zy.a.bb=function(n,t){n.f(t)};_zy.a.B=function(n,t){n.l(t)};_zy.a.H=function(n,t){n.i(t)};_zy.a.bm=function(n,t){n.dW(t)};_zy.a.A=function(n,t){n.n(t)};_zy.a.z=function(n,t){n.j(t)};_zy.a.C=function(n,t){n.bC(t)};_zy.a.cW=function(n,t){n.dw(t)};_zy.a.bA=function(n,t){n.J(t)};_zy.a.bd=function(){_zy.a.p||(_zy.a.p=new _b.bF);return _zy.a.p};_zy.a.bc=function(){_zy.a.o||(_zy.a.o=new _fc.k);return _zy.a.o};_zy.a._I=function(){var e="RichTextEditorView.FontNameTemplate";new _j.d(e,function(){_zy.a.a[e]===undefined&&(_zy.a.a[e]=[[[-1,1,["DataContext"],[_zy.a.P],null,"Html",null,_zy.a.bF,1,_zy.a.bd(),'<span style="font-family:{0};">{0}</span>',null]]]);var n=_zy.a.i.childNodes[0].cloneNode(!0);var t=new _b.o(n.children[0],_j.b.Instance.a(_a.f));return new _j.a(n,[t])},"",String,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_zy.a.a);var f="RichTextEditorView.FontSizeTemplate";new _j.d(f,function(){_zy.a.a[f]===undefined&&(_zy.a.a[f]=[[[-1,1,["DataContext"],[_zy.a.P],null,"Text",null,_zy.a.I,1,null,null,null]]]);var n=_zy.a.i.childNodes[1].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",String,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_zy.a.a);var o="RichTextEditorView.InsertLinkDialogTemplate";new _j.d(o,function(){_zy.a.a[o]===undefined&&(_zy.a.a[o]=[[[-1,4,null,null,null,"Text",null,_zy.a.I,0,null,null,null,_nbs.a.Qs]],[[-1,0,["InsertLinkDialogUrl"],[_zy.a.bZ],_zy.a.cH,"Text",_zy.a.J,_zy.a.K,2,null,null,null]]]);var n=_zy.a.i.childNodes[2].cloneNode(!0);var t=new _fc.i(_j.a.a(n,[0,0,1]));t.f=!0;var i=new _fc.a(_j.a.a(n,[0,0,0]));return new _j.a(n,[i,t])},"",_zy.b,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_zy.a.a);var h="RichTextEditorView.InsertAltTextDialogTemplate";new _j.d(h,function(){_zy.a.a[h]===undefined&&(_zy.a.a[h]=[[[-1,0,["InsertAltTextDialogText"],[_zy.a.bY],_zy.a.cG,"Text",_zy.a.J,_zy.a.K,2,null,null,null]]]);var t=_zy.a.i.childNodes[3].cloneNode(!0);var n=new _fc.i(_j.a.a(t,[0,0,0]));n.f=!0;return new _j.a(t,[n])},"",_zy.b,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_zy.a.a);var s="RichTextEditorView.ColorGridMenuItemTemplate._tid4";new _j.d(s,function(){_zy.a.a[s]===undefined&&(_zy.a.a[s]=[null]);var t=_zy.a.i.childNodes[4].cloneNode(!0);var n=new _b.U(t.children[0]);n.c=2;n.i=5;n.j=66;n.g=166;n.f=!1;n.b=0;return new _j.a(t,[n]).l({ListPanel:n})},"",_fm.f,_fce.a,function(n){return new _fce.a(n,_j.b.Instance.a(_ff.a))},!1,!0,!1,0,_zy.a.a);var t="RichTextEditorView.ColorGridMenuItemTemplate";new _j.d(t,function(){_zy.a.a[t]===undefined&&(_zy.a.a[t]=[null,[[-1,0,["SelectedItem"],[_zy.a.bs],_zy.a.bt,"SelectedItem",_zy.a.bj,_zy.a.bl,2,null,null,null],[-1,0,["ContextMenuItems"],[_zy.a.bp],null,"DataSource",null,_zy.a.bk,1,null,null,null]]]);var f=_zy.a.i.childNodes[5].cloneNode(!0);var n=new _fce.a(_j.a.a(f,[0,0]),_j.b.Instance.a(_ff.a));n.t("ContextMenuView.GenericContextMenuItem");n.bc("div");var s=new _fc.g;var e=new _fc.c;e.V(_j.f.a(["ContextParent","ContextParent","DownArrowCommand"],[_zy.a.j,_zy.a.j,_zy.a.x],null,"Command",null,_zy.a.q,1));e.i("DOWNARROW");var i=new _fc.c;i.V(_j.f.a(["ContextParent","ContextParent","UpArrowCommand"],[_zy.a.j,_zy.a.j,_zy.a.y],null,"Command",null,_zy.a.q,1));i.i("UPARROW");var r=new _fc.c;r.V(_j.f.a(["ContextParent","ContextParent","DownArrowCommand"],[_zy.a.j,_zy.a.j,_zy.a.x],null,"Command",null,_zy.a.q,1));r.i("RIGHTARROW");var u=new _fc.c;u.V(_j.f.a(["ContextParent","ContextParent","UpArrowCommand"],[_zy.a.j,_zy.a.j,_zy.a.y],null,"Command",null,_zy.a.q,1));u.i("LEFTARROW");s.a([e,i,r,u]);n.D([s]);n.y("RichTextEditorView.ColorGridMenuItemTemplate._tid4");var o=new _j.h(f.children[0]);return new _j.a(f,[o,n]).l({PopupContent:o,MenuListView:n})},"",_fm.f,_fce.m,function(n){return new _fce.m(n,_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b),_j.b.Instance.a(String))},!1,!1,!1,0,_zy.a.a);var n="RichTextEditorView.ColorMenuItemTemplate._tid5";new _j.d(n,function(){_zy.a.a[n]===undefined&&(_zy.a.a[n]=[[[-1,0,["Value"],[_zy.a.bu],null,"ItemColor",null,_zy.a.bB,0,null,null,null],[-1,5,["IsHovered"],[_zy.a.bz],null,"ms-border-color-themeSecondary",null,null,1,null,null,null],[-1,5,["IsChecked"],[_zy.a.N],null,"colorSquareSelected",null,null,0,null,null,null]]]);var t=_zy.a.i.childNodes[6].cloneNode(!0);var i=new _b.bj(t.children[0]);return new _j.a(t,[i])},"",_fm.h,_fce.p,function(n){return new _fce.p(n,_j.b.Instance.a(_j.j))},!1,!0,!1,0,_zy.a.a);var i="RichTextEditorView.ColorMenuItemTemplate";new _j.d(i,function(){_zy.a.a[i]===undefined&&(_zy.a.a[i]=[[[-1,0,["Text"],[_zy.a.bx],null,"Title",null,_zy.a.b,1,null,null,null],[-1,0,["IsChecked"],[_zy.a.N],_zy.a.bv,"IsChecked",_zy.a.bh,_zy.a.bi,2,null,null,!1],[-1,0,["Command"],[_zy.a.bw],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,0,["ParentContextMenu","ContextMenuPopupCloseCommand"],[_zy.a.O,_zy.a.bq],null,"CloseMenuCommand",null,_zy.a.bf,1,null,null,null],[-1,0,["ParentContextMenu","ContextMenuPopupId"],[_zy.a.O,_zy.a.br],null,"ContextMenuPopupId",null,_zy.a.bg,1,null,null,0]]]);var t=_zy.a.i.childNodes[7].cloneNode(!0);var n=new _fce.p(t.children[0],_j.b.Instance.a(_j.j));n.a=!0;n.y("RichTextEditorView.ColorMenuItemTemplate._tid5");return new _j.a(t,[n])},"",_fm.h,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_zy.a.a);var u="RichTextEditorView";new _j.d(u,function(){_zy.a.a[u]===undefined&&(_zy.a.a[u]=[[[-1,5,["UserAgent","IsIOS"],[_zy.a.cD,_zy.a.by],null,"_zy_n",null,null,1,null,null,null],[-1,5,["IsFormatBarHidden"],[_zy.a.U],null,"_zy_m",null,null,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_nbs.a.fq],[-1,1,["FontNameOptions"],[_zy.a.bT],null,"Options",null,_zy.a.F,1,null,null,null],[-1,1,["FontName"],[_zy.a.bS],_zy.a.cE,"SelectedValue",_zy.a.D,_zy.a.G,2,null,null,null],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.E,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_nbs.a.WB],[-1,1,["FontSizeOptions"],[_zy.a.bV],null,"Options",null,_zy.a.F,1,null,null,null],[-1,1,["FontSize"],[_zy.a.bU],_zy.a.cF,"SelectedValue",_zy.a.D,_zy.a.G,2,null,null,null],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.E,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.Ju],[-1,4,null,null,null,"Text",null,_zy.a.r,0,null,null,null,_u.n.MF],[-1,1,["BoldCommand"],[_zy.a.bK],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["IsBoldApplied"],[_zy.a.cd],_zy.a.cL,"IsChecked",_zy.a.g,_zy.a.h,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.Iy],[-1,4,null,null,null,"Text",null,_zy.a.r,0,null,null,null,_u.n.HB],[-1,1,["ItalicCommand"],[_zy.a.co],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["IsItalicApplied"],[_zy.a.cf],_zy.a.cN,"IsChecked",_zy.a.g,_zy.a.h,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.I],[-1,4,null,null,null,"Text",null,_zy.a.r,0,null,null,null,_u.n.HH],[-1,1,["UnderlineCommand"],[_zy.a.cA],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["IsUnderlineApplied"],[_zy.a.cn],_zy.a.cV,"IsChecked",_zy.a.g,_zy.a.h,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.OM],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.d()],[-1,1,["BulletCommand"],[_zy.a.bL],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["IsBulletApplied"],[_zy.a.ce],_zy.a.cM,"IsChecked",_zy.a.g,_zy.a.h,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.MK],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.i()],[-1,1,["NumberCommand"],[_zy.a.ct],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["IsNumberApplied"],[_zy.a.ci],_zy.a.cQ,"IsChecked",_zy.a.g,_zy.a.h,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.u],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.m()],[-1,1,["DecreaseIndentCommand"],[_zy.a.bP],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0],[-1,5,["IsCultureRtl"],[_zy.a.T],null,"rtl",null,null,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.MD],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.h()],[-1,1,["IncreaseIndentCommand"],[_zy.a.bX],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0],[-1,5,["IsCultureRtl"],[_zy.a.T],null,"rtl",null,null,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.DU],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.a()],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.HG],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.f()],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.LH],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.s()],[-1,1,["ClearFormatCommand"],[_zy.a.bO],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.Iu],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.k()],[-1,1,["AlignLeftCommand"],[_zy.a.bH],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["IsAlignLeftApplied"],[_zy.a.cb],_zy.a.cJ,"IsChecked",_zy.a.g,_zy.a.h,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.SW],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.j()],[-1,1,["AlignCenterCommand"],[_zy.a.bG],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["IsAlignCenterApplied"],[_zy.a.ca],_zy.a.cI,"IsChecked",_zy.a.g,_zy.a.h,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.BQ],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.l()],[-1,1,["AlignRightCommand"],[_zy.a.bI],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["IsAlignRightApplied"],[_zy.a.cc],_zy.a.cK,"IsChecked",_zy.a.g,_zy.a.h,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.Oc],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.e()],[-1,1,["EnableCreateLink"],[_zy.a.bR],null,"IsEnabled",null,_zy.a.n,1,null,null,!1],[-1,1,["LinkCommand"],[_zy.a.cq],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.Ms],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.x()],[-1,1,["EnableBreakLink"],[_zy.a.bQ],null,"IsEnabled",null,_zy.a.n,1,null,null,!1],[-1,1,["UnLinkCommand"],[_zy.a.cC],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.Qc],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.v()],[-1,1,["SuperscriptCommand"],[_zy.a.cz],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["IsSuperscriptApplied"],[_zy.a.cm],_zy.a.cU,"IsChecked",_zy.a.g,_zy.a.h,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.Lx],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.u()],[-1,1,["SubscriptCommand"],[_zy.a.cy],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["IsSubscriptApplied"],[_zy.a.cl],_zy.a.cT,"IsChecked",_zy.a.g,_zy.a.h,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.RS],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.t()],[-1,1,["StrikeThroughCommand"],[_zy.a.cx],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["IsStrikeThroughApplied"],[_zy.a.ck],_zy.a.cS,"IsChecked",_zy.a.g,_zy.a.h,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_nbs.a.Si],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.g()],[-1,1,["AltTextCommand"],[_zy.a.bJ],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["ImageSelected"],[_zy.a.bW],null,"IsEnabled",null,_zy.a.n,1,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.OZ],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.b()],[-1,1,["LeftToRightCommand"],[_zy.a.cp],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["IsLeftToRightApplied"],[_zy.a.cg],_zy.a.cO,"IsChecked",_zy.a.g,_zy.a.h,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.Rz],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.c()],[-1,1,["RightToLeftCommand"],[_zy.a.cv],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["IsRightToLeftApplied"],[_zy.a.cj],_zy.a.cR,"IsChecked",_zy.a.g,_zy.a.h,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.R.JF],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.w()],[-1,1,["UndoCommand"],[_zy.a.cB],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["CanUndo"],[_zy.a.bN],null,"IsEnabled",null,_zy.a.n,1,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_u.n.Ir],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_zy.c.r()],[-1,1,["RedoCommand"],[_zy.a.cu],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["CanRedo"],[_zy.a.bM],null,"IsEnabled",null,_zy.a.n,1,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy.a.b,0,null,null,null,_nbs.a.SE],[-1,4,null,null,null,"ImageId",null,_zy.a.f,0,null,null,null,_b.j.a()],[-1,1,["ShowMoreButtonsCommand"],[_zy.a.cw],null,"ClickCommand",null,_zy.a.e,1,null,null,null],[-1,1,["FormatBarTabIndex"],[_zy.a.c],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0],[-1,5,["IsFormatBarHidden"],[_zy.a.U],null,"_zy_m",null,null,1,null,null,null]],[[-1,1,["IsMoreButtonsPopUpShown"],[_zy.a.ch],_zy.a.cP,"IsShown",_zy.a.s,_zy.a.t,2,null,null,!1]],[[-1,1,["EditorTabIndex"],[_zy.a.bC],null,"AriaTabIndex",null,_zy.a.d,1,null,null,0]],null,null,null,[[-1,1,["InsertLinkDialog"],[_zy.a.k],null,"DataContext",null,_zy.a.Q,1,null,null,null],[0,1,["InsertLinkDialog","IsShown"],[_zy.a.k,_zy.a.Y],_zy.a.bb,"IsShown",_zy.a.s,_zy.a.t,2,null,null,!1],[0,1,["InsertLinkDialog","Title"],[_zy.a.k,_zy.a.ba],null,"DialogTitle",null,_zy.a.B,1,null,null,null],[0,1,["InsertLinkDialog","CloseCommand"],[_zy.a.k,_zy.a.V],null,"CloseCommand",null,_zy.a.H,1,null,null,null],[0,1,["InsertLinkDialog","ConfirmCommand"],[_zy.a.k,_zy.a.cX],null,"ConfirmCommand",null,_zy.a.bm,1,null,null,null],[0,1,["InsertLinkDialog","ContentDataContext"],[_zy.a.k,_zy.a.W],null,"ContentDataContext",null,_zy.a.A,1,null,null,null],[0,1,["InsertLinkDialog","FooterButtons"],[_zy.a.k,_zy.a.X],null,"ButtonDataList",null,_zy.a.z,1,null,null,null],[0,1,["InsertLinkDialog","ParentProjectionWindow"],[_zy.a.k,_zy.a.Z],null,"ParentProjectionWindow",null,_zy.a.C,1,null,null,null]],[[-1,1,["InsertAltTextDialog"],[_zy.a.l],null,"DataContext",null,_zy.a.Q,1,null,null,null],[0,1,["InsertAltTextDialog","IsShown"],[_zy.a.l,_zy.a.Y],_zy.a.bb,"IsShown",_zy.a.s,_zy.a.t,2,null,null,!1],[0,1,["InsertAltTextDialog","Title"],[_zy.a.l,_zy.a.ba],null,"DialogTitle",null,_zy.a.B,1,null,null,null],[0,1,["InsertAltTextDialog","CloseCommand"],[_zy.a.l,_zy.a.V],null,"CloseCommand",null,_zy.a.H,1,null,null,null],[0,1,["InsertAltTextDialog","ContentDataContext"],[_zy.a.l,_zy.a.W],null,"ContentDataContext",null,_zy.a.A,1,null,null,null],[0,1,["InsertAltTextDialog","FooterButtons"],[_zy.a.l,_zy.a.X],null,"ButtonDataList",null,_zy.a.z,1,null,null,null],[0,1,["InsertAltTextDialog","ParentProjectionWindow"],[_zy.a.l,_zy.a.Z],null,"ParentProjectionWindow",null,_zy.a.C,1,null,null,null]]]);var n=_zy.a.i.childNodes[8].cloneNode(!0);var bt=new _fce.n(n.children[7],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));bt.c("RichTextEditorView.InsertAltTextDialogTemplate");var yt=new _fce.n(n.children[6],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));yt.c("RichTextEditorView.InsertLinkDialogTemplate");var ft=new _b.D(_j.a.a(n,[5,0]));ft.J(!0);var wt=new _j.h(n.children[5]);var d=new _j.h(n.children[4]);d.A(-1);d.J(!0);var at=new _j.h(n.children[3]);at.J(!0);var t=new _fce.l(n.children[2],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));t.f=!0;t.bU(!0);var pt=new _fce.F(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_ff.b));pt.V(_j.f.a(["TemplatedParent","MoreButtonsPopupXPosition"],[_zy.a.m,_zy.a.cr],null,"X",null,_zy.a.bn,1,null,null,0)).V(_j.f.a(["TemplatedParent","MoreButtonsPopupYPosition"],[_zy.a.m,_zy.a.cs],null,"Y",null,_zy.a.bo,1,null,null,0));t.b(pt);var g=new _fc.b(n.children[1]);g.d("ms-bg-color-themeLighter ms-border-color-themeSecondary");g.J(!0);var ct=new _fc.b(_j.a.a(n,[0,12,1]));ct.c("ms-border-color-themeSecondary");ct.g("_zy_h");var ht=new _fc.b(_j.a.a(n,[0,12,0]));ht.c("btnHovered ms-border-color-themeSecondary");ht.g("_zy_h");var k=new _fc.j(_j.a.a(n,[0,11,1]));k.r("ms-bg-color-themeLighter");k.bC("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");k.c("btnHovered ms-border-color-themeSecondary");var nt=new _fc.j(_j.a.a(n,[0,11,0]));nt.r("ms-bg-color-themeLighter");nt.bC("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");nt.c("btnHovered ms-border-color-themeSecondary");var rt=new _fc.b(_j.a.a(n,[0,10,1]));rt.c("ms-border-color-themeSecondary");rt.d("ms-bg-color-themeLighter ms-border-color-themeSecondary");rt.g("_zy_h");var tt=new _fc.j(_j.a.a(n,[0,10,0]));tt.r("ms-bg-color-themeLighter");tt.bC("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");tt.c("btnHovered ms-border-color-themeSecondary");var it=new _fc.j(_j.a.a(n,[0,9,1]));it.r("ms-bg-color-themeLighter");it.bC("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");it.c("btnHovered ms-border-color-themeSecondary");var c=new _fc.j(_j.a.a(n,[0,9,0]));c.r("ms-bg-color-themeLighter");c.bC("ms-bg-color-themeLighter ms-border-color-themeSecondary");c.c("ms-border-color-themeSecondary");var l=new _fc.b(_j.a.a(n,[0,8,1]));l.c("ms-border-color-themeSecondary");l.d("ms-bg-color-themeLighter ms-border-color-themeSecondary");l.g("_zy_h");var h=new _fc.b(_j.a.a(n,[0,8,0]));h.c("ms-border-color-themeSecondary");h.d("ms-bg-color-themeLighter ms-border-color-themeSecondary");h.g("_zy_h");var o=new _fc.j(_j.a.a(n,[0,7,2]));o.r("ms-bg-color-themeLighter");o.bC("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");o.c("btnHovered ms-border-color-themeSecondary");var s=new _fc.j(_j.a.a(n,[0,7,1]));s.r("ms-bg-color-themeLighter");s.bC("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");s.c("btnHovered ms-border-color-themeSecondary");var a=new _fc.j(_j.a.a(n,[0,7,0]));a.r("ms-bg-color-themeLighter");a.bC("ms-bg-color-themeLighter ms-border-color-themeSecondary");a.c("ms-border-color-themeSecondary");var lt=new _fc.b(_j.a.a(n,[0,6,0]));lt.c("ms-border-color-themeSecondary");lt.d("ms-bg-color-themeLighter ms-border-color-themeSecondary");var f=new _fc.b(_j.a.a(n,[0,5,1]));f.c("ms-border-color-themeSecondary");f.d("ms-bg-color-themeLighter ms-border-color-themeSecondary");var e=new _fce.f(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));e.V(_j.f.a(["TemplatedParent","ForeColorPicker"],[_zy.a.m,_zy.a.S],null,"MenuDataContext",null,_zy.a.w,1)).V(_j.f.a(["TemplatedParent","ForeColorPicker","IsShown"],[_zy.a.m,_zy.a.S,_zy.a.L],_zy.a.M,"IsShown",_zy.a.u,_zy.a.v,2,null,null,!1));e.m("RichTextEditorView.ColorGridMenuItemTemplate");e.a=3;e.b=1;f.D([e]);var r=new _fc.b(_j.a.a(n,[0,5,0]));r.c("ms-border-color-themeSecondary");r.d("ms-bg-color-themeLighter ms-border-color-themeSecondary");var i=new _fce.f(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));i.V(_j.f.a(["TemplatedParent","BackColorPicker"],[_zy.a.m,_zy.a.R],null,"MenuDataContext",null,_zy.a.w,1)).V(_j.f.a(["TemplatedParent","BackColorPicker","IsShown"],[_zy.a.m,_zy.a.R,_zy.a.L],_zy.a.M,"IsShown",_zy.a.u,_zy.a.v,2,null,null,!1));i.m("RichTextEditorView.ColorGridMenuItemTemplate");i.a=3;i.b=1;r.D([i]);var vt=new _fc.b(_j.a.a(n,[0,4,1]));vt.d("ms-bg-color-themeLighter ms-border-color-themeSecondary");vt.c("btnHovered ms-border-color-themeSecondary");var ut=new _fc.b(_j.a.a(n,[0,4,0]));ut.d("ms-bg-color-themeLighter ms-border-color-themeSecondary");ut.c("btnHovered ms-border-color-themeSecondary");var y=new _fc.j(_j.a.a(n,[0,3,1]));y.r("ms-bg-color-themeLighter");y.bC("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");y.c("btnHovered ms-border-color-themeSecondary");var v=new _fc.j(_j.a.a(n,[0,3,0]));v.r("ms-bg-color-themeLighter");v.bC("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");v.c("btnHovered ms-border-color-themeSecondary");var p=new _fc.j(_j.a.a(n,[0,2,2]));p.r("ms-bg-color-themeLighter");p.bC("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");p.c("btnHovered ms-border-color-themeSecondary");var b=new _fc.j(_j.a.a(n,[0,2,1]));b.r("ms-bg-color-themeLighter");b.bC("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");b.c("btnHovered ms-border-color-themeSecondary");var w=new _fc.j(_j.a.a(n,[0,2,0]));w.r("ms-bg-color-themeLighter");w.bC("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");w.c("btnHovered ms-border-color-themeSecondary");var st=new _fce.k(_j.a.a(n,[0,1,0]));st.a("RichTextEditorView.FontSizeTemplate");var ot=new _fce.k(_j.a.a(n,[0,0,0]));ot.a("RichTextEditorView.FontNameTemplate");var et=new _j.h(n.children[0]);et.J(!0);return new _j.a(n,[et,ot,st,w,b,p,v,y,ut,vt,r,f,lt,a,s,o,h,l,c,it,tt,rt,nt,k,ht,ct,g,t,at,d,wt,ft,yt,bt]).l({EditorFormatBar:et,FontNameOptions:ot,FontSizeOptions:st,HighLightColorOptions:r,ForeColorOptions:f,MoreDropDownButton:g,MoreButtonsPopup:t,ClickableArea:at,PasteModeMenuStyleElement:d,EditorWrapper:wt,EditorBody:ft})},"",_zy.b,_zy.b,function(n){return new _zy.b(n,_j.b.Instance.a(_a.x),_j.b.Instance.a(_g.a),_j.b.Instance.a(_b.f),_j.b.Instance.a(_a.bn),_j.b.Instance.a(InlineImageLoader),_j.b.Instance.a(_j.j),_j.b.Instance.a(_j.n),_j.b.Instance.a(_y.a),_j.b.Instance.a(_j.u),_j.b.Instance.a(_zy.e),_j.b.Instance.a(_a.f),_j.b.Instance.a(_h.o),_j.b.Instance.a(_zz.W),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b),_j.b.Instance.a(_b.d))},!1,!1,!1,0,_zy.a.a);var r="RTEWrapperView";new _j.d(r,function(){_zy.a.a[r]===undefined&&(_zy.a.a[r]=[null,[[-1,1,["InnerEditor"],[_zy.a.bD],null,"TextEditor",null,_zy.a.cW,1,null,null,null],[-1,1,["IsEntitySuggesterEnabled"],[_zy.a.bE],null,"IsHidden",null,_zy.a.bA,1,_zy.a.bc(),null,!0]]]);var t=_zy.a.i.childNodes[9].cloneNode(!0);var i=new _zy.f(t.children[1],_j.b.Instance.a(_j.cc.$$(IEntitySuggestionManager)),_j.b.Instance.a(_j.j),_j.b.Instance.a(_j.cc.$$(IFindRecipientAtMentionSuggestionViewModelFactory)),_j.b.Instance.a(_a.f));var n=new _zy.b(t.children[0],_j.b.Instance.a(_a.x),_j.b.Instance.a(_g.a),_j.b.Instance.a(_b.f),_j.b.Instance.a(_a.bn),_j.b.Instance.a(InlineImageLoader),_j.b.Instance.a(_j.j),_j.b.Instance.a(_j.n),_j.b.Instance.a(_y.a),_j.b.Instance.a(_j.u),_j.b.Instance.a(_zy.e),_j.b.Instance.a(_a.f),_j.b.Instance.a(_h.o),_j.b.Instance.a(_zz.W),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b),_j.b.Instance.a(_b.d));n.J(!0);return new _j.a(t,[n,i]).l({Editor:n})},"",_zz.bj,_zz.bj,function(n){return new _zz.bj(n,_j.b.Instance.a(_a.f))},!1,!1,!1,0,_zy.a.a)};_zy.e.registerClass("_zy.e");_zy.b.registerClass("_zy.b",_zz.i,_zz.cM);_zy.b.n.registerClass("_zy.b.n",_j.h);_zy.f.registerClass("_zy.f",_zz.E);_zy.g.registerClass("_zy.g",_a.ds);_zy.h.registerClass("_zy.h",_a.db);RichTextEditorComponent.registerClass("RichTextEditorComponent",null,_a.ib,_j.ce);_zy.b.i=new RegExp("(<style[^>]*>)[\\s]*p[\\s]*{[^}]*}","i");_zy.b.j=new RegExp("}[\\s]*p[\\s]*{[^}]*","gi");_zy.b.m=new RegExp("^\\s*<!--\\s*","i");_zy.b.l=new RegExp("\\s*-->\\s*$","i");_zy.b.d=new _a.e("ForeColorPicker",_b.N,_zy.b);_zy.b.b=new _a.e("BackColorPicker",_b.N,_zy.b);_zy.b.c=["OWAUnderLineID","OWAItalicID","OWAStrongID"];_zy.b.g=new _a.e("InsertLinkDialog",_bc.l,_zy.b);_zy.b.f=new _a.e("InsertAltTextDialog",_bc.l,_zy.b);_zy.b.k=[new StyleFileRecord("nbsprite1.mouse.css","Sprite"),new StyleFileRecord("sprite1.mouse.css","Sprite"),new StyleFileRecord("microsoft.owa.core.controls.editorbase.mouse.css","Standard"),new StyleFileRecord("microsoft.fabric.controls.extended.mouse.css","Standard")];_zy.b.h=["microsoftajax.js","ms.rte.js","rteinit.js"];_zy.b.a.a=null;_zy.d.d=["#757b80","#bd1398","#7232ad","#006fc9","#4ba524","#e2c501","#d05c12","#FF0000","#FFFFFF","#000000"];_zy.d.c=[_nbs.a.XX,_nbs.a.hL,_nbs.a.qF,_nbs.a.Sk,_nbs.a.GH,_nbs.a.DU,_nbs.a.Tb,_nbs.a.C,_nbs.a.hc,_nbs.a.dY];_zy.d.a=["#ffff00","#00ff00","#00ffff","#ff00ff","#0000ff","#ff0000","#bebebe","#666666","#FFFFFF","#000000"];_zy.d.b=[_nbs.a.DU,_nbs.a.GH,_nbs.a.FJ,_nbs.a.qF,_nbs.a.Sk,_nbs.a.C,_nbs.a.XX,_nbs.a.pY,_nbs.a.hc,_nbs.a.dY];RichTextEditorComponent.$$cctor();_zy.a.i=_zy.a.be();_zy.a.p=null;_zy.a.o=null;_zy.a.a={};_zy.a.$$cctor();
window.scriptsLoaded['microsoft.owa.core.controls.richtexteditor.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.controls.richtexteditor.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
