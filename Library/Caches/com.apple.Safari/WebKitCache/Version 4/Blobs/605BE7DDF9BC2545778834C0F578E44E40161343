try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.tagset.js'] = (new Date()).getTime();
Type.registerNamespace("_ts");_ts.f=function(n,t,i,r,u){_ts.f.initializeBase(this,[2]);this.u(n);this.bh=i;this.v="UpdateHashtags";this.be=r;this.m=u;this.g=t;this.bi=new _a.j(t)};_ts.f.b=function(n){return n.bW()};_ts.f.a=function(n){return n.cv()};_ts.f.d=function(n,t){n.hP(t)};_ts.f.c=function(n,t){n.eQ(t)};_ts.f.prototype={g:null,be:null,m:!1,bi:null,bh:null,c:null,K:function(){return this.W("V2015_10_15")},x:function(){for(var f=this.n.length,u=new Array(f),n=0;n<f;n++){this.c=_zz.d.K(this.g,this.bh);var e=this.bk();var i=this.n[n].bj.ItemId;var r=new _g.g(i.Id);r.ChangeKey=i.ChangeKey;var t=new _g.bq;t.ItemId=r;t.Updates=e;u[n]=t}return u},bd:function(n,t){_h.fb.prototype.bd.call(this,n,t);this.m&&this.be.c(this.g)},P:function(){_a.cT.prototype.P.call(this);_h.c.c(_g.h,_a.j,this.n,"Hashtags",_ts.f.b,this.bi,_ts.f.d);_h.c.c(_g.h,_a.j,this.n,"AppliedHashtags",_ts.f.a,this.c,_ts.f.c)},bk:function(){var i=this.c.b();var t=new _g.v(new _g.d("AppliedHashtags"));t.Item=new _g.G;t.Item.AppliedHashtags=new Array(i);for(var n=0;n<i;n++)t.Item.AppliedHashtags[n]=this.c.a(n);return[t]}};function TagSetComponent(){}TagSetComponent.$$cctor=function(){_a.u.a().a(TagSetComponent)};TagSetComponent.prototype={a:function(n,t,i){var e=this;n.b(_ts.g,function(){return new _ts.g(n.a(_j.j),n.a(_a.f))}).b(IEntitySuggestionManager).a();var o=this;n.b(IHashtagViewModelFactory,function(){return new _ts.r(n.a(IEntitySuggestionManager),n.a(_j.j),n.a(_a.f),n.a(_g.a),n.a(_a.x),n.d(IDeferredActionsFactory),n.d(IDeferredTypeLoader))});var f=this;n.b(IHashtagWellViewModelFactory,function(){return new _ts.s(n.a(_j.j),n.a(_y.p),n.a(IEntitySuggestionManager))});var r=this;n.b(IHashtagFirstRunHelper,function(){return new _ts.l(n.c(IIntroductionControllerFactory))}).b(IHashtagFirstRunHelper).a();var u=this;n.b(IEntityLinkHandler,function(){return new _ts.m(n.a(_j.j),n.a(IBasePersonaViewModelFactory))}).b(IEntityLinkHandler).a()},b:function(){return[]}};_ts.o=function(n){_ts.o.initializeBase(this);this.c=n};_ts.o.prototype={c:null,I:function(n){var t=new _dg.bn;t.Tag=this.c;t.AppName="Outlook";var i=new _dg.bC(this.K());i.Body=t;var r=new _dg.bR(200);n.dj(i,r,this.G,this.E)},cG:function(n){n.ResponseClass!=="Success"}};_ts.k=function(){_ts.k.initializeBase(this)};_ts.k.prototype={c:null,I:function(n){var t=new _dg.bG;t.IndexedPageItemView=new _g.F("Beginning");this.c&&(t.Context=this.c);var r=new _dg.ce(200);var i=new _dg.bF(this.K(),t);n.br(i,r,this.G,this.E)},cG:function(n){n.ResponseClass!=="Success"||!n.ResultSet}};_ts.p=function(n){_ts.p.initializeBase(this);this.c=n};_ts.p.prototype={c:null,I:function(n){var i=new _dg.bs;i.Tag=this.c;var r=new _dg.ct(200);var t=new _dg.bL(this.K());t.Body=i;n.ga(t,r,this.G,this.E)},cG:function(n){n.ResponseClass!=="Success"}};_ts.l=function(n){this.b=n};_ts.l.prototype={b:null,a:function(n){var t=this;this.b.a(function(t){var i=t.a(_nbs.a.jV,_nbs.a.IC,12,null,null,14);n(i)})}};_ts.m=function(n,t){this.d=n;this.c=t};_ts.m.prototype={d:null,c:null,b:function(n,t,i,r,u){return _zz.d.v(n,t,r,this.d,u,10)},a:function(n,t,i,r){if(this.e(n,t,i)){var o=t.indexOf("mailto:")+7;var s=t.substring(o,t.length);var f=new _g.f;f.MailboxType="Unknown";f.EmailAddress=s;f.RoutingType="SMTP";var h=_h.i.a(f);var u=this.c.a(h,4,!0,0,!1,!1);var e=new _j.h($("#"+n).get(0));r.cz(u);u.U(e);u.P();u.b(!0);u.s();u.U(e);return!0}return!1},e:function(n,t,i){return!_j.i.a(n)&&!_j.i.a(i)&&!_j.i.a(t)&&n.startsWith("OWAAM")&&t.startsWith("mailto:")&&i.startsWith("@")?!0:!1}};_ts.g=function(n,t){this.l=Function.createDelegate(this,this.u);this.m=Function.createDelegate(this,this.v);this.o=Function.createDelegate(this,this.x);this.n=Function.createDelegate(this,this.w);this.k=Function.createDelegate(this,this.q);_ts.g.initializeBase(this);t&&(this.i=t.a().eN().Enabled&&t.a().eK().Enabled);this.z();this.g||_j.o.a().c(_ts.g.a,"LoadHashtagLists",this.k)};_ts.g.prototype={i:!1,g:null,h:null,e:function(){return this.h},y:function(n){if(this.h!==n){this.h=n;this.et("PersonalHashtagsFromServer")}return n},z:function(){if(this.i){var t=_g.b.a.nameToId("tagitems");if(t){var n=new _g.M;n.NotificationType="RowNotification";n.FolderId=t.Id;var i=new _h.E(n);i.l(_ts.g.a,"EntitySuggestionManager",this.n,1)}}},w:function(n){n.EventType==="RowAdded"&&this.j()},a:function(n){if(this.g){for(var r=this.g.length,t=0;t<r;t++){var i=this.g[t];if(i.toLocaleLowerCase()===n.toLocaleLowerCase()){this.g[t]=n;return}}Array.insert(this.g,0,n)}},r:function(n){var f=[];if(this.g){var i=this.g;if(i&&i.length>0){for(var u=i,o=u.length,r=0;r<o;++r){var s=u[r];var t=s;t.startsWith("#")&&t.length>1&&(n||(t=t.substr(1)));f.push(t)}var e=new _ts.q(i.length);_a.r.c.a(e)}}return f},f:function(n){this.s(n);var t=new _ts.p(n);t.e(this.o);_a.g.a.a(t);_h.m.a(_a.a.W,"HashtagHide",7,1,null)},x:function(n){this.q()},d:function(){return 7},b:function(n,t,i){var r=this.r(t);var e=new _j.q;if(n){for(var s=n.toLowerCase(),o=0,u=0;u<r.length;u++)if(r[u].toLowerCase().indexOf(s)>-1){e.c(r[u]);o++;if(i>0&&o>=i)break}}else if(i>0)for(var f=0;f<r.length&&f<i;f++)e.c(r[f]);else e.h(r);return e.j()},c:function(n){if(!this.i){var r=n?n.length:0;if(r>0){for(var u=[],t=0;t<r;t++){var i=n[t];Array.contains(this.h,i)||Array.enqueue(u,i)}this.p(u)}}},q:function(){this.j();this.t()},p:function(n){if(!n.length){this.j();return}var r=Array.dequeue(n);var t=new _ts.o(r);var i=this;t.b(function(){i.p(n)});_a.g.a.a(t)},j:function(){var i=new _ts.k;var t,n;var r=[(t=new _gg.y,t.Key="AppName",t.Value="Outlook",t),(n=new _gg.y,n.Key="Scope",n.Value="Personal",n)];i.c=r;i.d(this.m);_a.g.a.a(i)},t:function(){var n=new _ts.k;n.d(this.l);_a.g.a.a(n)},u:function(n){var t=n;t.L&&t.L.Body&&t.L.Body.ResultSet&&(this.g=t.L.Body.ResultSet)},v:function(n){var t=n;t.L&&t.L.Body&&t.L.Body.ResultSet&&this.y(t.L.Body.ResultSet)},s:function(n){if(Array.contains(this.h,n)){Array.remove(this.h,n);this.et("PersonalHashtagsFromServer")}Array.contains(this.g,n)&&Array.remove(this.g,n)}};_ts.n=function(n){_ts.n.initializeBase(this);_j.s.b(n,"HashTagTreeViewModel");this.a=n};_ts.n.prototype={a:null,o:function(){return _u.n.GH},b:null,m:function(){return this.b},p:function(n){this.b=n;return n}};_ts.q=function(n){_ts.q.initializeBase(this,[1,"HashtagSuggestion"]);this.a.SuggestionCount=n};_ts.h=function(n,t,i,r,u,f){this.C=Function.createDelegate(this,this.P);_ts.h.initializeBase(this,[n,t,i,null,null,!1,r,u,null,null]);this.r=f;!f||this.s||this.h.bj.FolderId||this.w(!0)};_ts.h.prototype={r:!1,k:!1,I:function(){return null},w:function(n){if(this.k!==n){this.k=n;this.et("IsHidden")}return n},F:function(){return[]},z:function(){var n=[];Array.contains(_ts.c.a,this.h.bj.DisplayName)&&this.i.E||Array.add(n,new _fm.d(_nbs.a.CV,null,new _j.g(this.C,this.j())));return n},L:function(){_j.e.c(_a.a.W,"HashtagTreeNodeViewModel : Dragging hashtag is not supported")},P:function(){this.r&&this.w(!0);this.i.w&&this.i.w.Id===this.h.bj.FolderId.Id&&this.i.n.K.a();this.i.J.f(this.h.bj.DisplayName)}};_ts.c=function(n,t,i,r,u,f,e){this.U=Function.createDelegate(this,this.bw);this.Q=Function.createDelegate(this,this.be);this.m=new _j.k;this.r=new _j.k;_ts.c.initializeBase(this,[null,!1,t,i,u,f,e]);this.J=n;this.o=r;this.bc=new _fm.f(null);this.y=this.o.a().bj.IsHashtagTreeCollapsed;this.o.b().apcl("SystemCategoriesToShowInFolderPane",this.Q);this.J.apcl("PersonalHashtagsFromServer",this.Q);this.apcl("SelectedFolder",this.U)};_ts.c.b=function(n,t){var r=n.h.bj.DisplayName.toLowerCase();var i=t.h.bj.DisplayName.toLowerCase();return r.localeCompare(i)};_ts.c.prototype={o:null,y:!1,bc:null,T:null,K:null,z:null,bd:null,J:null,bv:function(){return this.y||this.bo()},bA:function(n){if(n!==this.y){this.y=n;this.bx();this.ex("IsHashtagTreeCollapsed","HashtagsRootNodeToolTip")}if(this.o.a().bj.IsHashtagTreeCollapsed!==n){this.o.a().cD(n);_h.f.a(this.o.a().v,_a.g.a)}return n},bu:function(){return this.y?_u.R.Ji:_u.R.Rs},bo:function(){return this.m.x.length?this.m.x.length===1?this.z.k:!1:!0},g:function(){this.be(null,null)},O:function(n){_j.e.c(_a.a.W,"HashtagTreeViewModel.OnFolderNodeDeleted is not implemented")},b:function(n){var t=null;t=this.bn(this.m,n);if(!t){t=this.bn(this.r,n);if(!t){var i=this.bp(n);this.z.h.f(n);this.z.h.h(new _g.bQ(i,"Hashtag",n));t=this.z;this.bd=n}}t.w(!1);this.q(t.h.bj.FolderId);this.ex("IsHashtagTreeEmpty","IsHashtagTreeCollapsed");return t.h},d:function(n){for(var r=!1,u=this.m.x.length,t=0;t<u;t++){var i=this.m.x[t].h;if(i&&i.bj.FolderId&&n.bj.FolderId&&n.bj.FolderId.Id===i.bj.FolderId.Id){this.q(n.bj.FolderId);r=!0;break}}!r&&this.K&&this.q(this.K.h.bj.FolderId)},bb:null,c:function(n){this.bb=n;return n},a:function(){this.T||(this.T=new _ts.n(this));return this.T},ew:function(){this.J.rpcl("PersonalHashtagsFromServer",this.Q);this.rpcl("SelectedFolder",this.U);this.m.dispose();this.r.dispose();_y.gt.prototype.ew.call(this)},bn:function(n,t){for(var u=null,e=n.x.length,o=t.toLocaleLowerCase(),i=0;i<e;i++){var r=n.x[i];var f=r.h.bj.DisplayName;if(f&&f.toLocaleLowerCase()===o){u=r;break}}return u},be:function(n,t){this.br();this.bz()},br:function(){for(var i=this.m.x.length,t=0;t<i;t++)this.m.x[t].dispose();this.m.f();i=this.r.x.length;for(var n=0;n<i;n++)this.r.x[n].dispose();this.r.f()},bz:function(){var n=new _j.q;var s=this.J.e();if(this.E){n.h(_ts.c.a);if(s)for(var c=s,v=c.length,o=0;o<v;++o){var l=c[o];this.bt(n.j(),l)||n.c(l)}}else n.h(s);var a=n?n.d.length:0;var u=0;var r=[];if(a>0){for(var t=new _j.q,e=0;e<a;e++){var h=n.d[e];_j.i.a(h)?_j.e.b(_a.a.W,"[HashtagTreeViewModel] Hashtag name cannot be null"):t.c(this.bf(h,!1))}var i=t.j();if(this.E)this.m.m(i);else{u=t.d.length;var y=Math.min(u,5);Array.addRange(r,i.slice(0,y));t.k(_ts.c.b);i=t.j();this.r.m(i)}}r.push(this.bq());if(!this.E&&u>5){var f=new _g.u;f.h(new _g.l("MoreHashtags"));f.f(_u.R.MH);this.K=new _ts.t(f,this,this.o,this.D,this.t);r.push(this.K)}this.m.m(r);this.ex("IsHashtagTreeEmpty","IsHashtagTreeCollapsed")},bq:function(){this.z=this.bf(this.bd,!0);return this.z},bf:function(n,t){var i=this.bs(n,t);return new _ts.h(i,this,this.o,this.D,this.t,t)},bp:function(n){var i="Hashtag".toLowerCase();return i+"#"+n.substr(1)},bs:function(n,t){var i=new _g.i;i.v(_g.b.a.nameToId("msgfolderroot"));if(t&&!_j.i.a(n)||!t){var r=this.bp(n);i.h(new _g.bQ(r,"Hashtag",n));i.f(n)}return i},bw:function(n,t){_zz.d.o(7,0)},bx:function(){var n=new _a.o;n.c("expand",!this.y);_h.m.a(_a.a.W,"HashtagTreeExpand",7,1,n)},bt:function(n,t){for(var r=n,f=r.length,i=0;i<f;++i){var u=r[i];if(u.toLocaleLowerCase()===t.toLocaleLowerCase())return!0}return!1}};_ts.r=function(n,t,i,r,u,f,e){this.e=n;this.f=t;this.g=i;this.h=r;this.b=u;this.c=f;this.d=e};_ts.r.prototype={e:null,f:null,g:null,h:null,b:null,c:null,d:null,a:function(){return new _ts.c(this.e,this.f,this.g,this.h,this.b,this.c,this.d)}};_ts.s=function(n,t,i){this.d=n;this.e=t;this.c=i};_ts.s.prototype={d:null,e:null,c:null,a:function(n){return new _ts.e(n,this.d,this.e)},b:function(n,t,i,r){return new _ts.f(n,t,i,this.c,r)}};_ts.t=function(n,t,i,r,u){_ts.t.initializeBase(this,[n,t,i,r,u,!1])};_ts.t.prototype={I:function(){return this.i.bb},bb:function(){return!0},z:function(){return[]}};_ts.e=function(n,t,i){this.p=Function.createDelegate(this,this.r);this.q=Function.createDelegate(this,this.s);_ts.e.initializeBase(this);this.h=n;this.k=t;this.j=i;this.n=new _j.g(this.q,_ts.e.a);this.o=new _j.g(this.p,_ts.e.a)};_ts.e.prototype={k:null,j:null,h:null,i:!1,m:!1,l:null,a:function(){return this.h},d:function(){return"IsDeleted"},b:function(){return this.i},c:function(n){if(this.i!==n){this.i=n;this.et("IsDeleted")}return n},e:function(){return this.m},f:function(n){if(this.m!==n){this.m=n;this.et("IsNew")}return n},g:function(n){this.l=n;return n},n:null,o:null,s:function(){var n=0;if(this.j&&this.j.a()){var t=this.j.a();if(t.d){n=8;_zz.d.p(n,this.h,this.k)}else if(t.a){n=this.j.a().a;_zz.d.p(n,this.h,this.k)}else _zz.d.E(this.h,this.k,8)}},r:function(){this.c(!0);this.l&&this.l();_h.m.a(_a.a.W,"HashtagRemove",7,1,null)}};_ts.i=function(){};_ts.i.a=function(){return _fm.b.a(_fm.a.c,"ms-fcl-ns-b",_fm.WebfontSizes.a.t)};_ts.i.b=function(){return _fm.b.a(_fm.a.c,"ms-fcl-nd-b",_fm.WebfontSizes.a.t)};_ts.i.c=function(){return _fm.b.a(_fm.a.a,"ms-fcl-w-b",_fm.WebfontSizes.a.f)};_ts.j=function(n){_ts.j.initializeBase(this,[n])};_ts.j.prototype={a:function(){return this.e()?_ts.i.c():_y.e.e()},u:function(){this.bq("CloseButtonImageId");_fce.e.prototype.u.call(this)}};_ts.d=function(n,t){this.c=Function.createDelegate(this,this.g);this.d=Function.createDelegate(this,this.h);_ts.d.initializeBase(this,[n,t]);this.y("TagListView")};_ts.d.prototype={b:!1,i:function(n){if(this.b!==n){n||this.be(null);this.b=n;this.bq("IsInEditMode")}return n},by:function(){var i=new _fc.c;i.i("LEFTARROW");i.j=0;i.k=new _j.g(this.ma,_ts.d.a);i.n=!0;var r=new _fc.c;r.i("RIGHTARROW");r.j=0;r.k=new _j.g(this.lZ,_ts.d.a);r.n=!0;var n=new _fc.c;n.i("DELETE");n.j=0;n.k=new _j.g(this.d,_ts.d.a);n.n=!0;var t=new _fc.c;t.i("BACKSPACE");t.j=0;t.k=new _j.g(this.c,_ts.d.a);t.n=!0;var u=new _fc.g;u.a([i,r,n,t]);return[u]},eQ:function(){this.a(3,!1)},eR:function(){this.a(2,!1)},f:function(n){return this.a(2,!0)},a:function(n,t){var i=this.e(n);i===-1&&n===2&&t&&(i=this.e(3));if(i!==-1&&i!==this.et())this.be(this.v().c(i));else{this.be(null);this.bq(_ts.b.b)}return i},e:function(n){var r=this.dn();var i=0;switch(n){case 3:i=1;break;case 2:r===-1&&(r=this.et());i=-1;break;default:return-1}for(var t=r+i,u=!1;t>=0&&t<this.et()&&(u=this.v().c(t).b());)t+=i;return u?-1:t},g:function(){this.w()&&this.w().c(!0);this.a(2,!0)},h:function(){this.w()&&this.w().c(!0);this.a(3,!1)}};_ts.b=function(n,t,i,r){this.bW=Function.createDelegate(this,this.cu);this.q=Function.createDelegate(this,this.cH);this.bR=Function.createDelegate(this,this.cr);this.bX=Function.createDelegate(this,this.cy);this.bc=Function.createDelegate(this,this.cp);this.bw=Function.createDelegate(this,this.cn);this.bk=Function.createDelegate(this,this.cD);this.bg=Function.createDelegate(this,this.cC);this.bv=Function.createDelegate(this,this.cN);this.bd=Function.createDelegate(this,this.cx);this.bV=Function.createDelegate(this,this.ct);this.bU=Function.createDelegate(this,this.ca);this.bo=Function.createDelegate(this,this.cE);this.be=Function.createDelegate(this,this.cb);this.bY=Function.createDelegate(this,this.cz);_ts.b.initializeBase(this,[n]);this.y("TagSetContainer");this.l=t;this.s=r;this.r=i;this.bA=new _j.g(this.bY,_ts.b.a);this.bZ=new _j.g(this.be,_ts.b.a);this.bC=new _j.g(this.bo,_ts.b.a);this.bL=new _j.g(this.bU,_ts.b.a);this.bM=new _j.g(this.bV,_ts.b.a);this.u(!0);this.bi(5);this.w=!1;this.cw()};_ts.b.prototype={l:null,e:!1,w:!1,x:!1,i:"",p:null,t:!1,r:null,v:!1,f:null,s:null,b:null,o:null,k:!1,h:null,cM:function(n){if(this.f!==n){this.f=n;this.bq("IntroductionController")}return n},cj:function(n){if(this.v!==n){this.v=n;this.bq("ShouldShowIntroductionPeek")}return n},bA:null,bC:null,bL:null,bZ:null,bM:null,u:function(n){if(this.t!==n){this.t=n;n?this.r.b(IAddHashtagEvent,this.bd):this.r.c(IAddHashtagEvent,this.bd);this.bq("IsTextboxFocused")}return n},cL:function(n){if(this.e!==n){n&&this.j(!1);this.e=n;this.bt("InEditMode","IsInEditOrPopOutMode")}return n},ct:function(){this.g().text()===""&&this.a().x.length>0&&this.ca()},cs:function(){return this.e||this.W().M()},cl:function(n){this.w=n;this.bq("ShowAddTag");return n},m:function(n){this.i=n;this.bq("HashtagsText");return n},a:function(){this.p||(this.p=new _j.k);return this.p},bP:function(n){this.co(n);this.bq("TagCollection");return n},g:function(){var n=this.C.a("HashtagsTextBox");return $(n?n.z:null)},d:function(){return this.W()},c:function(){return this.d()&&this.d().g()?this.d().g().c():null},I:function(){_j.c.prototype.I.call(this);this.b=this.C.a("TextInputEntitySuggester");this.h=this.C.a("TagListView");this.h.apcl(_ts.b.b,this.bv);if(this.b){_j.l.f(this.b.z);this.X.X.z.appendChild(this.b.z)}},bs:function(){this.cb();_j.bl.prototype.bs.call(this);if(this.d()){this.d().rpcl("EditHashtags",this.bg);this.c()&&this.c().rpcl("ReadingPaneListViewTransitionState",this.bk);this.d().rpcl("TagList",this.bw)}},Z:function(){_j.h.prototype.Z.call(this);if(this.d()){this.c()&&this.c().apcl("ReadingPaneListViewTransitionState",this.bk);this.d().apcl("EditHashtags",this.bg);this.d().apcl("TagList",this.bw);this.cn(null,null)}else this.bP(new _j.k)},cn:function(n,t){this.bP(this.d().cw())},G:function(){_j.c.prototype.G.call(this);this.o=this.C.a("ShareHashtagsButton");this.j(!1)},br:function(){this.cB(5);this.h.rpcl(_ts.b.b,this.bv);var n;_a.i.a(n={val:this.b}),this.b=n.val;this.u(!1);this.f&&this.f.d(this.bc);_j.c.prototype.br.call(this)},by:function(){var t=new _fc.c;t.i("ESC");t.j=0;t.k=new _j.g(this.be,_ts.b.a);var n=new _fc.c;n.i("ENTER");n.j=0;n.k=new _j.g(this.bo,_ts.b.a);var i=new _fc.g;i.a([t,n]);return[i]},M:function(){_j.c.prototype.M.call(this);this.n(!1);this.j(!1)},cJ:function(n){this.cc(!0);_j.h.prototype.cJ.call(this,n)},ck:function(n){this.cc(!1);_j.h.prototype.ck.call(this,n)},bK:function(n){if(this.e){n.c();this.g().focus();this.i!==""&&this.i.charAt(0).toString()==="#"&&this.b.o().a()}},cC:function(n,t){this.n(!0)},cc:function(n){this.e||this.cl(n&&!!this.a().x.length)},cx:function(n){if(this.e){for(var i=this.a().x.length-1;i>=0;i--){var r=this.p.x[i];if(!r.b()&&!r.a().localeCompare(n.a())){this.bN();return}}var t=this.l.a(n.a());t.f(!0);t.g(this.bX);this.a().a(t);this.bN();this.j(!0)}},j:function(n){this.o&&this.o.p(n)},ca:function(){this.u(!1);var n=this.a().x.length;if(n>0){var t=this.h.f(this.a().x[n-1]);t!==-1&&this.h.S()}},cD:function(n,t){if(this.c()&&!this.c().a&&this.b)if(this.c().b&&this.c().f===1&&this.k){this.k=!1;_j.o.a().c(_a.a.W,"TagSetContainer:SetFocusOnTagWell",this.bR)}else this.c().b||this.b.g()},cr:function(){this.g().focus();this.b.o().a()},ci:function(){var n=[];var t=this;this.a().p(function(i){var r=i;r.c(!1);r.e()&&n.push(r);r.rpcl(r.d(),t.q)});this.cf(n)},cH:function(n,t){this.j(!0)},cz:function(){this.cl(!1);this.n(!0)},n:function(n){this.cL(n);var t=this;this.a().p(function(i){var r=i;n&&r.apcl(r.d(),t.q)});if(n){this.g().css("display","");this.bN()}else this.ce(!1)},bN:function(){this.m("");this.g().focus();this.m("#");this.ce(this.e)},ce:function(n){this.k=!1;this.b&&(n?this.c()&&!this.c().a&&this.c().f!==1?this.k=!0:this.b.o().a():this.b.g())},cb:function(){this.m("");this.ci();this.n(!1);!this.a().x.length&&this.d()&&this.d().bz(!1)},cE:function(){if(this.o.t()){var f=[];var n=[];var i=new _j.k;n.push(this.i);for(var u=0;u<3;u++)n=this.cO(n," ,;".charAt(u));this.cI(n);var o=this;this.a().p(function(n){var t=n;if(t.b())f.push(t);else{i.a(o.l.a(t.a()));t.e()&&t.f(!1)}});this.cf(f);for(var r=0;r<n.length;r++){var t=n[r];if(_zz.w.a(t,!1)){t.charAt(0)!=="#"&&(t="#"+t);var e=this.l.a(t);i.a(e)}}this.bP(i);this.ci();this.W().cC(i);this.m("");this.n(!1);this.a().x.length>0&&this.cP();_h.m.a(_a.a.W,"HashtagCreate",8,0,null)}},cf:function(n){for(var i=0;i<n.length;i++){var t=n[i];this.a().n(t,!0);t.rpcl("IsDeleted",this.q);t.dispose()}},cu:function(n,t){if(n&&t&&!String.isInstanceOfType(n)&&!_ts.e.isInstanceOfType(t))return!1;var r=n.toString().toLowerCase();var i=t.h.substr(1).toLowerCase();return!r.localeCompare(i)&&!t.i?!0:!1},co:function(n){this.a().f();if(n){var t=this;n.p(function(n){t.a().a(n)})}},cO:function(n,t){for(var r=[],u=n.length,i=0;i<u;i++)r.push.apply(r,n[i].split(t));return r},cI:function(n){for(var i=[],f=n.length,t=0;t<f;t++){for(var e=n[t].toString().toLowerCase(),r=t+1;r<f;r++){var o=n[r].toString().toLowerCase();e.localeCompare(o)||i.push(n[t])}this.a().w(e,this.bW)&&i.push(n[t])}for(var u=0;u<i.length;u++)Array.remove(n,i[u])},cw:function(){if(this.s){var n=this;this.s.a(function(t){n.cM(t);n.x=!0;n.f.c(n.bc)})}},cP:function(){if(this.x&&_y.Q.b(14)){this.cj(!0);var n=this;_j.o.a().a(this.F(),"TryShowIntroductionPopup",function(){n.f.e();n.x=!1},1e3)}},cp:function(){this.cj(!1)},cN:function(n,t){this.a().x.length&&this.h.w()||this.g().focus()},cy:function(){this.b.o().a()}};_ts.a=function(){};_ts.a.$$cctor=function(){_ts.a._I()};_ts.a.R=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div class='_ts_5'></div>  </div><div> <div class='_ts_6'> <button type='button' class='_ts_7'></button> <button type='button' class='_ts_9 ms-font-weight-semibold'></button> </div> </div><div><div></div></div><div> <div class='_ts_2 ms-border-color-neutralLight'> <div class='_ts_4'> <div class='_ts_5 ms-border-color-neutralLight'></div> <div class='_ts_e'> <input autoid=\"_ts_0\" class='_ts_b ms-font-m'/> <div></div> </div> </div> <button autoid=\"_ts_1\" type='button' class='_ts_a'></button> <div class='_ts_d'> <button autoid=\"_ts_2\" type='button' class='ms-font-s ms-font-weight-semibold _ts_c'></button> </div> </div>  </div><div> <div></div> </div><div>  <div></div> <div></div>  </div><div>  <div></div> <div class='_ts_f'> <div></div> </div>  </div><div>  <div tabindex=\"0\" class='_ts_g'>  <span role=\"tree\" class='_ts_h _ts_j'> <span> <button type='button' class='_ts_k ms-font-weight-regular'></button> </span> <span class='_ts_l ms-font-weight-semilight ms-font-l'></span> </span> </div> <div></div> </div><div> <div class='_ts_r'>  <div class='_ts_m _ts_n border-color-transparent'> <div class='_ts_o'> <span class='_ts_p ms-font-m ms-fwt-sl'></span>  <button type='button' class='_ts_s ms-font-weight-regular ms-font-color-neutralSecondary'></button> </div> </div> </div> </div><div>  <div class='_ts_t'> </div> <div></div> </div>";_j.h.a().appendChild(n);return n};_ts.a.bx=function(n){return n.i};_ts.a.E=function(n){return n.X};_ts.a.bF=function(n){return _ts.b.isInstanceOfType(n)?n.cs():null};_ts.a.T=function(n){return n.e()};_ts.a.by=function(n){return n.h};_ts.a.bv=function(n){return n.n};_ts.a.U=function(n){return n.c};_ts.a.bA=function(n){return _ts.d.isInstanceOfType(n)?n.b:null};_ts.a.bw=function(n){return n.o};_ts.a.bz=function(n){return n.a()};_ts.a.l=function(n){return n.e};_ts.a.bK=function(n){return n.a()};_ts.a.bD=function(n){return n.i};_ts.a.W=function(n){return n.b};_ts.a.bL=function(n){return n.bL};_ts.a.bM=function(n){return n.bM};_ts.a.bG=function(n){return n.t};_ts.a.V=function(n){return n.j};_ts.a.bE=function(n){return n.g()};_ts.a.bJ=function(n){return n.w};_ts.a.bC=function(n){return n.bA};_ts.a.bH=function(n){return n.bC};_ts.a.b=function(n){return n.X};_ts.a.bI=function(n){return _ts.b.isInstanceOfType(n)?n.v:null};_ts.a.G=function(n){return _ts.b.isInstanceOfType(n)?n.f:null};_ts.a.L=function(n){return n.b()};_ts.a.bS=function(n){return n.b()};_ts.a.bj=function(n){return n.j()};_ts.a.bf=function(n){return _j.h.isInstanceOfType(n)?n.z:null};_ts.a.bt=function(n){return n.r};_ts.a.t=function(n){return n.c()};_ts.a.v=function(n){return _n.c.isInstanceOfType(n)?n.bA:null};_ts.a.u=function(n){return _n.c.isInstanceOfType(n)?n.bw:null};_ts.a.f=function(n){return _n.c.isInstanceOfType(n)?n.bv:null};_ts.a.p=function(n){return n.a};_ts.a.J=function(n){return n.p};_ts.a.N=function(n){return n.f};_ts.a.I=function(n){return n.v};_ts.a.s=function(n){return n.h};_ts.a.m=function(n){return n.bj.DisplayName};_ts.a.r=function(n){return n.n};_ts.a.o=function(n){return n.q()};_ts.a.bQ=function(n){return n.y};_ts.a.bo=function(n){return n.I()};_ts.a.bP=function(n){return n.s};_ts.a.bW=function(n){return n.d()};_ts.a.bX=function(n){return n.f()};_ts.a.F=function(n){return n.bc};_ts.a.z=function(n){return n.j()};_ts.a.q=function(n){return n.bv()};_ts.a.br=function(n){return n.bu()};_ts.a.bq=function(n){return n.m};_ts.a.bp=function(n){return n.k};_ts.a.bU=function(n){return n.es()};_ts.a.H=function(n){return n.bb()};_ts.a.ca=function(n){return n.c()};_ts.a.bs=function(n){return n.bo()};_ts.a.bZ=function(n){return _n.c.isInstanceOfType(n)?n.be:null};_ts.a.bY=function(n){return _n.c.isInstanceOfType(n)?n.bo:null};_ts.a.bd=function(n){return n.W()};_ts.a.bV=function(n){return n.a};_ts.a.bR=function(n){return n.x};_ts.a.e=function(n,t){n.J(t)};_ts.a.y=function(n,t){n.k(t)};_ts.a.i=function(n,t){n.bb(t)};_ts.a.j=function(n,t){n.l(t)};_ts.a.bB=function(n,t){n.i(t)};_ts.a.S=function(n,t){n.bk(t)};_ts.a.bN=function(n,t){n.m(t)};_ts.a.Y=function(n,t){n.c(t)};_ts.a.bl=function(n,t){n.dl(t)};_ts.a.bm=function(n,t){n.dH(t)};_ts.a.bO=function(n,t){n.u(t)};_ts.a.X=function(n,t){n.o(t)};_ts.a.bn=function(n,t){n.n(t)};_ts.a.n=function(n,t){n.m(t)};_ts.a.k=function(n,t){n.bn(t)};_ts.a.bi=function(n,t){n.c(t)};_ts.a.bh=function(n,t){n.g(t)};_ts.a.bT=function(n,t){n.a(t)};_ts.a.bk=function(n,t){n.i(t)};_ts.a.bg=function(n,t){n.d(t)};_ts.a.M=function(n,t){n.e(t)};_ts.a.w=function(n,t){n.bL(t)};_ts.a.d=function(n,t){n.k=t};_ts.a.P=function(n,t){n.h(t)};_ts.a.K=function(n,t){n.C(t)};_ts.a.Q=function(n,t){n.g(t)};_ts.a.O=function(n,t){n.j(t)};_ts.a.ci=function(n,t){n.cr(t)};_ts.a.cb=function(n,t){n.bY(t)};_ts.a.cd=function(n,t){n.da(t)};_ts.a.cc=function(n,t){n.dM(t)};_ts.a.cf=function(n,t){n.v(t)};_ts.a.cg=function(n,t){n.bP(t)};_ts.a.ch=function(n,t){n.bR(t)};_ts.a.B=function(n,t){n.c(t)};_ts.a.D=function(n,t){n.r(t)};_ts.a.A=function(n,t){n.i(t)};_ts.a.x=function(n,t){n.s(t)};_ts.a.bb=function(n,t){n.o(t)};_ts.a.Z=function(n,t){n.v(t)};_ts.a.bc=function(n,t){n.bR(t)};_ts.a.ba=function(n,t){n.bc(t)};_ts.a.C=function(n,t){n.a(t)};_ts.a.bu=function(n,t){n.bA(t)};_ts.a.ce=function(n,t){n.s(t)};_ts.a.cj=function(n,t){n.a=t};_ts.a.be=function(n,t){n.ba(t)};_ts.a.h=function(){_ts.a.g||(_ts.a.g=new _fc.k);return _ts.a.g};_ts.a._I=function(){var i="TagSetContainer._tid1";new _j.d(i,function(){_ts.a.a[i]===undefined&&(_ts.a.a[i]=[null]);var t=_ts.a.c.childNodes[0].cloneNode(!0);var n=new _fce.d(t.children[0]);return new _j.a(t,[n]).l({ListPanel:n})},"",_y.Z,_ts.d,function(n){return new _ts.d(n,_j.b.Instance.a(_ff.a))},!1,!0,!1,0,_ts.a.a);var r="TagSetContainer.TagListItemView";new _j.d(r,function(){_ts.a.a[r]===undefined&&(_ts.a.a[r]=[[[-1,0,["IsDeleted"],[_ts.a.bx],null,"IsHidden",null,_ts.a.e,1,null,null,!0],[-1,5,["TemplatedParent","TemplatedParent","IsInEditOrPopOutMode"],[_ts.a.E,_ts.a.E,_ts.a.bF],null,"_ts_8",null,null,1,null,null,null],[-1,5,["IsSelected"],[_ts.a.T],null,"ms-bg-color-themePrimary ms-font-color-white:ms-bg-color-neutralLighter ms-font-color-neutralPrimary",null,null,1,null,null,null]],[[-1,0,["Name"],[_ts.a.by],null,"Text",null,_ts.a.y,1,null,null,null],[-1,0,["ClickCommand"],[_ts.a.bv],null,"ClickCommand",null,_ts.a.i,1,null,null,null],[-1,5,["ListView","IsInEditMode"],[_ts.a.U,_ts.a.bA],null,"ms-font-weight-semibold:ms-font-weight-regular",null,null,1,null,null,null]],[[-1,1,["CloseButtonImageId"],[_ts.a.bz],null,"ImageId",null,_ts.a.j,1,null,null,null],[-1,0,["DeleteCommand"],[_ts.a.bw],null,"ClickCommand",null,_ts.a.i,1,null,null,null]]]);var n=_ts.a.c.childNodes[1].cloneNode(!0);var u=new _fc.b(_j.a.a(n,[0,1]));u.c("ms-bg-color-neutralTertiaryAlt");var t=new _fc.b(_j.a.a(n,[0,0]));t.d("ms-font-color-white ms-bg-color-themePrimary");t.c("ms-bg-color-neutralLight");var i=new _j.h(n.children[0]);i.A(-1);return new _j.a(n,[i,t,u])},"",_ts.e,_ts.j,function(n){return new _ts.j(n)},!1,!1,!1,0,_ts.a.a);var n="TagSetContainer";new _j.d(n,function(){_ts.a.a[n]===undefined&&(_ts.a.a[n]=[[[-1,5,["InEditMode"],[_ts.a.l],null,"_ts_3",null,null,1,null,null,null]],[[-1,1,["InEditMode"],[_ts.a.l],null,"IsInEditMode",null,_ts.a.bB,1,null,null,!1],[-1,1,["TagCollection"],[_ts.a.bK],null,"DataSource",null,_ts.a.S,1,null,null,null]],[[-1,1,["InEditMode"],[_ts.a.l],null,"IsHidden",null,_ts.a.e,1,_ts.a.h(),null,!0],[-1,1,["HashtagsText"],[_ts.a.bD],_ts.a.bN,"Text",_ts.a.W,_ts.a.Y,2,null,null,null],[-1,1,["TextBoxBackspaceCommand"],[_ts.a.bL],null,"BackspaceOutCommand",null,_ts.a.bl,1,null,null,null],[-1,1,["TextBoxLeftArrowCommand"],[_ts.a.bM],null,"LeftArrowCommand",null,_ts.a.bm,1,null,null,null],[-1,1,["IsTextboxFocused"],[_ts.a.bG],_ts.a.bO,"HasFocus",_ts.a.V,_ts.a.X,2,null,null,!1]],[[-1,1,["HashtagsTextInput"],[_ts.a.bE],null,"EditorElement",null,_ts.a.bn,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_ts.a.j,0,null,null,null,_ts.i.a()],[-1,4,null,null,null,"HoveredImageId",null,_ts.a.n,0,null,null,null,_ts.i.b()],[-1,4,null,null,null,"Title",null,_ts.a.k,0,null,null,null,_nbs.a.Yr],[-1,1,["ShowAddTag"],[_ts.a.bJ],null,"IsHidden",null,_ts.a.e,1,_ts.a.h(),null,!0],[-1,1,["EditCommand"],[_ts.a.bC],null,"ClickCommand",null,_ts.a.i,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_ts.a.y,0,null,null,null,_u.n.Mm],[-1,4,null,null,null,"Title",null,_ts.a.k,0,null,null,null,_nbs.a.FA],[-1,1,["InEditMode"],[_ts.a.l],null,"IsHidden",null,_ts.a.e,1,_ts.a.h(),null,!0],[-1,1,["ShareCommand"],[_ts.a.bH],null,"ClickCommand",null,_ts.a.i,1,null,null,null]]]);var r=_ts.a.c.childNodes[3].cloneNode(!0);var i=new _fc.b(_j.a.a(r,[0,2,0]));i.g("ms-font-color-neutralTertiary ms-bg-color-neutralLighter");i.f(" ms-font-color-white ms-bg-color-themePrimary");i.c("ms-font-color-white ms-bg-color-themeDark");i.d("ms-font-color-white ms-bg-color-themeDark");var t=new _b.J(_j.b.Instance.a(_b.p),_j.b.Instance.a(_b.a),_j.b.Instance.a(_y.a),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.b));t.V(_j.f.a(["ContextParent","ShouldShowIntroductionPeek"],[_ts.a.b,_ts.a.bI],null,"IsEnabled",null,_ts.a.bi,1,null,null,!1)).V(_j.f.a(["ContextParent","IntroductionController","IntroductionPeekContentViewModel"],[_ts.a.b,_ts.a.G,_ts.a.L],null,"PeekDataContext",null,_ts.a.bh,1)).V(_j.f.a(["ContextParent","IntroductionController","IntroductionPeekContentViewModel","IsShown"],[_ts.a.b,_ts.a.G,_ts.a.L,_ts.a.bS],_ts.a.bT,"IsShown",_ts.a.bj,_ts.a.bk,2,null,null,!1)).V(_j.f.a(["ContextParent","DOMElement"],[_ts.a.b,_ts.a.bf],null,"AnchorElement",null,_ts.a.bg,1));t.P(0);t.C=!0;t.f("IntroductionPeekContentView");t.l(2);t.n(10);i.D([t]);var f=new _fc.b(_j.a.a(r,[0,1]));f.f("ms-bg-color-neutralLighter");f.c("ms-bg-color-neutralLight-hover");f.d("ms-font-color-white ms-bg-color-neutralTertiaryAlt");var o=new _zz.be(_j.a.a(r,[0,0,1,1]),_j.b.Instance.a(_j.cc.$$(IEntitySuggestionManager)),_j.b.Instance.a(_j.j),_j.b.Instance.a(_j.cc.$$(IFindRecipientAtMentionSuggestionViewModelFactory)),_j.b.Instance.a(_a.f));var e=new _b.x(_j.a.a(r,[0,0,1,0]));e.a(32);var u=new _ts.d(_j.a.a(r,[0,0,0]),_j.b.Instance.a(_ff.a));u.bd=!0;u.x(function(){var t=_ts.a.c.childNodes[2].cloneNode(!0).childNodes[0];var n=new _ts.j(t);n.y("TagSetContainer.TagListItemView");return n});u.y("TagSetContainer._tid1");var s=new _j.h(r.children[0]);return new _j.a(r,[s,u,e,o,f,i]).l({TagListView:u,HashtagsTextBox:e,TextInputEntitySuggester:o,ShareHashtagsButton:i}).b(u)},"",_y.Z,_ts.b,function(n){return new _ts.b(n,_j.b.Instance.a(IHashtagWellViewModelFactory),_j.b.Instance.a(_j.j),_j.b.Instance.a(IHashtagFirstRunHelper))},!1,!1,!1,0,_ts.a.a);var t="TagSetContainerWrapper";new _j.d(t,function(){_ts.a.a[t]===undefined&&(_ts.a.a[t]=[null]);var i=_ts.a.c.childNodes[4].cloneNode(!0);var n=new _ts.b(i.children[0],_j.b.Instance.a(IHashtagWellViewModelFactory),_j.b.Instance.a(_j.j),_j.b.Instance.a(IHashtagFirstRunHelper));return new _j.a(i,[n]).b(n)},"",_y.Z,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_ts.a.a)};_ts.f.registerClass("_ts.f",_h.cL);TagSetComponent.registerClass("TagSetComponent",null,_a.ib,_j.ce);_ts.o.registerClass("_ts.o",_h.cO.$$(_dg.bS,_dg.bT));_ts.k.registerClass("_ts.k",_h.cO.$$(_dg.cf,_dg.cg));_ts.p.registerClass("_ts.p",_h.cO.$$(_dg.cu,_dg.cv));_ts.g.registerClass("_ts.g",_a.iX,IEntitySuggestionManager);_ts.n.registerClass("_ts.n",_a.bB,_y.ep);_ts.q.registerClass("_ts.q",_a.bp);_ts.h.registerClass("_ts.h",_y.bq);_ts.c.registerClass("_ts.c",_y.gt,IHashtagTreeViewModel);_ts.t.registerClass("_ts.t",_ts.h);_ts.e.registerClass("_ts.e",_a.bB,ITagViewModel,_j.bq,Sys.IDisposable);_ts.j.registerClass("_ts.j",_fce.e);_ts.d.registerClass("_ts.d",_fce.a);_ts.b.registerClass("_ts.b",_j.c);TagSetComponent.$$cctor();_ts.l.a=_a.a.W;_ts.m.a=_a.a.W;_ts.g.a=_a.a.W;_ts.c.a=["#Newsletters","#Travel","#Promotions","#Purchases"];_ts.e.a=_a.a.W;_ts.d.a=_a.a.W;_ts.b.b="SetFocusOnInputTextBox";_ts.b.a=_a.a.W;_ts.a.c=_ts.a.R();_ts.a.g=null;_ts.a.a={};_ts.a.$$cctor();
window.scriptsLoaded['microsoft.owa.core.tagset.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.tagset.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
