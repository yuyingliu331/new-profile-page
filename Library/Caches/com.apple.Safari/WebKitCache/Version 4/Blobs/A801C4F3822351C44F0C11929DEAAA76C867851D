try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.mail.compose.js'] = (new Date()).getTime();
Type.registerNamespace("_mcp");_mcp.L=function(n,t,i,r){_mcp.L.initializeBase(this,[2]);_a.b.a(n,"approvalMessage");this.y=r;this.bp=!0;this.bc="CreateApprovalResponse";this.l=n;this.j=t;this.w=i};_mcp.L.prototype={l:null,j:null,w:!1,P:function(){_a.cT.prototype.P.call(this);this.y===1&&_h.c.m(this.l.bj.ItemId,this.l.bj.ConversationId.Id)},bj:function(){var n;n=this.w?new _gg.bh:new _gg.ch;this.be=this.y?_g.b.a.nameToId("outbox"):_g.b.a.nameToId("drafts");n.ReferenceItemId=_g.g.a(this.l.bj.ItemId);this.x(n);return[n]},cG:function(n){!this.y&&n.Items&&n.Items[0]?this.D=n.Items[0].ItemId:this.y===1&&_h.c.f(this.l.bj.ItemId,this.l.bj.ConversationId.Id)},R:function(){_a.cT.prototype.R.call(this);this.y===1&&_h.c.f(this.l.bj.ItemId,this.l.bj.ConversationId.Id)},x:function(n){if(!this.j){var u=this.w?_nbs.a.nM:_nbs.a.Nl;var r=String.format(_nbs.a.ik,u,this.l.cF());n.Subject=r;if(this.l.bj.Sender){var t=new _a.j;t.c(this.l.bj.Sender.Mailbox);n.ToRecipients=_db.f.a(t)}return}var i;_db.f.d(this.j.I(),i={val:this.bw},this.bo),this.bw=i.val;n.Importance=this.j.bK();this.j.m()&&this.j.m().b()>0&&(n.ToRecipients=_db.f.a(this.j.m()));this.j.o()&&this.j.o().b()>0&&(n.CcRecipients=_db.f.a(this.j.o()));this.j.v()&&this.j.v().b()>0&&(n.BccRecipients=_db.f.a(this.j.v()));n.Sensitivity=this.j.bP();n.IsDeliveryReceiptRequested=this.j.bj.IsDeliveryReceiptRequested;n.IsReadReceiptRequested=this.j.bj.IsReadReceiptRequested;this.j.I()&&(n.Body=new _g.s(this.j.I().a()==="HTML"?"HTML":"Text",this.j.I().bj.Value));n.Subject=this.j.bj.Subject}};_mcp.bq=function(n,t){_mcp.bq.initializeBase(this);this.g=n;this.c=t};_mcp.bq.prototype={g:null,c:null,i:null,I:function(n){var t=new _gg.sn(this.J);n.bi(this.g,this.c,t,this.G,this.E)},cQ:function(n,t,i){this.i=n;t()}};_mcp.S=function(){this.g=Function.createDelegate(this,this.j);_mcp.S.initializeBase(this);if(!model)throw Error.argumentNull("model");this.c=model};_mcp.S.a=function(n){_a.b.b(n,"UserAgent shouldn't be null.");return n.q()?_nbs.a.VP:n.r()?_nbs.a.Gp:n.e()?_nbs.a.pz:_nbs.a.ZZ};_mcp.S.prototype={c:null,a:null,Y:function(){try{var n=_a.bk.a();var t=n.b("MOWA.IsSignatureChanged")==="true"?!0:!1;this.c.a(t?Boolean.parse(n.b("MOWA.AutoAddSignature")):!0);this.c.c(t?n.b("MOWA.SignatureText"):_mcp.S.a(_a.k.a()));this.c.e(t?Boolean.parse(n.b("MOWA.UseDesktopSignature")):!1);this.a=new _h.cc;this.a.d(this.g);_a.g.a.a(this.a)}catch(i){this.i(i)}return 1},l:function(){this.T(null)},i:function(n){this.T(n)},j:function(n){this.c.b(this.a.c.UserOptions.SignatureText);this.l()}};_mcp.bd=function(n,t){_mcp.bd.initializeBase(this);this.c=n;this.g=t};_mcp.bd.prototype={c:null,i:null,g:"EwsLegacyId",j:function(){return this.i},I:function(n){var i=new _gg.eh(this.g);i.DestinationFormat=this.g;i.SourceIds=new Array(this.c.length);for(var t=0;t<this.c.length;t++){var f=new _gg.bg(this.c[t].Format,this.c[t].Id,this.c[t].Mailbox);i.SourceIds[t]=f}var u=new _gg.eg(this.K(),i);var r=new _gg.og(this.J);n.Z(u,r,this.G,this.E)},cG:function(n){this.i=n.AlternateId}};function MailComposeComponent(){}MailComposeComponent.$$cctor=function(){_a.u.a().a(MailComposeComponent)};MailComposeComponent.a=function(n,t,i){var o=n==="Mouse";var s=!(t.a()&&t.d().b()<9);var r=i.c().bj.UserCulture;var e=!!r&&r.startsWith("en");var f=!!i.i()&&i.i().bj.CheckForForgottenAttachmentsEnabled;var u=!!i.a()&&i.a().bj.CheckForForgottenAttachments;return o&&f&&u&&s&&e};MailComposeComponent.prototype={a:function(n,t,i){var y=this;n.b(_mcp.K,function(){return new _mcp.K(n.a(_a.C),n.c(ICancelCalendarItemActionFactory),n.a(_j.j))}).b(IMailComposeActionFactory).a();var p=this;n.b(_mcp.bn,function(){return new _mcp.bn(n.a(IInferenceTracker),n.a(_g.a),n.a(IMailComposeContextFactory),n.a(_mcp.K),n.c(ISmimeCommandFactory),n.c(IGetCalendarItemActionFactory),n.c(ICalendarTimeConverterFactory))}).b(IMailResponseViewModelFactory).a();var w=this;n.b(_mcp.bi,function(){return new _mcp.bi(n.a(_y.dE),n.a(_a.C))}).b(IMailComposeContextFactory).a();var o=n.a(_j.n);var e=n.a(_g.e);var u=MailComposeComponent.a(i.a(),o,e);var f=n.a(_a.f);var r=i.a()==="Mouse"&&_g.a.a().bj.AsyncSendEnabled;var d=this;n.b(_mcp.A,function(){return new _mcp.A(n.a(_a.t),n.a(_j.j),n.a(_g.e))}).a();var k=this;n.b(_mcp.bk,function(){return new _mcp.bk(n.c(IExtensibilityViewModelFactory),n.a(_rw.i),u?n.c(IForgottenAttachmentDetectorFactory):null,n.c(IRichPeoplePickerViewModelFactory),n.a(IMailComposeContextFactory),n.a(_mcp.K),n.a(_pe.e),n.a(_y.a),n.c(IOfflineHelpProvider),n.a(_mcp.E),n.a(_y.K),n.a(_j.j),n.c(IAttachmentWellViewModelFactory),f,n.a(_a.C),n.d(IAttachmentsFilePickerPanelViewModel),n.a(IInferenceTracker),n.a(_g.cl),n.a(_a.B),n.c(IMailTipsHandlerFactory),n.c(IPeopleRecommendationsHandlerFactory),n.c(IPolicyTipsHandlerFactory),i.a()==="Mouse"?n.a(_cmc.z):null,r?n.c(ISendNotificationProviderViewModel):null,r?n.c(ISendFailureNotificationProviderViewModel):null,n.c(IFindRecipientMailComposeViewModelFactory),n.d(IComponentOverrideFactory),n.a(_g.a).bj.AttachmentPolicy,n.c(IIntroductionControllerFactory),n.d(ILinkPreviewBuilderFactory),n.c(IToPeoplePickerViewModelFactory),n.c(IGetCalendarItemActionFactory),n.c(ICalendarTimeConverterFactory),n.c(ILocationViewModelFactory),n.c(IExtensibilityEntryPointCollection),n.c(IEntitySuggestionManager),n.c(IModernGroupCardViewModelFactory),n.a(_g.a).a(),n.a(_j.n),i,n.a(_y.r),n.a(_h.bb),n.a(_mcp.A),i.a()==="TouchNarrow"?n.a(_y.q):null,n.c(IAtMentionsHandler))}).b(IMailComposeViewModelFactory).a();var b=this;n.b(_mcp.bl,function(){return new _mcp.bl(n.c(IExtensibilityViewModelFactory),n.a(_rw.i),u?n.c(IForgottenAttachmentDetectorFactory):null,n.c(IRichPeoplePickerViewModelFactory),n.a(IMailComposeContextFactory),n.a(_mcp.K),n.a(_pe.e),n.a(_y.a),n.c(IOfflineHelpProvider),n.a(_mcp.E),n.a(_y.K),n.a(_j.j),n.c(IAttachmentWellViewModelFactory),f,n.a(_a.C),n.d(IAttachmentsFilePickerPanelViewModel),n.a(IInferenceTracker),n.a(_g.cl),n.a(_a.B),n.c(IMailTipsHandlerFactory),n.c(IPeopleRecommendationsHandlerFactory),n.c(IPolicyTipsHandlerFactory),i.a()==="Mouse"?n.a(_cmc.z):null,r?n.c(ISendNotificationProviderViewModel):null,r?n.c(ISendFailureNotificationProviderViewModel):null,n.c(IFindRecipientMailComposeViewModelFactory),n.d(IComponentOverrideFactory),n.a(_g.a).bj.AttachmentPolicy,n.c(IIntroductionControllerFactory),n.d(ILinkPreviewBuilderFactory),n.c(IToPeoplePickerViewModelFactory),n.c(IGetCalendarItemActionFactory),n.c(ICalendarTimeConverterFactory),n.c(ILocationViewModelFactory),n.c(IExtensibilityEntryPointCollection),n.c(IEntitySuggestionManager),n.c(IModernGroupCardViewModelFactory),n.a(_g.a).a(),n.a(_j.n),i,n.a(_y.r),n.a(_h.bb),n.a(_mcp.A),i.a()==="TouchNarrow"?n.a(_y.q):null,n.c(IAtMentionsHandler))}).b(IMailInlineComposeViewModelFactory).a();var c=this;n.b(_mcp.E,function(){return new _mcp.E(n.a(IMailComposeActionFactory))}).b(IMailComposeDiscardManager).a();var h=this;n.b(_mcp.T,function(){return new _mcp.T(n.a(_y.a),n.a(_j.u),n.a(_g.e),n.a(_j.j),n.a(IMailComposeViewModelFactory))}).a();var s=this;n.b(_mcp.l,function(){return new _mcp.l(window.document.createElement("div"),i.a(),n.a(_j.n),n.a(_a.C),n.a(_a.f),n.a(_j.j),n.a(_a.B),n.a(_b.d))});var v=this;n.b(_mcp.n,function(){return new _mcp.n(window.document.createElement("div"),i.a(),n.a(_j.n),n.a(_a.C),n.a(_a.f),n.a(_j.j),n.a(_a.B),n.a(_b.d))});var a=this;n.b(_mcp.R,function(){return new _mcp.R(window.document.createElement("div"),i.a(),n.a(_j.n),n.a(_a.C),n.a(_a.f),n.a(_j.j),n.a(_a.B),n.a(_b.d),!0)});var l=this;n.b(_mcp.U,function(){return new _mcp.U(n.d(IPopOutHelper),i.a())}).a();_a.n.a(_a.bI.e)},b:function(){return[new _j.x(_mcp.U,1,1),new _j.x(_mcp.A,1,73),new _j.x(_mcp.T,4,1)]}};_mcp.T=function(n,t,i,r,u){this.i=Function.createDelegate(this,this.p);this.h=Function.createDelegate(this,this.n);this.e=n;this.g=t;this.l=i;this.c=r;this.d=u;this.c.b(IDelayedSendEvent,this.h);this.c.b(_cmc.bc,this.i)};_mcp.T.prototype={e:null,g:null,l:null,c:null,d:null,a:null,b:null,n:function(n){_j.s.a(n.a(),"SendEvent.DelayedSendCallback is null.");_j.s.a(n.b(),"SendEvent.MailComposeContext is null.");var u=n.c()*1e3;var e=n.b();var r=n.a();var t=this,o=this;var i=new _mcp.bv(this.c,u,function(){_j.e.a(_a.a.a,"UndoDelayedSendAction.undoDelegate - cancelling the queued delayed-send task.");t.k()||_j.e.b(_a.a.a,"TryCancelQueuedTask failed on undo delayed send. Continuing to navigate to the draft.");_j.e.a(_a.a.a,"UndoDelayedSendAction.undoDelegate - popping the cancelled undo action from the undo stack.");t.f();t.o(e)},function(){_j.e.a(_a.a.a,"UndoDelayedSendAction.flushDelegate - cancelling the queued delayed-send task.");if(o.k()){_j.e.a(_a.a.a,"Flushing the delayed-send task by firing the send callback.");r()}});_j.e.a(_a.a.a,"HandleDelayedSendEvent - pushing the undo action to the undo stack.");this.q(i);_j.e.a(_a.a.a,"HandleDelayedSendEvent - queueing the delayed-send task.");var f=this;this.a=_j.o.a().a(_a.a.a,"SubmitDelayedComposeAction",function(){f.m(r,i)},u)},m:function(n,t){_j.e.a(_a.a.a,"DelayedSendTaskDelegate - executing the delayed-send task callback.");t.a();this.a=null;if(t===this.b){_j.e.a(_a.a.a,"DelayedSendTaskDelegate - action flushed; now popping the action from the undo stack.");this.f()}},k:function(){_j.e.a(_a.a.a,"TryCancelQueuedTask - attempting to cancel the queued delayed-send task...");var n=!1;if(this.a){this.a=this.g.b(this.a);_j.e.a(_a.a.a,"TryCancelQueuedTask - delayed-send task has been cancelled.");n=!this.a}else _j.e.b(_a.a.a,"TryCancelQueuedTask- queuedTaskHandle is null on flush, skipping...");return n},o:function(n){_j.e.a(_a.a.a,"NavigateToDelayedMessage - navigating to the cancelled draft message.");n.f(!1);var t=this.d.a(n,null,null);t.t(!1);t.x(!1);this.e.f(t,0,!0)},p:function(n){this.j()},q:function(n){this.j();this.b=n},j:function(){var n=this.f();n&&n.a()},f:function(){var n=this.b;this.b=null;return n}};_mcp.U=function(n,t){if(t==="Mouse"){var i=this;n.d(function(n){n.a(_mcp.b,"MailComposeContext")},!1)}};_mcp.A=function(n,t,i){this.e=Function.createDelegate(this,this.i);this.f=Function.createDelegate(this,this.j);_mcp.A.initializeBase(this);this.d=n;this.h=t;this.c=i.a();this.a=0;var r=this.c.bj.SignatureHtml;r===""||r||this.k()};_mcp.A.prototype={d:null,h:null,c:null,a:0,b:null,k:function(){this.b=new _cmc.d(_a.a.a,"MailComposeSigPreload",!1);this.a=1;var n=new _mcp.bs;n.d(this.f);n.e(this.e);this.d.a(n)},j:function(n){this.c.bF(n.c.bj.SignatureHtml);this.c.bG(n.c.bj.SignatureText);this.a=2;this.et("CurrentStatus");this.g(n,!1)},i:function(n){this.a=3;_j.e.b(_a.a.a,"SignaturePreloadService.OnPreloadFailed - error: '{0}'",n.F?n.F.message:"");this.et("CurrentStatus");this.g(n,!0)},g:function(n,t){if(this.b)if(t){this.b.k(n.M());this.b.d(n.N(),null)}else this.b.b()}};_mcp.bu=function(){};_mcp.bt=function(n){_mcp.bt.initializeBase(this);this.g=n;this.l=_a.a.bD;this.i="GetSuggestedGroupsFromRecipientsAction"};_mcp.bt.prototype={c:null,n:0,j:!1,g:null,i:null,l:null,I:function(n){var i=new _gg.kd(this.K());var t=new _gg.yM(this.J);t.actionName="GetSuggestedGroupsFromRecipientsAction";i.Body.Recipients=this.g;_a.n.b(this.l,this.i,!0);n.fI(i,t,this.G,this.E)},cQ:function(n,t,i){try{if(n.Body.ResponseCode==="NoError"){this.c=n.Body.SuggestedUnifiedGroups;this.n=n.Body.SuggestedUnifiedGroupCount;this.j=n.Body.ShouldCreateNewGroup;this.m(null);t()}else{var r=Error.create("GetSuggestedGroupsFromRecipientsAction: group suggestions could not be retrieved.ResponseCode: "+n.Body.ResponseCode+"."+"MessageText: "+n.Body.MessageText+".");this.m(r);i(r)}}catch(u){this.m(u);i(u)}},m:function(n){var i=null;n&&(i=n.message?n.message:n.name?n.name.toString():"UnknownError");var r=_a.n.c(this.i);if(r){var t=new _a.o;this.g&&t.a("rc",this.g.length);if(this.c){t.a("sgc",this.c.length);if(this.c[0].TopRelevantMembers){t.a("sgmc",this.c[0].TopRelevantMembers.length);t.a("mrp",this.c[0].TopRelevantMembers.length*100/this.g.length)}}this.j?t.c("scng",!0):t.c("scng",!1);r.j=t.toString();r.k=i;r.l=this.M();_a.n.a(this.i)}}};_mcp.bv=function(n,t,i,r){this.p=Function.createDelegate(this,this.a);this.l=n;this.o=i;this.n=r;var u=this;this.l.a(_a.bj,new _a.bj(11,_u.P.a,_u.P.t,_u.P.L,this.p,function(){u.g()}))};_mcp.bv.prototype={l:null,o:null,n:null,m:!1,toString:function(){return _u.n.MC},g:function(){this.m=!0;this.o();this.m=!1;this.k();return!0},a:function(){this.n();this.l.a(_a.bj,new _a.bj(13,"","","",null,null))},j:function(){this.l.a(_a.bj,new _a.bj(4,"","","",null,null))},k:function(){this.l.a(_a.bj,new _a.bj(12,"","","",null,null))},f:function(){return this.m},c:function(){return null},e:function(n){return!1},d:function(n){return!1},b:function(n){return!0},i:function(n){},h:function(){}};_mcp.C=function(n){_mcp.C.initializeBase(this);this.c=n};_mcp.C.prototype={c:null,I:function(n){var i=this.g();var t=new _gg.so(this.J);t.explicitLogonUser=this.c.z();this.c.c()&&!t.actionName&&(t.actionName=this.c.c());n.dI(i,t,this.G,this.E)},g:function(){var t=this.c.l();var i=new _gg.hI(this.K());var n=new _gg.en;n.Items=t.Items;n.ItemShape=t.ItemShape;n.ShapeName=t.ShapeName;n.SubjectPrefix=t.SubjectPrefix;n.ClientSupportsIrm=t.ClientSupportsIrm;n.ComplianceId=t.ComplianceId;n.ComposeOperation=t.ComposeOperation;n.IsNonDraft=t.IsNonDraft;n.MessageDisposition=t.MessageDisposition;n.OutboundCharset=t.OutboundCharset;n.SavedItemFolderId=t.SavedItemFolderId;n.SendOnNotFoundError=t.SendOnNotFoundError;n.ShouldSuppressReadReceipt=t.ShouldSuppressReadReceipt;n.UseGB18030=t.UseGB18030;n.UseISO885915=t.UseISO885915;n.TimeFormat=t.TimeFormat;i.Body=n;return i},ba:function(n){_h.fb.prototype.ba.call(this,n)},cG:function(n){this.c.w(n)}};_mcp.br=function(){_mcp.br.initializeBase(this)};_mcp.br.prototype={c:null,g:null,i:null,I:function(n){var i=new _gg.eU(this.K());var t=new _gg.ow(200);n.x(i,t,this.G,this.E)},cQ:function(n,t,i){if(n.Options){this.c=n.Options.EmailAddresses;this.g=n.Options.NotManagedEmailAddresses;this.i=n.Options.SendEnabledConnectedAccounts;t&&t()}else!_j.i.a(n.ErrorMessage)&&i&&i(Error.create(n.ErrorMessage))}};_mcp.bs=function(){_mcp.bs.initializeBase(this)};_mcp.bs.prototype={c:null,I:function(n){var t=new _gg.oB(this.J);n.z(t,this.G,this.E)},cQ:function(n,t,i){this.c=new _gg.h(n.Options);t()}};var IMailComposeOverridable=function(){};IMailComposeOverridable.registerInterface("IMailComposeOverridable");_mcp.bj=function(){};_mcp.bj.a=function(n){var t=null;_db.f.isInstanceOfType(n)?t=n.D:_mco.b.isInstanceOfType(n)?t=n.bk:_mcp.C.isInstanceOfType(n)&&(t=n.c.g());return t};_mcp.M=function(n,t,i,r){_mcp.M.initializeBase(this,["AddOriginalAttachmentInfoBarView"]);this.a=n;this.d=t;this.b=new _j.g(i,_a.a.a);this.c=new _j.g(r,_a.a.a)};_mcp.M.prototype={d:0,a:null,f:function(){return this.a.length===1?String.format(_u.R.Kx,this.a[0].Name):String.format(_u.n.PK,this.a.length)},e:function(){return this.d>1?_u.n.CS:_u.n.Cc},b:null,c:null};_mcp.bR=function(n,t,i){this.e=n;this.f=t;this.d=i};_mcp.bR.prototype={e:0,c:function(){return this.e},f:null,b:function(){return this.f},d:null,a:function(){return this.d}};_mcp.bS=function(){};_mcp.bU=function(n,t){this.c=n;this.d=t};_mcp.bU.prototype={c:null,d:null,a:function(){return this.c},b:function(){return this.d}};_mcp.bo=function(n){this.a=n};_mcp.bo.prototype={a:null};_mcp.bX=function(n){this.b=n};_mcp.bX.prototype={b:null,a:function(){return this.b}};_mcp.Q=function(n,t,i,r){this.g=n;this.e=t;this.h=i;this.f=r};_mcp.Q.prototype={g:!1,e:null,h:!1,f:null,c:function(){return this.g},a:function(){return this.e},d:function(){return this.h},b:function(){return this.f}};_mcp.bp=function(n){this.b=n};_mcp.bp.prototype={b:!1,a:function(){return this.b}};_mcp.bY=function(n){this.b=n};_mcp.bY.prototype={b:null,a:function(){return this.b}};_mcp.K=function(n,t,i){this.f=n;this.j=t;this.g=i};_mcp.K.prototype={f:null,j:null,g:null,h:function(n,t){var i=n.bb;var u=i.a();var s=3===u||2===u||1===u;var e=this.f.b()&&i.i();(n.bP().j()||i.ds()&&(i.dk()||n.bh().l()>0))&&(e=!!(e&i.bk()));var f=null;if(s&&!e)f=this.l(i,t);else if(i.bs()){_j.e.a(_a.a.a,"Creating UpdateMessageForComposeAction for context:{0}; disposition={1}",i,t);var h=this.m(t,i);f=h}else if(8===i.a()){_j.e.a(_a.a.a,"Creating CancelCalendarItemAction for context:{0}; disposition={1}",i,t);f=this.o(i,t)}else if(u!==5&&u!==6&&u!==7)if(u===9||u===10){_j.e.a(_a.a.a,"CreateComposeAction: ApprovalRequestAction");f=this.n(i,t)}else{_j.e.a(_a.a.a,"Creating CreateMessageForComposeAction for context:{0}; disposition={1}",i,t);var r=null;if(u===11||u===12){r=new _mco.a(i.bx(!1),i.bK(),this.f,this.g);r.y=0}else{var o=this.k(i);r=new _mco.a(o,null,this.f,this.g);r.y=t}r.bo=!this.f.b();i.u()&&(r.bx=i.u());r.cc=i.bS(100);r.ce=_y.l.toString(i.a());r.bN=i.bP();r.bP=i.S();f=r}f.V=i.b();return f},i:function(n,t,i){var r=new _h.cw(200,n);r.i=t||_h.b.f();r.u=_j.t.a(i)?"MailCompose":i;return r},a:function(n,t){var r=t?"HardDelete":"MoveToDeletedItems";return new _db.cq([n],r,2)},d:function(n,t){var r=null;r=n.R()?n.bx(!0):n.C(!0);var i=this.c(n,r);i.bk=t;i.by=!this.f.b()&&n.j()==="HTML"?"MailComposeNormalizedBody":"MailCompose";i.bZ=_g.a.a().a().bj.TimeFormat;return i},o:function(n,t){var i=null;var r=this;this.j.b(function(t){i=t.a(n.F(),1,n.dg());i.l(n.C(!1));n.u()&&i.j(n.u())});return i},c:function(n,t){var r=n.cs()?new _db.r(n.F()):n.F();var i=null;i=new _mco.d(this.q(n.a()),r,this.f,this.g);i.bK(t);i.bv=n.dm();i.bo=!this.f.b();n.u()&&(i.bx=n.u());i.bm=n.bo();i.bz=n.dn();i.V=n.b();n.d()&&_g.j.isInstanceOfType(n.d())&&n.d().bj.IsReadReceiptRequested&&(i.bJ=!0);switch(n.a()){case 1:case 2:i.bR=_u.n.KI;break;case 3:i.bR=_nbs.a.ZF;break}return i},e:function(n,t,i){return new _mco.b(n,t,i)},b:function(n,t,i){var r;r=_g.bt.isInstanceOfType(n)?this.p(n,this.f):new _mco.a(n,null,this.f,this.g);return r},l:function(n,t){var r;_j.e.a(_a.a.a,"Creating CreateResponseAction for context:{0}; layout={1}; disposition={2}",n,_y.c.a.a(),t);var f=n.C(!1);var i=this.c(n,f);i.y=t;i.cc=n.bS(100);i.ce=_y.l.toString(n.a());i.bN=n.bP();i.bP=n.S();if(n.bh()){var u=new _mcp.C(i);r=u}else r=i;return r},k:function(n){return n.C(!1)},m:function(n,t){var i=null;if(t.R()){i=new _mco.b(t.bx(!1),this.f,this.g);i.bj=_g.n.c(t.bK());i.y=0}else{i=new _mco.b(t.C(!1),this.f,this.g);i.y=n}i.bT=!this.f.b();i.bs=t.bP();i.bv=t.S();t.u()&&(i.bb=t.u());i.bQ=t.bS(100);i.bl="AlwaysOverwrite";i.bw=_y.l.toString(t.a());return i},q:function(n){switch(n){case 1:return new _g.bN;case 2:return new _g.bx;case 3:return new _g.bG;case 12:return new _g.eE;default:throw Error.invalidOperation("Unable to get SmartResponseType from MailComposeOperation "+_y.l.toString(n));}},n:function(n,t){var r=n.d();var i=new _mcp.L(r,n.C(!1),n.a()===9,t);i.bo=!this.f.b();return i},p:function(n,t){var r=_mco.d.a(n);var i=new _mco.d(r,n.bj.ReferenceItemId,this.f,this.g);i.bo=!t.b();i.bK(n);i.bv=n.n();i.bJ=!0;return i}};_mcp.bi=function(n,t){this.d=n;this.c=t};_mcp.bi.prototype={c:null,d:null,a:function(n,t){var i=new _mcp.b;if(this.c){i.ef(this.c.b());i.ef(this.c.b())}i.t(n?0:this.d.a());return i},b:function(n,t,i,r){var u=this.a(!1,!1);u.t(this.d.a());u.e(4);u.f(!1);u.L(n);u.dV(t);r&&!r.a()?u.m(r.h()):u.m(i===1?"Text":"HTML");return u}};_mcp.bk=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii){_a.b.b(k,"nativeBridge");this.z=n;this.M=t;this.C=i;this.N=r;this.W=u;this.i=f;this.K=e;this.e=o;this.I=s;this.w=h;this.L=c;this.x=l;this.c=v;this.d=y;this.A=p;this.s=a;this.E=w;this.u=b;this.H=k;this.n=d;this.o=g;this.p=nt;this.v=tt;this.P=it;this.O=rt;this.B=ut;this.R=ft;this.r=et;this.F=ot;this.G=st;this.S=ht;this.l=ct;this.k=lt;this.m=at;this.y=vt;this.f=yt;this.g=pt;this.h=wt;this.T=bt;this.t=kt;this.D=dt;this.J=gt;this.Q=ni;this.j=ti;this.q=ii};_mcp.bk.prototype={y:null,z:null,M:null,C:null,N:null,W:null,i:null,x:null,K:null,e:null,I:null,w:null,L:null,c:null,d:null,A:null,S:null,s:null,u:null,E:null,v:null,H:null,n:null,o:null,p:null,P:null,O:null,B:null,R:null,r:null,F:null,G:null,l:null,k:null,m:null,T:null,t:null,D:null,J:null,Q:null,j:null,q:null,f:null,g:null,h:null,b:function(n,t,i){return this.X(n,null,t,i)},a:function(n,t,i){return this.U(n,null,t,i)},X:function(n,t,i,r){var u=this.W.a(!1,!1);u.gI(n);return this.U(u,t,i,r)},U:function(n,t,i,r){var u=null;u=this.e.a()==="Mouse"&&this.c&&this.c.a().f().Enabled?new _mcp.u(n,t,this.z,this.M,this.C,this.N,this.K,this.e,this.I,this.w,this.L,this.x,this.s,this.c,this.d,this.A,this.E,this.u,this.H,this.i,i,r,this.n,this.o,this.p,this.v,this.P,this.O,this.B,this.R,this.r,this.F,this.G,this.S,this.l,this.k,this.m,this.y,this.f,this.g,this.h,this.T,this.t,this.D,this.J,this.Q,this.j,this.q):new _mcp.e(n,t,this.z,this.M,this.C,this.N,this.K,this.e,this.I,this.w,this.L,this.x,this.s,this.c,this.d,this.A,this.E,this.u,this.H,this.i,i,r,this.n,this.o,this.p,this.v,this.P,this.O,this.B,this.R,this.r,this.F,this.G,this.S,this.l,this.k,this.m,this.y,this.f,this.g,this.h,this.T,this.t,this.D,this.J,this.Q,this.j,this.q);u.cx();return u}};_mcp.bl=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii){_mcp.bl.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii])};_mcp.bl.prototype={U:function(n,t,i,r){var u=new _mcp.i(n,t,this.z,this.M,this.C,this.N,this.K,this.e,this.I,this.w,this.L,this.x,this.s,this.c,this.d,this.A,this.E,this.u,this.H,this.i,i,r,this.n,this.o,this.p,this.v,this.P,this.O,this.B,this.R,this.r,this.F,this.G,this.S,this.l,this.k,this.m,this.y,this.f,this.g,this.h,this.T,this.t,this.D,this.J,this.Q,this.j,this.q);u.cx();return u}};_mcp.O=function(n,t,i,r,u,f,e,o){this.i=Function.createDelegate(this,this.G);this.j=Function.createDelegate(this,this.I);this.r=Function.createDelegate(this,this.J);_mcp.O.initializeBase(this,["GroupCreateSuggestionInfoBarView"]);this.k=new _j.g(n,_a.a.a);this.l=new _j.g(this.r,_a.a.a);this.m=t;this.b=i;this.e=r;this.q=u;this.v(f);this.c=e;this.p=o;this.b.b(ICreateGroupInGroupSuggestionEvent,this.j);this.b.b(ICreateGroupCompleteInGroupSuggestionEvent,this.i)};_mcp.O.prototype={a:null,m:null,p:null,b:null,h:!1,g:!0,f:!1,n:!1,o:!0,d:!1,c:null,e:null,q:null,C:function(){this.a||(this.a=new _mcp.J(this.m,this.b,this.e,this.q,this.p));return this.a},w:function(n){if(this.h!==n){this.h=n;this.et("IsCreatingGroupStatus")}return n},t:function(n){if(this.g!==n){this.g=n;this.et("BeforeCreateGroupStatus")}return n},s:function(n){if(this.f!==n){this.f=n;this.et("AfterCreateGroupStatus");this.et("AfterCreateGroupText")}return n},I:function(n){this.w(!0);this.t(!1);this.s(!1);var t=this;_j.o.a().a(_a.a.O,"GroupCreationSuggestion",function(){t.F()},12e3)},G:function(n){this.o=n.a();this.w(!1);this.t(!1);this.s(!0)},F:function(){this.n=!0;this.et("CreatingGroupText")},A:function(){return this.n?_nbs.a.DL:_nbs.a.id},x:function(){return this.o?_nbs.a.Jz:_nbs.a.fb},E:function(){return this.d?String.format(_nbs.a.pR,this.c.DisplayName):_nbs.a.NA},v:function(n){if(this.d!==n){this.d=n;this.et("HasExistingGroup");this.et("InfoBarText")}return n},K:function(){this.et("InfoBarText");this.a&&this.a.D()},l:null,J:function(){var r=this.e.b(0);var n=new _g.f;n.Name=this.c.DisplayName;n.EmailAddress=this.c.SmtpAddress;n.MailboxType="GroupMailbox";var u=r.m(n);u.D(!0);var t=this.c.TopRelevantMembers;if(t)for(var i=0;i<t.length;i++)r.i(t[i].EmailAddress.EmailAddress);_a.d.c(_a.a.bD,"GroupSuggestionOnCompose_ClickReplaceWithGroupLink")},ew:function(){this.e=null;var n;_a.i.a(n={val:this.a}),this.a=n.val;this.b.c(ICreateGroupInGroupSuggestionEvent,this.j);this.b.c(ICreateGroupCompleteInGroupSuggestionEvent,this.i);_a.iX.prototype.ew.call(this)},k:null,y:function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.c,"ms-fcl-ns-b")},z:function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.c,"ms-fcl-nd-b")}};_mcp.J=function(n,t,i,r,u){this.j=Function.createDelegate(this,this.y);_mcp.J.initializeBase(this);var f=this;this.n=new _j.g(function(){f.a(!1)},_a.a.a);this.k=n;this.h=t;this.e=i;this.m=r;this.l=u;this.h.b(ICreateGroupInGroupSuggestionEvent,this.j);this.q()};_mcp.J.prototype={g:!1,n:null,k:null,d:null,i:!0,s:"http://groups.outlook.com/",h:null,e:null,m:null,l:null,c:null,q:function(){var n=this;this.k.a(function(t){if(!n.d&&n.e){n.z(t.d(n.l,n.e.b(0).f()));n.A(!1)}})},z:function(n){this.d=n;this.et("GroupCreationViewModel");return n},t:function(){this.c&&this.r();this.c=new _j.k;for(var e=this.e.s(),u=this.e.e(),f=Math.min(6,u),n=0;n<f;n++){var t=_h.i.a(e.d[n]);var i=1;var r=this.m.a(t,2,!1,i,!1,!1);this.c.a(r)}return this.c},x:function(){return this.e.e()>6?!0:!1},w:function(){var n=this.e.e()-6;n=n>0?n:0;return String.format(_nbs.a.fS,n)},v:function(){return this.i||!this.d},A:function(n){if(this.i!==n){this.i=n;this.et("IsCreateGroupPaneLoading")}return n},D:function(){this.et("GroupMemberPersonas");this.et("ShowPersonasTotalNumber");this.et("PersonasTotalNumber")},y:function(n){this.a(!1)},ew:function(){this.e=null;var n;_a.i.a(n={val:this.d}),this.d=n.val;this.r();this.h.c(ICreateGroupInGroupSuggestionEvent,this.j);_a.iX.prototype.ew.call(this)},r:function(){if(this.c){for(var n=0;n<this.c.x.length;n++){var r=this.c.x[n];var i;_a.i.a(i={val:r}),r=i.val}var t;_a.i.a(t={val:this.c}),this.c=t.val}},b:function(){return this.g},a:function(n){if(this.g===n)return n;if(n){var t;_a.i.a(t={val:this.d}),this.d=t.val;this.q();this.C();_a.d.c(_a.a.bD,"GroupSuggestionOnCompose_ClickCreateGroupLink")}this.g=n;this.et("IsShown");return n},C:function(){var n=$("span[class*='notchBase']");if(n){n.hasClass("ms-bg-color-white")&&n.removeClass("ms-bg-color-white");n.addClass("ms-bg-color-themePrimary")}},o:function(){return 431},p:function(){return 320},f:function(){return!0}};_mcp.bh=function(){_mcp.bh.initializeBase(this)};_mcp.bh.prototype={b:null,a:null,d:function(n){if(this.b!==n){this.b=n;this.et("Description")}return n},c:function(n){if(this.a!==n){this.a=n;this.et("ConversationOwner")}return n}};_mcp.Y=function(n){this.e=Function.createDelegate(this,this.i);_mcp.Y.initializeBase(this);this.b=_a.g.a;this.c=n};_mcp.Y.prototype={c:null,b:null,a:function(n,t,i,r){t&&n.d(t);n.e(i||this.e);r&&n.b(r);this.b.a(n)},f:function(n,t){var i=_nbs.a.NM;this.g(n,i,null,i,null,t)},h:function(n,t,i,r,u,f){var e=t;var o=n.F;if(o){if(_g.L.a(o)){var h=o;if(h.ErrorCode===503){_j.e.a(_a.a.a,"GetErrorMessage returning service unavailable {0} since the specified exception was a service unavailable json fault body",_u.R.Df);e=_u.R.Df}else if(h.ErrorCode===408&&u){_j.e.a(_a.a.a,"GetErrorMessage returning request timeout {0} since the specified exception was a request timeout json fault body",u);e=u}else if(_g.L.c(h)&&i){_j.e.a(_a.a.a,"GetErrorMessage returning disconnected {0} since the specified exception was a disconnected json fault body",i);e=i}}if(e===t){var s=_a.b.l(o);s?r&&s==="ErrorItemNotFound"?e=r:s==="ErrorAccessDenied"?e=_u.R.DP:f&&s==="ErrorQuotaExceeded"?e=f:_j.e.a(_a.a.ci,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not one of the specific jsonFaultBody or response code exceptions we are currently looking for"):_j.e.b(_a.a.ci,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not a JsonFaultBody exception or an exception with response code. The exception.Message was "+o.message)}}else _j.e.a(_a.a.a,"GetErrorMessage returning default message {0} since the exception was null",t);_j.e.a(_a.a.a,"MailComposeActionSubmitter.GetErrorMessage: showing error {0}",e);return e},g:function(n,t,i,r,u,f){var e=this.h(n,t,i,r,u,null);this.c.g(0,e,f)},i:function(n){this.f(n,null);this.d(n)},d:function(n){this.bO("MailComposeActionFailed",n)}};_mcp.b=function(){this.fs=Function.createDelegate(this,this.gx);this.q=this.A;this.ck=this.z;this.ci=this.D;this.cj=this.bC;this.cX=this.j;this.cW=this.p;_mcp.b.initializeBase(this);this.m("Html"===_g.a.a().a().m()?"HTML":"Text");this.apcl(_mcp.b.b.a,this.fs);this.apcl(_mcp.b.i.a,this.fs);if(_a.p.a&&_a.p.d()){this.ek(_g.a.a().a().bj.SmimeEncrypt);this.em(_g.a.a().a().bj.SmimeSign)}this.eZ=-1;this.eL={};this.eQ={}};_mcp.b.$$cctor=function(){_mcp.b.n.b(new _a.bv(_g.f));_mcp.b.g.b(new _a.bv(_g.f));_mcp.b.f.b(new _a.bv(_g.f));_mcp.b.m.b(new _a.bv(_pc.a));_mcp.b.d.b(new _a.bv(_g.Attachment));_mcp.b.h.b(new _a.bv(_g.bl));_mcp.b.e.b(new _a.bv(_db.d))};_mcp.b.ca=function(n,t,i,r){if(!(i in t))return r;var u=t[i];return _j.i.a(u)?r:_j.t.b(n,u)};_mcp.b.bZ=function(n,t,i){if(!(t in n))return i;var r=n[t];return _j.i.a(r)?i:Boolean.parse(r)};_mcp.b.bY=function(n){return!_j.i.b(_mcp.b.a)&&!_j.i.b(n)&&(_mcp.b.a===n||_mcp.b.a.toLowerCase()===n.toLowerCase())};_mcp.b.j=function(n,t,i,r){r.val+=" "+n+"(";if(t)for(var u=0;u<t.b();u++){r.val+=_g.m.h(t.c(u));u!==t.b()-1&&(r.val+="|")}r.val+=" QS="+i+")"};_mcp.b.cd=function(n){return n.replace(_mcp.b.cb,"\r\n")};_mcp.b.prototype={fD:null,eO:null,eX:!1,fr:null,cY:function(n){this.ey("OnAsyncSendCallbackEvent",n)},dA:function(n){this.ez("OnAsyncSendCallbackEvent",n)},fl:!1,di:function(){return this.fl},cH:function(n){this.fl=n;return n},fN:!1,b:function(){return this.ev(_mcp.b.bU)},fL:function(n){this.eu(_mcp.b.bU,n);return n},a:function(){return this.ev(_mcp.b.b)},e:function(n){this.eu(_mcp.b.b,n);return n},l:function(){return this.ev(_mcp.b.k)},t:function(n){this.eu(_mcp.b.k,n);return n},F:function(){return this.ev(_mcp.b.bq)},cM:function(n){this.eu(_mcp.b.bq,n);return n},dm:function(){return this.ev(_mcp.b.bp)},eb:function(n){this.eu(_mcp.b.bp,n);return n},d:function(){this.eO||(this.eO=this.ev(_mcp.b.br));return this.eO},cN:function(n){this.eO=n;this.eu(_mcp.b.br,this.eO);return n},h:function(){return this.ev(_mcp.b.G)},L:function(n){if(this.h()&&n){this.h().Id=n.Id;this.h().ChangeKey=n.ChangeKey}else this.eu(_mcp.b.G,n);return n},bs:function(){return!!this.h()},be:function(){return!this.gf()},gC:function(){return this.ev(_mcp.b.bO)},gU:function(n){this.eu(_mcp.b.bO,n);return n},A:function(){return this.ev(_mcp.b.bP)},z:function(n){this.eu(_mcp.b.bP,n);return n},D:function(){return this.ev(_mcp.b.J)},w:function(n){this.eu(_mcp.b.J,n);return n},x:function(){return this.ev(_mcp.b.bC)},cO:function(n){this.eu(_mcp.b.bC,n);return n},df:function(){return this.ev(_mcp.b.I)},cD:function(n){this.eu(_mcp.b.I,n);return n},eP:null,bC:function(){return this.eP},dN:function(n){this.eP=n;return n},j:function(){return this.ev(_mcp.b.s)},m:function(n){this.eu(_mcp.b.s,n);return n},g:function(){return this.ev(_mcp.b.n)},r:function(n){this.eu(_mcp.b.n,n);return n},bO:function(){return this.ev(_mcp.b.m)},en:function(n){this.eu(_mcp.b.m,n);return n},bn:function(){return this.ev(_mcp.b.bQ)},cR:function(n){this.eu(_mcp.b.bQ,n);return n},n:function(){return this.ev(_mcp.b.g)},ba:function(n){this.eu(_mcp.b.g,n);return n},bg:function(){return this.ev(_mcp.b.u)},dE:function(n){this.eu(_mcp.b.u,n);return n},c:function(){return this.ev(_mcp.b.f)},bU:function(n){this.eu(_mcp.b.f,n);return n},N:function(){return this.ev(_mcp.b.r)},dD:function(n){this.eu(_mcp.b.r,n);return n},fA:function(){return this.ev(_mcp.b.l)},f:function(n){this.eu(_mcp.b.l,n);return n},X:function(){return this.ev(_mcp.b.T)},dP:function(n){this.eu(_mcp.b.T,n);return n},dq:function(){return this.ev(_mcp.b.by)},fg:function(n){this.eu(_mcp.b.by,n);return n},gB:function(){return this.ev(_mcp.b.bH)},ej:function(n){this.eu(_mcp.b.bH,n);return n},bM:function(){return this.ev(_mcp.b.bJ)},cP:function(n){this.eu(_mcp.b.bJ,n);return n},gc:function(){return this.ev(_mcp.b.bK)},el:function(n){this.eu(_mcp.b.bK,n);return n},fw:function(){return this.ev(_mcp.b.o)},cA:function(n){this.eu(_mcp.b.o,n);return n},fi:0,O:function(){return this.fi},bZ:function(n){this.fi=n;return n},eR:null,bz:function(){return this.eR},bT:function(n){this.eR=n;return n},eW:0,cv:function(){return this.eW},M:function(n){this.eW=n;return n},fy:function(){return this.ev(_mcp.b.Z)},eY:function(n){this.eu(_mcp.b.Z,n);return n},bq:function(){return this.ev(_mcp.b.i)},fI:function(n){this.eu(_mcp.b.i,n);return n},br:function(){return this.ev(_mcp.b.bd)},fJ:function(n){this.eu(_mcp.b.bd,n);return n},dj:function(){return this.ev(_mcp.b.bk)},gn:function(n){this.eu(_mcp.b.bk,n);return n},fp:function(){return this.ev(_mcp.b.bo)},go:function(n){this.eu(_mcp.b.bo,n);return n},bE:function(){return this.ev(_mcp.b.Q)},gj:function(n){this.eu(_mcp.b.Q,n);return n},dh:function(){return this.ev(_mcp.b.V)},dR:function(n){this.eu(_mcp.b.V,n);return n},k:function(){return this.ev(_mcp.b.M)},cE:function(n){this.eu(_mcp.b.M,n);return n},bt:function(){return this.ev(_mcp.b.bD)},eg:function(n){this.eu(_mcp.b.bD,n);return n},i:function(){return this.ev(_mcp.b.bn)},cK:function(n){this.eu(_mcp.b.bn,n);return n},ds:function(){return this.ev(_mcp.b.bG)},gT:function(n){this.eu(_mcp.b.bG,n);return n},E:function(){return this.ev(_mcp.b.bb)},dU:function(n){this.eu(_mcp.b.bb,n);return n},bF:function(){return this.ev(_mcp.b.X)},fq:function(n){this.eu(_mcp.b.X,n);return n},Q:function(){return this.ev(_mcp.b.W)},ca:function(n){this.eu(_mcp.b.W,n);return n},bL:function(){return this.ev(_mcp.b.bu)},ed:function(n){this.eu(_mcp.b.bu,n);return n},bK:function(){return this.ev(_mcp.b.bt)},ec:function(n){this.eu(_mcp.b.bt,n);return n},fX:function(){return!!this.cl()},cl:function(){return this.ev(_mcp.b.t)},cB:function(n){this.eu(_mcp.b.t,n);return n},cs:function(){return this.ev(_mcp.b.bf)},cI:function(n){this.eu(_mcp.b.bf,n);return n},dg:function(){return this.ev(_mcp.b.L)},dL:function(n){this.eu(_mcp.b.L,n);return n},fV:function(){return this.ev(_mcp.b.U)},dQ:function(n){this.eu(_mcp.b.U,n);return n},bD:function(){return this.ev(_mcp.b.P)},fG:function(n){this.eu(_mcp.b.P,n);return n},cq:function(){return this.ev(_mcp.b.O)},dO:function(n){this.eu(_mcp.b.O,n);return n},bP:function(){return this.ev(_mcp.b.bR)},cS:function(n){this.eu(_mcp.b.bR,n);return n},S:function(){return this.ev(_mcp.b.bS)},gV:function(n){this.eu(_mcp.b.bS,n);return n},bl:function(){return this.ev(_mcp.b.bl)},cJ:function(n){this.eu(_mcp.b.bl,n);return n},U:function(){return this.ev(_mcp.b.H)},dJ:function(n){this.eu(_mcp.b.H,n);return n},bf:function(){return this.ev(_mcp.b.p)},gO:function(n){this.eu(_mcp.b.p,n);return n},V:function(){return this.ev(_mcp.b.N)},cF:function(n){this.eu(_mcp.b.N,n);return n},p:function(){return this.ev(_mcp.b.d)},T:function(n){var i=null;if(n){i=new _j.k;for(var t=0;t<n.b();t++)i.a(n.c(t))}this.eu(_mcp.b.d,i);this.gu();return n},by:function(){return this.ev(_mcp.b.e)},dC:function(n){this.eu(_mcp.b.e,n);return n},gz:function(){return this.ev(_mcp.b.F)},gP:function(n){this.eu(_mcp.b.F,n);return n},J:function(){return this.ev(_mcp.b.bT)},ep:function(n){this.eu(_mcp.b.bT,n);return n},eH:function(){return this.ev(_mcp.b.q)},ff:function(n){this.eu(_mcp.b.q,n);return n},eJ:null,eN:!1,bh:function(){return this.eN},cG:function(n){this.eN=n;return n},G:function(){return this.ev(_mcp.b.bB)},cd:function(n){if(n!==this.G()){this.eu(_mcp.b.bB,n);this.ex("IsCopyRestricted","IsPrintRestricted")}return n},u:function(){return this.ev(_mcp.b.z)},bY:function(n){this.eu(_mcp.b.z,n);return n},fO:!1,ei:function(n){this.fO=n;return n},bi:function(){return this.eX},dT:function(n){if(this.eX!==n){this.eX=n;n&&!this.eH()&&this.fU();this.et("IsEditorInitialized")}return n},ft:null,dK:function(n){this.ft=n;return n},fu:!1,dZ:function(n){this.fu=n;return n},bG:function(){return this.ev(_mcp.b.bc)},fH:function(n){this.eu(_mcp.b.bc,n);return n},dv:function(){return this.ev(_mcp.b.bV)},eU:function(n){this.eu(_mcp.b.bV,n);return n},W:function(){return this.ev(_mcp.b.S)},gl:function(n){this.eu(_mcp.b.S,n);return n},fz:function(){return this.ev(_mcp.b.be)},dV:function(n){this.eu(_mcp.b.be,n);return n},cy:function(){return this.ev(_mcp.b.bW)},fM:function(n){this.eu(_mcp.b.bW,n);return n},fY:function(){return!!this.G()&&!this.G().a()&&!this.G().e()&&!this.G().b()},bu:function(){return this.bq()&&_mcp.g.g(this)},fW:function(){return!!this.G()&&0===this.G().a()&&!this.G().f()&&!this.G().b()},bd:function(){return null},ce:function(){return this.A()},bw:function(){return this.fD},bp:function(){return this.ev(_mcp.b.Y)},cb:function(n){this.eu(_mcp.b.Y,n);return n},db:function(){return this.ev(_mcp.b.w)},bX:function(n){this.eu(_mcp.b.w,n);return n},cp:function(){return this.ev(_mcp.b.E)},dI:function(n){this.eu(_mcp.b.E,n);return n},co:function(){return this.ev(_mcp.b.D)},dH:function(n){this.eu(_mcp.b.D,n);return n},gy:function(){return this.ev(_mcp.b.C)},dG:function(n){this.eu(_mcp.b.C,n);return n},cm:function(){return this.ev(_mcp.b.y)},bV:function(n){this.eu(_mcp.b.y,n);return n},cn:function(){return this.ev(_mcp.b.v)},bW:function(n){this.eu(_mcp.b.v,n);return n},dc:function(){return this.ev(_mcp.b.x)},gh:function(n){this.eu(_mcp.b.x,n);return n},y:function(){return this.ev(_mcp.b.bF)},eh:function(n){this.eu(_mcp.b.bF,n);return n},Y:function(){return this.ev(_mcp.b.ba)},dS:function(n){this.eu(_mcp.b.ba,n);return n},Z:function(){return this.ev(_mcp.b.bi)},dX:function(n){this.eu(_mcp.b.bi,n);return n},fB:function(){return this.I()},bN:function(){return this.ev(_mcp.b.bL)},cQ:function(n){this.eu(_mcp.b.bL,n);return n},I:function(){return _a.p.a&&(this.o()||this.s())},o:function(){if(!_a.p.a||!_a.p.i()||!this.dz()||_g.a.a().a().bj.AlwaysShowFrom)return!1;var n=_g.a.a().bj.SmimeAdminSettings;return!!n&&n.AlwaysEncrypt||this.ev(_mcp.b.bI)},ek:function(n){this.eu(_mcp.b.bI,n);this.et(_mcp.b.c);_j.e.a(_a.a.i,"Context.SmimeEncryptMessage is set to {0}",n);return n},s:function(){if(!_a.p.a||!_a.p.i()||!this.dz()||_g.a.a().a().bj.AlwaysShowFrom)return!1;var n=_g.a.a().bj.SmimeAdminSettings;return!!n&&n.AlwaysSign||this.ev(_mcp.b.bM)},em:function(n){this.eu(_mcp.b.bM,n);this.et(_mcp.b.c);_j.e.a(_a.a.i,"Context.SmimeSignMessage is set to {0}",n);return n},dt:function(){return _g.a.a().bj.SmimeAdminSettings&&(_g.a.a().bj.SmimeAdminSettings.AlwaysEncrypt||_g.a.a().a().bj.AlwaysShowFrom)||this.E()?!1:!0},du:function(){return _g.a.a().bj.SmimeAdminSettings&&(_g.a.a().bj.SmimeAdminSettings.AlwaysSign||_g.a.a().a().bj.AlwaysShowFrom)||this.E()?!1:!0},eZ:0,bo:function(){return this.ev(_mcp.b.A)},fF:function(n){this.eu(_mcp.b.A,n);return n},dn:function(){return this.ev(_mcp.b.bs)},fK:function(n){this.eu(_mcp.b.bs,n);return n},bI:function(){if(this.bq()||_y.c.a.i()||this.I()||this.eN)return!1;var n=this.G();return!n||!!n.a()||n.b()},bH:function(){return _a.g.b?!1:this.a()!==8&&!this.R()},eS:function(){return this.ev(_mcp.b.bh)},gQ:function(n){this.eu(_mcp.b.bh,n);return n},fm:!1,fP:!1,bm:function(){return this.fP},R:function(){return this.a()===11||this.a()===12||this.a()===13},bA:function(){return this.ev(_mcp.b.bw)},v:function(n){this.eu(_mcp.b.bw,n);return n},fe:function(){return this.ev(_mcp.b.bv)},bb:function(n){this.eu(_mcp.b.bv,n);return n},gD:function(){return this.ev(_mcp.b.bX)},bc:function(n){this.eu(_mcp.b.bX,n);return n},dr:function(){return this.ev(_mcp.b.bA)},ef:function(n){this.eu(_mcp.b.bA,n);return n},P:function(){return this.ev(_mcp.b.h)},dM:function(n){this.eu(_mcp.b.h,n);return n},bk:function(){return this.ev(_mcp.b.bg)},dW:function(n){this.eu(_mcp.b.bg,n);return n},dk:function(){return this.ev(_mcp.b.bm)},dY:function(n){this.eu(_mcp.b.bm,n);return n},cr:function(){return this.ev(_mcp.b.R)},gk:function(n){this.eu(_mcp.b.R,n);return n},gA:function(){return this.ev(_mcp.b.bE)},gS:function(n){this.eu(_mcp.b.bE,n);return n},cw:function(){this.fr||(this.fr=this.bR());return this.fr},cU:function(){return this.ev(_mcp.b.bx)},cf:function(n){this.eu(_mcp.b.bx,n);return n},bB:function(){return this.ev(_mcp.b.B)},cC:function(n){this.eu(_mcp.b.B,n);return n},bj:function(){if(this.P()){var n=_g.c.a(this.P().d(),_g.c.c());return!!n&&n.bj.Value.toUpperCase()==="TRUE"}return!1},cc:function(n){_j.e.a(_a.a.a,"Setting IsOmeRequested to {0}",n);this.gY(n);return n},bJ:function(){if(!this.P())return null;var n=_g.c.a(this.P().d(),_g.c.b());if(n&&n.bj.Value){var i=n.bj.Value;var t=_a.c.b(i);t||_j.e.c(_a.a.G,"Attempt to get OME expiration time but value in extended property cannot be parsed into a datetime object.  Value: {0}",i);return t}else return null},cL:function(n){_j.e.a(_a.a.a,"Setting OmeTimeExpiration to {0}",n);this.gZ(n?_a.c.bJ(n):"");return n},fZ:function(){return this.a()===1||this.a()===2||this.fj===1},fa:null,ct:function(){return this.fa},ea:function(n){this.fa=n;return n},fb:null,ee:function(n){this.fb=n;return n},eL:null,dp:function(){return this.eL},dl:function(){return _zz.d.m(_g.co,this.eL,_zz.d.b,null)},eQ:null,cu:function(){return this.eQ},da:function(){return _zz.d.l(this.eQ,this.fk,!0)},fk:null,fd:null,dd:function(){return this.fd},dF:function(n){this.fd=n;return n},fj:0,de:function(){return this.fj},fc:!1,cx:function(){return this.fc},eo:function(n){this.fc=n;return n},ch:function(){return this.ev(_mcp.b.bN)},gr:function(n){this.eu(_mcp.b.bN,n);return n},cg:function(){return this.ev(_mcp.b.K)},gi:function(n){this.eu(_mcp.b.K,n);return n},es:function(){return this.ev(_mcp.b.bz)},gq:function(n){this.eu(_mcp.b.bz,n);return n},cV:function(){return this.ev(_mcp.b.bj)},gm:function(n){this.eu(_mcp.b.bj,n);return n},cz:function(n){return _gg.b.isInstanceOfType(n)?2:_dg.a.isInstanceOfType(n)?1:0},gI:function(n){this.t(_mcp.b.ca(_y.dD,n,_mcp.b.k.a,0));this.e(_mcp.b.ca(_y.l,n,_mcp.b.b.a,0));this.f(_mcp.b.bZ(n,_mcp.b.l.a,!0));var t=_mcp.b.bZ(n,"IsCalendarItem",!1);this.cB(t?1:0);if(n&&"StoreId"in n){this.eY(!1);this.gU(n.StoreId)}this.gJ(n);this.cK(0===this.a()||4===this.a())},dx:function(n){_g.cx.isInstanceOfType(n)?this.e(1):_g.cw.isInstanceOfType(n)?this.e(2):_g.cI.isInstanceOfType(n)&&this.e(3);this.gv(n,n.c());this.cM(n.bj.ReferenceItemId);this.eb(n.n());this.L(n.bj.ItemId);this.z(n.bj.Subject);this.w(n.c().bj.Value);this.cE(n.bj.From);this.r(n.m()?n.m().e:null);this.ba(n.o()?n.o().e:null);this.bU(n.v()?n.v().e:null);this.f(!1);this.dP(n.bK());this.fn(n);this.cd(n.bA());this.eh(n.bP());this.dS(n.bj.IsDeliveryReceiptRequested);this.dX(n.bj.IsReadReceiptRequested);this.dR(n.bj.InternetMessageId);this.fR(n);this.ge(n);this.cK(!1);this.eY(!0);_j.e.a(_a.a.a,"Initialized context with smart response, context: {0}",this)},dw:function(n){if(!n)throw Error.argumentNull("message");this.gv(n,n.I());this.dJ(n);this.L(n.bj.ItemId);this.z(n.bj.Subject);this.w(n.cn()?n.cn().bj.Value:n.I().bj.Value);this.fF(n.bj.ConversationId);if(_g.j.isInstanceOfType(n)){var t=n;this.cE(t.bj.From);this.r(t.m()?t.m().x():null);this.ba(t.o()?t.o().x():null);this.bU(t.v()?t.v().x():null);this.dS(t.bj.IsDeliveryReceiptRequested);this.dX(t.bj.IsReadReceiptRequested);this.dR(t.bj.InternetMessageId);if(t.bj.ParentMessageId){this.cM(t.bj.ParentMessageId);this.fj=t.dM()}n.cU()&&_zz.d.s(n.cU(),this.eL,this.eQ,_mco.c.b);n.cv()&&(this.fk=n.cv())}else if(_g.bd.isInstanceOfType(n)){var u=n;this.cE(u.bj.From)}this.f(!1);this.dP(n.bK());this.fn(n);this.cd(n.bA());this.eh(n.bP());n.bA()&&!n.bA().a()?this.m(n.bA().h()):n.cn()?this.m(n.cn().a()):this.m(n.du()===1?"Text":"HTML");this.fI(_dg.o.isInstanceOfType(n));if(this.bq()){var i=n;this.fo(i.y());this.fJ(_dg.j.isInstanceOfType(i));i.bj.From&&this.cE(i.bj.From);i.bj.Sender&&this.eg(i.bj.Sender)}n.cw()&&n.cw().b()?this.T(n.cw()?n.cw().e:null):(!this.eS()||this.i())&&this.T(n.T()?n.T().e:null);if(this.p()&&n.I().a()==="Text")for(var r=0;r<this.p().b();r++)this.p().c(r)&&this.p().c(r).b()&&this.p().c(r).g(!1);this.ge(n);this.cK(!0);this.eY(!0);_j.e.a(_a.a.a,"Initialized context with draft, context: {0}",this)},K:function(n){this.cN(n);this.gF(n)},gd:function(){this.eC("OnAsyncSendCallbackEvent",this)},C:function(n){var i=new _g.j;var t;this.gs(i,t={val:n}),n=t.val;return i},bx:function(n){var i=new _g.bd;var t;this.gs(i,t={val:n}),n=t.val;return i},cZ:function(){var t=this.fT();_a.b.b(this.eP,"GetEditorContentCommand");this.eP.a();var n=this.D();t.a()==="Text"&&(n=_mcp.b.cd(n));t.b(n);this.eZ=_j.i.a(n)?0:n.length;_j.e.a(_a.a.a,"MailComposeContext.CreateBodyFromEditor, ContentLength: {0}",this.eZ);return t},gX:function(n){var t=this.eH();if(!t||this.X()===t.i()){this.dP(n);t&&t.A(n)}},fU:function(){if(this.eX&&this.fu){this.eP.a();if(this.eH()){_mcp.c.z(this.eH(),this);_j.e.a(_a.a.a,"Updated baseline, context: {0}",this)}else{this.ff(_mcp.c.b(this));_j.e.a(_a.a.a,"Captured baseline for the first time, context: {0}",this);if(this.fm&&this.eJ){this.eJ.r(this.eH().a());this.fm=!1}if(!this.h()||this.eS()&&this.dv()){this.eJ=_mcp.c.b(this);_j.e.a(_a.a.a,"Captured initial baseline for context: {0}",this)}}}},gf:function(){if(!this.eH())return!1;this.eP&&this.eP.a();return!this.eH().t(this)},bS:function(n){var t=null;if(this.j()==="HTML"){var r,i;i=_a.y.a(this.D(),r={val:t}),t=r.val,i}else t=this.D();t=t?t.length>n?t.substr(0,n)+"...":t:"";return t},eV:function(n,t,i,r,u){this.r(new _j.k);var f=n?n.Mailbox:null;if(!_mcp.b.a){var h=_g.a.a().c();_mcp.b.a=_j.i.a(h.bj.SharePointUrl)?h.bj.UserEmailAddress||"":h.bj.LogonEmailAddress||""}this.a()!==8&&this.dQ(!0);if(f&&_mcp.b.bY(f.EmailAddress)){var a;var l;if(this.a()===1&&(a=t?t.b():0)+(l=i?i.b():0)+(r?r.b():0)===1){this.dQ(!1);a===1?this.g().a(t.c(0)):l===1?this.g().a(i.c(0)):this.g().a(r.c(0))}else this.a()===2&&this.dQ(!1)}if(this.a()===8&&this.fV()||this.a()!==8&&(!u||!u.b())&&f&&this.fV()){this.g().a(f);_j.e.a(_a.a.a,"Adding original From to To, Operation = {0}; From= {1}; Self= {2}",this.a(),_g.m.h(n),_mcp.b.a)}if(this.a()===2||this.a()===8){_j.e.a(_a.a.a,"Adding {0} To recipients to To.",t?t.b():0);this.fv(t,this.g(),f,null);_j.e.a(_a.a.a,"Adding {0} Cc recipients to Cc.",i?i.b():0);this.ba(new _j.k);this.fv(i,this.n(),f,this.g());_j.e.a(_a.a.a,"Adding {0} Bcc recipients to Bcc.",r?r.b():0);this.bU(new _j.k);this.fv(r,this.c(),f,this.g())}if(u&&u.b()>0)if(this.a()===1){this.g().f();for(var e=0;e<u.b();e++){var v=u.c(e);this.g().a(v)}}else if(this.a()===2)for(var o=0;o<u.b();o++){var s=u.c(o);var y=this;if(this.g().b()===this.g().i(function(n){return _g.m.a(s,n)})){var p=this;var c=this.n().i(function(n){return _g.m.a(s,n)});c!==this.n().b()&&this.n().o(c);this.g().a(s)}}if(this.a()!==8&&f&&0===this.g().b()&&(!this.n()||0===this.n().b())){this.g().a(f);_j.e.a(_a.a.a,"Adding original From since there are no recipients left, From = {0}",_g.m.h(n))}this.fQ()},toString:function(){var n="Id="+this.b()+"; Op="+this.a()+"; Mode="+this.l()+"; Oid=";n+=this.F()?this.F().Id+":"+this.F().ChangeKey+";":this.eO&&this.eO.bj.ItemId?this.eO.bj.ItemId.Id+":"+this.eO.bj.ItemId.ChangeKey+";":"null;";n+=" Did=";n+=this.h()?this.h().Id+":"+this.h().ChangeKey+";":this.U()&&this.U().bj.ItemId?this.U().bj.ItemId.Id+":"+this.U().bj.ItemId.ChangeKey+";":"null;";n+=" Subject="+this.A()+"; ContentLength="+(_j.i.a(this.D())?"0":this.D().length.toString())+"; BodyType="+this.j()+";";var r;_mcp.b.j("To",this.g(),this.bn(),r={val:n}),n=r.val;var u;_mcp.b.j("Cc",this.n(),this.bg(),u={val:n}),n=u.val;var t;_mcp.b.j("Bcc",this.c(),this.N(),t={val:n}),n=t.val;var i;_mcp.b.j("Mentions",this.dl().x(),"",i={val:n}),n=i.val;n+=" AutoSig="+this.fA()+"; Imp="+this.X()+"; QuotedBodyLength="+(_j.i.a(this.dq())?"0":this.dq().length.toString())+"; IsComplete="+this.fy()+"; IsMeeting="+this.bq()+"; IsMeetingForward="+this.br()+"; IsReplyBcc="+this.dj()+"; HasLocation="+this.bE()+"; InternetMessageId="+this.dh()+"; MeetingTime="+(this.bq()?"null":this.cV()+":"+(this.ch()?this.ch().i():"null")+":"+(this.cg()?this.cg().i():"null"))+"; From="+_g.m.h(this.k())+"; Sender="+_g.m.h(this.bt())+"; IsFromShown="+this.E()+"; IsCcShown="+this.bF()+"; IsBccShown="+this.Q()+"; AttachmentCount="+(this.p()?this.p().b().toString():"0")+"; UpgradeFailed="+this.J()+"; HasBaseline="+(!!this.eH()).toString()+"; HasInitBaseline="+(!!this.eJ).toString()+"; UserSaved="+this.bD()+"; AutoSaved="+this.cq()+"; IsReplyForward="+this.bl()+"; HasDraft="+(!!this.U()).toString()+"; HasRMLD="+(!!this.G()).toString()+"; Classified="+this.bp()+"; Class="+this.cm()+"; Sensitivity="+this.y()+"; DeliveryReceipt="+this.Y()+"; ReadReceipt="+this.Z()+"; SmimeEncryptMessage="+this.o()+"; SmimeSignMessage="+this.s()+"; ConversationId="+(this.bo()?this.bo().Id+":"+this.bo().ChangeKey:"null")+" ParentConversationNodeId="+this.dn()+"; IsOriCalId="+this.fX()+"; OccurrenceRefMaster="+this.cs()+"; IsLoadedDraft="+this.bG()+"; IsMovedToDraftFromOutbox="+this.fz()+"; IsUpgraded="+this.i()+"; IsCached="+this.fN+";";return n},dB:function(){_j.e.a(_a.a.a,"Context reset start.");this.fL(null);this.eP=null;this.a()&&this.e(0);this.l()&&this.t(0);this.F()&&this.cM(null);this.d()&&this.cN(null);this.h()&&this.L(null);_j.i.a(this.A())||this.z(null);_j.i.a(this.D())||this.w("");this.g()&&this.r(null);_j.i.a(this.bn())||this.cR(null);this.n()&&this.ba(null);_j.i.a(this.bg())||this.dE(null);this.c()&&this.bU(null);_j.i.a(this.N())||this.dD(null);this.fA()||this.f(!0);this.X()!=="Normal"&&this.dP("Normal");_j.i.a(this.dq())||this.fg(null);this.fy()&&this.eY(!1);this.bq()&&this.fI(!1);this.br()&&this.fJ(!1);this.dj()&&this.gn(!1);this.fp()&&this.go(null);this.bE()&&this.gj(!1);this.dh()&&this.dR(null);this.ch()&&this.gr(null);this.cg()&&this.gi(null);this.es()&&this.gq(null);this.cV()&&this.gm(!1);this.k()&&this.cE(null);this.bt()&&this.eg(null);this.i()&&this.cK(!1);this.E()&&this.dU(!1);this.bF()&&this.fq(!1);this.Q()&&this.ca(!1);this.p()&&this.T(null);this.by()&&this.dC(null);this.J()&&this.ep(!1);this.eH()&&this.ff(null);this.bD()&&this.fG(!1);this.cq()&&this.dO(!1);this.bl()&&this.cJ(!1);this.U()&&this.dJ(null);this.G()&&this.cd(null);_j.i.a(this.u())||this.bY(null);this.bp()&&this.cb(!1);_j.i.a(this.db())||this.bX(null);_j.i.a(this.cm())||this.bV(null);_j.i.a(this.cn())||this.bW(null);this.dc()&&this.gh(!1);this.y()!=="Normal"&&this.eh("Normal");this.Y()&&this.dS(!1);this.Z()&&this.dX(!1);this.o()&&this.ek(!1);this.s()&&this.em(!1);this.gc()&&this.el(null);this.bo()&&this.fF(null);_j.i.a(this.dn())||this.fK(null);this.cl()&&this.cB(0);this.cs()&&this.cI(!1);this.bG()&&this.fH(!1);this.fz()&&this.dV(!1);this.P()&&this.dM(null);this.fc&&(this.fc=!1);if(this.bA()){_y.j.a(this.bA(),null,"ContextReset",null,null);this.v(null)}_j.e.a(_a.a.a,"Context reset end.")},dy:function(){return!!this.d().bA()&&0===this.d().bA().a()&&!this.d().bA().i()&&!this.d().bA().l()},bQ:function(){var n=null;if(this.k()&&this.k().Mailbox&&!_j.i.a(this.k().Mailbox.EmailAddress))n=this.k().Mailbox;else if(this.bt()&&this.bt().Mailbox&&!_j.i.a(this.bt().Mailbox.EmailAddress))n=this.bt().Mailbox;else if(!_j.i.a(_mcp.b.a)){n=new _g.f;n.EmailAddress=_mcp.b.a;n.MailboxType="Mailbox";n.RoutingType="SMTP"}return n},dz:function(){if(!_a.p.a||_a.p.o)return!1;switch(this.a()){case 0:case 1:case 2:case 3:case 4:break;default:return!1}return this.U()&&!this.fC(this.U())?!1:this.d()&&!this.fC(this.d())?!1:_j.i.a(this.bB())?!0:!1},fC:function(n){if(_j.i.a(n.bj.ItemClass)||n.bj.ItemClass==="IPM.Note"||n.bG())return!0;else{var i=this.a()===1||this.a()===2;var t=i||this.a()===3;return i&&(n.bj.ItemClass.startsWith("IPM.Schedule.Meeting")||n.bj.ItemClass.startsWith("IPM.Appointment"))?!0:t&&n.bj.ItemClass.startsWith("REPORT.IPM.Note")?!0:t&&n.bj.ItemClass.startsWith("IPM.Note.Rules")?!0:t&&n.bj.ItemClass==="IPM.Post"?!0:!1}},cT:function(n){_j.e.a(_a.a.i,"Updating S/MIME options...");if(_a.p.a)switch(n){case 6:this.ek(!0);this.em(!1);break;case 10:case 11:this.ek(!1);this.em(!0);break;case 12:case 13:case 14:this.ek(!0);this.em(!0);break;case-1:case 0:default:this.ek(!1);this.em(!1);break}},ha:function(n){_j.e.a(_a.a.i,"Upgrading S/MIME options...");if(_a.p.a)switch(n){case 6:this.ek(!0);break;case 10:case 11:this.em(!0);break;case 12:case 13:case 14:this.ek(!0);this.em(!0);break;case-1:case 0:default:break}},bv:function(){if(this.bA()){var t=!1;var n=this;this.fD=function(i){if(!t&&n.bA()){_y.j.a(n.bA(),null,i);n.v(null);t=!0}}}},bR:function(n,t){var i=this.gc();if(!i||!i.length)return null;_j.B.a(n)&&(n=0);_j.B.a(t)&&(t=i.length);for(var r=new _j.q,h=n;h<n+t;h++){var s=i[h];if(s&&s.length)for(var a=s,v=a.length,f=0;f<v;++f){var u=a[f];_j.i.a(u)||r.g(u)||r.c(u)}}if(n+t<i.length){var o=i[i.length-1];if(o&&o.length>0)for(var l=o,y=l.length,e=0;e<y;++e){var c=l[e];_j.i.a(c)||r.g(c)||r.c(c)}}return r.d.length>0?r.d:null},gs:function(n,t){t.val=!!t.val!==t.val?!1:t.val;n.ck(this.A());n.dy(this.X());n.bN(this.h());n.ba(new(_a.fe.$$(_g.Attachment,_g.bm)));if(this.I()){var s=_g.a.a().bj.SmimeAdminSettings.ClearSign;n.eW(this.o()?"IPM.Note.SMIME":s?"IPM.Note.SMIME.MultipartSigned":"IPM.Note.SMIME");n.bj.ItemClass==="IPM.Note.SMIME.MultipartSigned"?n.cB(this.fS(t.val)):n.cB(new _g.w(new _g.s(this.j(),"")));var o=_a.bl.b(this.gB());n.hT(new _g.ez(o))}else{n.cB(this.fS(t.val));(this.U()&&this.U().bG()||this.d()&&this.d().bG())&&n.eW("IPM.Note");this.p()&&n.T().i(this.p().d())}n.hW(this.G());n.dl(this.y());n.eV(this.bp());n.eR(this.cm());n.eS(this.cn());n.eU(this.db());n.gt(this.cp());n.gs(this.co());n.gr(this.gy());n.hL(this.gz());if(this.P()){n.fE(new(_a.fe.$$(_g.bl,_g.U)));n.bL().i(this.P().d())}if(_g.j.isInstanceOfType(n)){var i=n;i.cu(this.k());_zz.d.j(i.I().bj.Value,i.bj.Subject,this.eL);_zz.d.k(i.I().bj.Value,i.bj.Subject,this.eQ);var e=_zz.d.i(i.I().bj.Value,i.bj.Subject,this.eL);i.fC(e);this.gL(e);_zz.d.d(i,this.eL,this.dl(),this.eQ,this.da());if(this.I()&&this.eW){if(this.eW===1){i.bV(new _a.j);this.g()&&i.m().i(this.g().d());i.ca(new _a.j);this.n()&&i.o().i(this.n().d())}else if(this.eW===2){i.cd(new _a.j);this.c()&&i.v().c(this.c().c(this.fi))}else if(this.eW===3){i.cd(new _a.j);this.c()&&i.v().i(this.c().d())}}else{i.bV(new _a.j);this.g()&&i.m().i(this.g().d());i.ca(new _a.j);this.n()&&i.o().i(this.n().d());i.cd(new _a.j);this.c()&&i.v().i(this.c().d())}i.cy(this.Y());i.cD(this.Z());i.dV(this.o());i.dW(this.s());this.dh()&&i.cx(this.dh())}else{var u=n;u.cI(this.bK());var f=_g.a.a().c();var r=null;r=_j.i.a(f.bj.LogonEmailAddress)?null!==this.k()&&this.k().Mailbox?this.k().Mailbox.EmailAddress:_mco.a.g(null)||f.bj.UserEmailAddress:f.bj.LogonEmailAddress;if(r){u.g(new _g.O);u.bj.From.Mailbox=new _g.f;u.bj.From.Mailbox.EmailAddress=r}}},gL:function(n){if(n){var r="AtAllMention_Mail_";r=r+(this.eN?"Group_":"ME_");var h=_y.l.toString(this.a());var e=new _a.bp(1,r+h);_a.r.c.a(e);for(var t=this.g(),i=!1,u=0;u<t.b();u++)if(t.c(u).MailboxType==="GroupMailbox"){i=!0;break}if(!i){t=this.n();for(var f=0;f<t.b();f++)if(t.c(f).MailboxType==="GroupMailbox"){i=!0;break}}if(!i){t=this.c();for(var o=0;o<t.b();o++)if(t.c(o).MailboxType==="GroupMailbox"){i=!0;break}}var s="MsgHasAtleastAGroup_";i||(s="MsgHasNoGroup_");e=new _a.bp(1,r+s+h);_a.r.c.a(e)}},fv:function(n,t,i,r){if(n)for(var f=0;f<n.b();f++){var u=n.c(f);if(_g.m.a(u,i)){_j.e.a(_a.a.a,"Excluding original from {0}",i);continue}if(_mcp.b.bY(u.EmailAddress)||this.gK(u.EmailAddress)){_j.e.a(_a.a.a,"Excluding self address {0}",_mcp.b.a||"null");continue}var e=this;if(r&&r.b()!==r.i(function(n){return _g.m.a(u,n)})){_j.e.a(_a.a.a,"Excluding address {0} already in to",u);continue}t.a(u)}},gK:function(n){var t=this.k();return!!t&&!!t.Mailbox&&t.Mailbox.EmailAddress===n},gx:function(n,t){this.et("ShowMeetingReadonlyFields")},gJ:function(n){var t=this.gM(n);switch(this.a()){case 0:case 4:this.L(t);break;case 1:case 2:case 3:this.cM(t);break}},ge:function(n){if(n.bL()){this.dM(new _j.k);this.P().m(n.bL().f())}},gM:function(n){var t=null;if(n&&"Id"in n){t=new _g.g(n.Id);"ChangeKey"in n&&(t.ChangeKey=n.ChangeKey)}return t},gv:function(n,t){0===n.du()&&n.fI(t&&t.a()==="Text"?1:3)},gH:function(n){var r=_mco.a.g(n);if(r){this.cE(new _g.O);this.k().Mailbox=new _g.f;this.k().Mailbox.EmailAddress=r}this.cB(0);switch(this.a()){case 1:case 2:case 12:this.fn(n);if(_g.j.isInstanceOfType(n)){var t=n;t.x()?this.eV(t.bj.From||t.bj.Sender,null,null,null,null):this.eV(t.bj.From||t.bj.Sender,t.m()?t.m().e:null,t.o()?t.o().e:null,t.v()?t.v().e:null,t.db()?t.db().e:null);this.gn(this.a()===2&&n.hC()&&!t.bj.IsGroupEscalationMessage);this.eb(n.ef())}else if(_g.bd.isInstanceOfType(n)){var i=n;this.eV(i.bj.From||i.bj.Sender,null,null,null,null)}this.fE(n);break;case 3:_dg.o.isInstanceOfType(n)||this.fn(n);this.eb(n.ef());this.fQ();this.fE(n);this.gN(n);break;case 9:case 10:_g.j.isInstanceOfType(n)?this.eV(n.bj.Sender,null,null,null,null):_g.bd.isInstanceOfType(n)&&this.eV(n.bj.Sender,null,null,null,null);this.fE(n);break;case 5:case 6:case 7:default:this.gt();break}_j.e.a(_a.a.a,"Initialized context with original email message, context: {0}",this)},gF:function(n){this.cM(n.bj.ItemId);var i=this.dy();this.cd(i?null:n.bA());this.gW(n.cF());this.eh(n.bP());this.w(this.D()||"");this.fR(n);if(!this.i()){this.cK(!(this.a()===1||this.a()===2||this.a()===3||this.a()===12));this.a()!==3||_a.p.a&&n.bG()||i||this.G()&&this.G().a()||this.T(n.T()?n.T().e:null)}if(_dg.ICalendaring.isInstanceOfType(n)){var t=n;t.be();this.gG(t)}else if(_g.j.isInstanceOfType(n)||_g.bd.isInstanceOfType(n)){if(3===this.a()&&!this.i()){this.dP(n.bK());_j.e.a(_a.a.a,"Setting importance to {0} since we are forwarding item {1} with that importance",this.X(),_h.ba.a(n.bj.ItemId))}this.gH(n)}else throw Error.invalidOperation(String.format("Original item of type {0} is not supported.",Object.getType(n).getName()));this.gu();_g.j.isInstanceOfType(n)&&n.bQ?this.eY(!1):this.eY(!0)},fR:function(n){n.cn()&&this.m(n.cn().a())},gE:function(n){var t=null;_dg.q.isInstanceOfType(n)||_dg.n.isInstanceOfType(n)?t=n.bj.From:n.r()?t=n.r():_j.e.c(_a.a.a,"ICalendaring doesnt have an organizer");return t},gu:function(){var n=new _j.q;this.br()&&n.h(_dg.j.a(this.p()));if(this.eO&&_a.p.a&&this.eO.bG()&&this.eO.dQ()){var t=this.eO.T().a(0).bj.AttachmentId.Id;n.c(t)}this.gO(n.j())},gG:function(n){this.cB(this.cz(n));var u=this.gE(n);var t;var r;if(_dg.q.isInstanceOfType(n)||_dg.n.isInstanceOfType(n)){t=n.m()?_g.m.g(n.m().e):null;r=n.o()?_g.m.g(n.o().e):null}else{t=n.q()?_g.m.g(_dg.f.d(n.q().e)):null;r=n.t()?_g.m.g(_dg.f.d(n.t().e)):null}if(_gg.b.isInstanceOfType(n)){var i=n;if(!_j.i.a(i.bj.CustomerEmail)&&_a.G.a(i.bj.CustomerEmail)){var f=new _g.f;f.EmailAddress=i.bj.CustomerEmail;f.Name=_j.i.b(i.bj.CustomerName)?i.bj.CustomerEmail:i.bj.CustomerName;t.a(f)}}switch(this.a()){case 1:case 2:this.eV(u,t,r,null,null);break;case 5:case 6:case 7:this.eV(u,t,r,null,null);this.fo(n);this.gl(!0);break;case 8:var e=n.q().t();e.i(n.F().f());t=_g.m.g(_dg.f.d(e.e));this.eV(u,t,r,null,null);this.fo(n);this.gl(!0);break;case 3:if(_dg.j.isInstanceOfType(n)||_dg.a.isInstanceOfType(n)){this.fJ(!0);this.cE(u);this.fo(n)}break;default:this.gt();break}this.fI(!0);_j.e.a(_a.a.a,"Initialized context from original calendar item, context: {0}",this)},fo:function(n){this.gw(n);this.go(n.s());this.gj(!!this.fp()&&!_j.i.a(this.fp().bj.DisplayName))},gW:function(n){var t="";switch(this.a()){case 1:case 2:case 12:t=_u.n.KI;break;case 3:t=_nbs.a.ZF;break;case 5:t=_nbs.a.Vc;break;case 6:t=_nbs.a.gw;break;case 7:t=_nbs.a.ec;break;case 8:t=_nbs.a.Sc;break;case 9:t=_nbs.a.nM;break;case 10:t=_nbs.a.Nl;break}var i=String.format(_nbs.a.ik,t,n);_j.e.a(_a.a.a,"Formatted subject with Prefix = {0}; Operation = {1}",t,this.a());if(255<i.length){this.z(i.substr(0,255));_j.e.a(_a.a.a,"Truncated subject from {0} to {1} to meet the {2} characters rule.",i,this.A(),255)}else this.z(i)},fE:function(n){this.fF(n.bj.ConversationId);_g.j.isInstanceOfType(n)?this.fK(n.bj.InternetMessageId):_g.bd.isInstanceOfType(n)&&this.fK(n.bj.InternetMessageId)},gt:function(){var n=_j.t.d(_y.l,this.a());throw Error.invalidOperation(String.format("Cannot perform operation {0} with original item.",n));},fn:function(n){this.cb(n.dt());this.bX(n.ed());this.bV(n.eb());this.bW(n.ec());this.gh(n.hv())},fS:function(n){return n?this.fT():this.cZ()},fT:function(){var n=new _g.w(new _g.s("HTML",""));n.b("");if(4!==this.a()&&13!==this.a()||this.dr()){_j.e.a(_a.a.a,"Create new body for action email message, setting body type to context body type: {0}",this.j());n.c(this.j())}else{_j.e.a(_a.a.a,"Create new body for action email message, setting body type to text due to lack of support for RichTextEditor.");n.c("Text")}return n},fQ:function(){if(_y.c.a.i()){var n=this.bQ();if(n){if(!this.gg(this.g(),n.EmailAddress)&&!this.gg(this.n(),n.EmailAddress)){this.n()||this.ba(new _j.k);this.n().a(n);_j.e.a(_a.a.a,"Adding self to CC")}}else _j.e.c(_a.a.a,"Could not add self to CC as the address was missing")}},gg:function(n,t){if(n)for(var i=0;i<n.b();i++){var r=n.c(i);if(t.toLowerCase()===r.EmailAddress.toLowerCase())return!0}return!1},gY:function(n){var t=null;if(n){this.P()?t=_g.c.a(this.P().d(),_g.c.c()):this.dM(new _j.k);if(!t){var i=new _g.U;i.ExtendedFieldURI=_g.c.c();t=new _g.bl(i);this.P().a(t)}t.b("True")}else{if(!this.P())return;t=_g.c.a(this.P().d(),_g.c.c());t&&t.b("False")}},gw:function(n){this.gr(n.c());this.gi(n.g());this.gq(n.D());this.gm(n.J())},gZ:function(n){var t=null;if(_j.i.a(n)){if(!this.P())return;t=_g.c.a(this.P().d(),_g.c.b());if(t){t.b(undefined);this.P().n(t,!0)}}else{this.P()?t=_g.c.a(this.P().d(),_g.c.b()):this.dM(new _j.k);if(!t){var i=new _g.U;i.ExtendedFieldURI=_g.c.b();t=new _g.bl(i);this.P().a(t)}t.b(n)}},gN:function(n){if(_a.g.b){var t=n.bL()?_g.c.a(n.bL().f(),_g.c.b()):null;t&&this.cL(_a.c.b(t.bj.Value))}}};_mcp.E=function(n){this.e={};this.f=n};_mcp.E.prototype={f:null,a:function(n){return n in this.e},d:function(n,t){if(n in this.e){var i=this.e[n];!i.a&&t&&(this.e[n]=new _mcp.bb(t))}else this.e[n]=new _mcp.bb(t)},g:function(n,t){var u=n.a;var i=u.bb;var r=i.b();var o=i.h();var f=!1;if(i.bG())_j.e.a(_a.a.a,"Not discarding a loaded draft for context {0}",r);else if(i.bD())_j.e.a(_a.a.a,"Not discarding an explicitly saved draft for context {0}",r);else if(u.bm().f())_j.e.a(_a.a.a,"Not discarding a draft currently being explicitly saved for context {0}",r);else if(u.bh().c())_j.e.a(_a.a.a,"Not discarding a draft currently being sent for context {0}",r);else{var e=!1;if(t)_j.e.a(_a.a.a,"Skipping dirty check for context {0}",r);else{_j.e.a(_a.a.a,"Checking dirty for determining whether to discard unused message on navigate away. Context:{0}",i);e=u.bR()}if(e)_j.e.a(_a.a.a,"Not discarding a dirty draft for context {0}",r);else if(i.eJ)if(i.eJ.s(i.eH())){if(_g.k.b&&i.bl()&&!i.h()){_j.e.a(_a.a.a,"Calling main window to remember the pending discard for context {0}",r);_g.k.b.jp(r,!i.bD());f=!0}else if(!i.R()){_j.e.a(_a.a.a,"Discarding unused draft for context {0}",r);this.b(r,o,u.bq,i.bD());f=!0}}else _j.e.a(_a.a.a,"Not discarding a draft different from the initial baseline for context {0}",r);else _j.e.a(_a.a.a,"Not discarding without an initial baseline for context {0}",r)}return f},b:function(n,t,i,r){i||(i=new _mcp.Y(new _bc.b));var u;if(this.e[n]){var e=this.e[n];u=e.a}else u=!r;if(t){var f=this.f.a(t,u);i.a(f,null,null,null);delete this.e[n];_j.e.a(_a.a.a,"Delete action submitted, ID={0}, Changekey={1}, isHardDelete={2}",t.Id,t.ChangeKey,u)}else{this.e[n]=new _mcp.bb(u);_j.e.a(_a.a.a,"Discard pending because we do not have the draft ID yet. ContextId={0}; Hard={1}",n,u)}},c:function(n,t){this.b(n,t,new _mcp.Y(new _bc.b),!1)}};_mcp.c=function(){_mcp.c.initializeBase(this)};_mcp.c.$$cctor=function(){_mcp.c.h.b(_mcp.c.f);_mcp.c.e.b(_mcp.c.f);_mcp.c.d.b(_mcp.c.f);_mcp.c.c.b(new _a.bv(_g.Attachment));_mcp.c.g.b(new _a.bv(_g.bl))};_mcp.c.b=function(n){var t=new _mcp.c;_mcp.c.z(t,n);return t};_mcp.c.z=function(n,t){n.K(t.q());n.r(t.D());if(t.g()){n.B(new _j.k);n.e().m(t.g().d())}else n.B(null);n.L(t.bn());if(t.n()){n.x(new _j.k);n.d().m(t.n().d())}else n.x(null);n.D(t.bg());if(t.c()){n.w(new _j.k);n.c().m(t.c().d())}else n.w(null);if(t.p()){n.p(new _j.k);n.b().m(t.p().d())}else n.p(null);if(t.P()){n.y(new _j.k);n.q().m(t.P().d())}else n.y(null);n.C(t.N());n.A(t.X());n.z(t.k());n.E(t.u());n.H(t.y());n.F(t.Y());n.G(t.Z());n.I(t.o());n.J(t.s())};_mcp.c.a=function(n,t,i,r){if(i!==r&&!(_j.i.a(i)&&_j.i.a(r))||!_mcp.c.x(n,t))return!1;if(!n||!t)return!0;for(var u=0;u<n.b();u++){var e=n.c(u);var f=t.c(u);if(!_mcp.c.i(e,f))return!1}return!0};_mcp.c.i=function(n,t){return!n&&t||!t&&n?!1:!n&&!t?!0:_g.m.a(n,t)};_mcp.c.x=function(n,t){var r=_mcp.c.y(n);var i=_mcp.c.y(t);return r===i};_mcp.c.y=function(n){return n?n.b():0};_mcp.c.w=function(n,t){if(!_mcp.c.x(n,t))return!1;if(!n||!t)return!0;for(var i=0;i<n.b();i++){var u=n.c(i);var r=t.c(i);if(!_mcp.c.B(u,r))return!1}return!0};_mcp.c.A=function(n,t){return _db.bv.a(n,t)};_mcp.c.B=function(n,t){return!n&&t||!t&&n?!1:!n&&!t?!0:!n.bj.AttachmentId&&t.bj.AttachmentId||!t.bj.AttachmentId&&n.bj.AttachmentId?!1:n.bj.AttachmentId&&n.bj.AttachmentId.Id!==t.bj.AttachmentId.Id?!1:n.bj.Name!==t.bj.Name?!1:n.bj.ContentType!==t.bj.ContentType?!1:n.bj.ContentId!==t.bj.ContentId?!1:n.bj.ContentLocation!==t.bj.ContentLocation?!1:n.a()!==t.a()?!1:!n.m()&&t.m()||!t.m()&&n.m()?!1:n.m()&&!n.m().C(t.m())?!1:n.b()!==t.b()?!1:!0};_mcp.c.prototype={f:function(){return this.ev(_mcp.c.u)},K:function(n){this.eu(_mcp.c.u,n);return n},a:function(){return this.ev(_mcp.c.m)},r:function(n){this.eu(_mcp.c.m,n);return n},e:function(){return this.ev(_mcp.c.h)},B:function(n){this.eu(_mcp.c.h,n);return n},j:function(){return this.ev(_mcp.c.v)},L:function(n){this.eu(_mcp.c.v,n);return n},d:function(){return this.ev(_mcp.c.e)},x:function(n){this.eu(_mcp.c.e,n);return n},h:function(){return this.ev(_mcp.c.k)},D:function(n){this.eu(_mcp.c.k,n);return n},c:function(){return this.ev(_mcp.c.d)},w:function(n){this.eu(_mcp.c.d,n);return n},g:function(){return this.ev(_mcp.c.j)},C:function(n){this.eu(_mcp.c.j,n);return n},i:function(){return this.ev(_mcp.c.o)},A:function(n){this.eu(_mcp.c.o,n);return n},l:function(){return this.ev(_mcp.c.n)},z:function(n){this.eu(_mcp.c.n,n);return n},k:function(){return this.ev(_mcp.c.l)},E:function(n){this.eu(_mcp.c.l,n);return n},o:function(){return this.ev(_mcp.c.r)},H:function(n){this.eu(_mcp.c.r,n);return n},m:function(){return this.ev(_mcp.c.p)},F:function(n){this.eu(_mcp.c.p,n);return n},n:function(){return this.ev(_mcp.c.q)},G:function(n){this.eu(_mcp.c.q,n);return n},u:function(){return this.ev(_mcp.c.s)},I:function(n){this.eu(_mcp.c.s,n);return n},v:function(){return this.ev(_mcp.c.t)},J:function(n){this.eu(_mcp.c.t,n);return n},b:function(){return this.ev(_mcp.c.c)},p:function(n){this.eu(_mcp.c.c,n);return n},q:function(){return this.ev(_mcp.c.g)},y:function(n){this.eu(_mcp.c.g,n);return n},t:function(n){if(this.i()!==n.X()){_j.e.a(_a.a.a,"Dirty due to importance: snapshotImportance={0}, contextImportance={1}",this.i(),n.X());return!1}if(this.f()!==n.q()){_j.e.a(_a.a.a,"Dirty due to subject: snapshotSubjectLength={0}, contextSubjectLength={1}",this.f()?this.f().length:0,n.q()?n.q().length:0);return!1}if(this.k()!==n.u()){_j.e.a(_a.a.a,"Dirty due to compliance ID: snapshotId={0}, contextId={1}",this.k(),n.u());return!1}if(this.o()!==n.y()){_j.e.a(_a.a.a,"Dirty due to sensitivity: snapshot={0}, context={1}",this.o(),n.y());return!1}if(this.m()!==n.Y()){_j.e.a(_a.a.a,"Dirty due to IsDeliveryReceiptRequested: snapshot={0}, context={1}",this.m(),n.Y());return!1}if(this.n()!==n.Z()){_j.e.a(_a.a.a,"Dirty due to IsReadReceiptRequested: snapshot={0}, context={1}",this.n(),n.Z());return!1}if(this.u()!==n.o()){_j.e.a(_a.a.a,"Dirty due to SmimeEncryptMessage: snapshot={0}, context={1}",this.u(),n.o());return!1}if(this.v()!==n.s()){_j.e.a(_a.a.a,"Dirty due to SmimeSignMessage: snapshot={0}, context={1}",this.v(),n.s());return!1}var i=this.l()?this.l().Mailbox:null;var t=n.k()?n.k().Mailbox:null;if(!_mcp.c.i(i,t)){_j.e.a(_a.a.a,"Dirty due to From: snapshotFrom={0}, contextFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.c.a(this.e(),n.g(),this.j(),n.bn())){_j.e.a(_a.a.a,"Dirty due to To: snapshotToCout={0}, contextToCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",this.e()?this.e().x.length:0,n.g()?n.g().b():0,this.j()?this.j().length:0,n.bn()?n.bn().length:0);return!1}if(!_mcp.c.a(this.d(),n.n(),this.h(),n.bg())){_j.e.a(_a.a.a,"Dirty due to To: snapshotCcCout={0}, contextCcCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",this.d()?this.d().x.length:0,n.n()?n.n().b():0,this.h()?this.h().length:0,n.bg()?n.bg().length:0);return!1}if(!_mcp.c.a(this.c(),n.c(),this.g(),n.N())){_j.e.a(_a.a.a,"Dirty due to To: snapshotBccCout={0}, contextBccCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",this.c()?this.c().x.length:0,n.c()?n.c().b():0,this.g()?this.g().length:0,n.N()?n.N().length:0);return!1}if(!_mcp.c.w(this.b(),n.p())){_j.e.a(_a.a.a,"snapshotAttachmentCount="+(this.b()?this.b().b():0)+", contextAttachmentCount="+(n.p()?n.p().b():0));return!1}if(!_mcp.c.A(this.q(),n.P())){_j.e.a(_a.a.a,"snapshotExtendedPropertyCount="+(this.q()?this.q().x.length:0)+", contextExtendedPropertyCount="+(n.P()?n.P().x.length:0));return!1}if(this.a()!==n.D()){_j.e.a(_a.a.a,"Dirty due to editor content: snapshotContentLength={0}, contextContentLength={1}",this.a()?this.a().length:0,n.D()?n.D().length:0);return!1}_j.e.a(_a.a.a,"Context is clean");return!0},s:function(n){if(!n){_j.e.a(_a.a.a,"Comparing with a null snapshot, this case is always considered equal.");return!0}if(this.i()!==n.i()){_j.e.a(_a.a.a,"sourceImportance={0}, targetImportance={1}",this.i(),n.i());return!1}if(this.f()!==n.f()){_j.e.a(_a.a.a,"sourceSubject={0}, targetSubject={1}",this.f(),n.f());return!1}if(this.k()!==n.k()){_j.e.a(_a.a.a,"sourceComplianceId={0}, targetComplianceId={1}",this.k(),n.k());return!1}if(this.o()!==n.o()){_j.e.a(_a.a.a,"sourceSensitivity={0}, targetSensitivity={1}",this.o(),n.o());return!1}if(this.m()!==n.m()){_j.e.a(_a.a.a,"sourceIsDeliveryReceiptRequested={0}, targetIsDeliveryReceiptRequested={1}",this.m(),n.m());return!1}if(this.n()!==n.n()){_j.e.a(_a.a.a,"sourceIsReadReceiptRequested={0}, targetIsReadReceiptRequested={1}",this.n(),n.n());return!1}var i=this.l()?this.l().Mailbox:null;var t=n.l()?n.l().Mailbox:null;if(!_mcp.c.i(i,t)){_j.e.a(_a.a.a,"sourceFrom={0}, targetFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.c.a(this.e(),n.e(),this.j(),n.j())){_j.e.a(_a.a.a,"sourceToCout={0}, targetToCout={1}, sourceQueryString={2}, targetQueryString={3}",this.e()?this.e().x.length:0,n.e()?n.e().x.length:0,this.j(),n.j());return!1}if(!_mcp.c.a(this.d(),n.d(),this.h(),n.h())){_j.e.a(_a.a.a,"sourceCcCout={0}, targetCcCout={1}, sourceQueryString={2}, targetQueryString={3}",this.d()?this.d().x.length:0,n.d()?n.d().x.length:0,this.h(),n.h());return!1}if(!_mcp.c.a(this.c(),n.c(),this.g(),n.g())){_j.e.a(_a.a.a,"sourceBccCout={0}, targetBccCout={1}, sourceQueryString={2}, targetQueryString={3}",this.c()?this.c().x.length:0,n.c()?n.c().x.length:0,this.g(),n.g());return!1}if(!_mcp.c.w(this.b(),n.b())){_j.e.a(_a.a.a,"sourceAttachmentCount="+(this.b()?this.b().b():0)+", targetAttachmentCount="+(n.b()?n.b().b():0));return!1}if(this.a()!==n.a()){_j.e.a(_a.a.a,"Dirty due to editor content: snapshotContentLength={0}, snapshotContentLength={1}",this.a()?this.a().length:0,n.a()?n.a().length:0);return!1}_j.e.a(_a.a.a,"snapshot is clean");return!0}};_mcp.bT=function(n,t){this.g=Function.createDelegate(this,this.i);if(!n)throw Error.argumentNull("callback");if(t<=3e3)throw Error.argumentOutOfRange("timeoutPeriod");this.f=t;this.d=n};_mcp.bT.prototype={f:0,d:null,a:null,b:!1,c:function(){!this.a&&this.b&&(this.a=_j.o.a().a(_a.a.a,"MailComposeTimer",this.g,this.f))},h:function(){_j.e.a(_a.a.a,"Disabling timer.");this.b=!1;this.e()},e:function(){if(this.a){_j.e.a(_a.a.a,"Clearing timer.");this.a=_j.o.a().b(this.a)}},i:function(){_j.e.a(_a.a.a,"Executing timer callback.");this.e();this.d()}};_mcp.u=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi){_mcp.u.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi])};_mcp.u.prototype={L:function(){return this.bb.cx()?"MailUnifiedCompose_UpConverted":"MailUnifiedCompose"},dR:function(){return 15}};_mcp.e=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi){this.dd=Function.createDelegate(this,this.bf);this.dI=Function.createDelegate(this,this.eW);this.dK=Function.createDelegate(this,this.fg);this.dL=Function.createDelegate(this,this.fj);this.db=Function.createDelegate(this,this.eZ);this.cM=Function.createDelegate(this,this.em);this.cN=Function.createDelegate(this,this.eY);this.dH=Function.createDelegate(this,this.dO);this.dc=Function.createDelegate(this,this.fa);this.dJ=Function.createDelegate(this,this.eX);this.ce=new _j.V;_mcp.e.resolveInheritance();this.W=this.dispose;_mcp.e.initializeBase(this);_a.b.b(k,"nativeBridge");this.cD=4;this.bb=n;this.bl=t||new _bc.b;this.bl.F(g);this.bc=this.bw();this.di=i;this.bY=r;this.cW=u;this.bq=new _mcp.Y(this.bl);this.dv=f;this.cC=s;this.da=e;this.bv=o;this.bO=h;this.bB=c;this.bi=l;this.bo=v;this.cq=p;this.co=a;this.cw=w;this.bu=b;this.bC=y;this.cB=k;this.bT=d;this.bA=g;this.du=nt;this.cj=tt;this.ck=it;this.cl=rt;this.df=ut;this.bS=ft;this.bZ=et;this.dj=ot;this.cI=st;this.cn=ht;this.ek=ct;this.cA=lt;this.dw=at;this.ch=vt;this.cf=yt;this.ci=pt;this.cp=wt;this.cg=bt;this.de=kt;this.dx=dt;this.bE=gt;this.bU=ni;this.bQ=ti;this.dt=ii;this.cH=ri;this.cd=ui;this.cm=fi;if(o){var ei=o;this.bN=ei.t||(ei.t=Function.createDelegate(ei,ei.d))}this.bA||(this.cz=!0);this.cO=!0;this.cQ=!0;_j.e.a(_a.a.a,"ViewModel created")};_mcp.e.a=function(n,t){if(!n){_j.e.b(_a.a.a,"MailComposeViewModel.SafeGetComponent - map is null, cannot access component.");return null}return n.b(t)};_mcp.e.c=function(){return+new Date+":"+Math.random()};_mcp.e.prototype={di:null,bb:null,bY:null,cW:null,dv:null,da:null,cC:null,bl:null,bv:null,bo:null,cq:null,dw:null,bO:null,bi:null,bB:null,bC:null,cB:null,cw:null,ek:null,bT:null,cj:null,ck:null,cl:null,df:null,bA:null,du:null,bS:null,bZ:null,dj:null,bE:null,co:null,cI:null,cn:null,bU:null,bQ:null,dt:null,cH:null,cA:null,ch:null,cf:null,ci:null,cp:null,cd:null,cm:null,cZ:null,bc:null,cy:!1,ca:!1,cJ:null,cG:!1,bJ:!1,cD:0,cz:!1,cF:!1,bM:null,cR:null,cg:null,cE:!1,de:null,dx:null,J:function(n){this.ce.b(n)},O:function(n){this.ce.c(n)},a:function(){return this.bb},fc:function(n){if(this.bc!==n){this.bc=n;this.et("InfoBarViewModel")}return n},cu:function(){_a.b.d(this.cI.c(),"MailComposeViewModel: Smime override factory has not been created");return this.cI.b()},bt:function(){return _mcp.e.a(this.bg,0)},bH:function(){return _mcp.e.a(this.bg,10)},bp:function(){return _mcp.e.a(this.bg,2)},be:function(){return _mcp.e.a(this.bg,5)},eh:function(){return _mcp.e.a(this.bg,11)},dZ:function(){return _mcp.e.a(this.bg,4)},bd:function(){return _mcp.e.a(this.bg,1)},dT:function(){return _mcp.e.a(this.bg,6)},bh:function(){return _mcp.e.a(this.bg,7)},bm:function(){return _mcp.e.a(this.bg,8)},bV:function(){return _mcp.e.a(this.bg,9)},bW:function(){return _mcp.e.a(this.bg,28)},bD:function(){return _mcp.e.a(this.bg,16)},ct:function(){return _mcp.e.a(this.bg,18)},cr:function(){return _mcp.e.a(this.bg,3)},cX:function(){return _mcp.e.a(this.bg,17)},ea:function(){return _mcp.e.a(this.bg,29)},cY:function(){return _mcp.e.a(this.bg,23)},br:function(){return _mcp.e.a(this.bg,19)},bz:function(){return _mcp.e.a(this.bg,22)},dn:function(){return _mcp.e.a(this.bg,24)},dl:function(){return _mcp.e.a(this.bg,30)},bK:function(){return _mcp.e.a(this.bg,25)},dP:function(){return _mcp.e.a(this.bg,32)},bP:function(){return _mcp.e.a(this.bg,12)},dp:function(){return _mcp.e.a(this.bg,27)},dq:function(){return _mcp.e.a(this.bg,31)},dS:function(){return _mcp.e.a(this.bg,34)},bq:null,c:function(){return this.bA},bs:function(){return!this.bv.c()||!!this.bA},bn:function(){return!1},L:function(){return"MailCompose"},dm:function(){return!1},dR:function(){return 5},bX:function(){var t=this.bs();var n=new _a.o;n.c("P",t);n.b("I",t?this.bL().toString():"NA");n.b("ET",this.bb.ft);this.bC.a().f()&&this.bC.a().f().Enabled&&n.b("S",this.L());return n},eU:function(){return this.bs()||this.bv.i()},fd:function(n){if(this.cz!==n){this.cz=n;this.et("IsReadyForViewInitialization")}return n},bL:function(){return!!this.bA},bx:function(){return this.cD},es:function(n){if(this.cD!==n){this.cD=n;this.et("PopupPanelSize")}return n},w:function(){if(this.bH()){var n=this.bH();return n.c||(n.c=Function.createDelegate(n,n.j))}else return this.dJ},p:function(){return this.cZ},i:function(n){_j.e.a(_a.a.a,"Shell setting ClosePopupCommand from {0} to ",this.cZ?"non-null":"null",n?"non-null":"null");this.cZ=n;return n},cO:!1,by:function(){return this.cO},t:function(n){this.cO=n;return n},cQ:!1,x:function(n){this.cQ=n;return n},dU:function(){return this.bE.h()},eV:function(){return this.bE.e()},dY:function(){return this.bE.i()},dV:function(){return this.bE.f()},dW:function(){return this.bE.a()},n:function(){return this.cs()?0:1},eS:function(){return this.bE.D()},cP:!1,K:function(){return this.cP},S:function(n){this.cP=n;return n},eo:function(n){if(this.cy!==n){this.cy=n;this.et("IsInView")}return n},bF:!1,y:function(n){this.bF=n;return n},eJ:function(n){var t=this.eb();if(this.ca!==t){this.ca=t;this.et("ShouldShowToolbarMessage")}return n},eL:function(n){if(this.cJ!==n){this.cJ=n;this.et("ToolbarMessage")}return n},bg:null,eH:function(n){var t=this.eb();if(t!==this.cG){this.cG=t;this.et("ShouldBlockView")}return n},R:function(n){if(this.bJ!==n){this.bJ=n;this.et("IsNavigatingAway")}return n},eb:function(){return this.bp()&&(this.bp().h()||this.bp().f())?!0:this.bh()&&this.bh().c()?!0:!1},dk:function(){return!this.bE.k()},bu:null,dM:null,f:function(n){this.dM=n;return n},bN:null,A:function(n){this.bN=n;return n},s:function(){var n=_mcp.e.a(this.bg,27);n.d()||n.g();return n.a()},cv:function(){return this.bb.fB()},v:function(n){if(this.cF!==n){this.cF=n;this.et("SharedCommandingBarShown")}return n},cs:function(){return this.bv.a()==="Mouse"},dr:function(){return this.bU.c()&&this.cs()},bk:function(){this.cR||(this.cR=new _cmc.bu);return this.cR},cb:null,M:function(){return this.bh().a()},U:function(n){this.bh().b(n);return n},T:function(n){if(n!==this.cE){this.cE=n;this.et("ReadyToSetInitialFocus")}return n},ec:function(){return!1},fa:function(n,t){if(this.bb.I()){this.ba();this.bg.q()}else{this.Z();this.bg.l()}},eR:function(){this.bb.apcl(_mcp.b.c,this.dc)},ba:function(){if(this.cv()&&!this.bM){_j.e.a(_a.a.a,"Setting mail compose viewmodel override");this.bM=this.cu().c();this.bM.b(this.bc)}},Z:function(){if(this.bM){this.bM.a();this.bM=null}},P:function(){!this.eK&&this.be()&&this.be().a()&&this.be().a().e(this.be().a().b(),this.bb.p(),this.bb.bf())},bf:function(){if(!this.eK){this.bK().e();this.bd().bg()}},ds:function(n){this.cb=n;this.be()&&this.be().a()&&this.be().a().cj(this.cb)},cx:function(){this.bb.b()&&(this.bb.eS()||this.bb.dk())||this.bb.fL(_mcp.e.c());_j.e.a(_a.a.a,"Init:Context:{0}",this.bb);this.bi.a(_cmc.bc,new _mcp.bS);this.bg||(this.bg=this.dg());this.cE=!this.bQ||!this.bQ.q()||this.bQ.b;if(this.cv()){_j.e.a(_a.a.a,"Creating Smime override factory");this.dh(this.dH)}else this.dO()},dh:function(n){_j.e.a(_a.a.a,"Calling CreateSmimeOverrideFactoryAsync");var t=this;this.cI.a(function(i){_j.e.a(_a.a.a,"Smime override factory created");i.f(t.bb,t.bi);_j.e.a(_a.a.a,"Calling createFactoryCallback");n()})},dg:function(){return new _mcp.by(this,this.co,this.bo,this.bC,this.cq,this.cw,this.cB,this.bA,this.cj,this.ck,this.cl,this.cn,this.cA,this.ch,this.cf,this.ci,this.cp,this.cg,this.de,this.dx,this.bE,this.bU,this.bQ,this.cH,this.cd,this.cm)},dO:function(){_j.e.a(_a.a.a,"Completing initialization");this.ba();this.eR();if(this.bc){this.bc.r();this.bi.a(_y.dF,new _y.dF);this.bb.dk()&&this.dN(this.bb.gA())}this.R(!1);this.bi.b(_a.dH,this.cN);this.bt().g();if(!this.bA){this.bv.k(this.cM);this.bv.m(this.cM);_j.e.a(_a.a.a,"Before unload handler has been hooked up")}this.bH()&&(this.bH().f()?this.ce.a():this.bH().apcl("IsAppBarSetup",this.db))},eZ:function(n,t){this.bH().f()&&this.ce.a()},dN:function(n){switch(n){case 94:case 99:case 100:this.bc.c(n,null,_u.n.GZ,this.dL);break;case 98:this.bc.c(n,null,_u.n.GZ,this.dK);break;default:this.bc.a(n,null);break}},e:function(n){this.bp().k(n)},d:function(){return this.bp().l()},k:function(n,t){this.bm().b(n,t)},fj:function(){window.open("/owa/owahipcontrol.aspx?compose=1");this.bc.b(100);this.bc.b(99);this.bc.b(94)},fg:function(){window.open(_mcp.e.b);this.bc.b(98)},fe:function(n){this.ee(n);_j.e.a(_a.a.a,"Set screen view model appbar. ContextId={0}",this.bb.b())},ff:function(n){this.eg(n);_j.e.a(_a.a.a,"Set screen view model top appbar. ContextId={0}",this.bb.b())},cS:function(){_y.hO.prototype.cS.call(this);var n=this.bt();if(n.d()){_j.e.a(_a.a.a,"PostTransitionIn view model, begin secondary init now since primary init is already finished.");n.b()}else _j.e.a(_a.a.a,"PostTransitionIn view model, primary init not finished yet. Relying on primary init to fire secondary init...");this.eo(!0);if(this.bb.dk()&&this.bb.cr()){var i=this.bb.b();this.bi.a(_y.dR,new _y.dR(i))}(this.bb.a()||this.bv.a()!=="TouchNarrow")&&this.bb.fa&&this.bb.fa();if(this.cs()){var t=this;_j.o.a().c(_a.a.c,"PreloadOwaFilePicker",function(){var n=t.be();n&&n.v()})}if(this.bb.fb){this.bb.fb(this);this.bb.fb=null}this.bk().k(this.L())},cT:function(){_j.e.a(_a.a.a,"Post transition out");if(this.bh().i()){var n=this.bh().i();n.j=this.bb.cr()?"SentViaNotification":"NotSentViaNotificationDueToOtherPendingFailedAsyncSend";_a.d.a(n)}this.eo(!1);this.bk().c();if(!this.bh().h()){if(this.bF){this.bd().f();this.bb.eP.a()}IMailComposeAutoSaveComponent.isInstanceOfType(this.bh())&&this.bh().k()}this.bi.a(_a.ca,new _a.ca(!0,"NotLoadedByReadingPaneComposeHide"));this.bi.a(_a.bb,new _a.bb("MCompose"));_y.hO.prototype.cT.call(this)},bR:function(){if(this.be().b()){_j.e.a(_a.a.a,"Dirty due to attachment in progress");return!0}this.bd().f();return this.bb.gf()},bw:function(){this.bc||this.fc(new _db.i);return this.bc},N:function(){_h.v.k()},Q:function(){_h.v.g()},fi:function(){this.bM&&this.bM.c()},Y:function(){this.fd(!0)},X:function(){var n=new _y.eN;this.em(n);return n.b},em:function(n){this.bp().c(n);this.bk().c()},m:function(){this.bk().c()},eP:function(){this.bs()&&this.bb&&!_j.i.a(this.bb.A())&&!this.bA&&(document.title=this.bb.A())},j:function(n){this.dp().e(n+this.dR())},ew:function(){_j.e.a(_a.a.a,"Disposing view model, context: {0}",this.bb?this.bb:"null");this.Z();this.bb.rpcl(_mcp.b.c,this.dc);if(!this.bg){_j.e.b(_a.a.a,"MailComposeViewModel.Reset - Skipping post-transition out processing because the component map is null.");return}var n=this.bp();if(!n){_j.e.b(_a.a.a,"MailComposeViewModel.Reset - Skipping post-transition out processing because the navigation component is null.");return}if(!n.e()){_j.e.b(_a.a.a,"MailComposeViewModel.Reset - Skipping post-transition out processing because IsNavigatingAwayFromCompose is false.");return}this.bz()&&this.bz().a()&&this.bz().a().e(!1);this.bH()&&this.bH().rpcl("IsAppBarSetup",this.db);n.j(!1);this.bg.dispose();this.bg=null;this.bb&&!this.bF&&this.bb.dB();if(this.bc){this.bc.p.f();var t;_a.i.a(t={val:this.bc}),this.bc=t.val}this.bA||this.bv.k(this.cM);this.bi.c(_a.dH,this.cN);this.bN=null;this.cP=!1;_y.hO.prototype.ew.call(this)},fb:function(n,t){this.be().u(n);this.cs()&&(!n.c||n.c===2)&&this.be().r();if(this.bo&&this.bo.a().dD().Enabled&&t!==2)switch(n.c){case 0:this.dq().a(this.ej(n.a),!0);break;case 2:this.dq().a(this.ej(n.b),!1);break}this.dS()&&this.dS().a()},ej:function(n){for(var i=[],t=0;t<n.length;t++)_rw.f.isInstanceOfType(n[t])&&Array.add(i,n[t].k);return i},el:function(n){if(this.bb.bs()&&this.bb.F()&&this.bb.de()===1){var t=this.bb.F().Id;if(this.eO(n)){_j.e.a(_a.a.a,"Original message {0} loaded from cache.",t);return}var r=new _h.J(200,[this.bb.F()],_h.b.a(),"ItemNormalizedBody",2,!1);var i=this,u=this;this.bq.a(r,function(r){_j.e.a(_a.a.a,"Original message {0} loaded from server.",t);i.eO(n)},function(n){_j.e.b(_a.a.a,"Fail to load original item with id "+t)},null)}},eO:function(n){var t=_h.d.a().a(this.bb.F().Id);if(t){this.bb.cN(t);n&&n();return!0}return!1},eX:function(n,t,i){return t===1?!this.cQ:!1},eN:function(n){if(this.bl.p)_j.e.b(_a.a.a,"ShowMessageBoxForSessionTimeout: A message is already being shown, pending timeout dialog was not shown");else{_j.e.b(_a.a.a,"ShowMessageBoxForSessionTimeout: Show pending timeout dialog");n?this.bl.g(0,_u.n.n,this.dI,!1,_u.n.NS,null,_u.n.DC,this.bl.z):this.bl.g(0,_u.n.SZ,null,!1,null,null,_u.n.DC,this.bl.z)}},eY:function(n){if(n.b()<120){_j.e.a(_a.a.a,"OnSessionTimeoutEvent: Timeout header recieved with less than 2 minutes until session expires");this.bi.c(_a.dH,this.cN);var i=this,t=this;this.bm().a("Save",function(){_j.e.a(_a.a.a,"OnSessionTimeoutEvent: Save was successful");i.eN(!0)},function(){_j.e.a(_a.a.a,"OnSessionTimeoutEvent: Save was unsuccessful");t.eN(!1)},!1)}},eW:function(n,t){if(n){_j.e.a(_a.a.a,"HandleSessionTimeoutDialog: Logout for user");var r=new _a.bD;this.bi.a(_a.bD,r);var i=new _a.cp(this.dt.d());this.bi.a(_a.cp,i)}}};_mcp.i=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi){_mcp.i.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi])};_mcp.i.prototype={bn:function(){return!0},L:function(){return"MailInlineCompose"},ec:function(){return!0},b:null,e:function(n){_mcp.e.prototype.e.call(this,n);IInlineComposeConductorViewModel.isInstanceOfType(n)&&(this.b=n.f())}};_mcp.k=function(n,t,i){this.b=n;this.c=t;this.g=!!i&&i.a().E().Enabled};_mcp.k.b=function(n){return n.EmailAddress?n.EmailAddress.toLowerCase():n.ItemId.Id};_mcp.k.prototype={b:null,g:!1,d:null,c:!1,a:null,e:null,f:null,h:function(){!this.d&&this.b&&(this.d=_a.H.a(this.b.EmailAddress));return this.d},m:function(n){if(!this.c)return n.val.g();_j.e.a(_mcp.k.a,"begin calculating initial audience");var t=new _j.k;this.a={};if(this.b){_j.e.a(_mcp.k.a,"adding always keep address "+this.h()+" as the first To recipient");t.a(this.b);this.a[this.h()]=0}this.i(t,n.val.g(),0);this.i(t,n.val.n(),1);_j.e.a(_mcp.k.a,"end calculating initial audience");this.l(t,n);return t},o:function(n,t){if(_rw.d.isInstanceOfType(n)){this.e=n;if(this.g&&this.b)for(var u=this.e.C,i=0;i<u.b();i++){var r=u.c(i);if(_a.H.a(r.k.a().EmailAddress)===this.d){r.j.D(!0);break}}}this.f=t},l:function(n,t){if(!this.c||!n){t.val.r(n);return}for(var f=new _j.k,e=new _j.k,o=n.x.length,r=0;r<o;r++){var i=n.x[r];var u=_mcp.k.b(i);if(u in this.a)this.a[u]?e.a(i):f.a(i);else{_j.e.a(_mcp.k.a,"Email address "+u+" is not in the local bookkeeping, add it to To");f.a(i)}}t.val.r(f);t.val.ba(e);if(this.f){this.f.A(e);_j.e.a(_mcp.k.a,"Update Cc recipient well with the separated Cc recipients")}},n:function(n,t){if(this.c){var i=t.c;_j.e.a(_mcp.k.a,"user edited the To recipients, processing the "+i+" change");var u=t.b;var r=t.a;switch(i){case 0:this.j(r);break;case 2:this.k(u);break;case 3:this.k(u);this.j(r);break;default:throw Error.notImplemented("a new NotifyCollectionChangedAction "+i+" has been introduced and to recipient helper does not work with it");}}},k:function(n){if(n)for(var f=n.length,r=0;r<f;r++){var u=n[r].k.a();var t=_mcp.k.b(u);_j.e.a(_mcp.k.a,"recording removed recipient "+t);if(t in this.a)if(t===this.h()){var i=this;_j.o.a().a(_mcp.k.a,"ProcessAlwaysKeepRecipients",function(){if(i.e){_j.e.a(_mcp.k.a,"adding the always keep address "+t+" back in To well");var n=i.e.cg(i.b);i.g&&n.D(!0)}},0)}else{_j.e.a(_mcp.k.a,"removing removed recipient "+t+" from cc recipient well");delete this.a[t]}}},j:function(n){if(n)for(var r=n.length,t=0;t<r;t++){var u=n[t].k.a();var i=_mcp.k.b(u);_j.e.a(_mcp.k.a,"adding added recipient "+i+" to local copy");this.a[i]=0}},i:function(n,t,i){var e=t?t.b():0;_j.e.a(_mcp.k.a,"merging "+e+" "+i+" partial audience into audience");for(var r=0;r<e;r++){var f=t.c(r);var u=_mcp.k.b(f);if(!(u in this.a)){n.a(f);this.a[u]=i}}}};_mcp.bm=function(n,t,i,r,u,f,e,o){this.L=Function.createDelegate(this,this.P);this.z=Function.createDelegate(this,this.I);this.K=Function.createDelegate(this,this.N);_mcp.bm.initializeBase(this);this.G=o;this.k=o.b;this.m=n;this.t=t;this.l=o.a;this.x=i;this.C=r;this.F=u;this.E=f;this.D=e};_mcp.bm.prototype={t:null,m:null,k:null,l:null,G:null,x:null,C:null,F:null,E:null,D:null,q:null,n:0,w:!1,y:null,o:null,r:null,v:!1,f:function(){this.q||(this.q=new _y.bs);return this.q},e:function(n){this.q=n;return n},p:function(){return this.l?this.l.cj():null},A:null,j:function(n){this.A=n;return n},c:function(n){_a.M.b(_a.a.w,"MailComposeReplyLoad",3);this.v=!0;this.o=_y.j.b(_a.a.w,"MailComposeReply",!0);this.r=_y.j.b(_a.a.w,"MailComposeReplyLoad",!0);this.k.bj.ConversationId?this.m.m("Inference.Reply",this.k.bj.ItemId,this.k.bj.ConversationId,this.l?this.l.O():null,this.p()):this.m.a("Inference.Reply",this.k.bj.ItemId,this.p());this.s(1,n)},d:function(n){_a.M.b(_a.a.w,"MailComposeReplyAllLoad",3);this.v=!0;this.o=_y.j.b(_a.a.w,"MailComposeReplyAll",!0);this.r=_y.j.b(_a.a.w,"MailComposeReplyAllLoad",!0);this.k.bj.ConversationId?this.m.m("Inference.ReplyAll",this.k.bj.ItemId,this.k.bj.ConversationId,this.l?this.l.O():null,this.p()):this.m.a("Inference.ReplyAll",this.k.bj.ItemId,this.p());this.s(2,n)},h:function(n){this.w=!0;this.d(n)},b:function(n){this.m.a("Inference.PostReply",this.k.bj.ItemId,this.p());this.s(12,n)},a:function(n){_a.M.b(_a.a.w,"MailComposeForwardLoad",3);this.v=!0;this.o=_y.j.b(_a.a.w,"MailComposeForward",!0);this.r=_y.j.b(_a.a.w,"MailComposeForwardLoad",!0);this.k.bj.ConversationId?this.m.m("Inference.Forward",this.k.bj.ItemId,this.k.bj.ConversationId,this.l?this.l.O():null,this.p()):this.m.a("Inference.Forward",this.k.bj.ItemId,this.p());this.s(3,n)},g:function(n){this.w=!0;this.a(n)},i:function(){if(!this.G.l())throw Error.invalidOperation("OnSendAgain is invoked on an item that can't be sent again. ");var t=_g.b.a.nameToId("drafts");var n=new _mcp.bq(this.k.bj.ItemId.Id,t.Id);n.d(this.K);n.e(this.z);_a.g.a.a(n)},N:function(n){var i=n.i;if(i.length>0){var t=this.C.i(_g.g.b(i));t.d(this.L);t.e(this.z);_a.g.a.a(t)}else this.I(n)},I:function(n){this.l.x().b(9500);this.l.x().a(9500)},P:function(n){var t=n;if(t.c){this.l.x().b(9500);var i=this.x.b(t.j[0],!1,t.c.du(),t.c.bA());_y.c.a.c()||i.t(0);this.f().a(i)}else this.I(n)},s:function(n,t){this.n=n;this.Q(t)},Q:function(n){var u=_dg.a.isInstanceOfType(this.k);n||(n=!_y.c.a.c());var t=this.x.a(n,!1);t.bc(this.v);n&&t.t(0);var f=null;switch(this.n){case 1:f=!t.l()||u?"MailComposeReplyPopOut":"MailComposeReply";break;case 2:f=!t.l()||u?"MailComposeReplyAllPopOut":"MailComposeReplyAll";break;case 3:f=!t.l()||u?"MailComposeForwardPopOut":"MailComposeForward";break;default:break}if(f&&this.o){this.o.q=f;t.v(this.o);t.bb(this.r);t.bv()}t.ec(this.k.bj.ParentFolderId);this.l&&t.ed(this.l.cu());t.e(this.n);t.cJ(!0);t.eN=this.w;t.f(!t.eN||this.n===3);var i=new _g.O;i.Mailbox=new _g.f;i.Mailbox.EmailAddress=this.t.c().bj.UserEmailAddress;i.Mailbox.Name=this.t.c().bj.UserDisplayName;i.Mailbox.MailboxType="Mailbox";i.Mailbox.RoutingType="SMTP";t.eg(i);t.fa=this.A;if(u){var r=this.k;if(r.ce())t.K(r);else{t.dL(_dg.a.a(r));t.cB(t.cz(r));t.cM(this.k.bj.ItemId);t.cI(_dg.a.e(r))}}else t.K(this.k);if((this.n===1||this.n===2)&&_g.j.isInstanceOfType(this.k)){var o;var e=this.k;var l=this.J(e.v())+this.J(e.o())+this.J(e.m());o=this.n===1?"MailComposeBeforeReply":"MailComposeBeforeReplyAll";var c=_a.d.b(_a.a.w,o);c.j=l.toString();_a.d.a(c)}if((_g.j.isInstanceOfType(this.k)||u)&&t.fC(this.k)){var s=_a.p.d();s&&t.ha(this.k.dh());if(this.k.cm()||t.I()&&s){var h=this;this.O(function(n){n.b(t,h.k,h.n)})}else this.f().a(t)}else this.f().a(t)},O:function(n){_j.e.a(_a.a.i,"[MailResponseViewModel] Creating Smime command factory.");var t=this;this.F.a(function(i){t.E.a(function(r){t.D.a(function(u){t.y||(t.y=t.M(i,r,u));_j.e.a(_a.a.i,"[MailResponseViewModel] Executing smime operation.");n(t.y)})})})},M:function(n,t,i){_j.e.a(_a.a.i,"[MailResponseViewModel] Creating SmimeMailResponseViewModelCommand instance.");var r=null;r=n.f();var f=this,u=this;r.a(this,this.t,function(n,i){i.cB(i.cz(n));var u=t.a(n.bj.ItemId,i.cs(),i.cl(),_dg.a.a(n));var r=t.b(200,u,i.cl());r.V=i.b();return r},function(n,t,r){var u=new _mcp.bW(n,t,r,i);return u.toString()});return r},J:function(n){return n?n.b():0}};_mcp.bn=function(n,t,i,r,u,f,e){this.e=n;this.h=t;this.f=i;this.b=r;this.g=u;this.d=f;this.c=e};_mcp.bn.prototype={e:null,h:null,f:null,b:null,g:null,d:null,c:null,a:function(n){return new _mcp.bm(this.e,this.h,this.f,this.b,this.g,this.d,this.c,n)}};_mcp.P=function(){_mcp.P.initializeBase(this)};_mcp.P.prototype={a:null,d:"Normal",e:!1,f:!1,b:!1,c:!1,i:!1,j:!1,g:null,h:!1,k:!1,l:!1,r:function(){if(!this.a){this.a=new _j.k;this.a.a("Normal");this.a.a("Personal");this.a.a("Private");this.a.a("Confidential")}return this.a},o:function(n){if(this.d!==n){this.d=n;this.et("Sensitivity")}return n},m:function(n){if(this.e!==n){this.e=n;this.et("IsDeliveryReceiptRequested")}return n},n:function(n){if(this.f!==n){this.f=n;this.et("IsReadReceiptRequested")}return n},v:function(n){if(this.h!==n){this.h=n;this.et("ShowSmimeOptions")}return n},p:function(n){if(this.b!==n){this.b=n;this.et("SmimeEncryptMessage")}return n},q:function(n){if(this.c!==n){this.c=n;this.et("SmimeSignMessage")}return n},w:function(n){if(this.i!==n){this.i=n;this.et("SmimeEncryptMessageIsEnabled")}return n},x:function(n){if(this.j!==n){this.j=n;this.et("SmimeSignMessageIsEnabled")}return n},y:function(n){if(this.l!==n){this.l=n;this.et("WaitingForPreviousAction")}return n},t:function(n){if(this.g!==n){this.g=n;this.et("Conductor")}return n},s:function(n){this.k=n.I();this.v(_a.p.a&&_a.p.i()&&n.dz());this.y(!1);this.o(n.y());this.m(n.Y());this.n(n.Z());this.p(n.o());this.q(n.s());this.w(n.dt());this.x(n.du())},ew:function(){this.g=null;this.a.f();var n;_a.i.a(n={val:this.a}),this.a=n.val;_a.iX.prototype.ew.call(this)}};_mcp.ba=function(n){_mcp.ba.initializeBase(this);this.h=n;var t=_a.c.cb();if(t.length>=3){this.c=new _mcp.Z(t[0]);this.e=new _mcp.Z(t[1]);this.f=new _mcp.Z(t[2])}};_mcp.ba.prototype={h:0,b:null,a:0,d:!1,g:"",c:null,e:null,f:null,l:function(){return(this.h&3)==3},j:function(n){if(this.d!==n){this.d=n;this.et("IsTimeExpirationSelected")}return n},n:function(n){this.a=n;this.j(this.a===1?!0:!1);this.et("SelectedOption");return n},i:function(n){this.g=n;this.et("ErrorText");return n},k:function(){return[this.c,this.e,this.f]},m:function(n){if(this.b!==n){this.b=n;this.et("Conductor")}return n}};_mcp.Z=function(n){this.b=n};_mcp.Z.prototype={b:0,a:null,c:!1,f:function(n){this.a!==n&&(this.a=n);return n},e:function(){var n="";switch(this.b){case 7:n=_nbs.a.Ce;break;case 6:n=_nbs.a.pH;break;case 5:this.c=!0;n=_nbs.a.hN;break}return n},d:function(){var n=0;switch(this.b){case 7:case 6:n=2;break;case 5:n=4;break}return n}};_mcp.bb=function(n){this.a=n};_mcp.bb.prototype={a:!1};_mcp.bV=function(n,t){this.a=n;this.b=t};_mcp.bV.prototype={a:null,b:null};_mcp.bW=function(n,t,i,r){this.j=new RegExp("<","g");this.i=new RegExp(">","g");this.d=n;this.a=t;this.e=i};_mcp.bW.prototype={e:0,a:null,d:!1,f:null,toString:function(){_j.e.a(_a.a.a,"Building message headers for reply/fwd. locally.");var a=this.n();var t=this.g(!0);var r=this.g(!1);r&&r.toLowerCase()!==t.toLowerCase()&&(t=String.format(_u.n.QE,r,t));var o=this.a.cl()||this.a.cK();var w=o?o.toString():this.a.hD();var h=this.h(!0);var e=this.h(!1);var i,n;var s,u;this.o(s={val:i},u={val:n}),i=s.val,n=u.val;var p=this.b(_nbs.a.el,t);var k=this.b(_nbs.a.Ky,w);var b=h?this.b(_u.n.On,h.join("; ")):null;var y=e?this.b(_u.n.PO,e.join("; ")):null;var l=this.b(_u.P.b,a);var c=i?this.b(_u.P.P,i):null;var v=n?this.b(_u.P.I,n):null;var f=this.k(p,k,b,y,l,c,v);return this.d?'<p style="color:black;border-top:1pt solid #E1E1E1;padding-top:3pt;margin-bottom:13pt;font-family:Calibri,sans-serif;font-size:11pt">'+f.join("<br/>")+"</p>":String.format("________________________________________{0}{1}{0}{0}","\r\n",f.join("\r\n"))},k:function(){for(var u=[],n=0;n<arguments.length;++n)u[n]=arguments[n];for(var f=new _j.q,r=u,e=r.length,t=0;t<e;++t){var i=r[t];_j.i.a(i)||f.c(i)}return f.j()},n:function(){if(this.a.bj.Subject)return this.a.bj.Subject;else{var n;switch(this.e){case 1:case 2:case 12:n=_u.n.KI;break;case 3:n=_nbs.a.ZF;break;case 8:n=_nbs.a.Sc;break;case 9:n=_nbs.a.nM;break;case 10:n=_nbs.a.Nl;break;case 5:case 6:case 7:n="";break;default:n="";break}return String.format(_nbs.a.ik,n,this.a.cF()||_u.R.Sp)}},g:function(n){if(_g.j.isInstanceOfType(this.a)){var r=this.a;var i=n?r.bj.From:r.bj.Sender;return i?this.c(i.Mailbox):null}else if(_dg.a.isInstanceOfType(this.a)){var t=this.a;return t.bj.Organizer?this.c(t.bj.Organizer.Mailbox):null}else return null},h:function(n){if(_g.j.isInstanceOfType(this.a)){var i=this.a;return this.m(n?i.m():i.o())}else if(_dg.a.isInstanceOfType(this.a)){var t=this.a;return this.l(n?t.q():t.t(),n)}else return null},o:function(n,t){var i=null;var r=null;n.val=t.val=null;if(_dg.o.isInstanceOfType(this.a)){var f=this.a;i=f.y();r=f.dH()}else if(_dg.a.isInstanceOfType(this.a)){var u=this.a;i=u;r=u}if(r){var e=this.f.a();n.val=e.a(r,null)||" "}i&&(t.val=i.s()?i.s().bj.DisplayName||" ":" ")},m:function(n){if(!n||!n.b())return null;var t=new _j.q;var i=this;n.n(function(n){t.c(i.c(n))});return t.j()},l:function(n,t){if(!n||!n.b())return t?[this.c(this.a.bj.Organizer.Mailbox)]:null;var i=new _j.q;var r=this;n.n(function(n){i.c(r.c(n.bj.Mailbox))});return i.j()},c:function(n){return n?n.Name||n.OriginalDisplayName||n.EmailAddress||"":""},b:function(n,t){return this.d?"<b>"+n+"</b> "+this.p(t):n+" "+t},p:function(n){if(!n)return null;n=n.replace(this.j,"&lt;");n=n.replace(this.i,"&gt;");return n}};_mcp.be=function(){};_mcp.be.prototype={setNoRestriciton:0,unknownClassification:1};_mcp.be.registerEnum("_mcp.be",!1);_mcp.bf=function(){};_mcp.bf.prototype={others:0,fullComposeCommandingBar:1,fullComposeBottomButton:2,inlineCompose:3};_mcp.bf.registerEnum("_mcp.bf",!1);var IMailComposeComponent=function(){};IMailComposeComponent.registerInterface("IMailComposeComponent");_mcp.cb=function(){};_mcp.cb.registerInterface("_mcp.cb");var IMailComposeAttachmentComponent=function(){};IMailComposeAttachmentComponent.registerInterface("IMailComposeAttachmentComponent");var IMailComposeAutoSaveComponent=function(){};IMailComposeAutoSaveComponent.registerInterface("IMailComposeAutoSaveComponent");var IMailComposeCalendaringInfobarComponent=function(){};IMailComposeCalendaringInfobarComponent.registerInterface("IMailComposeCalendaringInfobarComponent");var IMailComposeCommandingBarComponent=function(){};IMailComposeCommandingBarComponent.registerInterface("IMailComposeCommandingBarComponent");var IMailComposeComplianceComponent=function(){};IMailComposeComplianceComponent.registerInterface("IMailComposeComplianceComponent");var IMailComposeContentConversionComponent=function(){};IMailComposeContentConversionComponent.registerInterface("IMailComposeContentConversionComponent");var IMailComposeContextMenuProvider=function(){};IMailComposeContextMenuProvider.registerInterface("IMailComposeContextMenuProvider");var IMailComposeContextMenuComponent=function(){};IMailComposeContextMenuComponent.registerInterface("IMailComposeContextMenuComponent");var IMailComposeDiscardComponent=function(){};IMailComposeDiscardComponent.registerInterface("IMailComposeDiscardComponent");var IMailComposeEditorComponent=function(){};IMailComposeEditorComponent.registerInterface("IMailComposeEditorComponent");var IMailComposeExtensibilityComponent=function(){};IMailComposeExtensibilityComponent.registerInterface("IMailComposeExtensibilityComponent");_mcp.cc=function(){};_mcp.cc.registerInterface("_mcp.cc");var IMailComposeHashtagComponent=function(){};IMailComposeHashtagComponent.registerInterface("IMailComposeHashtagComponent");var IMailComposeImportanceComponent=function(){};IMailComposeImportanceComponent.registerInterface("IMailComposeImportanceComponent");var IMailComposeInitializerComponent=function(){};IMailComposeInitializerComponent.registerInterface("IMailComposeInitializerComponent");var IMailComposeLinkPreviewComponent=function(){};IMailComposeLinkPreviewComponent.registerInterface("IMailComposeLinkPreviewComponent");var IMailComposeMailTipsComponent=function(){};IMailComposeMailTipsComponent.registerInterface("IMailComposeMailTipsComponent");var IMailComposeMeetingComponent=function(){};IMailComposeMeetingComponent.registerInterface("IMailComposeMeetingComponent");var IMailComposeMessageOptionsComponent=function(){};IMailComposeMessageOptionsComponent.registerInterface("IMailComposeMessageOptionsComponent");var IMailComposePeopleRecommendationsComponent=function(){};IMailComposePeopleRecommendationsComponent.registerInterface("IMailComposePeopleRecommendationsComponent");var IMailComposeNavigationComponent=function(){};IMailComposeNavigationComponent.registerInterface("IMailComposeNavigationComponent");var IMailComposeOmeComponent=function(){};IMailComposeOmeComponent.registerInterface("IMailComposeOmeComponent");var IMailComposePALGenericAttachmentComponent=function(){};IMailComposePALGenericAttachmentComponent.registerInterface("IMailComposePALGenericAttachmentComponent");var IMailComposePhotoComponent=function(){};IMailComposePhotoComponent.registerInterface("IMailComposePhotoComponent");var IMailComposePolicyTipsComponent=function(){};IMailComposePolicyTipsComponent.registerInterface("IMailComposePolicyTipsComponent");var IMailComposeRecipientComponent=function(){};IMailComposeRecipientComponent.registerInterface("IMailComposeRecipientComponent");var IMailComposeRecipientSummarizationComponent=function(){};IMailComposeRecipientSummarizationComponent.registerInterface("IMailComposeRecipientSummarizationComponent");var IMailComposeSaveComponent=function(){};IMailComposeSaveComponent.registerInterface("IMailComposeSaveComponent");var IMailComposeSendAsContextMenuComponent=function(){};IMailComposeSendAsContextMenuComponent.registerInterface("IMailComposeSendAsContextMenuComponent");var IMailComposeSendComponent=function(){};IMailComposeSendComponent.registerInterface("IMailComposeSendComponent");var IMailComposeShareAttachmentComponent=function(){};IMailComposeShareAttachmentComponent.registerInterface("IMailComposeShareAttachmentComponent");var IMailComposeSignatureComponent=function(){};IMailComposeSignatureComponent.registerInterface("IMailComposeSignatureComponent");var IMailComposeTouchComponent=function(){};IMailComposeTouchComponent.registerInterface("IMailComposeTouchComponent");var IMailComposeUpgradeComponent=function(){};IMailComposeUpgradeComponent.registerInterface("IMailComposeUpgradeComponent");_mcp.bw=function(n,t,i,r){this.p=Function.createDelegate(this,this.t);this.m=Function.createDelegate(this,this.u);this.o=Function.createDelegate(this,this.s);_mcp.bw.initializeBase(this,[32,n]);this.l=i;this.e=t;this.i=r};_mcp.bw.prototype={l:null,e:null,i:null,c:null,f:null,g:function(){if(this.d()){_j.e.b(_a.a.a,"MailComposeAtMentionComponent is already initialized, skipping redundant Initialize call.");return}if(this.e&&this.e.c()&&this.i){this.i.a(this.o);this.e.d()&&this.r()}_mcp.G.prototype.g.call(this)},br:function(){this.c&&this.q();var n;_a.i.a(n={val:this.f}),this.f=n.val;_mcp.G.prototype.br.call(this)},a:function(){return this.f},b:function(){return!this.e||!this.e.d()},n:function(){var n=this.bi.a.bc;n.a(10302,null);this.bh.bf()},v:function(){var n=this.bi.a.bc;n.b(10302);this.bh.bf()},j:function(n){if(this.bj)if(n.b()){this.c.a(n.a(),this.bj.eL);this.n()}else{var t=this.bh.bd().b(0);this.c.b(n,this.bj.eL,t)}},k:function(n){if(n.a()&&this.bj){var t=this.bj.eL;if(n.b()){this.c.c(n.a(),t);_zz.d.y(t)||this.v()}else{var i=this.bh.bd().b(0);this.c.d(n,t,i,_zz.d.n)}}},h:function(){return this.bj?_cmc.l.a(this.bj.eL):null},s:function(n){this.c=n;this.l.b(_y.ct,this.m)},r:function(){this.f=new _j.g(this.p,_a.a.a);_zz.d.y(this.bj.eL)&&this.n()},q:function(){this.l.c(_y.ct,this.m);this.c=null},u:function(n){var t=this.bh.bd().b(0);this.bj&&t&&n.b()===t.q()&&this.c.e(n.a(),this.bj.eL)},t:function(){var t=_zz.d.a("OWAALLAM");var r=_zz.d.r("@all",t);var n=new _cmc.h(0,r,!0);n.p=!1;n.m=!0;this.bj.cD(n);this.n();this.bj.eL[t]="at-all";var i=new _a.bp(1,"AtAllMention_AddedUsingButton");_a.r.c.a(i)}};_mcp.m=function(n,t,i,r,u,f,e){this.bn=Function.createDelegate(this,this.bP);this.bd=Function.createDelegate(this,this.bZ);this.X=Function.createDelegate(this,this.bW);this.Y=Function.createDelegate(this,this.bX);this.bb=Function.createDelegate(this,this.bK);this.bc=Function.createDelegate(this,this.bY);this.bw=Function.createDelegate(this,this.bJ);this.bB=Function.createDelegate(this,this.bN);this.bz=Function.createDelegate(this,this.cc);this.bA=Function.createDelegate(this,this.ce);this.by=Function.createDelegate(this,this.cb);this.bx=Function.createDelegate(this,this.ca);this.bs=Function.createDelegate(this,this.bT);this.bv=Function.createDelegate(this,this.bV);this.bp=Function.createDelegate(this,this.bQ);this.q=this.a;_mcp.m.initializeBase(this,[5,n]);this.P=i;this.L=u;this.be=t;this.D=new _j.g(this.bp,this.bk());this.K=r;this.T=f;this.S=e;this.bl=!!this.P&&this.P.a().b().Enabled&&this.P.a().L().Enabled};_mcp.m.prototype={G:null,P:null,K:null,L:null,be:null,T:null,bl:!1,D:null,N:null,bm:null,V:!1,F:null,E:null,R:!1,S:null,bg:!0,M:null,J:null,W:!1,Q:null,i:function(){this.G||this.bE();return this.G},ck:function(n){if(this.G!==n){this.G=n;this.bq("Menu")}return n},ci:function(n){if(this.M!==n){this.M=n;this.bq("InsertButtonCommand")}return n},cj:function(n){if(this.Q!==n){this.Q=n;this.bq("InsertButtonText")}return n},h:function(){if(!this.N){var n=this;this.N=new _j.v(this.bv,this.bk(),this.bi.a.bb,"BodyType",function(){return n.bi.a.bb.j()==="HTML"})}return this.N},p:function(n){this.bu("AttachmentWellInitialized",n)},w:function(n){this.bI("AttachmentWellInitialized",n)},a:function(){return this.ev(_mcp.m.a)},x:function(n){this.eu(_mcp.m.a,n);return n},b:function(){return this.a()?this.a().j():!1},j:function(){return this.a()&&this.a().a()?this.a().a().x.length>0:!1},s:function(){return this.a()?this.a().n():0},y:function(n){this.bg=n;return n},k:function(){var n=_a.k.a();return n.c()&&this.K.b()},ba:function(){if(this.bh.cv()&&!this.E){_j.e.a(_a.a.a,"Setting attachment component override");this.E=this.bh.cu().a();this.E.c(this.bs)}},Z:function(){if(this.E){this.E.a();this.E=null}},g:function(){var n=this.bj;this.ba();this.bE();if(this.a()){var t=n.W();this.a().ca(n.h(),n.p(),t,n.b(),n.bf());this.bC(n,t)}else this.be.a(this.bx)},bT:function(){return this.a()},bZ:function(n,t){t==="EditorCallContext"&&this.bh.bK().a(this.a().bd())},o:function(n){this.bm&&this.bm.a(!n)},bW:function(n){if(_a.br.a){var t=this.bh;_j.o.a().c(_a.a.F,"SafeTriggerPolicyTipsIfNeededForAttachmentAdded",this.by)}this.bi.a.ds(this.bi.a.cb)},bX:function(){var t=this.bi.a;var n=t.bb;if(n.h()){this.bD(n);this.a()&&this.a().e(n.h(),n.p(),n.bf())}else t.bm().a("Attach",this.bA,this.bz,!1)},z:function(){if(!this.V&&this.a()){var n=this.bi.a.bb;if(_y.c.a.a()==="Mouse")this.a().e(n.h(),n.p(),n.bf());else{_j.e.a(_a.a.a,"Delaying attachment refresh because we're in not in mouse layout.");this.a().bE(n.h(),n.p(),n.bf(),this.bB)}this.bN();this.bi.a.bi.a(_y.dC,new _y.dC);this.V=!0}},r:function(){this.W||(this.bj.d()?this.bJ():this.bh.el(this.bw))},u:function(n){this.a()&&this.a().J(n)},bN:function(){var n=this.bi.a.bb;if(n.eJ)if(n.p()){var t=new _j.k;t.m(n.p().d());n.eJ.p(t);n.eH()&&n.eH().p(t)}else{n.eJ.p(null);n.eH()&&n.eH().p(null)}},t:function(){var n=[];var t=this.bi.b(13);var i=this.bi.b(20);if(t){t.a().b&&Array.add(n,new _y.h(_u.P.n,t.a()));t.b().b&&Array.add(n,new _y.h(_u.P.W,t.b()));this.O()&&Array.add(n,new _y.h(this.I(),this.D))}else i?Array.add(n,new _y.h(this.I(),i.a())):_a.k.a().B()&&Array.add(n,new _y.h(this.I(),this.D));return n},m:function(){var n=new _j.q;var t=this.bi.b(13);var i=this.bi.b(20);if(t){t.a().b&&n.c(new _fm.d(_u.P.n,null,t.a(),!1,null,_u.P.K));t.b().b&&n.c(new _fm.d(_u.P.W,null,t.b(),!1,null,_u.P.C));this.O()&&n.c(new _fm.d(this.I(),null,this.D,!1,null,this.U()))}else i?n.c(new _fm.d(this.I(),null,i.a(),!1,null,this.U())):_a.k.a().B()&&n.c(new _fm.d(this.I(),null,this.D,!1,null,this.U()));return n},A:function(){var n=this.bi.a.bb;if(!_j.i.a(n.bB())&&!this.R&&n.h()&&this.a()){this.R=!0;var t=!1;try{this.a().bA(n.bB(),this.bc,this.bb);t=!0}finally{t||(this.R=!1)}}},C:function(n){this.T&&this.a()&&this.T.a(this.a(),this.bk()).b(n)},l:function(){return this.a().a()},n:function(n,t){this.a().k(n,t)},c:function(n){var i=this.bi.a;var t=i.bb;if(!t||!t.i()){_j.e.a(_a.a.a,"Show not allowed to add attachment due to context={0}; Upgraded={1}",t?"non-null":"null",t.i());i.bl.g(0,this.bU(n),null);return!1}return!0},bQ:function(){var t=this.bi.a;var i=t.bb;_j.e.a(_a.a.a,"Insert attachment start");if(this.c(!1)&&this.a())if(this.E)this.E.b(!1);else if(this.O()){var n=_a.d.b(_a.a.c,"AttachmentsFilePickerPanelOpen");_j.e.a(_a.a.a,"Opening OWA's file picker");this.bM(n,0)}else{_j.e.a(_a.a.a,"Opening OS's file picker");this.a().f(!1,null,null)}this.bh.bk().a("AttachFile");_j.e.a(_a.a.a,"Insert attachment end")},bV:function(){var t=this.bi.a;var i=t.bb;_j.e.a(_a.a.a,"Insert picture start");if(this.c(!0)&&this.a()){if(this.E)this.E.b(!0);else if(this.bl){var n=_a.d.b(_a.a.c,"AttachmentsFilePickerPanelOpen");this.bM(n,1)}else this.a().f(!0,null,null);this.bh.bk().a("InsertPicture")}_j.e.a(_a.a.a,"Insert picture end")},br:function(){var n=this.a();if(n){n.M(this.Y);n.L(this.X);n.rpcl("EditorCallContext",this.bd);this.a().bo(this.bh.dd);n.dispose();this.x(null)}this.F=null;var r;_a.i.a(r={val:this.N}),this.N=r.val;var i;_a.i.a(i={val:this.D}),this.D=i.val;this.M=null;var t;_a.i.a(t={val:this.G}),this.G=t.val;this.V=!1;this.Z();this.bf(0);_mcp.G.prototype.br.call(this)},bE:function(){if(!this.G){var n=[];var t=new _fm.d(this.I(),null,this.D,!1,null,this.U());Array.add(n,t);this.ci(this.D);this.cj(_nbs.a.Tr);this.bh.bn()||this.ck(new _fm.f(n))}},bC:function(n,t){this.a().cg(!n.i());_j.e.a(_a.a.a,"Attachment component initialized, ReadOnly={0}",t);n.i()&&this.z();this.cl(n);this.bR(n);_mcp.G.prototype.g.call(this)},ca:function(n){var t=this.bj;var i=this.bh;if(this.bo()){_j.e.a(_a.a.a,"InitializeAttachmentWell is exiting early due to null context and/or view model disposing.");return}var h=t.W();var o=!((t.a()===4||t.a()===13)&&!this.K.b());var r=i.bd();var e=!!r.r().a||!!r.o().a||!!r.n().a;if(_y.c.a.a()==="TouchNarrow")this.x(n.a(t.h(),t.p(),t.W(),o,t.bf(),!0,i.bc,t.b(),e));else{var u=n.b(t.h());u.f(t.U());u.j(1);var f=t.V();var s=f?f.EmailAddress:null;this.x(n.c(u,t.p(),t.W(),_y.c.a.a()==="Mouse"?3:0,o&&this.bg,t.bf(),!0,i.bc,t.b(),i.bA,i.du,i.bN,s,e))}this.a().t(this.Y);this.a().D(this.X);this.a().apcl("EditorCallContext",this.bd);this.a().X(i.dd);this.bO("AttachmentWellInitialized",this);this.bC(t,h);i.ds(this.bi.a.cb)},bR:function(n){if(n&&this.a()&&n.a()===3&&this.a().v()){var t=_a.d.b(_a.a.c,"IntentToForwardReferenceAttachment");_a.d.a(t)}},bD:function(n){n.p()||n.T(new _j.k)},ce:function(n){var i=this.bi.a;var t=i.bb;if(n.V===t.b()){this.bD(t);this.a()&&this.a().e(t.h(),t.p(),t.bf());this.A()}},cc:function(n){var t=this.bi.a;var i=t.bb;if(this.a()&&n.V===i.b()){this.a().N();t.bl.p||t.bl.g(0,_nbs.a.oC,null);this.A()}},bM:function(n,t){if(this.L){var i=this;this.L.a(function(r){i.F=r;i.F&&i.F.a(i.a(),n,!1,i.bi.a.bN,i.bi.a.bA,i.bh.bb.j()==="Text",t)})}},v:function(){if(this.O()&&this.L){var n=this;this.L.a(function(t){n.F=t;n.F&&n.F.c()})}},O:function(){return!this.bj.R()&&!!this.K&&!!this.S&&this.K.j(this.S.AttachmentDataProviderAvailable)},bY:function(n){this.bi.a.bb.cC(null);this.bK(n)},bK:function(n){n.y(this.bc);n.bc(this.bb);this.R=!1},I:function(){return this.O()?_u.P.k:_u.P.A},U:function(){return this.O()?_u.P.X:_u.P.D},bJ:function(){if(this.bj){this.bh.bc.b(10301);var n=this.bj.d();if(_g.j.isInstanceOfType(n)&&!n.bG()&&n.bj.HasAttachments&&this.bj.fZ()){var u=this.bh.dq().b(n);if(!u.length)return;for(var r=0,t=0;t<n.cW().b();t++){var f=n.cW().c(t);if(!f.b()){_j.e.a(_a.a.a,"Found attachments from original item to be added: {0}, show infobar.",f.bj.Name);r++}}if(r>0){this.J=new _cmc.d(_a.a.a,"AddOriginalAttachment",!1);var i=this;var e=new _mcp.M(u,r,this.bn,function(){i.W=!0;i.bh.bc.b(10301);i.bf(-1)});this.bh.bc.d(10301,e)}}}},bP:function(){this.W=!0;this.bh.bc.b(10301);var i=this.bj.d();if(i){for(var r=new _j.k,u=0;u<i.cW().b();u++){var n=i.cW().c(u);if(n.b()){_j.e.a(_a.a.a,"Skip adding original attachment: {0}. IsInline: {1}",n.bj.Name,n.b());continue}var t=new _g.A;t.z(n.bj.AttachmentId.Id);t.e(n.bj.Name||_u.n.Op);t.g(!1);t.y(i.bj.ItemId.Id);_dg.i.isInstanceOfType(n)?t.c(!0):_dg.c.isInstanceOfType(n)?t.c(!1):_g.A.isInstanceOfType(n)&&t.c(n.bj.IsAttachmentItemAttachment);r.a(t);_j.e.a(_a.a.a,"Original attachment '{0}' added to the collection.",n.bj.Name)}if(r.x.length>0){var f=new _y.F;f.b(r);this.C(f);this.bf(r.x.length)}}},bf:function(n){if(this.J){this.J.a("A",n,!0,!0);this.J.b();this.J=null}},bU:function(n){return this.bh.bn()?n?_nbs.a.CB:_nbs.a.ka:n?_nbs.a.WO:_nbs.a.pU},cb:function(){_mcp.G.a(this.bh,8)},cl:function(n){n.by()&&n.by().x.length>0&&this.a().R(new _h.bP(n.by().d()))}};_mcp.V=function(n,t,i,r,u){this.C=Function.createDelegate(this,this.bf);this.K=Function.createDelegate(this,this.bg);this.L=Function.createDelegate(this,this.bl);this.D=Function.createDelegate(this,this.bn);_mcp.V.initializeBase(this,[n,t,i,r,u])};_mcp.V.prototype={p:null,g:function(){var n=this.bh;var t=n.bb;_j.e.a(_a.a.a,"Enabling timer during initialization of auto save component");this.p=this.bm();this.p.b=!0;if(!t.bm()){this.bp();_j.e.a(_a.a.a,"Auto save timer started")}_mcp.x.prototype.g.call(this);n.bi.b(_a.cI,this.D)},bf:function(){var r=this.bh;var n=r.bb;if(!this.cd&&!n.bm()){if(!n.bH()){_j.e.a(_a.a.a,"Auto Save not supported for the current operation {0}",n.a());return}var u=this.bh.be();_j.e.a(_a.a.a,"Checking dirty before auto save");var t=r.bR();var i=u.b();if(t&&!i){_j.e.a(_a.a.a,"AutoSave:Context:{0}",n);this.p.e();this.a("AutoSave",this.L,this.K,!1)}else{this.p.c();_j.e.a(_a.a.a,"Skip auto save since IsDirty={0}, AttachmentInProgress={1}",t,i)}}},bp:function(){var n=this.bi.a.bb;!n.bm()&&n.bH()&&this.p.c()},k:function(){this.p&&this.p.h()},br:function(){this.k();this.bh.bi.c(_a.cI,this.D);_mcp.x.prototype.br.call(this)},bm:function(){return new _mcp.bT(this.C,this.E())},E:function(){return 6e4},J:function(){_mcp.x.prototype.J.call(this);this.n&&this.n.o(_mcp.V.a)},bn:function(n){_j.o.a().c(_a.a.a,"Autosave triggered for PAL OnPause event",this.C)},bl:function(n){var i=this.bi;var r=i.a;var t=r.bb;t.dO(!0);t.bm()||this.p.c()},bg:function(n){_j.e.a(_a.a.a,"AutoSaveActionFailed: Error: {0}",n.F.message);this.bi.a.bb.bm()||this.p.c()}};_mcp.y=function(n,t,i,r){this.C=Function.createDelegate(this,this.Z);this.t=Function.createDelegate(this,this.W);this.u=Function.createDelegate(this,this.X);this.v=Function.createDelegate(this,this.Y);_mcp.y.initializeBase(this,[0,n]);this.A=t;this.w=i;this.x=r;this.j=new _a.j};_mcp.y.prototype={w:null,x:null,j:null,m:null,l:null,q:null,r:null,s:null,o:null,f:null,n:null,A:null,y:0,i:null,b:function(){return this.n},c:function(n){if(n!==this.n){this.n=n;this.bq("AddinsCalloutViewModel")}return n},a:function(){return this.f},ba:function(n){if(this.f!==n){this.f=n;this.bq("ComposeCommandingBar")}return n},F:function(){return this.bj.R()?this.bh.bh().a():this.bh.bh().n()},J:function(){return this.bh.br().a()},T:function(){return this.bh.bz().h()},O:function(){return this.bh.bp().b()},Q:function(){return this.bh.bm().j()},p:function(){return this.bh.be().i()},z:function(){this.s||(this.s=new _fm.g(this.T(),_u.P.M,_mcp.d.B(),0,null,_mcp.d.C(),!1,!1,!1,!1));return this.s},S:function(){this.m||(this.m=this.bj.R()?new _fm.g(this.F(),_u.P.e,_mcp.d.O(),0,null,null,!1,!1,!1,!1):new _fm.g(this.F(),_u.P.o,_mcp.d.R(),0,null,null,!1,!1,!1,!1));return this.m},K:function(){this.o||(this.o=new _fm.g(this.J(),_u.n.OJ,null,0,null,null,!1,!1,!1,!1));return this.o},L:function(){if(!this.l)if(this.p().p.x.length>1){var n=this;this.l=new _fm.l(_nbs.a.et,function(t){t(n.p())},0,_nbs.a.et,!1,!1,_mcp.d.o(),null)}else this.p().p.x.length===1&&(this.l=new _fm.g(this.p().p.x[0].l,_nbs.a.Tr,_mcp.d.o(),0,null,null,!1,!1,!1,!1));return this.l},P:function(){this.q||(this.q=new _fm.g(this.O(),null,_mcp.d.N(),0,_u.n.CF,null,!0,!1,!1,!1));return this.q},R:function(){this.r||(this.r=new _fm.g(this.Q(),null,_mcp.d.H(),0,_u.n.RW,null,!0,!1,!1,!1));return this.r},N:function(){return this.w.i()},M:function(){if(!this.bh||!this.bh.bo)return!1;var i=!!this.bh.bo.a().i()&&this.bh.bo.a().i().Enabled;var t=!!this.bh.bo.a().e()&&this.bh.bo.a().e().Enabled;var n=!!this.bh.bo.a().k()&&this.bh.bo.a().k().Enabled;return i||t||n},E:function(){return!!this.bh&&!!this.bh.bo&&!!this.bh.bo.a()&&!!this.bh.bo.a().e()&&this.bh.bo.a().e().Enabled},g:function(){if(this.d()){_j.e.a(_mcp.y.a,"Commanding bar component is already initialized, skipping redundant Initialize call.");return}if(!this.bh.bn()){_j.e.a(_mcp.y.a,"Initializing compose commanding bar");this.ba(new _fm.j(_u.R.Se));this.f.S=!0;this.f.I=!0;this.f.s=!0;this.k(this.S(),!0);this.k(this.L(),!0);(!this.M()||this.bh.bs())&&this.k(this.z(),!1);this.k(this.K(),!0);this.E()&&this.U();(this.A.b||this.bh.bs())&&!this.bj.dk()&&this.k(this.R(),!0);this.bi.a.apcl("ShouldShowToolbarMessage",this.v);if(this.bh.bt().d()){_j.e.a(this.bk(),"Primary init is complete; creating commanding bar affordance menu synchronously.");this.D()}else{_j.e.a(this.bk(),"Scheduling commanding bar affordance menu creation because primary initialization has not finished.");this.bh.bt().apcl("IsInitialized",this.u)}this.bi.a.bs()||this.bi.a.bb.l()===3||this.k(this.P(),!0);this.f.V();this.G(this.bh.bz().l());this.e(0);_j.e.a(_mcp.y.a,"Completed initializing compose commanding bar")}_mcp.G.prototype.g.call(this)},e:function(n){if(this.f){var u=this.bh.bs();var r=this.N();var t;var i;if(u){t=0;i=0}else{t=r?15:n;i=r?n:15}this.f.bp(t);this.f.X(i)}},br:function(){this.bi.a.rpcl("ShouldShowToolbarMessage",this.v);this.i&&this.i.rpcl("ComposeItems",this.t);var n;_a.i.a(n={val:this.f}),this.f=n.val;_mcp.G.prototype.br.call(this)},D:function(){_j.e.a(_mcp.y.a,"Adding affordance items to compose commanding bar");var n=new _j.q;this.h(n,8);this.h(n,11);this.h(n,1);this.h(n,28);this.h(n,6);this.h(n,3);this.h(n,15);this.h(n,9);for(var t=0;t<n.d.length;t++)this.f.a(n.d[t]);var i=n.d[0];i?_j.e.a(_mcp.y.a,"Completed added affordance items to compose commanding bar"):_j.e.b(_mcp.y.a,"Affordance menu item at index 0 is null.")},h:function(n,t){var r=null;var i=this.bi.b(t);if(i&&IMailComposeContextMenuProvider.isInstanceOfType(i)){_j.e.a(_a.a.a,"Getting affordance menu items for type '{0}', IsInitialized = {1}",Object.getType(i).getName(),i.d());i.d()||i.g();r=i;n.h(r.P())}},k:function(n,t){if(!this.f.bn(n)){n.a(!0);n.b(t);this.f.a(n)}},V:function(n,t){if(this.f&&!this.f.bn(t)){t.a(!0);t.b(!0);this.f.W(n,t)}},Y:function(n,t){var i=!this.bi.a.ca;this.bb(i)},bb:function(n){if(this.f)for(var r=this.f.b.x.length,t=0;t<r;t++){var i=this.f.b.x[t];i&&i.d!==1&&i.a(n)}},G:function(n){this.f&&!this.f.cd&&this.f.bn(this.z())&&this.z().b(n)},X:function(n,t){this.bh.bt().rpcl("IsInitialized",this.u);_j.o.a().c(_a.a.a,"AddAffordanceMenuItemsToComposeCommandingBar",this.C)},Z:function(){if(!this.cd&&this.f&&!this.f.cd&&this.f.b){this.f.s=!0;this.D();this.f.V()}else _j.e.a(this.bk(),"OnInitializerComponentPrimaryInitCompleted - commanding bar or its item collection is null, skipping affordance async init.")},U:function(){if(this.E()&&this.bh&&!this.bh.bs()){this.y=this.f.b.x.length;var n=this;this.x.a(function(t){if(t.g()&&!n.bo()){n.i=t;n.I();t.apcl("ComposeItems",n.t)}})}},I:function(){if(this.i&&this.i.a()){for(var t=0;t<this.j.b();t++)this.f.bo(this.j.a(t));this.j.m();for(var i=this.i.a(),n=0;n<i.b();n++){this.V(this.y+n,i.a(n));this.j.c(i.a(n))}}},W:function(n,t){this.I()}};_mcp.D=function(n,t,i,r){this.x=Function.createDelegate(this,this.J);this.y=Function.createDelegate(this,this.K);this.s=Function.createDelegate(this,this.F);this.z=Function.createDelegate(this,this.w);_mcp.D.initializeBase(this,[3,n,i,r]);this.E=t;this.k=!1};_mcp.D.b=function(n,t){return new _y.h(n,t)};_mcp.D.c=function(n,t){return new _fm.d(n,null,t,!0)};_mcp.D.prototype={E:null,p:null,j:null,o:null,m:null,n:!1,r:null,i:null,l:null,b:function(){return"IsIrmProtected"},h:null,f:null,a:function(){return this.n},q:function(n){if(this.n!==n){this.n=n;this.bq("IsIrmProtected")}return n},e:function(){return this.r},I:function(n){if(this.r!==n){this.r=n;this.bq("ShowIrmInformationCommand")}return n},c:function(){return this.i},G:function(n){if(this.i!==n){this.i=n;this.bq("DialogViewModel")}return n},k:!1,u:function(){var i=_g.a.a();if(i.e()&&!i.e().bj.Irm||this.bM.c()){_j.e.a(_a.a.a,"IRM segmentation flag has been turned off or user is consumer, cannot set compliance.");return!1}var n=this.bi.a.bb.G();var t=!n||!!n.a()||n.b()||n.l();_j.e.a(_a.a.a,"CanSetCompliance={0}",t);return t},v:function(){return!this.bj.R()&&this.u()&&!this.bh.bn()},g:function(){var n=this.bh;var u=n.bb;var o=n.dX;var r=n.bu;if(this.u())if(_g.k.b){_j.e.a(_a.a.a,"Checking main window for compliance configuration");this.f=_mcp.D.a;_g.k.b.jf(this.z)}else if(r.WasLoadedFromServer)this.w(r);else{_j.e.a(_a.a.a,"Adding the loading permissions menu item");this.f=_mcp.D.a;if(!r.IsLoadingFromServer){_j.e.a(_a.a.a,"Submitting GetComplianceConfigurationAction");var e=n.bi;e.b(_a.cB,this.s);var s=new _h.cb(r,n.bi);s.i()}}else if(this.f&&this.k&&o.a){n.dX.s(this.f);this.k=!1}var t=u.G();this.q(!!t&&!t.a());if(this.n&&"Mouse"===_y.c.a.a()){var i=n.bw();i.a.apply(i,[4499].concat([t.bj.TemplateName,t.bj.TemplateDescription]));i.a.apply(i,[4500].concat([t.bj.ContentOwner]))}else if(u.bp()){var f=n.bw();f.a.apply(f,[3800].concat([u.cm(),u.cn()]))}"Mouse"===_y.c.a.a()||this.r||this.I(new _j.g(this.y,this.bk()));_mcp.o.prototype.g.call(this)},br:function(){this.bh.bi.c(_a.cB,this.s);var t;_a.i.a(t={val:this.i}),this.i=t.val;var n;_a.i.a(n={val:this.l}),this.l=n.val;this.q(!1);_mcp.o.prototype.br.call(this)},bP:function(){if(this.v()){!this.h&&this.bh.bu.WasLoadedFromServer&&this.t();if(this.h){this.j=new _fm.k(_nbs.a.nN,null,this.h);return[this.j]}else if(this.u()&&this.bh.bu.IsLoadingFromServer){this.j=new _fm.k(_nbs.a.nN,null,null);this.j.a(!0);this.p=new _fm.d(_u.P.d,null,null);return[this.p,this.j]}else _j.e.b(_a.a.a,"Compliance sub-menu creation has been skipped.")}return null},bN:function(){if(this.v()){var n=this;this.m=new _fm.l(_nbs.a.nN,function(t){t(n.h)},1,null,!1,!1,null,null);if(this.h)return[this.m];else if(this.u()&&this.bh.bu.IsLoadingFromServer){this.m.a(!1);this.o=_mcp.o.a(null,_u.P.d);return[this.m,this.o]}}return null},bK:function(){if(this.v())return[this.f];else{this.k=!1;return null}},bY:function(){this.o&&this.o.a(!1);if(!this.h&&this.bh.bu.WasLoadedFromServer){this.t();this.h||(this.m=null)}this.m&&this.m.a(!0)},bZ:function(){this.p&&this.p.a(!0);if(!this.h&&this.bh.bu.WasLoadedFromServer){this.t();this.h||(this.j=null)}if(this.j){this.j.u(this.h);this.j.a(!1)}},cy:function(){this.f&&this.bh.dX&&this.bh.dX.s(this.f);this.f=null;this.k=!1;this.t()},D:function(n){var t=this.bi.a.bu;var e=t.RmsTemplates?t.RmsTemplates.length:0;var o=t.MessageClassifications?t.MessageClassifications.length:0;if(0===e&&0===o){_j.e.a(_a.a.a,"There are neither RmsTemplates nor message classifications available, skip setup of the compliance sub context menu.");return null}var i=new Array(1+e+o);var f=0;i[f++]=n(_nbs.a.r,new _j.g(this.x,this.bk()));for(var u=0,r=0;u<e||r<o;)if(u===e){var c=t.MessageClassifications[r++];i[f++]=n(c.Name,new _j.g(this.A(c.Id),this.bk()))}else if(r===o){var l=t.RmsTemplates[u++];i[f++]=n(l.Name,new _j.g(this.C(l.Id),this.bk()))}else{var s=t.MessageClassifications[r];var h=t.RmsTemplates[u];if(0<h.Name.localeCompare(s.Name)){i[f++]=n(s.Name,new _j.g(this.A(s.Id),this.bk()));r++}else{i[f++]=n(h.Name,new _j.g(this.C(h.Id),this.bk()));u++}}return i},t:function(){if("Mouse"===_y.c.a.a()||_y.c.a.a()==="TouchNarrow"){var i=this.D(_mcp.D.c);i&&(this.h=new _fm.f(i))}else if(!this.k){if(!this.f){var t=this.D(_mcp.D.b);t&&(this.f=new _y.h(_nbs.a.nN,null,t))}var n=this.bh.dX;if(this.f&&n){var r=n.a;if(r){this.ci=[this.f];this.bh.bH().b();this.k=!0}}}},F:function(n){if(!this.bo()){var t=this.bi.a;this.w(t.bu);t.bi.c(_a.cB,this.s)}},w:function(n){var t=this.bh;t.bu=n;_j.e.a(_a.a.a,"Updating menu with complete compliance configuration.");n.WasLoadedFromServer&&this.bv()},J:function(){var i=this.bi.a;var n=i.bb;i.bk().a(_mcp.be.toString(0));_j.e.a(_a.a.a,"Set no restriction");n.bY("0");var t=i.bw();if(n.G()){if("Mouse"===_y.c.a.a()){t.b(4499);t.b(4500)}n.cd(null);this.q(!1)}else if(n.bp()){t.b(3800);n.cb(!1);n.bV(null);n.bW(null);n.bX(null)}},C:function(n){var t=this;return function(){var h=new _cmc.d(_a.a.a,"MailComposeSetIRM",!0);var e=t.bi.a;var r=e.bb;r.bY(n);if(r.bp()){e.bc.b(3800);t.bh.bf();r.cb(!1);r.bV(null);r.bW(null);r.bX(null)}for(var s=e.bu.RmsTemplates,o=0;o<s.length;o++){var u=s[o];if(n.toLowerCase()===u.Id.toLowerCase()){var c="Permission_"+u.Id.toLowerCase();e.bk().a(c);var i=new _g.cK;i.v(n);i.r(_g.a.a().c().bj.UserEmailAddress);i.s(!0);i.t(0);i.x(u.Name);i.w(u.Description);i.q(r.j());r.cd(i);if("Mouse"===_y.c.a.a()){var f=e.bw();f.b(4499);f.b(4500);f.a.apply(f,[4499].concat([u.Name,u.Description]));f.a.apply(f,[4500].concat([i.bj.ContentOwner]))}t.q(!0);_j.e.a(_a.a.a,"Set IRM {0}",u.Name);break}}h.b()}},A:function(n){var t=this;return function(){var u=t.bi.a;var r=u.bb;r.bY(n);if(r.G()&&"Mouse"===_y.c.a.a()){var s=u.bw();s.b(4499);s.b(4500);r.cd(null);t.q(!1)}for(var o=u.bu.MessageClassifications,f=0;f<o.length;f++){var i=o[f];if(n.toLowerCase()===i.Id.toLowerCase()){var h="Classification_"+i.Id.toLowerCase();u.bk().a(h);r.cb(!0);r.bV(i.Name);r.bW(i.Description);r.bX(i.Id);var e=u.bw();e.b(3800);e.a.apply(e,[3800].concat([i.Name,i.Description]));_j.e.a(_a.a.a,"Set class {0}",i.Name);break}}}},K:function(){var t=this.bi.a.bb;if(t.G()){var n=t.G();this.L(n.bj.TemplateName,n.bj.TemplateDescription,n.bj.ContentOwner)}else _j.e.c(_a.a.a,"ShowIrmInformation was triggered without pre-existing license data or compliance entry selected.")},L:function(n,t,i){if(!this.i){this.G(new _bc.l);this.i.n.a(new _ff.d(this.i.o,_nbs.a.EN,null,!0))}this.i.q(n);this.l||(this.l=new _mcp.bh);this.l.d(t);this.l.c(String.format(_nbs.a.ca,i));this.i.s(this.l);this.i.f(!0)}};_mcp.G=function(n,t){this.dD=Function.createDelegate(this,this.ei);this.cI=Function.createDelegate(this,this.ej);_mcp.G.initializeBase(this);this.dE=n;this.bi=t;if(t&&t.a){this.bh=t.a;this.bj=this.bh.bb;this.bL=this.bh.bc}};_mcp.G.a=function(n,t){n&&!n.eK&&n.cY().a(t)};_mcp.G.prototype={dE:0,bi:null,bh:null,bj:null,bL:null,dg:!1,d:function(){return this.dg},ch:function(n){this.dg=n;return n},bk:function(){return _a.a.a},bo:function(){return this.cd||!this.bj||!this.bh||this.bh.eK},g:function(){this.ch(!0)},cJ:function(n){var i=this.cx(n);this.bh.dN(i);if(i===55||i===50){var t=this;this.bh.cC.a(function(n){if(!t.bo()){n.a(t.bL);t.bh.bf()}})}else this.bh.bf()},ej:function(n){this.bL.g(n);this.bh.bf()},ei:function(n,t){for(var u=[],i=2;i<arguments.length;++i)u[i-2]=arguments[i];var r;(r=this.bL).k.apply(r,[t,n].concat(u));this.bh.bf()},br:function(){this.ch(!1);_j.R.prototype.br.call(this)},cf:function(){this.bL.n();this.bL.e(_mcp.x.a);this.bL.e(_mcp.t.a);this.bL.e(_mcp.q.b);var n=this;this.bh.cC.a(function(t){if(!n.bo()){t.b(n.bL);n.bh.bf()}})},cx:function(n){throw Error.notImplemented(String.format("GetErrorInfoBarMessageId is not implemented for type {0}",Object.getType(this)));}};_mcp.by=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut){this.f=Function.createDelegate(this,this.k);this.i=Function.createDelegate(this,this.p);this.g=Function.createDelegate(this,this.m);this.h=Function.createDelegate(this,this.o);this.c=[];this.e=new _mcp.bx(this,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut);this.a=n};_mcp.by.prototype={e:null,c:null,a:null,b:function(n){var t=n;this.c[t]||(this.c[t]=this.e.t(n,this.a.bv.a()));return this.c[t]},n:function(){this.d(this.h)},dispose:function(){this.d(this.g,!0);this.c.length=0;this.c=null;this.a=null},q:function(){_j.e.a(_a.a.a,"Component Map set override start.");this.d(this.i);_j.e.a(_a.a.a,"Component Map set override end.")},l:function(){_j.e.a(_a.a.a,"Component Map clear override start.");this.d(this.f);_j.e.a(_a.a.a,"Component Map clear override end.")},d:function(n,t){if(!!t===t&&t)for(var i=this.c.length-1;i>=0;i--)this.j(n,i);else for(var r=0;r<this.c.length;r++)this.j(n,r)},j:function(n,t){var i=this.c[t];i&&n(i,t)},o:function(n,t){IMailComposeInitializerComponent.isInstanceOfType(n)||n.d()||n.g()},m:function(n,t){var i=Object.getType(n).getName();if(n.cd)_j.e.b(_a.a.a,"Skip component '{0}' at index {1} because it is already disposing.",i,t);else{_j.e.a(_a.a.a,"Disposing component '{0}' at index {1}...",i,t);try{n.dispose()}catch(r){_j.e.d(_a.a.a,r,"Exception in MailComposeComponentMap trying to dispose component '{0}'",i)}}},p:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.ba()},k:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.Z()}};_mcp.bz=function(n,t,i,r){this.l=Function.createDelegate(this,this.q);this.j=Function.createDelegate(this,this.o);this.k=Function.createDelegate(this,this.p);_mcp.bz.initializeBase(this,[15,n,i,r]);this.i=t};_mcp.bz.prototype={a:null,b:null,e:null,c:null,h:null,f:null,i:null,g:function(){this.b||(this.b=new _j.g(this.k,this.bk()));this.a||(this.a=new _j.g(this.j,this.bk()));_mcp.o.prototype.g.call(this)},br:function(){var t;_a.i.a(t={val:this.b}),this.b=t.val;var n;_a.i.a(n={val:this.a}),this.a=n.val;this.i=null;_mcp.o.prototype.br.call(this)},bP:function(){if(this.bh.bn())return null;this.e=new _fm.d(_nbs.a.bI,null,this.b);this.c=new _fm.d(_nbs.a.dR,null,this.a,!0);this.bv();return[this.e,this.c]},bN:function(){this.h=_mcp.o.a(this.b,_nbs.a.bI);this.f=_mcp.o.a(this.a,_nbs.a.dR);this.bv();return[this.h,this.f]},bK:function(){return null},bZ:function(){if(this.c&&this.e){this.c.a(this.bj.j()==="HTML");this.e.a(this.bj.j()!=="HTML")}},bY:function(){this.f.a(this.bj.j()!=="HTML");this.h.a(this.bj.j()==="HTML")},p:function(){_j.e.a(this.bk(),"User chose to convert to plain text");this.bi.a.bk().a("SwitchToPlain");if(this.n(_nbs.a.Pi)){this.bi.a.bb.bC().a();var r=this.bi.a.bb.D();var n;var i,t;var f=(t=_a.y.g(r,i={val:n}),n=i.val,t);if(!f){n=r;_j.e.a(this.bk(),"Using html due to failed conversion")}if(n.length>0){var u=this.bi.a.bl;u.h(1,[_nbs.a.Wd],this.l,!1,null,null,null,this.i,null)}else this.m()}},q:function(n,t){n&&this.m()},m:function(){var n=this.bi.b(5);n.o(!1);n.a()&&n.a().cl();this.bi.a.bb.m("Text");this.bv();_j.e.a(this.bk(),"MailComposeContentConversionComponent.ToPlainText succeeded.")},o:function(){_j.e.a(this.bk(),"User chose to convert to html");this.bi.a.bk().a("SwitchToHTML");if(this.n(_nbs.a.Qz)){var t=this.bi;var r=t.a;var i=r.bb;i.m("HTML");this.bv();var n=this.bi.b(5);n.o(!0);n.a()&&n.a().bS();_j.e.a(this.bk(),"MailComposeContentConversionComponent.ToHtml succeeded.")}},n:function(n){_j.e.a(this.bk(),"Checking if the email has been upgraded which is a pre-requisite of content conversion.");if(!this.bi.a.bb.i()){this.bi.a.bl.g(0,n,null);_j.e.a(this.bk(),"Conversion is not available because the email has not yet been upgraded.");return!1}if(!this.bi.a.bb.bi()){this.bi.a.bl.g(0,n,null);_j.e.a(this.bk(),"Conversion is not available when content is being loaded in editor.");return!1}var t=this.bi.b(5);if(t.a()&&t.a().v()){this.bi.a.bl.g(0,_nbs.a.aj,null);_j.e.a(this.bk(),"Conversion is not available because the email has reference attachments.");return!1}return!0}};_mcp.H=function(n){_mcp.H.initializeBase(this,[16,n])};_mcp.H.prototype={a:function(){return this.ev(_mcp.H.a)},f:function(n){this.eu(_mcp.H.a,n);return n},g:function(){if(this.d()){_j.e.a(_a.a.a,"Context menu component is already initialized, skipping redundant Initialize call.");return}var n=this.e();if(n&&n.d.length>0){_j.e.a(_a.a.a,"Creating context menu items.");this.f(new _fm.f(n.j()))}_mcp.G.prototype.g.call(this)},e:function(){var n=new _j.q;if("Mouse"===_y.c.a.a()){this.b(n,8);this.b(n,11);this.b(n,1);this.b(n,28);this.b(n,6);this.b(n,3);this.b(n,15);this.b(n,9);this.b(n,2)}return n},br:function(){if(this.a()){this.a().dispose();this.f(null)}_mcp.G.prototype.br.call(this)},b:function(n,t){var r=null;var i=this.bi.b(t);if(i&&IMailComposeContextMenuProvider.isInstanceOfType(i)){_j.e.a(_a.a.a,"Getting context menu items for type '{0}', IsInitialized = {1}",Object.getType(i).getName(),i.d());i.d()||i.g();r=i;n.h(r.Q())}}};_mcp.bA=function(n){_mcp.bA.initializeBase(this,[n])};_mcp.bA.prototype={e:function(){var n=new _j.q;if("TouchNarrow"===_y.c.a.a()){var t;var f=this.bh.be();var i=f.m();if(i)if(i.d.length>1){t=new _fm.k(_nbs.a.et,null,new _fm.f(i.d));n.c(t)}else if(i.d.length===1){var u=i.d[0].l;t=new _fm.d(_nbs.a.et,null,u);n.c(t)}var r=this.bh.bz();t=new _fm.d(_u.P.j,null,r.h());n.c(t);this.b(n,11);this.b(n,1);this.b(n,28);this.b(n,6);this.b(n,3);this.b(n,9)}return n}};_mcp.I=function(n,t,i,r,u){this.U=Function.createDelegate(this,this.bY);_mcp.I.initializeBase(this,[n,t,i,r,u]);this.V=!!i&&i.a().bd().Enabled;this.bh.bv.k(_mcp.I.a)};_mcp.I.a=function(n){n.a(_nbs.a.CH)};_mcp.I.prototype={V:!1,M:!1,L:function(){return this.V&&this.P()&&!this.bj.eN},bX:function(){return this.L()&&this.u>0},g:function(){if(this.L()){this.u=_j.B.a(_g.a.a().a().bj.MailSendUndoInterval)?0:_g.a.a().a().bj.MailSendUndoInterval;_g.a.a().a().apcl("MailSendUndoInterval",this.U)}_mcp.t.prototype.g.call(this)},br:function(){this.L()&&_g.a.a().a().rpcl("MailSendUndoInterval",this.U);this.bh.bv.k(_mcp.I.a);_mcp.t.prototype.br.call(this)},S:function(){this.M=!1;if(this.bX()&&!this.bE()){_j.e.a(_a.a.a,"Queueing delayed async send.");this.bZ();this.M=!0}else{_j.e.a(_a.a.a,"Submitting send action with no delay.");_mcp.t.prototype.S.call(this)}},bZ:function(){var n=this;_j.o.a().c(_a.a.a,"QueueAsyncSend",function(){n.bh.bv.m(_mcp.I.a);_j.e.a(_a.a.a,"Firing optimistic save for delayed send.");n.bh.bm().a("Save",function(){_j.e.a(_a.a.a,"Optimistic save for delayed send succeeded.");n.bd()},function(){_j.e.b(_a.a.a,"Optimistic save for delayed send failed! Continuing with delayed send anyway...")},!0);n.bd();var t=new _mcp.bR(n.u,n.bj,function(){n.bh.bv.k(_mcp.I.a);_mcp.t.prototype.S.call(n);n.bh.bS.a(function(){n.s.a(ISendEvent,new _mcp.bo(n.bh))})});n.s.a(IDelayedSendEvent,t)})},bd:function(){if(this.bj.U()&&_g.j.isInstanceOfType(this.bj.U())){var n=this.bj.U();if(!n.bE){_h.c.K(n,!0);_j.e.a(this.bk(),"TryFlagDraftAsQueuedForSubmission - draft was successfully updated as queued for submission.")}}else _j.e.b(this.bk(),"TryFlagDraftAsQueuedForSubmission - no draft to update as queued for submission.")},bV:function(){if(this.M)_j.e.a(_a.a.a,"Skipping firing send event for delayed async send.");else{_j.e.a(_a.a.a,"Firing send event for immediate async send.");this.bN()}},ca:function(){if(this.L()){var n=this.bh.bc;n.b(1002);this.u>0&&n.a(1002,this.u.toString())}},bY:function(n,t){this.u=_g.a.a().a().bj.MailSendUndoInterval;this.ca()}};_mcp.v=function(n){this.w=Function.createDelegate(this,this.I);this.y=Function.createDelegate(this,this.u);this.x=Function.createDelegate(this,this.D);this.v=Function.createDelegate(this,this.C);this.z=Function.createDelegate(this,this.M);this.A=Function.createDelegate(this,this.N);_mcp.v.initializeBase(this,[19,n]);this.o=new _j.g(this.A,this.bk());this.n=new _j.g(this.z,this.bk());this.q=n.a.bO};_mcp.v.prototype={o:null,n:null,q:null,p:null,m:null,t:!1,r:!1,a:function(){return this.o},l:function(){return this.n},f:function(){return this.p},G:function(n){if(n!==this.p){this.p=n;this.bq("DiscardConfirmDialogButtonData")}return n},F:function(n){if(n!==this.m){this.m=n;this.bq("CloseConfirmDialogButtonData")}return n},h:function(){return this.t},i:function(n){if(n!==this.t){this.t=n;this.bq("IsDiscardConfirmDialogShown")}return n},s:function(n){if(n!==this.r){this.r=n;this.bq("IsCloseConfirmDialogShown")}return n},k:function(){var i=this.bi;var t=i.a;var n=t.bb;t.bk().a("Discard");if(n.a()||!n.a()&&(n.h()||t.bm().c())){_j.e.a(_a.a.a,"Discard");this.E(n.b(),n.h())}},e:function(n,t){if(this.q.a(n)){_j.e.a(_a.a.a,"Resuming discard of {0}",_h.ba.a(t));this.E(n,t)}else _j.e.a(_a.a.a,"User had already discarded.")},j:function(){if(!this.bj.eJ)return!0;_j.e.a(_a.a.a,"Comparing initial baseline to baseline. Context:{0}",this.bj);if(!this.bj.eJ.s(this.bj.eH()))return!0;_j.e.a(_a.a.a,"Checking dirty before showing discard confirmation.");return this.bh.bR()?!0:this.bj.bD()?!0:!1},b:function(n){this.bu("IsDiscardingCompose",n)},c:function(n){this.bI("IsDiscardingCompose",n)},br:function(){this.i(!1);this.s(!1);this.G(null);this.F(null);var t;_a.i.a(t={val:this.o}),this.o=t.val;var n;_a.i.a(n={val:this.n}),this.n=n.val;this.q=null;_mcp.G.prototype.br.call(this)},L:function(){_j.e.a(_a.a.a,"Checking dirty before showing discard confirmation.");return this.bh.bR()?!0:!1},E:function(n,t){this.D();var i=this.bi.a;var r=i.bb.bG()||i.bb.bD();this.q.b(n,t,i.bq,r)},N:function(){var t=this.bi.a;var n=t.bb;_j.e.a(_a.a.a,"User chose to discard");if(this.j()){this.K();_j.e.a(_a.a.a,"Toggle IsDiscardConfirmDialogShown flag to show the dialog. Context:{0}",n);this.i(!0)}else{_j.e.a(_a.a.a,"User hit discard, we determined there's no need to show confirmation dialog, calling discard and navigating away. Context:{0}",n);this.C()}},M:function(){var t=this.bi.a;var n=t.bb;_j.e.a(_a.a.a,"User chose to close");if(this.L()){this.J();_j.e.a(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to show the dialog. Context:{0}",n);this.s(!0)}else{_j.e.a(_a.a.a,"User hit close, we determined there's no need to show confirmation dialog, navigating away. Context:{0}",n);this.u()}},D:function(){_j.e.a(_a.a.a,"Toggle IsDiscardConfirmDialogShown flag to hide the dialog. Context:{0}",this.bi.a.bb);this.i(!1)},I:function(){_j.e.a(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to hide the dialog. Context:{0}",this.bi.a.bb);this.s(!1)},K:function(){if(!this.p){_j.e.a(_a.a.a,"Creating discard confirm dialog.");var n=new _j.k;n.a(new _ff.d(new _j.g(this.v,this.bk()),_u.n.Ku,_u.n.LS,!0));n.a(new _ff.d(new _j.g(this.x,this.bk()),_u.n.Pn,_u.n.LI));this.G(n)}},J:function(){if(!this.m){_j.e.a(_a.a.a,"Creating close confirm dialog.");var n=new _j.k;n.a(new _ff.d(new _j.g(this.y,this.bk()),_u.n.Pp,_u.n.GK,!0));n.a(new _ff.d(new _j.g(this.w,this.bk()),_u.n.JU,_u.n.LI));this.F(n)}},C:function(){_j.e.a(_a.a.a,"Discard and close");this.k();this.u();this.bh.bd().u("Discard")},u:function(){this.bj.ff(null);this.bh.bp().a(this.bh,!1);_j.e.a(_a.a.a,"Navigated away from compose");this.cg("IsDiscardingCompose")}};_mcp.bB=function(n,t){this.k=Function.createDelegate(this,this.e);this.h=Function.createDelegate(this,this.p);this.m=Function.createDelegate(this,this.o);_mcp.bB.initializeBase(this,[25,n]);this.f=t;this.i=new _j.g(this.m,_a.a.a);var i=n.a.bb;i.dN(this.i)};_mcp.bB.prototype={i:null,f:null,j:!1,l:null,b:function(){return this.l},a:function(n){this.l=n;this.bq("EditorCallContext");return n},e:function(){this.a(new _cmc.L)},g:function(){if(!this.j){this.q();this.j=!0;_g.a.a().b().v(this.h);_g.a.a().b().I(this.h)}_mcp.G.prototype.g.call(this)},c:function(n,t){var i;if(n){var e=_g.a.a();var r=e.a().bU();var o=(r&1)>0;var u=(r&2)>0;var f=(r&4)>0;i=_j.i.b(t)?"<P><BR></P>":_a.y.e+t+_a.y.d;o&&(i='<strong id="OWAStrongID">'+i+"</strong>");u&&(i='<em id="OWAItalicID">'+i+"</em>");f&&(i='<span id="OWAUnderLineID" style="text-decoration:underline;">'+i+"</span>")}else i=_j.i.b(t)?"\r\n":t;return i},br:function(){var n;_a.i.a(n={val:this.i}),this.i=n.val;this.r();this.j=!1;this.f=null;_g.a.a().b().A(this.h);_g.a.a().b().N(this.h);_mcp.G.prototype.br.call(this)},o:function(){this.a(new _cmc.f(!1))},p:function(n,t){this.e()},q:function(){if(this.f)try{var n=this.f;if(!n.closed){var r=_j.w.b(n);var i=this;r.c("resize",function(n){i.e()},"MCEditorComponent")}}catch(u){var t=this.n(this.f);_j.e.d(this.bk(),u,"Projection window dump: {0}",t)}else _y.c.a.o(this.k)},r:function(){if(this.f){var n=_j.w.b(this.f);n.d("resize","MCEditorComponent")}else _y.c.a.p(this.k)},n:function(n){var t="";for(var i in n)t=t+i+",";return t}};_mcp.bC=function(n){_mcp.bC.initializeBase(this,[n,null])};_mcp.bC.prototype={e:function(){}};_mcp.bD=function(n,t,i){this.l=Function.createDelegate(this,this.w);this.m=Function.createDelegate(this,this.x);this.j=Function.createDelegate(this,this.u);this.k=Function.createDelegate(this,this.v);this.p=Function.createDelegate(this,this.s);_mcp.bD.initializeBase(this,[34,n]);this.n=t;this.f=i;this.c=this.bh.bi;this.e=this.bh.bc};_mcp.bD.prototype={n:null,f:null,e:null,c:null,b:null,h:!1,r:"",o:!1,a:function(){if(!this.o&&!(this.f.bj.GroupSuggestionDismissalCount>=10)){var n=this.bh.bd();if(n&&n.b(0)&&n.b(0).a()&&n.b(0).a().x.length>=3){var e=n.b(0).a();var s=!1;var h=e.x.length;var u=new _j.q;var t={};var c=_g.a.a().c();t[c.bj.LogonEmailAddress]=!0;for(var i=0;i<h;i++){var f=e.x[i];var r=f.k.a().EmailAddress;if(f.j.Z()){s=!0;this.bj.eN||_a.d.c(_a.a.bD,"GroupSuggestionOnCompose_ConversationAlreadyContainsGroup");break}if(!(r in t)){var o=new _g.f;o.EmailAddress=r;u.c(o);t[r]=!0}}if(u.d.length>=3&&!s)this.t(u.j());else if(!this.h){this.i();_a.d.c(_a.a.bD,"GroupSuggestionOnCompose_ContainsGroupToSkipRequest")}}else if(!this.h){this.i();_a.d.c(_a.a.bD,"GroupSuggestionOnCompose_NotEnoughRecipientsToSkipRequest")}}},q:function(n,t){if(this.e&&this.e.h(10307)&&this.b){this.b.c=t;this.b.v(n);this.b.K()}else{this.b=new _mcp.O(this.p,this.n,this.c,this.bh.bd(),this.bh.da,n,t,this.bh.bl);this.e.d(10307,this.b);this.c.b(ICreateGroupInGroupSuggestionEvent,this.k);this.c.b(ICreateGroupCompleteInGroupSuggestionEvent,this.j)}},s:function(){var t=this.f.bj.GroupSuggestionDismissalCount;if(t>=9){var n=this;this.bh.bl.g(2,_nbs.a.KY,function(i,r){if(i){n.f.bh(t+1);_h.f.a(n.f.v,_a.g.a);n.i();_a.d.c(_a.a.bD,"GroupSuggestionOnCompose_DismissSuggesstionPermanently")}r},!1,"","",_nbs.a.la)}else{this.f.bh(t+1);_h.f.a(this.f.v,_a.g.a);this.i();_a.d.c(_a.a.bD,"GroupSuggestionOnCompose_DismissSuggesstion")}this.o=!0},i:function(){if(this.e&&this.e.h(10307)){this.e.b(10307);var n;_a.i.a(n={val:this.b}),this.b=n.val;this.c.c(ICreateGroupInGroupSuggestionEvent,this.k);this.c.c(ICreateGroupCompleteInGroupSuggestionEvent,this.j)}},v:function(n){this.h=!0},u:function(n){var u=this.bh.bd();if(u){var t=u.b(0);t.i(this.r);if(n.a()&&t){var r=n.c();r.a().Name=r.c();var e=t.m(r.a());e.D(!0);for(var f=n.b(),i=0;i<f.length;i++)t.i(f[i])}}this.h=!1},t:function(n){var t=new _mcp.bt(n);t.d(this.m);t.e(this.l);this.bh.bq.a(t,null,null,null)},x:function(n){n.S(this.m);n.U(this.l);var i=n;var t=i.c;if(i.j){this.q(!1,null);_a.d.c(_a.a.bD,"GroupSuggestionOnCompose_ShowCreateGroupSuggestion")}else if(t&&t.length>0){this.q(!0,t[0]);_a.d.c(_a.a.bD,"GroupSuggestionOnCompose_ShowExistGroupSuggestion")}else this.h||this.i()},w:function(n){n.S(this.m);n.U(this.l);this.i()},g:function(){this.a();if(this.d()){_j.e.b(_a.a.a,"MailComposeAtMentionComponent is already initialized, skipping redundant Initialize call.");return}_mcp.G.prototype.g.call(this)},br:function(){var n;_a.i.a(n={val:this.b}),this.b=n.val;this.c.c(ICreateGroupInGroupSuggestionEvent,this.k);this.c.c(ICreateGroupCompleteInGroupSuggestionEvent,this.j);_mcp.G.prototype.br.call(this)}};_mcp.bF=function(n,t,i,r){this.k=Function.createDelegate(this,this.s);this.l=Function.createDelegate(this,this.t);this.j=Function.createDelegate(this,this.r);_mcp.bF.initializeBase(this,[6,n,i,r]);this.n=t};_mcp.bF.prototype={b:null,c:null,h:!1,e:!1,i:!1,n:null,o:function(n){if(n!==this.h){this.h=n;this.bq("IsHighImportance")}return n},a:function(){return this.e},q:function(n){if(n!==this.e){this.e=n;this.bq("IsNormalImportance")}return n},p:function(n){if(n!==this.i){this.i=n;this.bq("IsLowImportance")}return n},g:function(){var i=this.bj.X();this.f(i);_j.e.a(_a.a.a,"Importance component initialized and importance set to {0}",i);if("Mouse"===_y.c.a.a()||_y.c.a.a()==="TouchNarrow"){if(!this.b){var t=this.m(_mcp.o.b);t&&(this.b=new _fm.f(t))}}else if(!this.c){var n=this.m(_mcp.o.c);n&&(this.c=new _y.h(_nbs.a.gx,null,n))}_mcp.o.prototype.g.call(this)},br:function(){this.b=null;_mcp.o.prototype.br.call(this)},bP:function(){var n=new _fm.k(_nbs.a.gx,null,this.b);return[n]},bN:function(){var t=this;var n=new _fm.l(_nbs.a.gx,function(n){n(t.b)},1,null,!1,!1,null,null);return[n]},bK:function(){return[this.c]},r:function(){var n=new _cmc.d(_a.a.a,"MailComposeSetImp",!1);_j.e.a(_a.a.a,"User sets high importance");this.f("High");this.bi.a.bk().a("Importance:High");n.b()},t:function(){_j.e.a(_a.a.a,"User sets normal importance");this.f("Normal");this.bi.a.bk().a("Importance:Normal")},s:function(){var n=_a.d.b(_a.a.a,"MailComposeSetImp");_j.e.a(_a.a.a,"User sets low importance");this.f("Low");this.bi.a.bk().a("Importance:Low");_a.d.a(n)},f:function(n){this.bi.a.bb.dP(n);this.o("High"===n);this.q("Normal"===n);this.p("Low"===n)},m:function(n){return[n(new _j.g(this.j,this.bk()),_nbs.a.YC),n(new _j.g(this.l,this.bk()),_nbs.a.NS),n(new _j.g(this.k,this.bk()),_nbs.a.bh)]}};_mcp.w=function(n,t,i,r){this.S=Function.createDelegate(this,this.cl);this.Q=Function.createDelegate(this,this.bY);this.T=Function.createDelegate(this,this.cm);this.bl=Function.createDelegate(this,this.ck);this.bs=Function.createDelegate(this,this.cB);this.J=Function.createDelegate(this,this.W);this.bd=Function.createDelegate(this,this.U);this.bg=Function.createDelegate(this,this.bZ);this.y=Function.createDelegate(this,this.bc);this.P=Function.createDelegate(this,this.bX);this.L=Function.createDelegate(this,this.bT);this.K=Function.createDelegate(this,this.bR);this.M=Function.createDelegate(this,this.bU);this.N=Function.createDelegate(this,this.bV);this.O=Function.createDelegate(this,this.bW);this.R=Function.createDelegate(this,this.ce);this.be=Function.createDelegate(this,this.bx);this.bm=Function.createDelegate(this,this.cu);this.bf=Function.createDelegate(this,this.bP);this.bn=Function.createDelegate(this,this.cv);this.bp=Function.createDelegate(this,this.cw);this.bz=["bmp","gif","jpg","jpeg","png"];_mcp.w.initializeBase(this,[24,n]);this.n=_db.h.e(i);this.bb=r;this.G=_a.k.a();this.Y=t;this.z=i;_b.g.c()||this.bE(!1)};_mcp.w.prototype={o:null,A:null,n:!1,F:!1,E:!1,I:null,C:null,t:null,x:null,w:null,v:null,bb:null,l:null,m:null,p:null,r:null,s:null,G:null,q:null,Y:null,z:null,D:null,u:!1,bE:function(n){if(n!==this.n){this.n=n;this.bq("IsLinkPreviewEnabled")}return n},co:function(n){if(n!==this.u){this.u=n;this.bq("IsDocLinkPreviewActivated")}return n},cn:function(n){if(n!==this.o){this.o=n;this.cy()}return n},ca:function(){this.v||(this.v={});return this.v},cq:function(n){this.A=n;this.bq("LinkPreviewResponse");if(this.A&&_zz.e.f(this.l)){var t=this.l.bU();this.bv(this.A,t&&t.length>0?t[0]:null)}return n},cs:function(n){if(n!==this.x){this.x=n;this.x&&_db.h.a(this.x,null,this.bp,null,null)}return n},cr:function(n){if(n!==this.w){this.w=n;this.w&&_db.h.a(this.w,null,this.bn,null,null)}return n},b:function(){return this.F},e:function(n){if(this.F!==n){this.F=n;this.bq("ShowYouTubePlayer")}return n},a:function(){return this.E},c:function(n){if(this.E!==n){this.E=n;this.bq("ShowOEmbedVideoPlayer")}return n},i:function(){return this.I},ct:function(n){this.I=n;this.bq("YouTubePlayerUrl");return n},h:function(){return this.C},bJ:function(n){this.C=n;this.bq("OEmbedVideoPlayerHtml");return n},f:function(){this.t||(this.t=new _j.g(this.bf,_a.a.e));return this.t},br:function(){var n;_a.i.a(n={val:this.t}),this.t=n.val;this.l=null;this.cA();this.r=null;this.s=null;this.q=null;this.v=null;_mcp.G.prototype.br.call(this)},cy:function(){if(_db.h.c){_j.e.a(_a.a.e,"Link preview feature is disabled.  Skipping GetLinkPreview action for {0}",this.o.Url);this.bx();return}if(this.o){var i=1;var r=_a.d.b(_a.a.e,"GetComposeLinkPreview");var n=[];Array.add(n,this.o);_j.e.a(_a.a.e,"Preparing GetLinkPreview action for {0}",this.o.Url);this.o.Autoplay=!0;var u=new _db.h(this.o);_j.e.a(_a.a.e,"Submitting GetLinkPreview action for {0}",this.o.Url);var t=this,f=this;this.bi.a.bq.a(u,function(u){_db.h.k(u,t.bm,t.be,i,r,"GetComposeLinkPreview",n)},function(t){_db.h.h(t,i,r,"GetComposeLinkPreview",n)},null)}},cu:function(n){this.cq(n)},bx:function(){this.bE(!1)},cw:function(n){this.ct(n);this.e(!!this.I)},cv:function(n){var t=this.p.g(n);t?this.bJ(t):this.bJ(n);this.c(!!this.C)},bP:function(){this.c(!1)},j:function(n){this.m=n;this.m.r(this.R);this.m.b(this.O);this.m.a(this.N);this.m.c(this.M);this.m.i(this.K);this.m.j(this.L);this.m.s(this.P)},cA:function(){if(this.m){this.m.v(this.R);this.m.e(this.O);this.m.d(this.N);this.m.f(this.M);this.m.t(this.K);this.m.u(this.L);this.m.w(this.P);this.m=null}},cj:function(n){if(!this.n){_j.e.a(_a.a.e,"RTE: Skipping IsElementFromPreviewAnchor because previews are disabled");return!1}var t="LPNoLP";var r="a[id^='"+t+"']";var i=$(n);return _b.g.a(n.id,t)||i.find(r).length>0},ci:function(n){if(!this.n){_j.e.a(_a.a.e,"RTE: Skipping IsElementFromPreviewAnchor because previews are disabled");return!1}var t=!1;var r=$(n);var i="a[id^='LPlnk']";t=_b.g.a(n.id,"LPlnk")||r.find(i).length>0;!t&&n.nodeName==="#text"&&n.parentNode&&n.parentNode.nodeName==="A"&&(t=_b.g.a(n.parentNode.id,"LPlnk"));return t},ce:function(n){var i=n.c();var t=n.d();if(_zz.i.isInstanceOfType(t))this.l=t;else{_j.e.c(_a.a.e,"HandleLinkPreviewOnLinkAdded: event source was not an instance of HtmlEditorBase");return}this.bK(i)},bK:function(n){if(n&&this.n){var i=null;try{i=n.href}catch(u){var t=n.outerHTML;var r=t?" OuterHTML: "+t:"";_j.e.c(_a.a.e,"IsLinkPreviewProtocol exception: "+u.message+"."+r);return}if(this.cj(n)||this.ci(n))return;if(_b.g.e(n.id))return;if(this.k()&&!this.k().s(n))return;if(i.toLowerCase().startsWith("http")){n.id=_b.g.f();_j.e.a(_a.a.e,"FindAndInsertLinkInPreviousWord: Trigger link preview");this.cz(n.id,n.href)}}},bQ:function(n){if(n){var t=n.toLowerCase().split(".");if(t&&t.length>1)return Array.contains(this.bz,t[t.length-1])?!0:!1}return!1},bU:function(n){var t=n.d();if(_zz.i.isInstanceOfType(t))this.l=t;else{_j.e.c(_a.a.e,"EditorOnContentLoaded: event source was not an instance of HtmlEditorBase");return}this.Z(n.c())},bR:function(n){n.c()===1&&this.bM(n.e())},bT:function(n){this.Z(n.c())},bW:function(n){var t=n.c();this.bN(t)},bX:function(n){if(!this.n||!this.z||!this.z.n()){_j.e.a(_a.a.e,"RTE: Skipping getting doc links because doc link previews are disabled");return}if(this.p){var t=new _a.j;var i=this.k().h();var r=this;Array.forEach(i,function(n){var i=n;if(i.d()&&!i.h()){var r=new _g.em;r.Url=i.j();r.ProviderType=_g.p.toString(i.f()==null?0:i.f());r.PermissionType=i.b()==null?0:i.b();t.c(r);i.n(!0)}});this.bj.gP(t)}},bV:function(n){var t=n.c();this.Z(t)},cz:function(n,t){if(!this.n){_j.e.a(_a.a.e,"RTE: Skipping link preview requests because previews are disabled");return}if(this.bQ(t)){var i=this;_j.o.a().a(this.bk(),"InsertInlineImageTimerCallback",function(){if(!i.cd&&i.l&&i.l.Y()&&i.l.bc){var r=i.l.be().querySelectorAll("#"+n);if(r&&r.length>0&&r[0]){var f=document.createElement("img");try{f.src=t}catch(e){_j.e.a(_a.a.e,"Exception encountered when inserting image for {0}. Exception: {1}",t,e.message);return}var u=document.createElement("p");u.appendChild(f);i.l.bC(!0);r[0].parentNode&&r[0].parentNode.appendChild(u);i.l.bw(3);i.l.bW()}}},10)}else{_j.e.a(_a.a.e,"Trigger link preview request for {0}",t);var r=new _g.cS;r.Id=n;r.Url=t;r.RequestStartTimeMilliseconds=_a.c.a().h();if(this.G.a()){var u=this;_j.o.a().c(this.bk(),"QueueGenerateLinkPreviewForIE",function(){u.bc(r)})}else this.bc(r)}},bv:function(n,t){_j.e.a(_a.a.e,"Adding link preview for {0}",n.Url);var i=!1;_h.bU.a(n)&&(i=!0);if(!this.k()){this.r=n;this.s=t;this.p&&this.bC();return}if(i){this.k().l(this.y);return}if(this.l&&this.l.Y()&&this.l.bc){this.l.bC(!0);this.k().f(n,this.y,t,this.bg,this.bd,this.J,null);this.l.bw(3);this.l.bW()}else _j.e.a(_a.a.e,"Ignore AddLinkPreview since the editor isn't active or initialized")},k:function(){if(!this.p){_j.e.a(_a.a.e,"LinkPreviewBuilder: Create LinkPreviewBuilder");var n=this;this.bb.a(function(t){n.cp(t.a(n.bs,n.bl,!0,_y.c.a,n.Y,n.bh.bq));n.p.d(n.ca());n.bC()})}return this.p},cp:function(n){this.p=n;this.bq("LinkPreviewBuilder");return n},cB:function(n){this.cs(new _a.bV(new _db.l(n)))},ck:function(n){this.cr(new _a.bV(new _db.l(n)))},bC:function(){_j.e.a(_a.a.e,"LinkPreviewBuilder: LinkPreviewBuilderFactoryOnOnCreated");if(this.r&&this.s){_j.e.a(_a.a.e,"LinkPreviewBuilder: There was a deferred AddLinkPreview. Calling it now");this.bv(this.r,this.s);this.r=null;this.s=null}if(this.q){_j.e.a(_a.a.e,"LinkPreviewBuilder: There was a deferred InitializeLinkPreviewFromAnchors. Calling it now");this.bA(this.q);this.q=null}},bA:function(n){this.q=n;var h=!1;var s=!1;if(this.k())this.q=null;else return;for(var f=0;f<n.length;f++){var i=n[f];if(_b.g.a(i.id,"LPUrlAnchor")){var t;var l,c;if(c=this.k().u(i,l={val:t}),t=l.val,c){var p=this.D+"[id^='LPRemovePreview']";var y=$(t).find(p);if(y.length>0){_j.e.a(_a.a.e,"Remove preview button already added. Skipping preview initialization.");continue}this.ba(t);var u=!1;var o;this.k().p(t,o={val:u}),u=o.val;this.k().n(t);if(u){this.k().o(i);h=!0}this.bw(t);this.U(t);this.W(t);this.V(t);t.id=this.k().m(t.id,i.href);var r=this.k().a(i.href);r&&r.d()&&r.a()&&!(r.a().b()!=null)&&this.k().t(r,t,this.J)}}else{if(!s){this.bK(i);s=!0}if(_b.g.a(i.id,"LPlnk")&&this.bB(i.href)){var e=i.id.indexOf("_");var a=e>-1?i.id.substring(0,e):i.id;var v=this.l.z.querySelectorAll("div[id*='"+a+"']");v.length||i.setAttribute("previewremoved",!0)}}}h&&this.k().l(this.y)},bc:function(n){this.cn(n)},bZ:function(n){this.bw(n);this.U(n);this.W(n);this.V(n);var t=n;if(this.G.a()){n.style.display="inline-block";t=window.document.createElement("p");t.appendChild(n)}this.ba(t);return t},bw:function(n){var t=this.k().e(n,"[id^='LPRemovePreviewContainer']");if(t){this.D=t.tagName;t.id="LPRemovePreview";t.style.marginLeft="10px";var i=$(t);i.click(this.T);i.addClass(_mcp.d.P().a())}},W:function(n){var u=$(n);var f=u.find("a[id^='LPUrlAnchor']");if(f.length>0){var o=f[0].href;if(this.k().r(o)){var i=u.find("[id^='LPOptionsContainer']");if(i.length>0&&_j.i.a(i[0].innerHTML)){var t=this.k().e(n,"[id^='LPOptionsContainer']");if(t){t.id="LPOptions";var r=$(t);var e=_mcp.d.I().a();if(!r.hasClass(e)){r.addClass(e);this.V(n);this.co(!0)}}}}}},V:function(n){var o=$(n);var t=o.find("a[id^='LPUrlAnchor']");var r=o.find("[id^='LPMetadata']");if(r.length>0&&t.length>0){var e=t[0].href;if(this.bB(e)){var i;var u;var f;(i=this.k().a(e))&&!_j.i.a(u=this.k().b(i.b()==null?0:i.b()))?r.text(u):t.length>0&&!_j.i.a(f=this.cc(t[0].href))&&r.text(String.format(_nbs.a.Ms,f))}}},U:function(n){var i;if((i=$(n).find("div[id^='LPDescription']")).length>0&&!_j.i.a(i.attr("altdesc"))){var t=this.k().e(n,"[id^='LPExpandDescriptionContainer']");if(t){t.id="LPExpandDescription";var r=$(t);var u=i[0].id.endsWith("_summary")?_mcp.d.j().a():_mcp.d.k().a();r.addClass(u);r.click(this.Q)}}},ba:function(n){_j.e.a(_a.a.e,"InitializePreviewForEditor: InitializePreviewForEditor.");n.setAttribute("contenteditable",!1);var t=$(n);t.bind("click",this.S)},by:function(n){var t=[];this.X(t,n,this.D,"LPRemovePreview");this.X(t,n,"a","LPExpandDescription");this.X(t,n,"a","LPOptions");return t},X:function(n,t,i,r){for(var f=t.getElementsByTagName(i),u=0;u<f.length;u++)f[u].id===r&&Array.add(n,f[u])},bY:function(n){var e=n.target;var s=_b.g.b(e);var t=$(s).find("div[id^='LPDescription']");if(t.length>0){var i=$(e);if(t[0].id.endsWith("_summary")){t[0].id=t[0].id.substring(0,t[0].id.length-8);i.removeClass(_mcp.d.j().a());i.addClass(_mcp.d.k().a());this.bD(t[0],!1)}else{t[0].id+="_summary";i.removeClass(_mcp.d.k().a());i.addClass(_mcp.d.j().a());this.bD(t[0],!0)}var f=t.attr("altdesc");if(!_j.i.a(f)){t.attr("altdesc",t.html());t.html(f)}var u="maxHeight";var r=t.attr("altmaxheight");var o=r?r:"100%";t.attr("altmaxheight",t.css(u));t.css(u,o)}},bD:function(n,t){var i=new _a.o;var r=_a.d.b(_a.a.e,"LinkPreviewExpandDescriptionAction");var u=$(_b.g.b(n)).find("a[id^='LPUrlAnchor']");i.b("U",_db.h.b(u,"href",100));i.c("Summary",t);r.j=i.toString();_a.d.a(r)},cm:function(n){var t=new _cmc.d(_a.a.e,"RemoveLinkPreviewClickEvent",!1);if(!this.l){_j.e.c(_a.a.e,"RemovePreviewClicked: editor was null");return}this.l.dL(n);var h=n.target;var i=_b.g.b(h);var w=this.l.cO();if(i){var v=20;var r=null;if(_b.g.a(i.id,"LPBorder"))r=i;else{var c=$(i).find("[id^='LPBorder']");c.length>0&&(r=c[0])}if(r){var u=r.getAttribute("id");_b.g.a(u,"LPBorder_YT")?t.a("T","Y",!0,!0):_b.g.a(u,"LPBorder_VT")?t.a("T","V",!0,!0):_b.g.a(u,"LPBorder_PT")?t.a("T","P",!0,!0):_b.g.a(u,"LPBorder_BVT")?t.a("T","BV",!0,!0):t.a("T","G",!0,!0);var e=$(r).find("a[id^='LPUrlAnchor']");if(e.length>0){var y=e[0].href;var p=this.k().a(y);var a=p.k(u);var s=$(document.body).find(String.format("[id^='{0}']",a));s.length>0&&s[0].setAttribute("previewremoved",!0)}}var o=_b.g.h(i);o&&t.a("U",_db.h.d(o.href,v),!0,!0);var f=$(i).find("div[id^='LPDescription']");var l=f.length>0&&!!f[0].id&&f[0].id.endsWith("_summary");t.a("S",l,!0,!0);t.j().length<1;_j.l.c(h,"click");this.l.md(i);t.b()}else t&&t.d("NullPreview",null)},bN:function(n){if(!this.n){_j.e.a(_a.a.e,"RTE: Skipping link preview cleanup because previews are disabled");return!1}for(var r=this.by(n),u=0;u<r.length;u++){var h=r[u];var i=_b.g.b(h);if(i){i.removeAttribute("contenteditable");var s=$(i);s.unbind("click",this.S);var l=$(h);l.unbind("click mouseenter mouseleave");l.remove();this.k().q(s)}}for(var c=$(n).find(String.format("[id^='{0}']","LPBorder")),t=0;t<c.length;t++){var e=c[t];var o=$(e).find("a[id^='LPUrlAnchor']");if(o.length>0){var v=o[0].href;var f=this.k().a(v);f&&(e.id+=f.m())}}if(this.p){var a=this.k().h();var y=this;Array.forEach(a,function(t){t.q(n)})}return r.length>0},Z:function(n){if(!this.n){_j.e.a(_a.a.e,"RTE: Skipping link preview initialization because previews are disabled");return}if(!n){_j.e.a(_a.a.e,"RTE: Skipping link preview initialization because bodyElement is null");return}if(n.nodeType===3){_j.e.a(_a.a.e,"RTE: Skipping link preview initialization because bodyElement is text node");return}this.bA(this.cb(n))},bM:function(n){if(!this.n){_j.e.a(_a.a.e,"RTE: Skipping link preview bind because previews are disabled");return}if(n)for(var f=this.by(n),i=0;i<f.length;i++){var t=f[i];var u=_b.g.b(t);if(u){this.ba(u);var r=$(t);t.id==="LPRemovePreview"?r.click(this.T):t.id==="LPExpandDescription"&&r.click(this.Q)}}},cb:function(n){var r=[];if(!_j.C.a(n.children)&&n.children.length>0)for(var i=0;i<n.childNodes.length;i++){var t=n.childNodes[i];if(t.nodeType===1&&t.id!=="OwaReferenceAttachments"&&t.id!=="OwaReferenceAttachmentsEnd"){var u=this;_j.E.b(t.getElementsByTagName("A"),function(n,t){Array.add(r,t)})}}return r},cl:function(n){if(!this.l){_j.e.c(_a.a.e,"PreviewClicked: editor was null");return}if(this.l.cO()){var i=n.target.parentNode;var t=_b.g.b(i);if(t){this.l.ml(t);this.bi.a.bi.a(_a.V,new _a.V(_nbs.a.Bv+t.textContent.replace(_nbs.a.YQ,""),!1))}}},bB:function(n){var t=this.k().a(n);return!!t&&t.d()},cc:function(n){var t=this.k().a(n);return t?t.g():null}};_mcp.W=function(n,t){_mcp.W.initializeBase(this,[14,n]);this.e=t};_mcp.W.prototype={e:null,b:null,c:0,a:null,bo:function(){return _mcp.G.prototype.bo.call(this)||!this.b},g:function(){_mcp.G.prototype.g.call(this);this.a=this.j();var n=this.bi.a;this.b=n.bw();this.c=n.bb.a();_mcp.g.g(n.bb)&&!n.bb.bs()&&this.n()},br:function(){this.a=null;this.b=null;_mcp.G.prototype.br.call(this)},n:function(){this.b.e(_mcp.W.a);this.f()},j:function(){var n=this.bi.a.bb;var t=n.d()||n.U();return t&&n.bq()?t:null},m:function(){if(_dg.a.isInstanceOfType(this.a))return this.a.w();else if(_dg.o.isInstanceOfType(this.a)){var n=this.a;return n.y().w()==="RecurringMaster"?n.J()?"RecurringMaster":"Occurrence":n.y().w()}else throw Error.argument("this.Item","Unsupported calendaring type:"+Object.getType(this.a).getName());},f:function(){if(this.a&&!_dg.q.isInstanceOfType(this.a)){this.b.a(6800);switch(this.m()){case"Occurrence":case"Exception":this.i();break;case"RecurringMaster":this.h();break}}},k:function(n){var t;switch(n){case 8:t=3200;break;case 3:t=3205;break;case 5:case 6:case 7:default:throw Error.argument("operation","Unsupported mail compose operation on an occurrence: "+n);}return t},l:function(n){var t;switch(n){case 8:t=3100;break;case 3:t=3105;break;case 5:case 6:case 7:default:throw Error.argument("operation","Unsupported mail compose operation on a series: "+n);}return t},h:function(){var n=this.l(this.c);this.b.a(n)},i:function(){var n=this;this.e.a(function(t){if(!n.bo()){var u=t.a();var r=u.a(n.a,null);var i=n.k(n.c);n.b.a(i,r)}})}};_mcp.bG=function(n,t,i,r){this.p=Function.createDelegate(this,this.Z);this.q=Function.createDelegate(this,this.bb);this.I=Function.createDelegate(this,this.bn);this.D=Function.createDelegate(this,this.l);this.F=Function.createDelegate(this,this.O);this.t=Function.createDelegate(this,this.bw);this.E=Function.createDelegate(this,this.ba);this.K=Function.createDelegate(this,this.bs);this.J=Function.createDelegate(this,this.bp);this.i=Function.createDelegate(this,this.bd);this.G=Function.createDelegate(this,this.bg);this.r=Function.createDelegate(this,this.be);this.s=Function.createDelegate(this,this.bl);_mcp.bG.initializeBase(this,[0,n]);this.h=n.a.bO;this.f=t;this.v=i;this.C(!0);this.x=r};_mcp.bG.prototype={h:null,v:null,m:!1,k:!1,o:!1,z:null,A:null,n:null,f:null,x:!1,e:null,d:function(){return _mcp.G.prototype.d.call(this)},ch:function(n){if(n!==_mcp.G.prototype.d.call(this)){_mcp.G.prototype.ch.call(this,n);this.bq("IsInitialized")}this.bi.a.bb.dZ(n);return n},c:function(){return this.m},T:function(n){if(n!==this.m){this.m=n;this.bq("IsSecondInitializationComplete")}return n},a:function(){return this.k},C:function(n){if(this.k!==n){this.k=n;this.bq("CanLoadPopoutSuccessfully")}return n},V:function(){if(this.e){this.e.a();this.e=null}},g:function(){this.z=_j.m.a(_a.a.a,517,"VM.MailCompose.FirstInit");var i=this.bi.a;var n=i.bb;n.apcl("IsEditorInitialized",this.s);n.apcl("IsUpgraded",this.r);if(!n.eJ&&!n.h()){_j.e.a(_a.a.a,"Capture initial baseline for a non draft without existing initial baseline, context: {0}",n);n.eJ=_mcp.c.b(n);n.eS()||n.eU(!0)}if(n.fy()){_j.e.a(_a.a.a,"Finish 1st init for complete context");this.j();_j.e.a(_a.a.a,"Check begin upgrade for complete context");this.w()}else{var o=i.bq;var r=n.h();var t=n.F();var s=n.gC();if(!r&&s){var e;var u=_g.a.a().c();e=_j.i.a(u.bj.SharePointUrl)?u.bj.UserEmailAddress||"":u.bj.LogonEmailAddress||"";var l=new _gg.bg("StoreId",s,e);var a=new _mcp.bd([l],"EwsId");var v=this;o.a(a,this.G,function(n){v.bf(n)},this.i);_j.e.a(_a.a.a,"Calling server to convert id, storeId={0}",s)}else if(r)if(n.cy()&&n.eS()){_j.e.a(_a.a.a,"The message was saving prior to popout, check for save result from main window");this.S()}else{_j.e.a(_a.a.a,"Load draft {0}",_h.ba.a(r));this.y(r)}else if((4===n.a()||13===n.a())&&n.eS()){_j.e.a(_a.a.a,"Loading draft without id for the popout from reading-pane case, check id from main window");this.S()}else if(t){i.bc.b(3400);i.bc.a(3400,null);if(n.fX()){var f=this;this.v.b(function(i){var u=i.a(t,n.cs(),n.cl(),n.dg());var r=i.b(200,u,n.cl());r.V=n.b();o.a(r,f.J,function(n){f.R(n)},f.i);_j.e.a(_a.a.a,"Loading original calendar item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)})}else{var h=i.bT.i(t);h.V=n.b();var c=this;o.a(h,this.K,function(n){c.R(n)},this.i);_j.e.a(_a.a.a,"Loading original message item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}}else if(0===n.a()||11===n.a()){n.cK(!0);n.eY(!0);_j.e.a(_a.a.a,"Finish 1st init for new mail");this.j()}else{this.l("ErrorNoDraftOrOriginalItemId",null,null);throw Error.invalidOperation(String.format("Cannot perform operation {0} without either draft ID or original item ID",_j.t.d(_y.l,n.a())));}}_j.i.a(_g.a.a().c().bj.SharePointUrl)||i.bc.a(110,null)},b:function(){this.X();this.A=_j.m.a(_a.a.a,517,"VM.MailCompose.SecondInit");var i=this.bi;var n=i.a;var r=n.bb;_j.e.a(_a.a.a,"Queue secondary init task, context:{0}",r);_j.o.a().c(_a.a.a,"Delayed MailCompose Secondary Init",this.E);if(n.gS()&&!n.dX.a){var f=i.b(10);_j.e.a(_a.a.a,"Queue appbar setup task");var t=f;_j.o.a().c(_a.a.a,"SetupApplicationBarMenu",t.e||(t.e=Function.createDelegate(t,t.b)))}this.bv();if(r.bB()){_j.e.a(_a.a.a,"Queue diagnostics save to trigger uploading of the diagnostics attachment");var e=this;_j.o.a().c(_a.a.a,"Diagnostics save:",function(){n.bm().a("Diagnostics",null,null,!1)})}if(_a.cA.a){_j.e.a(_a.a.a,"Queue GetMailTips if needed task");var u=this;_j.o.a().c(_a.a.a,"TriggerMailTipsIfNeeded",function(){u.bo()||n.cX().a(32)})}},br:function(){var n=this.bj;n.rpcl("IsEditorInitialized",this.s);n.rpcl("IsUpgraded",this.r);this.ch(!1);this.T(!1);this.C(!0);this.o=!1;this.V();_mcp.G.prototype.br.call(this)},bn:function(n){var f=_j.m.a(_a.a.a,2,"VM.MailCompose.ProcessDraft");var e=this.bi.a.bb;var u=this.bh.br();var t=n;var i=n.V;_j.e.a(_a.a.a,"Got draft, checking pending discards for {0}",i);if(this.h.a(i))u.e(i,t.j[0]);else if(i===this.bj.b()){var r=t.c;if(_g.bt.isInstanceOfType(r)){this.bj.dx(r);this.u(!0);this.Q(t)}else _a.p.a&&r.bG()?this.bc(r,t):this.O(r,t);_a.br.a&&_j.o.a().c(_a.a.a,"SafeTriggerPolicyTipsIfNeededForOpenDraft",this.t)}else _j.e.a(_a.a.a,"Skipping get draft processing since action context {0} doesn't match current context {1}",i,this.bj);_j.m.b(f);_j.m.b(this.n)},bc:function(n,t){var i=this;this.bh.dh(function(){i.W();i.e.c(n,t)})},W:function(){if(!this.e){_j.e.a(_a.a.a,"Setting initializer component override");this.e=this.bh.cu().b();this.e.b(this.F,this.cI,this.D,this.bh.bq)}},O:function(n,t){this.bj.dw(n);this.u(!1);this.Q(t)},Q:function(n){if(this.bj.eS()&&this.bj.dv()){_j.e.a(_a.a.a,"Capture initial baseline for a loaded draft.");this.bj.eJ=_mcp.c.b(this.bj)}_j.e.a(_a.a.a,"Finish 1st init for a loaded draft.");this.j();_j.o.a().c(_a.a.a,"SafeTriggerPolicyTipsIfNeededForOpenDraft",this.t)},bp:function(n){var u=this.bi;var f=u.a;var t=f.bb;var i=n.V;if(i===t.b()&&!this.h.a(i)){var r=n;t.K(r.c());t.cI(!1);_j.e.a(_a.a.a,"Got original cal item, finish 1st init with context:{0}",t);this.j();_j.e.a(_a.a.a,"Check begin upgrade on original cal item");this.w()}},bs:function(n){var u=this.bi;var f=u.a;var t=f.bb;var i=n.V;if(i===t.b()&&!this.h.a(i)){var r=n;t.K(r.c);_j.e.a(_a.a.a,"Got original message, finish 1st init with context:{0}",t);this.j();_j.e.a(_a.a.a,"Check begin upgrade on original message item");this.w()}},Z:function(n,t){this.bh.bp().a(this.bi.a,!1);_j.e.a(_a.a.a,"Navigate away on action failure")},bd:function(n){if(!this.bo()&&n.V===this.bj.b()){this.bh.bc.b(3400);this.bh.bf()}},j:function(){var o=_j.m.a(_a.a.a,2,"VM.MailCompose.ComponentInit");var n=this.bi;var f=n.a;var e=f.bb;var s=e.a();n.b(7).g();n.b(8).g();n.b(1).g();e.bq()&&n.b(14).g();var i=n.b(11);i.g();if(this.bj.a()!==4&&!this.bj.D()||!this.bj.a()&&this.bj.D()){var t=this.bh.bK().c(this.f.b()&&this.bj.j()==="HTML",this.bj.D());if(i.a()){var u=i.b();u&&(t=t+u)}t=this.U(t,this.f.b()&&this.bj.j()==="HTML");this.bj.w(t)}var r=_y.c.a.a();if(r!=="Mouse"){if(r==="TouchNarrow"){n.b(5).g();n.b(6).g();n.b(3).g();n.b(9).g();n.b(22).g();n.b(16).g()}n.b(10).g()}else n.b(22).g();_j.m.b(o);_j.m.b(this.z);if(f.cy){_j.e.a(_a.a.a,"Finishing primary init, beginning secondary init because we are already in view.");this.b()}this.ch(!0)},U:function(n,t){var i='<div itemscope itemtype="http://schema.org/EmailMessageBody"><meta itemprop="id" content=""/><div>{0}</div></div>';return!this.bh.bo.a().bm()||!this.bh.bo.a().bm().Enabled?n:t?String.format(i,n):n},ba:function(){var n=this.bi;var i=n.a;var t=i.bb;n.b(2);n.b(15);n.b(25);n.b(27);n.b(32);n.b(34);n.n();t.eH()||t.fU();this.T(!0);_j.e.a(_a.a.a,"Finished secondary init, context:{0}",t);_j.m.b(this.A)},y:function(n){this.n=_j.m.a(_a.a.a,517,"VM.MailCompose.LoadDraft");var i=this.bi.a;var t=i.bb;var e=i.bq;if(t.eS()){if(t.dv()){_j.e.a(_a.a.a,"Capture initial baseline since message was a clean new message before popout, context: {0}",t);t.eJ=_mcp.c.b(t)}t.bl()&&!t.i()&&this.u(!0)}else t.fH(!0);i.bc.b(3400);i.bc.a(3400,null);t.fz()&&i.bc.a(3480);var r=this.f.b()&&t.j()==="HTML"?_h.b.f():_h.b.q();var o="MailCompose";var u=i.bT.i(n,r,o);u.V=t.b();var f=this;e.a(u,this.I,function(n){f.bm(n)},this.i);_j.e.a(_a.a.a,"Loading draft with ID={0}; Shape={1}; Layout={2}; ContextBodyType={3}",_h.ba.a(n),r.BodyType,_y.c.a.a(),t.j())},u:function(n){if(n!==this.o){var t=this.bi.a.bc;t.b(3440);n&&t.a(3440,null);this.bh.bf();this.o=n}},bg:function(n){var i=n;var t=new _g.g(i.j().Id);this.bi.a.bb.L(t);this.y(t)},w:function(){var u=this.bi;var n=u.a.bb;var t=n.a();var i=1===t||2===t||3===t||12===t;if(!i||n.h()||n.i()){if(i&&n.h()&&n.i()&&_a.k.a().G){var r=this;_j.o.a().a(_a.a.a,"MailComposeInitializerComponent.BeginUpgradeIfNecessary",function(){r.cd||r.bh.bf()},1e3)}}else this.bh.bP().h()},S:function(){var n=this.bi.a.bb.b();if(this.x){_j.e.a(_a.a.a,"Processing save result on main window for popout projection compose window {0}",n);var t=window.self.windowServiceEndPoint;t.getSaveResultForPopout(n,_a.U.b,this.q)}else{_j.e.a(_a.a.a,"Calling main window to process save result {0}",n);_g.k.b.getSaveResultForPopout(n,_a.U.b,this.q)}},bb:function(n){var t=this.bi.a.bb;if(n){var i=JsonParser.deserialize(n);_j.e.a(_a.a.a,"Resume loading draft after main window successfully saved item: {0}",i.Id);t.bl()&&!t.i()&&t.cK(!0);this.y(i)}else{_j.e.a(_a.a.a,"Save failed on the main window for this popout, show failure message.");this.C(!1);this.l("ErrorSaveFailedOnMainWindow",null,null)}},bl:function(n,t){var r=this.bi.a;var i=r.bb;i.eX&&this.Y()},be:function(n,t){var r=this.bi.a;var f=r.bb;if(f.i()){var i=this.bh.bP();if(i.e()){var u=r.bX()?r.bX().toString():"";_y.j.a(i.e(),null,null,null,u);i.k(null)}}},Y:function(){var t=this.bi.a;var n=t.bb;if(n.fe()){this.f.a().f()&&this.f.a().f().Enabled&&n.fe().o(new _a.bg("OneCompose"));var i=t.bX()?t.bX().toString():"";_y.j.a(n.fe(),null,"",null,i);n.bb(null)}this.L()},l:function(n,t,i){var f=this.bi.a;var r=f.bb;if(r.bA()){var u=new _a.o;_j.i.a(i)||u.b("E",i);_y.j.a(r.bA(),null,n,t,this.P(u.toString(),r.bA().j));r.v(null)}if(r.fe()){_y.j.a(r.fe(),null,n,t,i);r.bb(null)}this.L()},P:function(n,t){var i="";i=_j.i.a(n)?t:_j.i.a(t)?n:n+"|"+t;return i},X:function(){var i=this.bi.a;var n=i.bb;if(n.bA()){var t=n.bA().j;i.bX()&&(t=this.P(i.bX().toString(),t));_y.j.a(n.bA(),null,"",null,t);n.v(null)}},L:function(){var i=this.bi.a;var t=i.bb;if(t.gD()){var n=null;switch(t.a()){case 0:n="MailComposeNewLoad";break;case 1:n="MailComposeReplyLoad";break;case 2:n="MailComposeReplyAllLoad";break;case 3:n="MailComposeForwardLoad";break;case 4:n="MailComposeEditDraftLoad";break}if(n){_a.M.a(n);t.bc(!1)}}},bf:function(n){this.N(n,"ConvertIdAction")},bm:function(n){this.N(n,n.m)},N:function(n,t){var i=this;this.M(n,t,function(t){t.g(n,_nbs.a.Lq,_nbs.a.DR,_nbs.a.Lq,_bms.E.BC,i.p)})},R:function(n){var t=this;this.M(n,n.m,function(i){i.f(n,t.p)})},M:function(n,t,i){var r=t+"_UnknownError";if(this.bo()){_j.e.a(_a.a.a,"MailComposeInitializerComponent.HandleActionFailure: viewModel is null or disposing, aborting logic. ErrorCode = {0}",r);return}var s=this.bi;var e=s.a;var h=e.bb;var f=n.V;f!==h.b()||this.h.a(f)||i(e.bq);var u=r;u=_g.L.a(n.F)?_g.L.b(n.F)||r:n.F.ExceptionName||r;var o=n.F.FaultMessage||n.F.message;_j.m.b(this.n);this.l(u,n.M(),o)},bw:function(){_mcp.G.a(this.bh,32)},bv:function(){if(this.bh&&this.bh.bb.l()===1&&!this.bh.bs()){this.bh.bn()||this.bh.bi.a(_a.ca,new _a.ca(!1,"NotLoadedByReadingPaneComposeHide"));this.bh.bi.a(_a.bb,new _a.bb("MCompose"))}}};_mcp.g=function(n,t,i){_mcp.g.initializeBase(this,[4,n]);this.k=t;this.i=i};_mcp.g.f=function(){_mcp.g.b||(_mcp.g.b=new _a.e("LocationViewModel",ILocationViewModel,_mcp.g));return _mcp.g.b};_mcp.g.e=function(){_mcp.g.a||(_mcp.g.a=new _a.e("IsMeetingForwardOnBehalfOf",Boolean,_mcp.g));return _mcp.g.a};_mcp.g.g=function(n){switch(n.a()){case 4:return n.bs();case 8:case 3:return!0;case 5:case 7:case 6:return!1;default:return!1}};_mcp.g.prototype={k:null,i:null,h:null,a:function(){return this.ev(_mcp.g.c)},n:function(n){this.eu(_mcp.g.c,n);return n},e:function(){return this.ev(_mcp.g.d)},f:function(n){this.eu(_mcp.g.d,n);return n},b:function(){return this.ev(_mcp.g.f())},l:function(n){this.eu(_mcp.g.f(),n);return n},j:function(){return this.ev(_mcp.g.e())},o:function(n){this.eu(_mcp.g.e(),n);return n},c:function(){return this.h},p:function(n){if(n!==this.h){this.h=n;this.bq("MeetingCalendarTimePeriod")}return n},g:function(){var n=this.bi.a.bb;var i=this.bi.a.da;if(n.bE()){var e=this;this.k.a(function(t){e.l(t.a(n.fp(),null,!1))})}else this.l(null);if(n.bq()){if(n.bu()){var o=this;this.i.a(function(t){var i=t.a();o.p(i.a(n,null))})}if(n.br()){var t=2;var s=_pc.a.n(n.k());var r=i.e(s,_bc.e.a,!0,t,!1);this.n(r);this.o(!!n.bt()&&!!n.bt().Mailbox&&!!n.k()&&!!n.k().Mailbox&&!_g.m.a(n.k().Mailbox,n.bt().Mailbox));if(this.j()){var f=_pc.a.n(n.bt());var u=i.e(f,_bc.e.a,!0,t,!1);this.f(u)}else this.e()&&this.f(null)}}else this.m();_j.e.a(_a.a.a,"Meeting component initialized, IsMeeting={0}, IsMeetingForward={1}",n.bq(),n.br());_mcp.G.prototype.g.call(this)},br:function(){this.m();if(this.b()){this.b().dispose();this.l(null)}_mcp.G.prototype.br.call(this)},m:function(){if(this.a()){this.a().dispose();this.n(null)}if(this.e()){this.e().dispose();this.f(null)}}};_mcp.o=function(n,t,i,r){_mcp.o.initializeBase(this,[n,t]);this.bM=r;this.bs=i};_mcp.o.a=function(n,t){return new _fm.g(n,t,null,1,null,null,!1,!1,!1,!1)};_mcp.o.c=function(n,t){return new _y.h(t,n)};_mcp.o.b=function(n,t){return new _fm.d(t,null,n,!0)};_mcp.o.prototype={bM:null,bs:null,cN:null,cL:null,ci:null,Q:function(){return this.cN},P:function(){return this.cL},O:function(){return this.ci},cM:function(){return this.bM.a()==="Mouse"&&!!this.bs&&!this.bh.bn()},dF:function(){return!!this.bs&&this.bs.a().f().Enabled},g:function(){if(_y.c.a.a()==="Mouse"||_y.c.a.a()==="TouchNarrow"){this.cM()&&(this.cL=this.bN());(!this.cM()||this.dF())&&(this.cN=this.bP())}else this.ci=this.bK();_mcp.G.prototype.g.call(this)},bZ:function(){},bY:function(){},cy:function(){},br:function(){this.cN=null;this.cL=null;this.ci=null;_mcp.G.prototype.br.call(this)},bv:function(){if(_y.c.a.a()==="Mouse"||_y.c.a.a()==="TouchNarrow"){this.cM()&&this.bY();(!this.cM()||this.dF())&&this.bZ()}else this.cy()}};_mcp.bI=function(n,t,i,r){this.h=Function.createDelegate(this,this.v);this.f=Function.createDelegate(this,this.u);this.n=Function.createDelegate(this,this.s);this.k=Function.createDelegate(this,this.w);this.m=Function.createDelegate(this,this.r);this.o=Function.createDelegate(this,this.x);this.p=Function.createDelegate(this,this.A);_mcp.bI.initializeBase(this,[9,n,i,r]);this.j=t};_mcp.bI.prototype={j:null,e:null,c:null,b:null,l:null,a:function(){return this.c},z:function(n){if(this.c!==n){this.c=n;this.bq("DialogViewModel")}return n},g:function(){this.e||(this.e=new _j.g(this.p,this.bk()));this.q();_mcp.o.prototype.g.call(this)},br:function(){var t;_a.i.a(t={val:this.b}),this.b=t.val;var n;_a.i.a(n={val:this.e}),this.e=n.val;this.c=null;this.j=null;_mcp.o.prototype.br.call(this)},bP:function(){if(!this.bj.R()&&!this.bM.c()&&!this.bh.bn()){var n=_mcp.o.b(this.e,_nbs.a.OW);return[n]}return null},bN:function(){if(!this.bj.R()&&!this.bM.c()){var n=_mcp.o.a(this.e,_nbs.a.OW);return[n]}return null},bK:function(){if(!this.bj.R()&&!this.bM.c()){var n=new _y.h(_nbs.a.OW,this.e);return[n]}return null},A:function(){_j.e.a(_a.a.a,"User chose to show message options");this.b||(this.b=new _mcp.P);this.b.s(this.bj);if(!this.c){var t=new _bc.l;t.F(this.j);this.z(t);this.c.q(_nbs.a.Tp);this.l=[new _ff.d(new _j.g(this.o,this.bk()),_u.P.V,null,!0),new _ff.d(new _j.g(this.m,this.bk()),_u.R.BC,null)];this.c.n.m(this.l)}this.c.s(this.b);if("TouchNarrow"===_y.c.a.a()){var n=this.bi.a.bI();this.b.t(n);n.a().e(this.k)}this.c.f(!0)},x:function(){if(this.c.C){_j.e.a(_a.a.a,"User tried to click OK button more than once.");return}var n=this.bh.bb;if(n.y()!==this.b.d){this.bi.a.bk().a("Sensitivity:"+this.b.d);"Normal"!==n.y()&&this.y();n.eh(this.b.d);"Normal"!==n.y()&&this.q()}n.Y()!==this.b.e&&this.bi.a.bk().a("RequestDeliveryReceipt");n.Z()!==this.b.f&&this.bi.a.bk().a("ReadReceiptRequested");n.dS(this.b.e);n.dX(this.b.f);if(this.b.b&&!n.o()||this.b.c&&!n.s()){this.c.y(!0);this.bh.dh(this.n)}else this.s();this.b.b!==n.o()&&this.bi.a.bk().a("EncryptMessage");this.b.c!==n.s()&&this.bi.a.bk().a("SignMessage")},s:function(){this.c.y(!1);var n=this.bh.bb;var u=this.bi.a;var t=this.bh.be();var i=t.a();if(n.o()!==this.b.b){n.ek(this.b.b);this.bq("SmimeEncryptMessage");_j.e.a(_a.a.i,"SmimeEncryptMessage option is changed to {0} by user.",this.b.b)}if(n.s()!==this.b.c){n.em(this.b.c);this.bq("SmimeSignMessage");_j.e.a(_a.a.i,"SmimeSignMessage option is changed to {0} by user.",this.b.c)}var r=this.b.b||this.b.c;r&&u.fi();i&&i.br(n.I());if(this.b.k&&!r&&t.j())if(t.b()){_j.e.a(_a.a.i,"Waiting to move attachments because the attachment well is currently in progress.");this.c.y(!0);i.H(this.f)}else this.u(null,null);else if(!this.b.k&&r){this.bh.bn()&&this.bh.bP().i()&&!n.bk()&&this.bh.bP().a().a();if(t.j())if(t.b()){_j.e.a(_a.a.i,"Waiting to move attachments because the attachment well is currently in progress.");this.c.y(!0);i.H(this.h)}else this.v(null,null);else this.i()}else this.i()},u:function(n,t){if(this.t(n,t)){_j.e.a(_a.a.i,"Started MoveAttachmentsFromClientToServer due to user turned off S/MIME for current message.");if(n){n.B(this.f);this.c.y(!1)}var i=this.bh.be().a();if(this.bh.bb.h())i.bi();else{var r=this;this.bh.bm().a("Attach",function(){i.bi()},null,!1)}this.i()}},v:function(n,t){if(this.t(n,t)){_j.e.a(_a.a.i,"Started MoveAttachmentsFromServerToClient due to user turned on S/MIME for current message.");if(n){n.B(this.h);this.c.y(!1)}this.bh.be().a().bj();this.i()}},t:function(n,t){return!n&&!t?!0:t==="IsInProgress"&&!n.j()},i:function(){_j.e.a(_a.a.a,"User hit OK on message options dialog, setting Sensitivity="+this.bj.y()+"; DeliveryReceipt="+this.bj.Y()+"; ReadReceipt="+this.bj.Z()+"; SmimeEncryptMessage="+this.bj.o()+"; SmimeSignMessage="+this.bj.s());this.r()},r:function(){if(this.c.C){_j.e.a(_a.a.a,"User tried to close dialog when busy.");return}var t=this.bi.a.bb;var i=this.bh.bw();if(t.I()&&t.E()){_a.F.a(_u.R.Gc,1);i.a(750)}else i.b(750);this.bh.bd().bb().c(!t.I());var n=this.bh.be();if(n.a()){n.a().B(this.f);n.a().B(this.h)}"TouchNarrow"===_y.c.a.a()&&this.b.g.a().g(this.k);_j.e.a(_a.a.a,"Close message options dialog");this.c.o.a()},w:function(n,t){_mcp.e.isInstanceOfType(this.bi.a.bI().b())?this.c.f(!0):this.c.f(!1)},y:function(){var t=this.bi.a;var n=t.bw();switch(t.bb.y()){case"Personal":n.b(8900);break;case"Confidential":n.b(8901);break;case"Private":n.b(8902);break}this.bh.bf()},q:function(){var t=this.bi.a;var n=t.bw();switch(t.bb.y()){case"Personal":n.a(8900,null);break;case"Confidential":n.a(8901,null);break;case"Private":n.a(8902,null);break}this.bh.bf()}};_mcp.q=function(n,t,i,r){this.L=Function.createDelegate(this,this.Z);this.V=Function.createDelegate(this,this.bp);this.R=Function.createDelegate(this,this.bg);this.T=Function.createDelegate(this,this.bc);this.U=Function.createDelegate(this,this.bn);this.M=Function.createDelegate(this,this.bd);this.S=Function.createDelegate(this,this.bm);this.C=Function.createDelegate(this,this.be);this.N=Function.createDelegate(this,this.bf);_mcp.q.initializeBase(this,[2,n,i,r]);this.q=new _j.g(this.N,this.bk());var e=this;this.G=new _j.g(function(){e.A("Upconvert")},this.bk());var s=this;this.r=new _j.g(function(){s.A("ShowOriginalMessage")},this.bk());var h=this,o=this;this.I=new _j.v(function(){h.A("UpconvertOnFormat")},this.bk(),this.bi.a.bb,"BodyType",function(){return o.bi.a.bb.j()==="HTML"});var f=this;this.z=new _j.g(function(){f.A("UpconvertOnMoreOptions")},this.bk());var u=this;this.y=new _j.g(function(){u.bi.a.bb.ee(function(n){n.bz().F()});u.A("UpconvertAndShowApps")},this.bk());this.p=n.a.bO;this.D=t};_mcp.q.prototype={p:null,D:null,q:null,G:null,I:null,r:null,y:null,z:null,u:!1,v:!1,n:!1,s:!1,E:!1,m:null,o:null,x:!1,b:function(){return this.q},w:function(n){this.u!==n&&(this.u=n);return n},h:function(){return this.v},F:function(n){if(this.v!==n){this.v=n;this.W(n)}return n},f:function(){return this.n},K:function(n){if(this.n!==n){this.n=n;this.W(n)}return n},i:function(){return this.s},e:function(){return this.t().q()},j:function(n){this.t().j(n);return n},t:function(){this.o||(this.o=this.Y());return this.o},g:function(){var n=_y.c.a;"Mouse"!==n.a()||n.c()||n.x(this.C);_mcp.o.prototype.g.call(this)},k:function(n){this.o=n},a:function(n,t){n.R(!0);var i=this.bj.l();if(i===3){this.bh.bi.a(_a.bD,new _a.bD);this.bl(t)}this.t().e(n,t);i===1&&this.bh.bi.a(_y.bK,new _y.bK);this.bh.bi.a(IExtensibilityShowHideEvent,_mcp.X.a)},c:function(n){this.bi.a.bJ&&(this.x=!0);if(!this.x){_j.e.a(_a.a.a,"Checking dirty before prompting user for before unload confirmation. Context: {0}",this.bi.a.bb);this.bi.a.bR()&&n.a(_nbs.a.KN)}this.x=!0;_j.o.a().a(_a.a.a,"ResetSkipBeforeUnloadConfirmationFlag",this.S,100)},l:function(){var n=!0;var u=this.bi;var t=u.a;var i=t.bb;var r=t.bh();var o=t.bm();var e=i.b();var s=i.a();if(this.p.a(e))_j.e.a(_a.a.a,"User had chose to discard, simply navigate away.");else if(i.bl()&&this.p.g(u,!1))_j.e.a(_a.a.a,"User had navigated away on an unused response, the unused response was discarded.");else if(this.X())n=!1;else if(r.c()){_j.e.a(_a.a.a,"We're sending the message, can't exit yet.");n=!1}else if(r.m()){_j.e.a(_a.a.a,"We're resolving the recipients before sending, can't exit yet.");r.k();n=!1}else if(i.R()){var f=t.br();f.a().a();n=!1}else{_j.e.a(_a.a.a,"Checking dirty before navigating away from compose. Context:{0}",i);if(t.bR()){this.E=!1;_j.o.a().a(_a.a.a,"NavigatingAwaySaveTimeout",this.M,1e4);this.cf();if(o.a("ReadingPaneExit",this.U,this.T,!1)){this.K(!0);_j.e.a(_a.a.a,"Save is in progress or failed, can't exit yet.");n=!1}}}return n},Y:function(){return new _y.bs},br:function(){var r;_a.i.a(r={val:this.I}),this.I=r.val;var u;_a.i.a(u={val:this.q}),this.q=u.val;var f;_a.i.a(f={val:this.G}),this.G=f.val;var n;_a.i.a(n={val:this.r}),this.r=n.val;var t;_a.i.a(t={val:this.z}),this.z=t.val;var i;_a.i.a(i={val:this.y}),this.y=i.val;_y.c.a.E(this.C);this.o=null;_mcp.o.prototype.br.call(this)},bP:function(){if(this.bh.bn()){var n=new _fm.d(_u.n.Km,null,this.q);return[n]}return null},bN:function(){return null},bK:function(){return null},bm:function(){this.x=!1},be:function(){_y.c.a.E(this.C);this.p.g(this.bi,!0)},W:function(n){var t=this.bi.a;t.eL(_u.P.p);t.eJ(n);t.eH(n)},bf:function(){var t=this.bh;var n=t.bb;var f=n.b();_j.o.a().j(_a.a.a,"MailComposePopOut");if(this.u){_j.e.a(_a.a.a,"Skipped pop out because another pop out is in progress.");return}if(this.ba()){t.bk().a("UpconvertOnPopOut");n.v(this.m=_y.j.b(_a.a.a,"MailComposeReadingPanePopOut",!0));this.w(!0);var e=!1;try{var s=this.bi.a.bc;s.e(_mcp.q.b);t.bf();var i=t.bm();_j.e.a(_a.a.a,"Checking dirty before popping out from reading pane. Context:{0}",n);var u=t.bR();var r=t.bb.di();var o=t.eh();if(!n.h()||u||o.a()||r){this.F(!0);(n.h()&&!r||u||i.f())&&n.eU(!1);_j.e.a(_a.a.a,"Set WasCleanNewMessageBeforePopout = {0}",n.dv());this.s=!1;_j.o.a().a(_a.a.a,"PopoutSaveTimeout",this.R,1e4);n.fM(!0);this.cf();t.bB.get_saveForPopoutMap()[f]=new _y.fW;this.bb();i.a("Popout",this.V,this.L,!1)}else{if(n.bG())n.eU(!1);else if(n.bD())n.eU(!1);else if(i.f())n.eU(!1);else if(n.eJ){_j.e.a(_a.a.a,"Comparing initial baseline with baseline. Context:{0}",n);n.eJ.s(n.eH())||n.eU(!1)}else n.eU(!1);n.fM(!1);_j.s.b(t.bB,"PopoutManager");_j.s.b(t.bB.get_saveForPopoutMap(),"PopoutManager.SaveForPopoutMap");delete t.bB.get_saveForPopoutMap()[f];this.bb()}_j.e.a(_a.a.a,"MailComposeNavigationComponent::OpenComposeWindow - setting composeConductor.HasNavigatedFromReadingPaneToPopoutCompose = true");this.t().r(!0);e=!0}finally{if(!e){this.w(!1);this.F(!1);_y.j.a(this.m,null,_mcp.q.a.toString(4));n.v(null);this.m=null}}}},ba:function(){var r=this.bi;var u=r.a;var i=u.bb;var n=i.b();var t=this.bh.bh();if(t.c()){_j.e.a(_a.a.a,"Skipped navigating away because send is in progress.");return!1}if(this.X()||this.p.a(n)){_j.e.a(_a.a.a,"Skipped navigating away because attachment is currently uploading or user had discarded");return!1}return!0},X:function(){var n=this.bi.a;var t=n.be();if(t.b()){if(!n.bl.p){_j.e.a(_a.a.a,"Show attachment in progress error dialog");n.bl.g(0,_u.R.Di,null)}return!0}return!1},bb:function(){var r=this.bi.a;var n=r.bb;var t=new _mcp.b;this.D&&t.ef(this.D.b());t.t(0);t.f(!1);if(n.a()===11||n.a()===12){t.e(13);t.ed(n.bL());t.ec(n.bK())}else t.e(4);t.L(n.h());t.m(n.j());var i=this.Y();t.gQ(!0);t.cK(n.i());t.ep(n.J());t.cJ(n.bl());t.fH(n.bG());t.fG(n.bD());t.dO(n.cq());t.eU(n.dv());t.fM(n.cy());t.fL(n.b());t.z(n.q());t.v(n.bA());t.fq(n.bF());t.ca(n.Q());t.fc=n.cx();t.dR(n.dh());n.bA()&&n.bA().e()==="MailComposeReadingPanePopOut"&&n.v(null);n.i()||n.a()!==3||n.dy()||!n.d().T()||t.T(n.d().T().e);i.a(t);if(!n.cy()){this.J();this.w(!1)}},bp:function(n){this.F(!1);if(this.s){_j.e.a(_a.a.a,"Popout was cancelled by timer, skipping save succeeded processing for popout.");_y.j.a(this.m,null,_mcp.q.a.toString(3));this.m=null}else{var i=n.V;var t=this.bi.a;if(i in t.bB.get_saveForPopoutMap()){var u=_mcp.bj.a(n);var r=t.bB.get_saveForPopoutMap()[i];if(r.a.length){var f=JsonParser.serialize(u);t.bB.pushSaveResultToPopout(f,r.a);delete t.bB.get_saveForPopoutMap()[i]}else r.b=u}if(t.bb.b()===i){_j.e.a(_a.a.a,"Save succeeded for popout, navigating away from the main window.");this.J();this.w(!1)}else _j.e.a(_a.a.a,"Skipped navigating away since contextId={0}; viewModelId={1}",i,t.bb.b())}},bn:function(n){this.n&&this.K(!1);if(this.E){_j.e.a(_a.a.a,"Navigation away was cancelled by timer, skipping navigating from compose.");return}this.J()},bc:function(n){if(this.n){_j.e.a(_a.a.a,"Save failed, reset IsSavingForNavigatingAway flag to false");this.K(!1)}},J:function(){var n=this.bi.a;this.a(n,!1);_j.e.a(_a.a.a,"Navigated away from reading-pane compose")},A:function(n){this.bh.bk().a(n);var o=this.bi;var f=o.a;var t=f.bb;if(!t.i()&&!t.h()&&!t.J()){_j.e.a(_a.a.a,"upgrade is still in progress, need to wait till it is completed. ContextId={0}",t.b());f.bl.g(0,_nbs.a.iO);return}if(this.ba()){var e=this.t();if(IInlineComposeConductorViewModel.isInstanceOfType(e)){var i=_a.d.b(_a.a.a,"MailComposeUpConvert");i.j=n;var u=new _a.o;u.b("O",n);i.j=u.toString();t.v(i);t.eo(!0);var r=e;this.bh.bP().a().a();r.g(!1);r.m(t)}}},Z:function(n){if(this.u){this.w(!1);this.F(!1);var f=this.bi;var i=f.a;var t;t=n?n.V:i.bb.b();if(t in i.bB.get_saveForPopoutMap()){var r=i.bB.get_saveForPopoutMap()[t];r.a.length>0&&i.bB.pushSaveResultToPopout(null,r.a);delete i.bB.get_saveForPopoutMap()[t]}}var u=this.s?2:1;_y.j.a(this.m,null,_mcp.q.a.toString(u));this.m=null},bg:function(){_j.e.a(_a.a.a,"Attempt to popout expired since save did not come back in time");if(this.v&&!this.cd){this.s=!0;this.Z(null);var t=this.bi;var n=t.a.bc;this.cf();n.a(84);this.bh.bf()}},bd:function(){_j.e.a(_a.a.a,"Attempt to navigate away expired since save did not come back in time");if(this.n&&!this.cd){this.E=!0;this.bc(null);var n=this.bh.bc;this.cf();n.a(86);this.bh.bf()}},bl:function(n){var t=new _mcp.bu;t.Name="MailComposeNavigation";t.Result=n;n&&!this.bo()&&(t.Recipients=this.bh.bd().C());window.parent.postMessage(t,"*")}};_mcp.q.a=function(){};_mcp.q.a.prototype={popoutSaveFailed:1,popoutSaveExpired:2,popoutSaveSucceededExpired:3,popoutEncounteredException:4};_mcp.q.a.registerEnum("_mcp.q.a",!1);_mcp.bJ=function(n,t,i,r){this.z=Function.createDelegate(this,this.F);this.D=Function.createDelegate(this,this.R);this.p=Function.createDelegate(this,this.I);this.q=Function.createDelegate(this,this.K);this.A=Function.createDelegate(this,this.L);this.E=Function.createDelegate(this,this.S);this.C=Function.createDelegate(this,this.N);_mcp.bJ.initializeBase(this,[28,n,i,r]);this.i=new _j.g(this.C,this.bk());this.j=new _j.g(this.E,this.bk());this.h=new _j.g(this.A,this.bk());this.y=t;this.bh.bb.bj()&&this.G();if(_a.g.b){var u=this.bh.bb.bJ();if(u){var f=this.bh.bw();f.a(10213,u.a(9))}}};_mcp.bJ.prototype={i:null,j:null,h:null,o:null,v:null,m:null,x:null,u:null,w:null,n:null,t:null,l:null,f:null,b:null,c:null,y:null,k:null,e:0,r:function(){return!!this.bh.bu.OmeSettings},s:function(){var n=this.bh.bu.OmeSettings;return(n&3)==3||(n&5)==5},a:function(){return this.b},M:function(n){if(this.b!==n){this.b=n;this.bq("DialogViewModel")}return n},g:function(){this.bh.bu.WasLoadedFromServer||this.bh.bi.b(_a.cB,this.q);_mcp.o.prototype.g.call(this)},br:function(){this.bh.bi.c(_a.cB,this.q);var r;_a.i.a(r={val:this.b}),this.b=r.val;var u;_a.i.a(u={val:this.c}),this.c=u.val;this.k&&(this.k.length=0);this.bi.a.bI().a().g(this.p);var i;_a.i.a(i={val:this.i}),this.i=i.val;var n;_a.i.a(n={val:this.j}),this.j=n.val;var t;_a.i.a(t={val:this.h}),this.h=t.val;_mcp.o.prototype.br.call(this)},bP:function(){if(!_y.c.a.i()&&!this.bh.bn()){this.v=new _fm.d(_nbs.a.oy,null,this.j);this.o=new _fm.d(_nbs.a.qb,null,this.i);this.m=new _fm.d(_nbs.a.bY,null,this.h);this.bZ();return[this.v,this.o,this.m]}return null},bN:function(){if(!_y.c.a.i()){this.u=new _fm.g(this.j,_nbs.a.oy,null,1,null,null,!1,!1,!1,!1);this.x=new _fm.g(this.i,_nbs.a.qb,null,1,null,null,!1,!1,!1,!1);this.w=new _fm.g(this.h,_nbs.a.bY,null,1,null,null,!1,!1,!1,!1);this.bY();return[this.u,this.x,this.w]}return null},bK:function(){if(!_y.c.a.i()&&this.r()){this.t=new _y.h(_nbs.a.oy,this.j);this.n=new _y.h(_nbs.a.qb,this.i);this.l=new _y.h(_nbs.a.bY,this.h);this.f=this.bh.bb.bj()?this.l:this.s()?this.t:this.n;return[this.f]}return null},bY:function(){var t=this.r();var n=this.bh.bb.bj();var i=this.s();this.u.a(t&&i&&!n);this.x.a(t&&!i&&!n);this.w.a(t&&n)},bZ:function(){if(this.o&&this.m){var t=this.r();var n=this.bh.bb.bj();var i=this.s();this.v.a(!t||!i||n);this.o.a(!t||i||n);this.m.a(!t||!n)}},cy:function(){if(this.r()){this.l||this.n||(this.ci=this.bK());var n=this.bj.bj()?this.l:this.s()?this.t:this.n;if(this.f&&this.f!==n){this.bh.dX.K(this.f,n);this.f=n}else this.bh.bH().b()}},N:function(){this.bh.bb.cc(!0);this.bv();var n=this.bh.bw();this.e=10206;n.a(this.e,null)},L:function(){this.bh.bb.cc(!1);this.bh.bb.bJ()&&this.bh.bb.cL(null);this.bv();var n=this.bh.bw();n.b(this.e)},S:function(){_j.e.a(_a.a.a,"User chose to show message options");this.c||(this.c=new _mcp.ba(this.bh.bu.OmeSettings));if(!this.b){var t=new _bc.l;t.F(this.y);this.M(t);this.b.q(_nbs.a.VM);this.k=[new _ff.d(new _j.g(this.D,this.bk()),_u.P.V,null),new _ff.d(new _j.g(this.z,this.bk()),_u.R.BC,null)];this.b.n.m(this.k)}this.b.s(this.c);if("TouchNarrow"===_y.c.a.a()){var n=this.bi.a.bI();this.c.m(n);n.a().e(this.p)}this.b.f(!0)},F:function(){if(this.b.C){_j.e.a(_a.a.a,"User tried to close dialog when busy.");return}"TouchNarrow"===_y.c.a.a()&&this.c.b.a().g(this.p);_j.e.a(_a.a.a,"Close message options dialog");this.b.o.a()},G:function(){var i=this.bh.bw();var u=this.bh.bb.bj();if(u){var n=this.bh.bb.bJ();var f=!!n;var t="";if(f){var r=_a.c.a().u;t=n.F(r).a(1);this.e=10214}else this.e=10206;i.a(this.e,t)}else i.b(this.e)},I:function(n,t){_mcp.e.isInstanceOfType(this.bi.a.bI().b())?this.b.f(!0):this.b.f(!1)},R:function(){if(this.b.C){_j.e.a(_a.a.a,"User tried to click OK button more than once.");return}var n=!0;switch(this.c.a){case 0:break;case 1:n=this.J();break}if(n){this.c.i("");this.bh.bb.cc(!0);this.G();this.bv();this.F()}},J:function(){for(var n="",h=0,s=0,o=0,c,t=!0,l=this.c.k(),a=l.length,r=0;r<a;++r){var u=l[r];var i;if(_j.i.a(u.a)){n=_u.n.Gm;t=!1;break}else if(isNaN(i=Number.parseInvariant(u.a))){n=_u.n.OF;t=!1;break}switch(u.b){case 7:h=i;break;case 6:s=i-1;break;case 5:o=i;break}}if(t){var f,e;c=(e=this.T(o,s,h,f={val:n}),n=f.val,e);_j.i.a(n)&&this.bh.bb.cL(c.s())}if(!_j.i.a(n)){this.c.i(n);t=!1}return t},T:function(n,t,i,r){var u=new _a.c(n,t,i,23,59,0,0,_a.c.a().u);r.val="";t<0||t>11||_a.c.p(t,n)<i?r.val=_u.n.j:u.k(_a.c.a())<0&&(r.val=_u.n.NT);return _j.i.a(r.val)?u:null},K:function(n){if(!this.bo()){var t=this.bi.a;this.bv();t.bi.c(_a.cB,this.q)}}};_mcp.bK=function(n,t){this.c=Function.createDelegate(this,this.e);_mcp.bK.initializeBase(this,[13,n]);this.b=new _j.g(this.c,this.bk());this.b.c(t.f().a().a())};_mcp.bK.prototype={b:null,a:function(){return this.b},e:function(){_j.e.a(_a.a.a,"OpenFilePicker on PAL.");var n=this.bh.be();if(!n){_j.e.c(_a.a.a,"Unable to open file picker, attachment component is null.");return}if(!n.a()){_j.e.c(_a.a.a,"Unable to open file picker, attachment well ViewModel is null.");return}if(!n.c(!1)){_j.e.c(_a.a.a,"Unable to open file picker, ViewModel is not upgraded.");return}n.a().bV();_j.e.a(_a.a.a,"OpenFilePicker on PAL end.")},br:function(){var n;_a.i.a(n={val:this.b}),this.b=n.val;_mcp.G.prototype.br.call(this)}};_mcp.bM=function(n,t){this.h=Function.createDelegate(this,this.j);this.f=Function.createDelegate(this,this.i);_mcp.bM.initializeBase(this,[13,n]);var i;i=t.b(t.f())?t.f().a():this;var u=this;this.c=new _j.v(this.f,this.bk(),i,"CameraAvailable",function(){return t.b(t.f())&&t.f().a().c()});var r=this;this.e=new _j.v(this.h,this.bk(),i,"GalleryAvailable",function(){return t.b(t.f())&&t.f().a().e()})};_mcp.bM.prototype={c:null,e:null,a:function(){return this.c},b:function(){return this.e},i:function(){_j.e.a(_a.a.a,"User chose to attach from camera");var n=this.bi.b(5);if(!n){_j.e.c(_a.a.a,"Unable to open camera, attachment component is null.");return}if(!n.a()){_j.e.c(_a.a.a,"Unable to open camera, attachment well ViewModel is null.");return}if(!n.c(!1)){_j.e.c(_a.a.a,"Unable to open camera, ViewModel is not upgraded.");return}n.a().bk(n.k());_j.e.a(_a.a.a,"Attach from camera end")},j:function(){_j.e.a(_a.a.a,"User chose to attach from gallery");var n=this.bi.b(5);if(!n){_j.e.c(_a.a.a,"Unable to open gallery, attachment component is null.");return}if(!n.a()){_j.e.c(_a.a.a,"Unable to open gallery, attachment well ViewModel is null.");return}if(!n.c(!1)){_j.e.a(_a.a.a,"Unable to open gallery, ViewModel is not upgraded.");return}n.a().K(n.k());_j.e.a(_a.a.a,"Attach from gallery end")},br:function(){var t;_a.i.a(t={val:this.c}),this.c=t.val;var n;_a.i.a(n={val:this.e}),this.e=n.val;_mcp.G.prototype.br.call(this)}};_mcp.f=function(n,t,i){this.dG=Function.createDelegate(this,this.ew);this.dH=Function.createDelegate(this,this.cR);this.dI=Function.createDelegate(this,this.dS);this.dJ=Function.createDelegate(this,this.dT);this.dl=Function.createDelegate(this,this.eK);this.di=Function.createDelegate(this,this.eE);this.dj=Function.createDelegate(this,this.eH);this.dO=Function.createDelegate(this,this.eO);this.bA=Function.createDelegate(this,this.eF);this.dN=Function.createDelegate(this,this.eL);this.cz=Function.createDelegate(this,this.eD);this.dk=Function.createDelegate(this,this.eJ);this.cO=Function.createDelegate(this,this.ek);this.dM=Function.createDelegate(this,this.eI);this.dP=Function.createDelegate(this,this.eP);this.dh=Function.createDelegate(this,this.et);this.dL=Function.createDelegate(this,this.eB);this.dR=Function.createDelegate(this,this.dB);this.dK=Function.createDelegate(this,this.eA);this.dQ=Function.createDelegate(this,this.eR);_mcp.f.initializeBase(this,[1,n,t,i]);this.dn={};this.dY()&&(this.ca=new _fp.h(_a.g.a,i.h()));this.bm=this.ds(0);this.bl=this.ds(1);this.bn=this.ds(2);this.bX=new _j.g(this.dQ,this.bk());this.cb=new _j.g(this.dK,this.bk());this.bT=new _j.g(this.dR,this.bk());this.cc=new _j.g(this.dL,this.bk());this.cm=new _j.g(this.dh,this.bk());this.cA=new _j.g(this.dP,this.bk());this.bW=new _j.g(this.dM,this.bk());this.ce=new _j.q;this.en()};_mcp.f.d=function(n,t){n.ba(t)};_mcp.f.b=function(n,t){n.bU(t)};_mcp.f.e=function(n,t){n.cR(t)};_mcp.f.c=function(n,t){n.dE(t)};_mcp.f.a=function(n,t){n.dD(t)};_mcp.f.prototype={bm:null,bl:null,bn:null,bX:null,cb:null,bT:null,cc:null,cm:null,cA:null,bW:null,cw:null,ck:null,cj:null,ct:null,by:null,cv:null,cq:null,cs:null,co:null,cr:null,cn:null,cu:null,cp:null,de:null,cT:null,dd:null,cS:null,bp:null,bJ:null,da:!1,bw:!1,bx:null,cl:null,cQ:null,cE:null,dy:!1,dA:!1,dc:!1,db:!1,ce:null,bU:null,bz:null,cV:null,cW:null,cG:null,cU:null,cH:!0,T:function(n){this.bu("ResolveOperationSucceeded",n)},J:function(n){this.bI("ResolveOperationSucceeded",n)},S:function(n){this.bu("ResolveOperationCanceled",n)},I:function(n){this.bI("ResolveOperationCanceled",n)},dn:null,ca:null,l:function(){return this.ca},cY:function(n){if(this.bp!==n){this.bp=n;this.bq("FromPersonaViewModel")}return n},N:function(){return this.bp&&this.bp.bR?this.bp.bR.a():null},dX:function(){return!!this.bs&&this.bs.a().bo().Enabled},ey:function(){return!!this.bs&&this.bs.a().G().Enabled&&_y.c.a.a()==="Mouse"},dY:function(){return!!this.bs&&this.bs.a().ce().Enabled},Y:function(){var n=(this.bm.E()+this.bl.E()+this.bn.E()).trim();return n===""?n:n.substring(0,n.length-1)},m:function(){if(!this.bJ){var n=this;this.bh.dj.a(function(t){if(n.bo()){_j.e.a(_a.a.a,"get_FromFindRecipientViewModel: viewModel is null or disposing, aborting logic.");return}var i=t.b(null,null,0,0,!0);i.u(!0);i.bp(!1);i.cM(100);i.bq(0);i.cK("PersonaDetailedView");i.cq();i.Q(!0);i.bR(new _j.g(n.cO,_a.a.a));n.bM.c()&&i.bQ(new _j.g(n.cO,_a.a.a));_y.c.a.a()!=="Mouse"&&i.cD(new _j.g(n.cO,_a.a.a));i.K(n.dk);n.bJ=i;if(n.dc){n.dB();n.dc=!1}else if(n.db){n.dx();n.db=!1}})}return this.bJ},x:function(){return this.da},K:function(n){if(this.da!==n){this.da=n;this.bq("ShouldHighlightFromAsInvalid")}return n},r:function(){return this.bm},o:function(){return this.bl},n:function(){return this.bn},eG:function(){var n=this.bi.a.bb.E()&&(!!this.bp&&this.bp.eG()||!!this.bJ&&this.bJ.cu());return n||this.bm.eG()||this.bl.eG()||this.bn.eG()},v:function(){return this.bw},eQ:function(n){this.bw=n;this.bq("IsReadWrite");return n},cP:!1,Z:function(){return this.cP},ba:function(){return this.dy},cZ:function(n){this.dy=n;this.bq("IsPeoplePickerShown");return n},w:function(){return this.bW},z:function(){return this.bX},bb:function(){return this.bT},q:function(){var n=this.bi.a.bb;return!!n.k()&&!!n.k().Mailbox&&!_a.G.a(n.k().Mailbox.EmailAddress)},dm:!1,bV:!1,cC:function(){this.de||(this.de=new _y.h(_nbs.a.nU,this.bT));return this.de},dv:function(){this.cT||(this.cT=new _y.h(_nbs.a.Ob,this.cc));return this.cT},dw:function(){this.dd||(this.dd=new _y.h(_nbs.a.Kd,this.bX));return this.dd},du:function(){this.cS||(this.cS=new _y.h(_nbs.a.RR,this.cb));return this.cS},ea:function(){return!this.bi.a.bb.R()},dZ:function(){return this.bi.a.bb.R()},W:function(){return this.dq(this.bw?this.bm.a.E:this.bm.b.c())||this.dq(this.bw?this.bl.a.E:this.bl.b.c())||this.dq(this.bw?this.bn.a.E:this.bn.b.c())},p:function(){return this.bm.f()||this.bl.f()||this.bn.f()},X:function(){return this.bm.g()&&this.bl.g()&&this.bn.g()},dW:function(){return this.bi.a.bb.R()||this.bi.a.dm()},cB:function(){return _y.c.a.a()==="Mouse"&&!!this.bs&&this.bs.a().f().Enabled},bQ:null,A:function(){return this.bQ},bB:function(){if(this.dX()&&!this.by){var n=this.eo();this.by=this.bh.bY.b(1,_bc.e.a,n,2,!1,!0,!1,0,0,this.bs,null,!0,this.bh.bs());this.by.d(!1);this.bQ=new _j.k;this.bQ.m(this.by.a().d())}return this.by},bC:function(){if(this.by&&this.bQ){var t=this.by.a().x.length;var n=this.F()-t;if(n>0)return String.format(_u.n.FC,n)}return""},bE:function(){return null},y:function(){return this.cH},L:function(n){if(!this.bh.bn()&&!this.bj.eN)return n;if(this.cH!==n){if(n){if(this.F()<=0)return n;this.f();this.bm.d.k(this.bj.g());this.bl.d.k(this.bj.n());this.bn.d.k(this.bj.c())}this.cH=n;this.bq("ShowAggregatedHeader");!this.cH&&_g.a.a().a().bj.AlwaysShowFrom&&this.dB()}return n},bD:function(){return!1},G:function(n){return this.cD(n).a.C},U:function(n,t){this.cD(t).a.cg(n)},bd:function(n){this.cD(n).a.bQ()},c:function(n){this.cD(n).bh()},b:function(n){return this.cD(n).a},bg:function(){this.bm.J();this.bl.J();this.bn.J()},bf:function(n){this.cE=n},ep:function(n,t,i){if(this.bx){this.bx.c(this.cl);this.bx.a(i);this.cl=i;this.bx.d(t);this.bx.e(n);this.cZ(!0);this.bi.a.bN(this.bx)}else{var r=this;this.bh.dv.a(function(u){if(r.bo()){_j.e.a(_a.a.a,"BuildAndLaunchRichPeoplePickerViewModel: viewModel is null or disposing, aborting logic.");return}r.bx=u.a(n,t,r.bh.bs());r.bx.a(i);r.bx.b(r.cz);r.cl=i;r.cZ(!0);r.bi.a.bN(r.bx)})}},em:function(){this.dp(0);this.dp(1)},a:function(){return this.ce},eq:function(n,t,i,r){var u=null;this.cV=n;this.cW=r;this.cG=t;this.cU=i;r&&(u=this.ed(this.cW));if(!this.bz&&u){var f=this;this.bh.dw.a(function(t){if(!f.bo()){f.bz=t.a();f.ee(n,u)}})}else if(u){this.bz.a(this.cQ);this.ee(n,u)}},ee:function(n,t){this.bz.d(this.cz);this.bz.c(this.cV);this.bz.b(this.cU);this.cQ=n;t.a.D().cL(this.bz);this.cZ(t.q=!0);t.a.D().cO()},ed:function(n){var t=null;n===_u.n.On?t=this.bm:n===_u.n.PO?t=this.bl:n===_u.n.RC&&(t=this.bn);return t},g:function(){var n=this.bi.a.bb;var t=n.G();this.eQ(!t||!!t.a()||t.o()||t.b());this.bU=new _mcp.k(n.V(),this.dW(),this.bs);if(n.bO()&&n.bO().b()>0){this.bm.V(n.bO(),this.bw,_u.n.On);n.en(null)}else{var u,f;var e=(f=this.bU.m(u={val:n}),n=u.val,f);this.bm.F(e,n.bn(),this.bw,_u.n.On)}this.bl.F(n.n(),n.bg(),this.bw,_u.n.PO);this.bj.fq(this.bj.bF()||!this.dW()&&(this.bh.dr()||this.bh.bn()?!!n.n()&&n.n().b()>0:!0));this.bU.o(this.bw?this.bm.a:this.bm.b,this.bw?this.bl.a:this.bl.b);_y.c.a.i()&&this.eg(!0);this.em();var i=_g.a.a().c();if(!_j.i.a(i.bj.SharePointUrl)&&!_j.i.a(i.bj.LogonEmailAddress)){var r=new _g.O;r.Mailbox=this.dr(i.bj.LogonEmailAddress);n.cE(r)}("Mouse"===_y.c.a.a()||n.k()||_g.a.a().a().bj.AlwaysShowFrom||n.c()&&n.c().b()>0||_g.a.a().a().bj.AlwaysShowBcc)&&this.bR();this.eh(n);if(this.bh.bn()||n.bh()){this.bm.y(this.bh.bb.g());this.bl.y(this.bh.bb.n());this.bn.y(this.bh.bb.c());this.L(this.F()>0)}_mcp.o.prototype.g.call(this);this.dY()&&this.ca.e(this.C())},eN:function(){if(this.bQ){this.bQ.f();this.bQ=null}if(this.by){if(this.by.a()){this.by.h(!0);var n;_a.i.a(n={val:this.by}),this.by=n.val}this.by=null}},f:function(){this.bR();var n=this.bj;this.df();this.dz(n,this.bm,this.dN,_mcp.f.e);this.dz(n,this.bl,_mcp.f.d,_mcp.f.c);this.dz(n,this.bn,_mcp.f.b,_mcp.f.a)},R:function(n){var u=this.bB().a().x.length;var i=u-1;if(n<i)this.bB().a().s(n+1,i-n);else if(n>i)for(var t=u;t<=n;t++)this.bB().a().a(this.bQ.x[t]);var r=!1;this.bB().a().x.length<this.bQ.x.length&&(r=!0);this.bB().d(r);this.bq("RecipientsTruncatedString")},M:function(n,t){var r=_a.G.a(n);if(r){this.m().d("");var e=this.dr(n);var o=_pc.a.a(e);var f=this.bi.a.bY.c;var i=f.a(o,4,!0,2,this.bh.bs(),!1);i.R(this.cA);i.b(!0);i.cv=!0;this.cY(i);this.es()}else{this.m().d(n);this.cY(null)}if(t&&_a.cA.a){var u=this.bi.a.cX();u.a(1)}this.K(!r);this.f()},F:function(){this.bR();return this.bm.h()+this.bl.h()+this.bn.h()},e:function(){this.bR();return this.bm.h()},E:function(){this.bR();return this.bl.h()},D:function(){this.bR();return this.bn.h()},be:function(n){this.L(!1);this.bR();this.df();this.er();this.dA=n;this.ex()},C:function(){var n=new _j.q;this.bm.a?n.h(this.bm.a.f()):this.bm.b&&n.h(this.bm.b.f());this.bl.a?n.h(this.bl.a.f()):this.bl.b&&n.h(this.bl.b.f());this.bn.a?n.h(this.bn.a.f()):this.bn.b&&n.h(this.bn.b.f());return n.j()},u:function(n){this.ca&&this.ca.c(n)},br:function(){var c;_a.i.a(c={val:this.bp}),this.bp=c.val;if(this.bx){this.bx.c(this.cl);this.bx.f(this.cz);this.bx.dispose();this.bx=null;this.cl=null}if(this.ey()&&this.bz){this.bz.f(this.cz);this.bz.a(this.cV);this.bz.e(this.cU);this.bz.dispose();this.bz=null;this.cQ=null;this.cG=null}this.ef();if(this.bJ){this.bJ.N(this.dk);this.bJ.dispose();this.bJ=null}this.eN();this.ef();this.eM();this.ce.f();var h;_a.i.a(h={val:this.bm}),this.bm=h.val;var s;_a.i.a(s={val:this.bl}),this.bl=s.val;var l;_a.i.a(l={val:this.bn}),this.bn=l.val;var y;_a.i.a(y={val:this.bX}),this.bX=y.val;var v;_a.i.a(v={val:this.cb}),this.cb=v.val;var a;_a.i.a(a={val:this.bT}),this.bT=a.val;var o;_a.i.a(o={val:this.cc}),this.cc=o.val;var i;_a.i.a(i={val:this.cm}),this.cm=i.val;var t;_a.i.a(t={val:this.cA}),this.cA=t.val;var n;_a.i.a(n={val:this.bW}),this.bW=n.val;var r;_a.i.a(r={val:this.cw}),this.cw=r.val;var e;_a.i.a(e={val:this.ck}),this.ck=e.val;var f;_a.i.a(f={val:this.cj}),this.cj=f.val;var u;_a.i.a(u={val:this.ct}),this.ct=u.val;this.bU=null;this.cE=null;_mcp.o.prototype.br.call(this)},bP:function(){var n=new _j.q;if(!this.bj.R()){this.cs=new _fm.d(_nbs.a.Kd,null,this.bX);(_g.a.a().a().bj.AlwaysShowBcc||this.cB())&&this.cs.a(!0);n.c(this.cs);this.co=new _fm.d(_nbs.a.RR,null,this.cb);(!_g.a.a().a().bj.AlwaysShowBcc||this.cB())&&this.co.a(!0);n.c(this.co)}if(this.bj.bI()||this.bj.I()){var i=this.bi.b(1);this.cv=new _fm.d(_nbs.a.nU,null,this.bT);n.c(this.cv);this.bT.c(!this.bj.I());this.cq=new _fm.d(_nbs.a.Ob,null,this.cc);this.cv.a(this.bj.E());this.cq.a(!this.bj.E());n.c(this.cq)}if(!this.bj.R()&&!_y.c.a.i()&&!this.bh.bn()&&_y.c.a.a()!=="TouchNarrow"){var t=new _fm.d(_nbs.a.gW,null,this.bW);n.c(t)}return n.j()},bN:function(){var n=new _j.q;if(!(this.bj.R()||this.bh.dr()||this.cB())){this.cr=_mcp.o.a(this.bX,_nbs.a.Kd);n.c(this.cr);this.cn=_mcp.o.a(this.cb,_nbs.a.RR);n.c(this.cn);this.cr.a(!_g.a.a().a().bj.AlwaysShowBcc);this.cn.a(_g.a.a().a().bj.AlwaysShowBcc)}if(this.bj.bI()||this.bj.I()){this.cu=_mcp.o.a(this.bT,_nbs.a.nU);n.c(this.cu);this.cp=_mcp.o.a(this.cc,_nbs.a.Ob);n.c(this.cp);this.bT.c(!this.bj.I());this.cu.a(!this.bj.E());this.cp.a(this.bj.E())}if(!this.bj.R()&&!_y.c.a.i()){var t=_mcp.o.a(this.bW,_nbs.a.gW);n.c(t)}return n.j()},bK:function(){var n=new _j.q;_g.a.a().a().bj.AlwaysShowBcc?n.c(this.du()):n.c(this.dw());if(this.bj.bI())if(_g.a.a().a().bj.AlwaysShowFrom){n.c(this.dv());this.bV=!1}else{n.c(this.cC());this.bV=!0}else this.bV=!1;_a.g.b||n.c(new _y.h(_nbs.a.gW,this.bW));return n.j()},cy:function(){var n=this.bj;var t=this.bh.dX;if(t){var u=n.E()?this.dv():this.cC();var f=n.E()?this.cC():this.dv();t.K(f,u);var i=n.Q()?this.du():this.dw();var r=n.Q()?this.dw():this.du();t.K(r,i)}},bZ:function(){if(this.cv&&this.cq){this.cv.a(this.bj.E());this.cq.a(!this.bj.E())}if(this.cs&&this.co){this.cs.a(this.bj.Q()||this.cB());this.co.a(!this.bj.Q()||this.cB())}},bY:function(){if(this.cu&&this.cp){this.cu.a(!this.bj.E());this.cp.a(this.bj.E())}if(this.cr&&this.cn){this.cr.a(!this.bj.Q());this.cn.a(this.bj.Q())}},ex:function(){this.bm.c?this.bm.D():this.dT(!0)},dT:function(n){n?this.bl.c?this.bl.D():this.dS(!0):this.cR(!1)},dS:function(n){n?this.bn.c?this.bn.D():this.cR(!0):this.cR(!1)},cR:function(n){if(this.dA)if(n){_j.e.a(_a.a.a,"Force resolve completed");this.cg("ResolveOperationSucceeded")}else{_j.e.a(_a.a.a,"Force resolve cancelled");this.cg("ResolveOperationCanceled")}},V:function(){this.bR();this.df();this.bm.C();this.bl.C();this.bn.C()},bR:function(){if(!this.dm){this.dm=!0;var n=this.bi.a.bb;this.bn.F(n.c(),n.N(),this.bw,_u.n.RC);if(n.c()&&0<n.c().b()||!_j.i.a(n.N())||_g.a.a().a().bj.AlwaysShowBcc){n.ca(!0);_j.e.a(_a.a.a,"Showing BCC field due to: BccCount={0}, HasBccQueryString={1}, AlwaysShowBcc={2}",n.c()?n.c().b():0,!_j.i.a(n.N()),_g.a.a().a().bj.AlwaysShowBcc)}this.dp(2);_j.e.a(_a.a.a,"Recipient component initialized, ShouldValidate={0}, From={1}, ToCount={2}, CcCount={3}, BccCount={4}",!0,!n.k()||!n.k().Mailbox?"<not set>":n.k().Mailbox.EmailAddress,n.g()?n.g().b():0,n.n()?n.n().b():0,n.c()?n.c().b():0);this.eh(n);if(n.bI()&&!this.bh.bn()&&(n.k()||_g.a.a().a().bj.AlwaysShowFrom||this.eC())){_j.e.a(_a.a.a,"Showing From field due to: From={0}, AlwaysShowFrom={1}",!n.k()||!n.k().Mailbox?"<not set>":n.k().Mailbox.EmailAddress,_g.a.a().a().bj.AlwaysShowFrom);this.m()?this.dx():this.db=!0}else if(_g.a.a().a().bj.AlwaysShowFrom&&n.G()&&!n.G().b()){var t=this.bi.a.bc;t.b(4525);t.a(4525);this.bh.bf()}}},bc:function(){this.bm.G();this.bl.G();this.bn.G()},s:function(){_j.e.a(_a.a.i,"MailComposeRecipientComponent.GetAllEmailAddresses");var e=this.bi.a.bb;var t=new _j.q;var u=this.bw?this.bm.a.E:this.bm.b.c();var f=this.bw?this.bl.a.E:this.bl.b.c();var r=this.bw?this.bn.a.E:this.bn.b.c();if(u){_j.e.a(_a.a.i,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding to addresses");t.h(u.d())}if(f){_j.e.a(_a.a.i,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding cc addresses");t.h(f.d())}if(r){_j.e.a(_a.a.i,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding bcc addresses");t.h(r.d())}_j.e.a(_a.a.i,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding from address");var n=e.bQ();if(!n){var i=_g.a.a().c();n=new _g.f;n.Name=i.bj.UserDisplayName;n.EmailAddress=i.bj.UserEmailAddress||i.bj.LogonEmailAddress;n.MailboxType="Mailbox";n.RoutingType="SMTP"}t.c(n);return t},eP:function(){if(this.bp){_j.e.a(_a.a.a,"User selected from persona");this.bp.E(!0);this.cE&&this.cE()}else _j.e.a(_a.a.a,"User tries to select from persona, but it is null")},eI:function(){this.bi.a.bk().a("ResolveRecipients");this.be(!1)},et:function(){_j.e.a(_a.a.a,"User chose to delete from persona");this.cY(null);this.m().O(!0)},ek:function(){this.M(this.m().c(),!0)},eJ:function(n,t){this.el()},ds:function(n){return new _mcp.B(this.bi.a.bY,this,this.bs,this.bi,this.dn,this.ca,n,this.bh.bb.a(),this.bh.bs())},eL:function(n,t){if(this.bU){var i;this.bU.l(t,i={val:n}),n=i.val}else n.r(t)},eF:function(n,t){this.ce.f();this.dC(this.bm);this.dC(this.bl);this.dC(this.bn)},dC:function(n){n.a?this.ce.c(n.a):n.b&&this.ce.c(n.b)},en:function(){this.bm.apcl("ReadWriteRecipientWellViewModel",this.bA);this.bl.apcl("ReadWriteRecipientWellViewModel",this.bA);this.bn.apcl("ReadWriteRecipientWellViewModel",this.bA);this.bm.apcl("ReadOnlyRecipientWellViewModel",this.bA);this.bl.apcl("ReadOnlyRecipientWellViewModel",this.bA);this.bn.apcl("ReadOnlyRecipientWellViewModel",this.bA)},eM:function(){this.bm.rpcl("ReadWriteRecipientWellViewModel",this.bA);this.bl.rpcl("ReadWriteRecipientWellViewModel",this.bA);this.bn.rpcl("ReadWriteRecipientWellViewModel",this.bA);this.bm.rpcl("ReadOnlyRecipientWellViewModel",this.bA);this.bl.rpcl("ReadOnlyRecipientWellViewModel",this.bA);this.bn.rpcl("ReadOnlyRecipientWellViewModel",this.bA)},eE:function(n,t){this.L(!1);this.bm.f()||this.bl.f()||this.bn.f()||(this.bM.c()?this.bi.a.bc.b(97):this.bi.a.bc.b(65));this.bm.g()&&this.bl.g()&&this.bn.g()||this.bi.a.bc.b(70);_y.c.a.i()&&this.eg(!1);if(t&&t.c===2){var i=this.bi.a.cX();i.b();_a.br.a&&_j.o.a().c(_a.a.F,"TriggerPolicyTipsIfNeeded",this.dO)}},eK:function(n,t){this.bU&&this.bU.n(n,t)},er:function(){this.bm.a&&this.bm.a.bh();this.bl.a&&this.bl.a.bh();this.bn.a&&this.bn.a.bh()},eD:function(){this.cZ(!1);var n=this.ed(this.cW);n&&(n.q=!1);this.cG&&this.cG()},ef:function(){this.cX(0);this.cX(1);this.cX(2)},dp:function(n){var t=this.cX(n);if(t){t.cf(this.ec(n));t.ef(this.dj);t.C.e(this.di);n||t.C.e(this.dl)}return t},cX:function(n){var t=null;switch(n){case 0:t=this.bm.a;break;case 1:t=this.bl.a;break;case 2:t=this.bn.a;break}if(t){t.cq(this.ec(n));t.eH(this.dj);t.C.g(this.di);n||t.C.g(this.dl)}return t},ec:function(n){switch(n){case 0:return this.dJ;case 1:return this.dI;case 2:return this.dH;default:throw Error.notImplemented("a new recipient type has been introduced and mail compose recipient component does not work with it");}},eH:function(){this.bh.bf()},eR:function(){var t=_a.d.b(_a.a.a,"MailComposeShowBcc",!0);this.bi.a.bk().a("ShowBcc");_j.e.a(_a.a.a,"User chose to show bcc");this.bR();var n=this.bi.a.bb;if(!n.Q()){n.ca(!0);this.bq("ShowBccButton");this.bh.bf();this.bv()}_a.d.a(t)},eA:function(){var t=_a.d.b(_a.a.a,"MailComposeHideBcc",!0);this.bi.a.bk().a("HideBcc");_j.e.a(_a.a.a,"User chose to hide bcc");this.bR();var n=this.bi.a.bb;if(n.Q()){n.ca(!1);this.bq("ShowBccButton");this.bh.bf();this.bv()}_a.d.a(t)},eh:function(n){if("Mouse"!==_y.c.a.a()){var f=this.bi;var u=f.a;var r=u.dX;if(r){var i=r.a;if(i)if(n.bI()){if(!this.bV)for(var t=0;t<i.length;t++)if(_nbs.a.Kd===i[t].b){r.x(this.cC(),t+1);this.bV=!0}}else if(this.bV){u.dX.s(this.cC());this.bV=!1}}}},df:function(){var i=this.bi.a.bb;var n=null;if(i.E()){var t=null;this.bp?t=this.bp.bR.a():this.bJ&&!_j.i.a(this.bJ.c())&&(t=this.dr(this.bJ.c()));n=new _g.O;n.Mailbox=t;i.cE(n);this.q()||this.bi.a.bc.b(66)}return n},eC:function(){var t=!1;if(this.bM.c()){var n=_g.a.a().c();t=n.e().b()>0||!!n.a()&&n.a().b()>0||n.b().b()>1}return t},eo:function(){var n=new _j.k;if(this.bj){this.bj.g()&&n.m(this.bj.g().d());this.bj.n()&&n.m(this.bj.n().d());this.bj.c()&&n.m(this.bj.c().d())}return n},dr:function(n){var t=new _g.f;t.MailboxType="Mailbox";t.RoutingType="SMTP";t.EmailAddress=n;return t},es:function(){var t=_mcp.B.b;var n=[];(t&4)==4&&Array.add(n,new _fm.d(_u.n.NE,null,new _j.g(this.dG,_a.a.a)));(t&2)==2&&Array.add(n,new _fm.d(_u.n.Lq,null,new _j.g(this.dh,_a.a.a)));this.bp.ch&&(t&1)==1&&Array.addRange(n,this.bp.ch);this.bp.be(n)},dx:function(){var t=this.bi.a.bb;var n=null;var i=_g.a.a().c();n=_j.i.a(i.bj.SharePointUrl)||_j.i.a(i.bj.LogonEmailAddress)?null!==t.k()&&t.k().Mailbox?t.k().Mailbox.EmailAddress:_mco.a.g(null)||i.bj.UserEmailAddress:i.bj.LogonEmailAddress;var u=this.bh.ct();u.a()||u.g();var r;var e,f;(f=u.c(n,e={val:r}),r=e.val,f)&&(n=r);this.M(n,!1);t.dU(!0);var o=this.df();t.eH()&&t.eH().z(o);this.bv()},ew:function(){var n=this.bp.bR.a().EmailAddress;this.cY(null);this.m().d(n);this.m().O(!0)},el:function(){var n=this.m().A();if(n&&n.a()&&n.a().a()){var t=n.a().a().EmailAddress;_j.e.a(_a.a.a,"User selected from={0}",t);this.M(t,!0)}else _j.e.b(_a.a.a,"User selected from but the SelectedResultItem persona is invalid")},dB:function(){if(!this.m()){this.dc=!0;return}var t=_a.d.b(_a.a.a,"MailComposeShowFrom",!0);this.bi.a.bk().a("ShowFrom");var n=this.bi.a.bb;if(n.E())_j.e.a(_a.a.a,"Skip show from since it is already shown");else{_j.e.a(_a.a.a,"User chose to show from");this.L(!1);this.cP=!0;this.dx();this.bh.bf();this.bv()}_a.d.a(t)},eB:function(){this.L(!1);var t=_a.d.b(_a.a.a,"MailComposeHideFrom",!0);this.bi.a.bk().a("HideFrom");var n=this.bi.a.bb;if(n.E()){n.dU(!1);this.cP=!1;this.bh.bf()}else _j.e.a(_a.a.a,"Skip hide from since it is already hidden");this.bv();this.bi.a.bc.b(750);_a.d.a(t)},dz:function(n,t,i,r){var u=this.bw?t.a:t.b;if(u){i(n,u.c());if(_rw.d.isInstanceOfType(u)){var f=u;f.D()&&r(n,f.D().c())}}},eg:function(n){var e=this.bi.a.bb;var i=!1;var u=e.bQ();if(u){var t=this.bl.a.E;if(t)for(var r=0;r<t.x.length;r++){var f=t.x[r];if(u.EmailAddress.toLowerCase()===f.EmailAddress.toLowerCase()){i=!0;break}}}if(n&&i){this.bi.a.bc.b(4450);this.bi.a.bc.a(4450)}else n||i||this.bi.a.bc.b(4450)},dq:function(n){if(!n||!n.x.length)return!1;for(var t=0;t<n.x.length;t++){var i=n.x[t];if(i&&i.MailboxType==="GroupMailbox")return!0}return!1},dt:function(n){var t=this.bm.z(n)||this.bl.z(n)||this.bn.z(n);t&&n.a.di(t)},eb:function(){if(!this.cw){var n=this;this.cw=new _j.g(function(){n.dt(n.bm)},_a.a.a)}return this.cw},dV:function(){if(!this.ck){var n=this;this.ck=new _j.g(function(){n.dt(n.bl)},_a.a.a)}return this.ck},dU:function(){if(!this.cj){var n=this;this.cj=new _j.g(function(){n.dt(n.bn)},_a.a.a)}return this.cj},ez:function(){if(!this.ct){var n=this;this.ct=new _j.g(function(){n.bj.fq(!0);n.bh.bf();n.bi.a.bk().a("ShowCc")},_a.a.a)}return this.ct},cD:function(n){switch(n){case 0:return this.bm;case 1:return this.bl;case 2:return this.bn;default:throw Error.argument();}},eO:function(){_mcp.G.a(this.bh,1)}};_mcp.r=function(n){this.c=Function.createDelegate(this,this.h);_mcp.r.initializeBase(this,[31,n])};_mcp.r.f=function(n){for(var i=[],t=0;t<n.length;t++)_j.i.b(n[t])||Array.add(i,n[t].trim());return i};_mcp.r.d=function(n,t){for(var i=0;i<n.length;i++)if(n[i]===t||t&&n[i]&&n[i].toLowerCase()===t.toLowerCase())return!0;return!1};_mcp.r.c=function(n){var t=_g.a.a().c();t?Array.add(n,t.bj.UserEmailAddress):_j.e.b(_a.a.a,"SessionSettings is null.")};_mcp.r.b=function(n,t){t.bj.From&&t.bj.From.Mailbox&&t.bj.From.Mailbox.EmailAddress&&Array.add(n,t.bj.From.Mailbox.EmailAddress)};_mcp.r.a=function(n,t){if(t)for(var i=0;i<t.b();i++)Array.add(n,t.a(i).EmailAddress)};_mcp.r.e=function(n,t){for(var u=$("a[id^='OWAAM']",t),i=0;i<u.length;i++){var r=u[i];r.href.startsWith("mailto:")&&Array.add(n,r.href.substr(7))}};_mcp.r.prototype={a:function(n,t){if(this.bj.d())this.e(n,t);else{var i=this;this.bh.el(function(){i.e(n,t)})}},b:function(n){if(!n)throw Error.argumentNull("originalMessage");var u=[];var t=[];_mcp.r.c(t);_mcp.r.b(t,n);_mcp.r.a(t,n.m());_mcp.r.a(t,n.o());for(var f=this.bh.bd().s(),r=0;r<f.d.length;r++){var i=f.d[r];if(i&&!_mcp.r.d(t,i.EmailAddress)){Array.add(u,i);Array.add(t,i.EmailAddress)}}return u},e:function(n,t){if(this.bj&&this.bj.d()&&this.bj.d().bw()===1&&this.bj.fZ()&&this.bh.bv.a()==="Mouse"&&this.bj.j()!=="Text"){var r=this.bj.d();var i=new _cmc.V;i.c=r;i.a=n;i.b=t;i.d=this.c;this.bh.bK().a(i)}},h:function(n,t,i,r,u){var e=[];_mcp.r.c(e);_mcp.r.b(e,t);this.f(e);_mcp.r.a(e,t.m());_mcp.r.a(e,t.o());_mcp.r.e(e,i);var f;if(_j.i.a(n))f=new Array(0);else{n.startsWith("+")&&(n=n.substr(1));f=_mcp.r.f(n.split(","))}for(var l=0;l<r.length;l++){var s=r[l];if(s&&s.a()&&!_mcp.r.d(e,s.a().EmailAddress)){var o=s.c()||"";var a=o.indexOf(" ");a>0&&s.b()===1&&(o=o.substr(0,a));for(var c=-1,h=0;h<f.length;h++)f[h].toLowerCase()===o.toLowerCase()&&(c=h);u?Array.add(f,o):c>-1&&Array.removeAt(f,c)}}return f.length>0?"+"+f.join(", ")+" ":null},f:function(n){if(this.bj.eL){var r=this.bj.eL;for(var i in r){var u={key:i,value:r[i]};var t=u.value;t&&t.Mentioned&&Array.add(n,t.Mentioned.EmailAddress)}}}};_mcp.B=function(n,t,i,r,u,f,e,o,s){this.M=Function.createDelegate(this,this.ba);this.L=Function.createDelegate(this,this.Z);this.O=Function.createDelegate(this,this.bc);this.N=Function.createDelegate(this,this.bb);this.w=Function.createDelegate(this,this.be);this.u=Function.createDelegate(this,this.X);this.v=Function.createDelegate(this,this.bd);this.p=Function.createDelegate(this,this.Y);this.K=Function.createDelegate(this,this.W);_mcp.B.initializeBase(this);this.o=n;this.n=t;this.m=i;this.e=r;this.I=u;this.A=f;this.r=e;this.x=o;this.s=s};_mcp.B.prototype={o:null,m:null,j:null,a:null,b:null,d:null,n:null,i:null,k:null,t:null,e:null,I:null,A:null,s:!1,U:function(){return!!this.m&&this.m.a().G().Enabled&&_y.c.a.a()==="Mouse"},S:function(n){if(this.a!==n){this.a=n;this.bq("ReadWriteRecipientWellViewModel")}return n},q:!1,Q:function(){this.j||(this.j=new _j.g(this.K,_a.a.X));return this.j},l:0,bg:function(n){if(n!==this.b){this.b=n;this.bq("ReadOnlyRecipientWellViewModel")}return n},E:function(){return this.a?this.R(!0):""},bf:function(n){if(n!==this.d){this.d=n;this.bq("AggregatedRecipientWellViewModel")}return n},g:function(){return this.c&&_rw.b.h(this.a)},c:!1,f:function(){return this.c&&!!this.a&&this.a.O},bh:function(){this.c&&this.a&&this.a.ec()},r:0,x:0,V:function(n,t,i){this.k=n;this.c=t;this.a?this.a.k(null):this.S(this.P(null));var r=this.a.D();if(r){r.d("");r.bM(this.k)}else this.a.apcl("FindRecipientViewModel",this.p);this.i=i},F:function(n,t,i,r){this.c=i;this.t=t;if(this.c){this.a?this.a.k(n):this.S(this.P(n));var u=this.a.D();if(u){!_j.i.a(u.c())&&_j.i.a(t)&&u.d(t);_j.i.a(t)||u.d(t)}else this.a.apcl("FindRecipientViewModel",this.p);this.i=r;this.a.C&&this.a.C.e(this.v)}else this.b?this.b.k(n):this.bg(this.T(n))},D:function(){this.a&&this.a.ck()},C:function(){this.a&&!this.q&&this.a.bq()},J:function(){if(this.a&&this.a.D().bK())if(this.a.D().ct()){this.a.db(!0);this.a.db(!1)}else{this.a.dd(!0);this.a.dd(!1)}},h:function(){var n;n=this.c?this.a?!this.a.D()||_j.i.a(this.a.D().c())?this.a.E.x.length:this.a.E.x.length+1:0:this.b?this.b.c().x.length:0;return n},G:function(){if(this.a){var n=this.R(!1);n!==""&&_j.e.a(_a.a.a,"{0} Well Invalid Recipients are: {1} \n",this.i,n)}},R:function(n){var e="";if(this.a)for(var o="",f="",u,t,i=0,s=this.a.C.x.length;i<s;i++){u=this.a.C.x[i];if(u&&!u.l){t=this.a.E.x[i];if(t){f=_j.i.b(t.Name)?"":t.Name;var r=null;if(n)r=String.format("{0}, ",f);else{o=_j.i.b(t.EmailAddress)?"":t.EmailAddress;r=String.format("( {0} , {1} ),",f,o)}e+=r}}}return e},br:function(){if(this.a){this.a.C&&this.a.C.g(this.v);this.a.dY(this.u);this.a.rpcl("SelectedRecipient",this.w);this.a.t(!1);this.a.h(!0);var i;_a.i.a(i={val:this.a}),this.a=i.val}if(this.b){this.b.h(!0);var r;_a.i.a(r={val:this.b}),this.b=r.val}if(this.d){this.d.h(!0);var n;_a.i.a(n={val:this.d}),this.d=n.val}var t;_a.i.a(t={val:this.j}),this.j=t.val;this.n=null;_j.R.prototype.br.call(this)},P:function(n){var t=this.o.a(_mcp.B.b,_pe.c.b,n,!0,!0,this.I,this.A,this.r,this.x,this.s,!0);t.dH(this.u);t.apcl("SelectedRecipient",this.w);return t},T:function(n){return this.o.b(_mcp.B.a,_bc.e.a,n,2)},y:function(n){this.bf(this.o.b(_mcp.B.a,_bc.e.a,n,2,!1,!0,!1,n?n.b():0,0,this.m,null,!1,this.s));return this.d},be:function(n,t){if(this.e){var i=n;var r=this.e.a;if(i.F!==i.bg){r.bc.e([10210,10211]);i.bg=null}}},X:function(n){if(this.e){var t=this.e.a;switch(n){case 1:t.bc.a(10210);break;case 0:t.bc.a(10211);break}}},Y:function(n,t){var r=n;var i=r.D();if(this.k&&this.k.x.length>0){i.d("");i.bM(this.k)}_j.i.b(this.t)||i.d(this.t);r.rpcl("FindRecipientViewModel",this.p)},W:function(){if(this.c&&!_a.g.b)if(this.U()){_j.e.a(_a.a.a,"User chose to launch the new people picker");_a.r.a.c("VM.PeoplePicker.Launched",_a.c.a());var t;_a.n.b(_a.a.X,"LaunchV2PeoplePicker",!0,(t=new _a.R,t.b=!0,t));this.l=0;this.n.eq(this.N,this.O,this.L,this.i)}else{_j.e.a(_a.a.a,"User chose to launch rich people picker");this.a.bq();_a.r.a.c("VM.PeoplePicker.Launched",_a.c.a());var n;_a.n.b(_a.a.X,"PeoplePicker",!0,(n=new _a.R,n.b=!0,n));this.n.ep(this.a.C,this.i,this.M)}},Z:function(n){this.a&&this.a.D().R(n)},bb:function(n){var t=n;if(t.a()){_a.G.a(_g.m.c(t.a()))||t.a().RoutingType==="MAPIPDL"?this.a.v(t):this.a.Y(t);this.l++}},bc:function(){if(this.l>0){var n=new _cmc.d(_a.a.X,"CloseV2ToPicker",!1);n.a("sc",this.l,!0,!0);n.b()}},ba:function(n){_y.c.a.a()!=="TouchNarrow"&&this.a.y();var t=this;n.p(function(n){var i=n;i.l?t.a.v(i.k):t.a.Y(i.k)})},z:function(n){var u=this.a.C;var r=null;if(this!==n)for(var t=0;t<u.x.length;t++){var i=u.x[t];if(i.x){r=i;this.a.bk(i);break}}return r},bd:function(n,t){this.e&&this.e.a&&this.e.a.fb(t,this.r)}};_mcp.x=function(n,t,i,r,u){this.M=Function.createDelegate(this,this.bx);this.N=Function.createDelegate(this,this.by);this.T=Function.createDelegate(this,this.bd);this.U=Function.createDelegate(this,this.be);this.S=Function.createDelegate(this,this.bA);this.R=Function.createDelegate(this,this.bz);this.m={};_mcp.x.initializeBase(this,[8,n,r,u]);this.G=t;this.t=new _j.g(this.R,this.bk());this.x=new _j.g(this.S,this.bk());this.A=n.a.bO;this.W=i};_mcp.x.prototype={W:null,n:null,A:null,G:null,t:null,x:null,r:!1,w:!1,z:null,y:null,v:null,o:null,e:function(){return this.t},j:function(){return this.x},c:function(){return this.r},I:function(n){if(n!==this.r){this.r=n;this.bq("IsSaving")}return n},bB:function(n){if(n!==this.v){this.v=n;this.bq("DraftSavedTime")}return n},s:!1,h:function(){return this.s},l:function(n){this.s=n;return n},q:!1,f:function(){return this.q},b:function(n,t){var i=this.bi;var f=i.b(5);var u=i.a.bl;var r=i.a.bb;_j.e.a(_a.a.a,"UserInitiatedSave - SaveStart:Context:{0}",r);i.a.bk().a("Save");this.cf();if(!r.bH()){_j.e.a(_a.a.a,"Save not supported for the current operation {0}",r.a());return}if(f.b()){_j.e.a(_a.a.a,"Skip save and show attachment in progress dialog");u.p||u.g(0,_u.R.Di,null);return}this.q=!0;this.a("Save",n,t,!1)},g:function(){this.ba();_mcp.o.prototype.g.call(this)},ba:function(){if(this.bh.cv()&&!this.o){_j.e.a(_a.a.a,"Setting save component override");this.o=this.bh.cu().d();var u=this.bh.bd();var o=this.bh.be();var f=u,e=u,t=u,n=u,r=o,i=o;this.o.b(this.U,this.T,f.j||(f.j=Function.createDelegate(f,f.e)),e.i||(e.i=Function.createDelegate(e,e.E)),t.h||(t.h=Function.createDelegate(t,t.D)),n.k||(n.k=Function.createDelegate(n,n.f)),r.e||(r.e=Function.createDelegate(r,r.l)),i.f||(i.f=Function.createDelegate(i,i.n)),_zz.d.d,this.cI)}},Z:function(){if(this.o){this.o.a();this.o=null}},a:function(n,t,i,r){if(this.o&&!this.o.c()){_j.e.a(_a.a.a,"saveComponentOverride.IsReadyForSmimeOperation() == false.  Save ignored.");return!0}var h=this.bi;var o=h.a;var u=o.bb;var c=o.bc;var f=u.b();var a=this.bi.b(5);var s=this.bh.bh();if(s.c()&&!r){_j.e.a(_a.a.a,"Send is in progress, this {0} save is ignored. ContextId={1}",n,f);return!0}if(this.A.a(f)){_j.e.a(_a.a.a,"User already discarded, clearing all save processors to ignore save effects. ContextId={0}",f);this.m={};return!1}var e=this.bh.bd();e.V();if(_g.a.a().bj.MaxRecipientsPerMessage<e.F()){c.a(800,null);this.bh.bf();return!0}e.f();u.bC().a();this.m[n]=new _mcp.bV(t,i);if(!this.r||r){this.z=_mcp.c.b(u);this.I(!0)}else{this.w=!this.z.t(u);return!0}if(!u.i()&&!u.h()&&!u.J()){_j.e.a(_a.a.a,"Save was attempted during upgrade, remembering this save attempt and waiting for upgrade completion to resume this save. ContextId={0}",f);return!0}this.J();this.y=n;_j.o.a().j(_a.a.a,"MailComposeSave");_j.e.a(_a.a.a,"Started new task runner context before starting save.");try{this.o?this.o.d(n):this.be(n);return!0}catch(l){this.bd(l);throw l;}},J:function(){_a.M.b(_a.a.a,"MailComposeSave",5);this.n=_y.j.b(_a.a.a,"MailComposeSave",!0);this.n&&this.bj.eN&&this.n.o(_mcp.x.b)},i:function(){this.r=!1;this.w=!1;_j.e.a(_a.a.a,"ResumeSave:Context:{0}",this.bi.a.bb);var i=this.m;for(var r in i){var n={key:r,value:i[r]};var t=n.value;this.a(n.key,t.a,t.b,!0);break}},br:function(){this.r=!1;this.w=!1;this.q=!1;this.s=!1;this.m=null;this.z=null;this.Z();var t;_a.i.a(t={val:this.t}),this.t=t.val;var n;_a.i.a(n={val:this.x}),this.x=n.val;_mcp.o.prototype.br.call(this)},cx:function(n){return _db.i.c(n.F,40,50,60,700,88,89,43,57)},cJ:function(n){if("ReadingPaneExit"in this.m||"Popout"in this.m){var u=this.bi.a;var t=u.bc;var f=this.cx(n);var e=new _y.cF;var i=e.a(f,null);t.e(_mcp.q.b);"ReadingPaneExit"in this.m?t.a(87,i):t.a(85,i);if(f===50){var r=this;u.cC.a(function(n){if(!r.bo()){n.a(t);r.bh.bf()}})}else this.bh.bf()}else"Save"in this.m&&_mcp.G.prototype.cJ.call(this,n)},bP:function(){if(this.bj.a()!==8&&!this.bj.R()&&!_y.c.a.i()){var n=new _fm.d(_nbs.a.EL,null,this.bh.bm().e());return[n]}return null},bN:function(){if(this.bj.a()!==8&&!this.bj.R()&&!_y.c.a.i()){var n=_mcp.o.a(this.t,_nbs.a.EL);return[n]}return null},bK:function(){return null},be:function(n){_j.e.a(_a.a.bc,"Setup save action, context:{0}; OriParentFolderId={1}",this.bj,this.bj.d()&&this.bj.d().bj.ParentFolderId&&_g.b.a?_g.b.a.idToName(this.bj.d().bj.ParentFolderId):"null");var t=this.bh.bT.h(this.bh,0);if((_mco.a.isInstanceOfType(t)||_mco.b.isInstanceOfType(t))&&("Attach"===n||"Popout"===n)&&this.bj.R()){var i=t;i.bl=new _g.E(new _g.r("internalsubmission"))}this.bh.bq.a(t,this.N,this.M,null);_j.e.a(_a.a.a,"Save action submitted")},bz:function(){this.bi.a.bk().a("Save");this.b(null,null)},bA:function(){_j.e.a(_a.a.a,"User chose to close and save");if(this.bh.bR()){_j.e.a(_a.a.a,"User hit close, the form is dirty, attempt to save and navigate away. Context:{0}",this.bj);var n=this;this.b(function(){n.bb()},null)}else this.bb()},bd:function(n){this.I(!1);this.q=!1;var t=n.toString();_y.j.a(this.n,null,t,null,this.F(this.y,n.message));this.n=null;_a.M.a("MailComposeSave");_j.e.b(_a.a.a,"Save failed due to an error before action was submitted: {0}",t)},bc:function(n){var s=this.bi;var u=s.a;var f=u.bb;var t=n.V;var r=!1;if(this.A.a(t)){f.b()===t&&(this.m={});this.u(n);var e=_mcp.bj.a(n);if(e){_j.e.a(_a.a.a,"Resume discard for context {0}",t);u.br().e(t,e)}r=!0}else if(t===f.b()){if(this.s){this.s=!1;_j.e.a(_a.a.a,"User issued send while save was in progress, now the save had come back, resume the send and cancel any pending saves. ContextId={0}",t);this.m={};this.u(n);var i=null;_db.f.isInstanceOfType(n)?i=n.D:_mco.b.isInstanceOfType(n)&&(i=n.bk);i&&f.L(i);var o=this.bh.bh();o.e();r=!0}else if(this.w){_j.e.a(_a.a.a,"Saving new content per user's request. ContextId={0}",t);this.i();r=!0}}else _j.e.a(_a.a.a,"Skipping default save processing due to ContextId={0}; viewModelId={1}",t,u.bb.b());return r},by:function(n){var e=this.bi;var r=e.a;var u=r.bb;var h=r.br();var f=n.V;_j.e.a(_a.a.a,"Save action returned success, ContextId={0}; Context:{1}",f,u);if(!this.bc(n)&&f===u.b()){this.bw(n);this.Y();var i=!1;var t=null;if("Attach"in this.m){if("AutoSave"in this.m){t=this.m.AutoSave;t&&t.a(n)}t=this.m.Attach}else if("Popout"in this.m){t=this.m.Popout;var o=r.bp();if(o&&o.i()&&"ReadingPaneExit"in this.m){t&&t.a(n);t=this.m.ReadingPaneExit}}else if("ReadingPaneExit"in this.m)t=this.m.ReadingPaneExit;else if("AutoSave"in this.m){t=this.m.AutoSave;i=!0}else if("Save"in this.m){t=this.m.Save;i=!0}else"Diagnostics"in this.m&&(i=!0);t&&t.a&&t.a(n);if(i){var s=e.b(5);s.A()}this.m={}}_y.j.a(this.n,null,"",this.X(n),this.F(this.y,""));this.n=null},Y:function(){var i="";var t=this.m;for(var n in t){var r={key:n,value:t[n]};i+=r.key+":"}_j.e.a(_a.a.a,"ProcessorKeys:{0}",i)},bx:function(n){var o=this.bi.a.bb;var e=n.V;_j.e.a(_a.a.a,"Save action returned a failure, ContextId={0}; Context:{1}",e,o);if(!this.bc(n)&&e===o.b()){this.Y();var t=!1;var h=this.m;for(var s in h){var i={key:s,value:h[s]};var u=i.value;if(u.b){u.b(n);if((i.key==="ReadingPaneExit"||i.key==="Popout")&&!t){this.V(n);t=!0}}else if(!t){this.V(n);t=!0}}t||this.u(n);this.m={}}var r="SaveFailure_UnknownError";var f="";if(_g.L.a(n.F)){r=_g.L.b(n.F)||"SaveFailure_UnknownError";f=n.F.FaultMessage}_y.j.a(this.n,null,r,this.X(n),this.F(this.y,f));this.n=null},bw:function(n){var o=this.bi;var r=o.a;var t=r.bb;var f=n.V;var h=this.q;if(f===t.b()){this.bC(n);t.cH(!1);r.eP()}this.cg("MailSaveSucceeded");if(f===t.b()){var s=_a.c.a();var i=s.a(0);this.bB(t.bh()?String.format(_nbs.a.nE,i):String.format(_nbs.a.bf,i));var e=!!this.bs&&this.bs.a().f().Enabled;if(h&&!e){var u=r.bc;u.e(_mcp.x.a);u.a(1001,i);this.bh.bf()}}_a.br.a&&this.bh.cY().a(this.q?4:2);this.u(n)},V:function(n){_j.e.a(_a.a.a,"SaveActionFailed: Error: {0}",n.F.message);n.V===this.bi.a.bb.b()&&this.cJ(n);var t=this.bi.a;t.bJ&&t.R(!1);this.u(n)},u:function(n){var i=this.bi;var t=i.a.bb;if(n.V===t.b()){this.I(!1);this.q=!1}_a.M.a("MailComposeSave")},X:function(n){var t=null;_db.f.isInstanceOfType(n)&&n.O?t=n.O.correlationId:_mco.b.isInstanceOfType(n)&&n.O&&(t=n.O.correlationId);return t},F:function(n,t){var i=new _a.o;i.b("Ctx",n||"");i.b("Err",t||"");return i.toString()},bC:function(n){var t=this.bi.a.bb;t.ff(this.z);if(this.q){t.fG(!0);this.q=!1;_j.e.a(_a.a.a,"Explicit save recorded. ContextId={0}",t.b())}if(_mco.a.isInstanceOfType(n)){var u=n;var r=u.D;u.j.bN(r);t.L(r);t.dJ(u.j);_j.e.a(_a.a.a,"Updated context from create action. Context:{0}",t.toString());this.G.E(r)}else if(_mco.b.isInstanceOfType(n)){var i=n;var o=i.bk;i.g.bN(o);t.L(o);t.dJ(i.g);_j.e.a(_a.a.a,"Updated context from update action. Context:{0}",t)}else if(_mco.d.isInstanceOfType(n)){var a=n;var l=a.D;t.L(l);_j.e.a(_a.a.a,"Updated context from create response action. Context:{0}",t)}else if(_mcp.C.isInstanceOfType(n)){var v=n;var p=v.c.g();t.L(p);_j.e.a(_a.a.a,"Updated context from create response from modern group action. Context:{0}",t)}else if(_mcp.L.isInstanceOfType(n)){var y=n;var h=y.D;t.L(h);_j.e.a(_a.a.a,"Updated context from create approval response action. Context:{0}",t)}if(_db.f.isInstanceOfType(n)&&t.U()){var c=n;var e=c.bT;var f=t.U().cW();if(e&&f){var s=0;var w=this;f.p(function(n){var t=n;t.f(e[s]);s++});_j.e.a(_a.a.a,"Attachment IDs have been updated.")}}},bb:function(){this.bh.bp().a(this.bh,!1);_j.e.a(_a.a.a,"Navigated away from compose")}};_mcp.s=function(n,t){this.k=Function.createDelegate(this,this.q);this.j=Function.createDelegate(this,this.v);this.i=Function.createDelegate(this,this.u);_mcp.s.initializeBase(this,[18,n]);this.e=t.c()};_mcp.s.a=function(n,t){return new _fm.d(n,null,t,!0)};_mcp.s.prototype={e:!1,h:0,a:function(){return this.ev(_mcp.s.c)},p:function(n){this.eu(_mcp.s.c,n);return n},n:function(){var t=!1;if(this.e){var n=_g.a.a();var i=n.c().bj.UserEmailAddress;t=i.toLowerCase().startsWith("outlook_"+n.bj.HexCID)}return t},g:function(){if(!this.a()){var n=this.e?[_mcp.s.a(_u.R.NA,null)]:this.m(_fm.d,_mcp.s.a);if(n){this.p(new _fm.f(n));this.a().bJ(new _j.g(this.i,this.bk()));this.a().u=this.j}}_mcp.G.prototype.g.call(this)},b:function(n){if(n&&n.Mailbox){var r=n.Mailbox.EmailAddress;if(r!==_g.a.a().c().bj.UserEmailAddress&&!_mco.a.f(n)){var t=_g.a.a().a().R();if(t){if(t.g(r))return;t.b()===1&&t.a(0)===""&&t.p(0)}var i=new _a.j;i.c(r);i.y(t);i.b()>_mcp.s.b&&i.p(i.b()-1);_g.a.a().a().bD(i);_h.f.a(_g.a.a().a().v,_a.g.a);this.s(r)}}},c:function(n,t){t.val=null;var r=_g.a.a().c().bj.UserEmailAddress;if(this.n()&&n===r){var i=this.o(r);t.val=i.length>0?i[0]:t.val}return!_j.i.a(t.val)},br:function(){if(this.a()){this.a().dispose();this.p(null)}_mcp.G.prototype.br.call(this)},v:function(){if(this.e&&!this.h){this.h=1;_j.o.a().a(this.bk(),"SendAsContextMenu",this.k,2e3);var n=new _mcp.br;var i=this,r=this,t=this;this.bh.bq.a(n,function(t){_g.a.a().c().i(new _a.j(n.c));_g.a.a().c().h(new _a.j(n.g));_g.a.a().c().l(new _a.j(n.i))},function(n){_j.e.b(_a.a.a,"Fail to load alias list for consumer, use the alias list in userConfiguration instead.")},function(n){t.q()})}},s:function(n){if(!this.e&&this.a()){for(var r=_mcp.s.a(n,new _j.g(this.f(n),this.bk())),t=this.a().p,i=t.x.length-1;i>0;i--)if(_fm.i.isInstanceOfType(t.x[i])){t.t(i+1,r);var u=t.x.length-i-1;u>_mcp.s.b&&t.o(t.x.length-1);return}t.a(new _fm.i);t.a(r)}},u:function(){if(this.a()&&this.a().t){var f=this.a().t;var r=_g.a.a().a().R();var e=r.l(f.m);if(e){for(var n=this.a().p,t=n.x.length-1;t>0;t--)if(n.x[t].m===f.m){n.o(t);var u=n.x.length;_fm.i.isInstanceOfType(n.x[u-1])&&n.o(u-1);break}var i=new _a.j;r.b()>0?i.y(r):i.c("");_g.a.a().a().bD(i);_h.f.a(_g.a.a().a().v,_a.g.a)}}},m:function(n,t){var i=new _j.q;var r=_g.a.a().c().bj.UserEmailAddress;this.n()||i.c(t(r,new _j.g(this.f(r),this.bk())));if(this.e){var e;this.r(e={val:i},t,r),i=e.val;var o;this.l(o={val:i},t),i=o.val}else{var u;this.l(u={val:i},t),i=u.val;var f;this.t(f={val:i},t),i=f.val}return i.j()},l:function(n,t){for(var u,r=_g.a.a().c().e(),f=r?r.b():0,i=0;i<f;i++){u=r.a(i).EmailAddress;n.val.c(t(u,new _j.g(this.f(u),this.bk())))}},r:function(n,t,i){for(var e=this.o(i),u=e,o=u.length,r=0;r<o;++r){var f=u[r];n.val.c(t(f,new _j.g(this.f(f),this.bk())))}},o:function(n){var o=new _a.j;if(this.e){for(var f,e,u=_g.a.a().c().b(),s=u?u.b():0,t=_g.a.a().c().a(),h=t?t.b():0,i=0;i<s;i++){f=u.a(i);n!==f&&o.c(f)}for(var r=0;r<h;r++){e=t.a(r);n!==e&&o.c(e)}}return o.f()},t:function(n,t){var i=_g.a.a().a().R();var r=i?i.b():0;if(r===1&&i.a(0)===""){i.p(0);r=0}if(r>0){var f;n.val.c(new _fm.i);for(var u=0;u<r;u++){f=i.a(u);n.val.c(t(f,new _j.g(this.f(f),this.bk())))}}},f:function(n){var t=this;return function(){_j.e.a(_a.a.a,"User chose from={0}",n);t.bi.a.bd().M(n,!0)}},q:function(){if(this.h===1&&!this.bo()){this.h=2;var n=this.m(_fm.d,_mcp.s.a);if(n&&this.a()&&this.a().p){this.a().p.f();this.a().p.m(n)}}}};_mcp.t=function(n,t,i,r,u){this.bl=Function.createDelegate(this,this.ck);this.bs=Function.createDelegate(this,this.cq);this.bA=Function.createDelegate(this,this.cw);this.bp=Function.createDelegate(this,this.cp);this.E=Function.createDelegate(this,this.co);this.N=Function.createDelegate(this,this.cn);this.be=Function.createDelegate(this,this.G);this.bf=Function.createDelegate(this,this.bQ);this.bg=Function.createDelegate(this,this.bR);this.bB=Function.createDelegate(this,this.cz);this.bC=Function.createDelegate(this,this.cA);this.bn=Function.createDelegate(this,this.bW);this.D=Function.createDelegate(this,this.cb);this.bm=Function.createDelegate(this,this.Y);this.by=Function.createDelegate(this,this.cu);this.bx=Function.createDelegate(this,this.ct);this.bw=Function.createDelegate(this,this.cs);this.bv=Function.createDelegate(this,this.cr);this.bz=Function.createDelegate(this,this.cv);_mcp.t.initializeBase(this,[7,n]);this.o=new _j.g(this.bz,this.bk());this.J=new _j.g(this.bv,this.bk());this.K=new _j.g(this.bw,this.bk());this.C=new _j.g(this.bx,this.bk());this.z=new _j.g(this.by,this.bk());this.W=n.a.bO;this.bM=t;this.A=i;this.s=u};_mcp.t.prototype={W:null,bM:null,A:null,s:null,R:null,Q:null,y:!1,I:null,r:null,t:null,w:null,T:!1,bb:!1,p:null,o:null,z:null,K:null,J:null,C:null,v:0,f:function(){return this.p?this.p.c():null},a:function(){return this.o},b:function(n){this.o=n;return n},n:function(){return this.K},j:function(){return this.J},F:!1,m:function(){return this.F},c:function(){return this.y},x:function(n){if(n!==this.y){this.y=n;this.bq("IsSending");var t=this.bi.a;t.eH(this.y);t.eL(_u.P.O);t.eJ(this.y)}return n},h:function(){return this.P()&&this.bb},u:0,l:function(){return this.u},P:function(){var n=!this.bj.a()&&this.bj.eN;return _g.a.a().bj.AsyncSendEnabled&&this.bh.bv.a()==="Mouse"&&!this.bh.bs()&&!this.bj.I()&&!!this.bh.bS&&!!this.bh.bZ&&this.bj.l()!==3&&!n},ci:function(){return!!this.A&&this.A.a().b().Enabled},i:function(){return this.t},ba:function(){if(this.bh.cv()&&!this.p){_j.e.a(_a.a.a,"Setting send component override");this.p=this.bh.cu().e();var n=this.bh.bd();var s=this.bh.be();var f=n,e=n,o=n,i=n,t=n,u=s,r=s;this.p.d(this.bh.u(),this.bm,this.D,this.bn,this.bC,this.bB,this.bg,this.bf,this.bh.bq,this.bi.a.bY,f.t||(f.t=Function.createDelegate(f,f.s)),this.dD,this.be,e.j||(e.j=Function.createDelegate(e,e.e)),o.i||(o.i=Function.createDelegate(o,o.E)),i.h||(i.h=Function.createDelegate(i,i.D)),t.k||(t.k=Function.createDelegate(t,t.f)),u.e||(u.e=Function.createDelegate(u,u.l)),r.f||(r.f=Function.createDelegate(r,r.n)),_zz.d.d,this.cI);this.bq("InvalidRecipientsDialogViewModel")}},Z:function(){if(this.p){this.p.a();this.p=null;this.bq("InvalidRecipientsDialogViewModel")}},g:function(){this.ba();var n=this.bh.bd();if(n){n.J(this.N);n.I(this.D);n.T(this.N);n.S(this.D)}_mcp.G.prototype.g.call(this)},e:function(){_j.e.a(_a.a.a,"ResumeSend() called by external mail-compose component.");this.Y()},Y:function(){var i=this.bh;var n=this.bj;var t=i.bm();i.cY().e();i.ea().a();if(t.c()){t.l(!0);_j.e.a(_a.a.a,"Send deferred due to in progress save.")}if(n.i()||n.h()||n.J()){if(!t.h()){this.bh.bd().f();_j.e.a(_a.a.a,"Send without pending saves, context:{0}; OriParentFolderId={1}",n,n.d()&&n.d().bj.ParentFolderId&&_g.b.a?_g.b.a.idToName(n.d().bj.ParentFolderId):"null");this.S()}}else{var r=n.b();_j.e.a(_a.a.a,"Send was attempted during upgrade for context {0}, keeping the IsSending state and waiting for upgrade to finish. Upgrade component will resume send.",r)}},S:function(){var t=this.bh;var r=this.bj;var n=t.bT.h(t,1);_j.e.a(_a.a.a,"Submitting send action");var i=_g.k.a;_bc.m.isInstanceOfType(i)?_mco.b.isInstanceOfType(n)?n.bY(this.E):_mco.a.isInstanceOfType(n)&&n.bA(this.E):this.bT();t.bq.a(n,this.bR(),this.bQ(),this.bp);_j.e.a(_a.a.a,"Send action submitted")},br:function(){this.bh.bd().J(this.N);this.bh.bd().I(this.D);var r;_a.i.a(r={val:this.o}),this.o=r.val;var u;_a.i.a(u={val:this.z}),this.z=u.val;var i;_a.i.a(i={val:this.J}),this.J=i.val;var n;_a.i.a(n={val:this.K}),this.K=n.val;var t;_a.i.a(t={val:this.C}),this.C=t.val;this.x(!1);this.Z();this.R=null;this.Q=null;_mcp.G.prototype.br.call(this)},cb:function(){var i=this.bi.a.bc;var t=this.bh.bd();var n=null;this.x(!1);if(t.p()){this.O();n="InvalidRecipients";this.s.a(_a.V,new _a.V(_u.R.TZ,!1))}if(t.q()){this.O();n="InvalidSendAddress"}this.bh.bf();this.k();n=n||"CancelSend_UnknownError";this.q(n,null,null)},k:function(){var n=this;_j.o.a().a(_a.a.a,"ExitResolvingRecipientsMode",function(){n.F=!1},2e3)},cx:function(n){var t;var i=_a.b.l(n.F);if(i==="ErrorSendAsDenied")t=80;else{var u,r;i==="ErrorRightsManagementPermanentException"&&(r=this.cB(n.F,u={val:t}),t=u.val,r)||(t=i==="ErrorSubmissionQuotaExceeded"?47:i==="ErrorAccountSuspend"?90:i==="ErrorExceededMaxRecipientLimit"?91:i==="ErrorExceededMessageLimit"?92:i==="ErrorMessageBlocked"?93:i==="ErrorMessageSubmissionBlocked"?94:i==="ErrorAccountSuspendShowTierUpgrade"?98:i==="ErrorExceededMaxRecipientLimitShowTierUpgrade"?99:i==="ErrorExceededMessageLimitShowTierUpgrade"?100:_db.i.c(n.F,45,55,62,700,88,89,46,58))}return t},bR:function(){return this.R||this.bA},bQ:function(){return this.Q||this.bs},cA:function(n){this.R=n},cz:function(n){this.Q=n},cB:function(n,t){var u=n.MessageXml;if(u)for(var f=Sys.Net.XMLDOM(u),r=0;r<f.firstChild.childNodes.length;r++){var i=f.firstChild.childNodes[r];if(i.nodeType===1&&_a.X.b(i)==="Value"&&_a.X.c(i,"Name")==="HResult"&&-2147168383===Number.parseInvariant(_a.X.a(i))){t.val=48;return!0}}t.val=-1;return!1},cr:function(){if(this.o.b){this.v=this.X()?2:0;this.o.a()}},cs:function(){if(this.o.b){this.v=this.X()?1:0;this.o.a()}},ct:function(){if(this.o.b){this.v=this.X()?3:0;this.o.a()}},X:function(){return _y.c.a.a()==="Mouse"&&!!this.A&&this.A.a().f().Enabled},cv:function(){if(this.p&&!this.p.e()){_j.e.a(_a.a.a,"saveComponentOverride.IsReadyForSmimeOperation() == false. Exiting SendStart().");return}_a.M.b(_a.a.a,"MailComposeSend",5);this.T=!0;this.r=_y.j.b(_a.a.a,"MailComposeSend",!0);if(this.v){this.bh.bk().a(_mcp.bf.toString(this.v));this.v=0}(_mcp.i.isInstanceOfType(this.bh)||IGroupInlineComposeViewModel.isInstanceOfType(this.bh))&&this.bj.gT(!0);if(this.P()){this.t=_y.j.b(_a.a.a,"MailComposeSendAsync",!0);if(IGroupInlineComposeViewModel.isInstanceOfType(this.bh)){var n=this.bh;_g.j.isInstanceOfType(this.bj.d())&&n.b()&&(this.w=_y.j.b(_a.a.a,"MailComposeSendAsyncQuickQuickness",!0))}}_j.e.a(_a.a.a,"SendStart:Context:{0}",this.bj);this.cf();this.bj.s()?this.p.f():this.bW();this.bh.bk().a("Send")},bW:function(){_j.e.a(_a.a.a,"User chose to send, start force resolve recipients");this.F=!0;this.bh.bd().be(!0)},cn:function(){if(this.y){_j.e.a(_a.a.a,"Skip send since another send is in progress");return}this.x(!0);this.F=!1;_j.o.a().j(_a.a.a,"MailComposeSend");_j.e.a(_a.a.a,"Started new task runner context before starting send.");var r=!0;try{var n;var i,t;(t=this.cm(i={val:n}),n=i.val,t)?n?_j.e.a(_a.a.a,"waiting for a pending validation decision, once decided, send will resume"):this.bc():this.x(!1);r=!1}finally{if(r){this.x(!1);_j.e.b(_a.a.a,"Send failed due to an unhandled exception thrown before the action was submitted");this.G("SendFailure_UnhandledException",null,null)}}},bc:function(){_mco.i.a(this.bh.bc,"compose");this.bj.gk(!1);if(this.bh.bb.bi()){this.bj.cD(new _cmc.A);this.bj.gV(_cmc.A.a(this.bj.df()))}if(this.p)this.p.b();else{this.Y();if(this.P()&&!this.bj.dk()){var n=this.bE();if(!n){_j.e.a(_a.a.a,"Navigating away after submitting action for send via notification");this.bj.gk(!0);this.bb=!0;this.bU();this.bT();this.bV()}}}},bV:function(){this.bN()},bN:function(){var n=this;this.bh.bS.a(function(){n.s.a(ISendEvent,new _mcp.bo(n.bh))})},bE:function(){var n=!1;if(this.bh.bZ.c()){var i=this;this.bh.bZ.a(function(t){t.a()>0&&(n=!0)})}if(!n&&this.bh.bS.c()){var t=this;this.bh.bS.a(function(t){t.a()>0&&(n=!0)})}return n},bT:function(){if(IGroupInlineComposeViewModel.isInstanceOfType(this.bh)&&_g.j.isInstanceOfType(this.bj.d())&&this.bj.cr()){var n=this.bh;if(n.b()&&n.g()){var u=this.bj.d();var r=_cmc.m.b(n.b().bj,n.g(),this.bj.k()||this.bj.bt(),this.bj.bt(),"sentitems");var f="MC:"+r.InternetMessageId;this.s.a(_a.bW,new _a.bW(f,this.bj));_h.c.z(r,u.bj.InternetMessageId,n.q()?u:null);var i="OMC:"+n.b().bj.ConversationId.Id;var t=n.D().c[i];if(t)t.d.c(n.g().bj.InternetMessageId);else{t=new _cmc.bq(n.g().bj.InternetMessageId);this.s.a(_a.bW,new _a.bW(i,t))}if(this.w){_y.j.a(this.w);this.w=null}}}},cm:function(n){n.val=!1;var h=this.bi;var i=h.a;var t=i.bd();var o=i.be();var s=i.bc;var c=h.b(23);if(this.W.a(i.bb.b())){_j.e.a(_a.a.a,"User had already discarded, skipping send.");this.q("UserAlreadyDiscarded",null,"User has already discarded, skipping send");return!1}else if(t.q()){_j.e.a(_a.a.a,"Not valid to send since sender's address is invalid");s.a(66,null);this.bh.bf();this.q("InvalidSendAddress",null,"Sender's address is invalid, not valid to send");return!1}else if(!i.bb.R()&&t.X()){_j.e.a(_a.a.a,"Not valid to send since no recipients were specified");s.a(70,null);this.bh.bf();this.q("NoRecipients",null,"No recipients were specified, not valid to send");return!1}else if(t.p()){_j.e.a(_a.a.a,"Not valid to send since invalid recipients are present, IsFromRecipientInvalid={0}, HasInvalidRecipients={1}",t.q(),t.p());t.bc();this.O();this.bh.bf();this.q("InvalidRecipients",null,"Invalid recipients are present, not valid to send");return!1}else if(o.b()){_j.e.a(_a.a.a,"Not valid to send since attachment is in progress");var f=i.bl;f.p||f.g(0,_u.R.Di,null,!1,null,null,null,f.z);this.q("AttachmentInProgress",null,"Attachment is in progress, not valid to send");return!1}else if(_g.a.a().bj.MaxRecipientsPerMessage<t.F()){s.a(800,null);this.bh.bf();this.q("MaxRecipients",null,"Max recipients exceeded, not valid to send");return!1}else if(_a.br.a&&c.c()){_j.e.a(_a.a.a,"Not valid to send since policy violation detected");var l=i.bl;l.g(0,c.b(),null,!1,null,null,null,l.z);this.q("PolicyTipViolation",null,"PolicyTip violation detected, not valid to send");return!1}else if(_j.i.a(this.bh.bb.q())&&!this.bj.eN){n.val=!0;var u=i.bl;u.p||u.h(2,[_nbs.a.SI],this.bl,!1,_nbs.a.TK,_nbs.a.IW,_nbs.a.Kf,u.z,null);return!1}else if(o&&o.a()&&this.bh.cW)if(this.I)return this.bD();else{n.val=!0;var r=this;this.bh.cW.a(function(n){r.I=n.a(r.bh.bl,r.o);r.bD()?r.bc():r.x(!1)})}else if(this.bj.I())if(this.bj.E()){_a.F.a(_u.R.Gc,0);this.q("SmimeSendAs",null,"User attempted to send an S/MIME message using the SendAs (From) feature");return!1}else if(t.W()){_a.F.a(_u.n.Mj,0);this.q("SmimeModernGroups",null,"User attempted to send an S/MIME message to modern groups.");return!1}else if(this.bj.p()){var e=new _j.q;var a=this;this.bj.p().p(function(n){_dg.c.isInstanceOfType(n)||_dg.i.isInstanceOfType(n)||_g.A.isInstanceOfType(n)||e.c(n.bj.Name)});if(e.d.length>0){_a.F.a(String.format(_u.n.QC,e.d.join(", ")),0);this.q("SmimeCloudAttachment",null,"User attempted to send an S/MIME message with cloud attachments.");return!1}}return!0},bD:function(){var n=this.bh.be();try{if(this.I.a(this.bh.bb,n.a().a())){this.q("ForgottenAttachment",null,"Forgotten attachment detected, not valid to send");return!1}}catch(t){_j.e.d(_a.a.a,t,"An exception has been caught for FAD check; keep sending",this.I,this.bh.bb,n.a().a())}return!0},cw:function(n){var u=this.bh;var t=this.bj;var i=n.V;_j.e.a(_a.a.a,"Send action succeeded, ContextId={0}; Context:{1}",i,t);this.cy();var r=!1;var o=_g.k.a;_bc.m.isInstanceOfType(o)&&(r=!0);t.bI()&&!r&&this.bh.ct().b(t.k());this.bh.dl()&&this.bh.dl().a(t.eQ);if(t.eR&&t.eR.length>0){var s=this.bi.a.bc;s.a(742,t.eR);_j.e.a(_a.a.a,"Showing infobar message for Bcc forking failed");this.x(!1);u.bq.d(n);this.G(_j.t.d(_bc.E,742),null,null)}else{if(i===t.b()){t.ff(null);if(this.bj.cr()){_j.e.a(_a.a.a,"skip navigating away from compose for send via notification since the navigation was already done at send time, raise send succeeded event instead");var f=this;this.bh.bS.a(function(){f.s.a(ISendSucceededEvent,new _mcp.bY(u))});this.bj.gd()}else{_j.e.a(_a.a.a,"Context match, navigating away from compose at the end of send success. ContextId={0}",i);this.bU()}}else _j.e.a(_a.a.a,"Context does not match, skipping navigating away from compose.");this.cg("MailSendSucceeded");var e=this.bP();this.ce(e)}this.s.a(_a.V,new _a.V(_nbs.a.Ch,!1))},bU:function(){this.bh.bp().a(this.bh,!0)},cq:function(n){var r=this.bi.a;var t=r.bb;var o=n.V;_j.e.a(_a.a.a,"Send action failed, ContextId={0}; Context:{1}",o,t);var i="SendFailure_UnknownError";var u="";if(_g.L.a(n.F)){i=_g.L.b(n.F);u=n.F.FaultMessage}else if(_g.H.isInstanceOfType(n.F)){var e=n.F;i=e.responseCode;u=e.toString()}if(o===t.b()){t.eR&&t.eR.length>0&&this.O();this.x(!1);_j.e.a(_a.a.a,"Context match. Showing infobar message for ResponseCode={0}",i);this.cJ(n);var f=this.cx(n);if(this.bj.cr()){_j.e.a(_a.a.a,"Raise send failed event for send via notification");t.gS(f);var s=this;this.bh.bZ.a(function(){s.s.a(ISendFailedEvent,new _mcp.bX(r))});t.gd()}this.cl(n,f)}else _j.e.a(_a.a.a,"Context does not match. Skip showing infobar message for ResponseCode={0}",i);this.G(i,this.cj(n),u);r.bq.d(n)},cl:function(n,t){switch(t){case 92:case 100:_j.e.b(_a.a.a,"Got Wascl verdict {0}, save a draft to prevent data loss.",t);this.bh.bm().a("AutoSave",null,null,!1);break;case 90:case 98:_mco.a.isInstanceOfType(n)?_mcp.e.b=n.L.Body.AccountRecoveryFlowUrl:_mco.b.isInstanceOfType(n)&&(_mcp.e.b=n.L.Body.AccountRecoveryFlowUrl);_j.e.b(_a.a.a,"Got Wascl verdict {0}, set account recovery flow url to {1}.",t,_mcp.e.b);break;case 91:case 99:case 93:case 94:_j.e.b(_a.a.a,"Got Wascl verdict {0}.",t);break}},O:function(){var n=this.bi.a.bc;var t=this.bi.a.bd();if(this.ci()){n.b(97);n.a(97,t.Y())}else n.a(65,null)},cp:function(n){this.bK();this.cc()},cj:function(n){var t=null;_db.f.isInstanceOfType(n)&&n.O?t=n.O.correlationId:_mco.b.isInstanceOfType(n)&&n.O&&(t=n.O.correlationId);return t},cu:function(){if(this.bi.a.dk()&&this.o.b){this.v=0;this.o.a()}},cy:function(){var t=this.bh.bd();var n=this.bh.be();_j.e.a(_a.a.a,"Check to see if we have attachments to set permissions for");n.a()&&n.a().v()&&n.a().bt(t.C())},bP:function(){var t;if(this.bj){var u=this.bj.j()==="HTML"?"html":"text";var i;i=this.bj.a()===1||this.bj.a()===2||this.bj.a()===3?this.bj.i()?"yes":"no":"na";var n=new _a.o;n.b("BT",u);n.b("U",i);this.bj.eZ!==-1&&n.a("S",this.bj.eZ);n.a("O",this.bj.a());n.a("M",this.bj.l());n.a("D",this.u);_j.i.a(this.bj.fd)||n.b("P",this.bj.fd);this.bh&&this.bj.eN&&n.b("CS",this.bh.L());t=n.toString();if(this.bh&&this.bh.be()&&this.bh.be().a()){var r=this.bh.be().a().bQ();_j.i.a(r)||(t+="|"+r)}}else t=null;return t},G:function(n,t,i){var r=this.bP();if(this.r){_j.i.a(i)||(this.r.m=i);_y.j.a(this.r,null,n,t,r);this.r=null}if(this.t){_j.i.a(i)||(this.t.m=i);_y.j.a(this.t,null,n,t,r);this.t=null}this.bJ(n,t,r);this.bK()},ce:function(n){if(this.r){_y.j.a(this.r,null,null,null,n);this.r=null}this.bJ(null,null,n)},bK:function(){if(this.T){_a.M.a("MailComposeSend");this.T=!1}},q:function(n,t,i){if(this.r){this.r.q="MailComposeInvalidToSend";this.r.o(new _a.bg(this.bh.L()))}if(this.t){this.t.q="MailComposeInvalidToSend";this.t.o(new _a.bg(this.bh.L()))}this.G(n,t,i)},cc:function(){this.bh.bd().u("Send")},bJ:function(n,t,i){if(this.w){if(this.bj.cr()){_j.e.c(this.bk(),"Quick quickness should have been enabled during async send.");i+="|ErrorNoQuickQuicknessForAsyncSend"}else i+="|NoQuickQuicknessForSyncSend";_y.j.a(this.w,null,n,t,i);this.w=null}},ck:function(n,t){n?this.bc():this.q("NoSubject",null,'No subject was specified, and user chose "Don\'t Send"')},co:function(n){_mco.a.isInstanceOfType(n)&&n.bz(this.E);_mco.b.isInstanceOfType(n)&&n.bV(this.E);if(this.bi&&this.bi.a){var t=this.bi.a.bb;t&&t.bI()&&this.bh.ct().b(t.k())}}};_mcp.bO=function(n,t){_mcp.bO.initializeBase(this,[21,n]);this.a=t};_mcp.bO.prototype={a:null,g:function(){if(!this.d()&&this.a.a().a().e()===2&&this.a.m().a().a()){var n=this.bi.b(5);n&&n.a()&&n.c(!1)&&n.a().bB()}_mcp.G.prototype.g.call(this)}};_mcp.p=function(n,t,i,r,u){this.p=Function.createDelegate(this,this.C);this.s=Function.createDelegate(this,this.D);this.w=Function.createDelegate(this,this.z);_mcp.p.initializeBase(this,[11,n,i,r]);this.e=new _j.g(this.w,this.bk());this.u=t;this.o=_a.k.a();this.j=_a.bk.a();this.c=u};_mcp.p.a=function(n,t){return t?n.bj.SignatureHtml:n.bj.SignatureText};_mcp.p.prototype={u:null,c:null,e:null,k:null,f:null,v:!0,r:!0,o:null,j:null,i:null,n:null,m:null,h:!1,b:function(){return this.q()?this.f:this.k},a:function(){return this.bj.fA()&&!this.bj.dk()&&this.A()&&!this.x()?!0:!1},x:function(){return this.q()?this.v:this.r},q:function(){return this.bj.j()==="HTML"&&this.u.b()},g:function(){var n=_g.a.a().a();n.apcl("SignatureText",this.s);if(!this.d()){this.t();!this.c||this.f||this.k||this.c.apcl("CurrentStatus",this.p);_mcp.o.prototype.g.call(this)}},t:function(){var u=_g.a.a().a();var i=this.y(u,!0);if(_j.i.a(i)){_j.e.a(_a.a.a,"No html signature.");this.f=null}else{var e=String.format('<{0} id="{1}">',"DIV","Signature");var f=String.format("</{0}>","DIV");var n=_mcp.p.f+e+i.replace(_mcp.p.e," ")+f;_j.e.a(_a.a.a,"Computed html signature. OriSig={0}, FormattedSig={1}",i,n);n=this.F(n);n=this.E(n);this.f=n}var t=this.y(u,!1);if(_j.i.a(t)){_j.e.a(_a.a.a,"No plain text signature.");this.k=null}else{var r="\n"+t;_j.e.a(_a.a.a,"Computed plain text signature. OriSig={0}, FormattedSig={1}",t,r);this.k=r}this.G()},br:function(){var n;_a.i.a(n={val:this.e}),this.e=n.val;var t=_g.a.a().a();t.rpcl("SignatureText",this.s);this.c&&this.c.rpcl("CurrentStatus",this.p);_mcp.o.prototype.br.call(this)},bP:function(){if(!this.bh.bn()){this.i=new _fm.d(_nbs.a.Bz,null,this.e);this.i.w(_nbs.a.Bz);this.i.a(!this.l());return[this.i]}return null},bN:function(){this.n=_mcp.o.a(this.e,_nbs.a.Bz);this.n.a(this.l());return[this.n]},bK:function(){if(!_a.g.b){this.m=new _y.h(_nbs.a.Bz,this.e);this.h=!1;if(this.l()){this.h=!0;return[this.m]}}return null},bZ:function(){this.i&&this.i.a(!this.l())},bY:function(){this.n&&this.n.a(this.l())},cy:function(){var n=this.bh.dX;if(n&&this.m)if(this.h&&!this.l()){n.s(this.m);this.h=!1}else if(!this.h&&this.l()){n.x(this.m);this.h=!0}},A:function(){var t=_g.a.a().a();if("Mouse"===_y.c.a.a()){var n=this.bj.a();var i=1===n||2===n||3===n||12===n;return i?t.bj.AutoAddSignatureOnReply:t.bj.AutoAddSignature}return this.o.c()?this.j.b("MOWA.IsSignatureChanged")==="true"?this.j.b("MOWA.AutoAddSignature")==="true":!0:t.bj.AutoAddSignatureOnMobile},y:function(n,t){if("Mouse"===_y.c.a.a())return _mcp.p.a(n,t);if(this.o.c()){if(this.j.b("MOWA.IsSignatureChanged")==="true")if(this.j.b("MOWA.UseDesktopSignature")==="true")return _mcp.p.a(n,t);else{var r=this.j.b("MOWA.SignatureText")||"";return t?_a.y.b(r):r}return t?_a.y.b(_mcp.S.a(this.o)):_mcp.S.a(this.o)}if(n.bj.UseDesktopSignature)return _mcp.p.a(n,t);else{var i=n.bj.SignatureTextOnMobile||"";return t?_a.y.b(i):i}},l:function(){var n="Mouse"===_y.c.a.a()||_g.a.a().a().bj.UseDesktopSignature;return n?!this.x():!_j.i.b(_g.a.a().a().bj.SignatureTextOnMobile)},z:function(){var i=this.bi.a.bb;var r=_g.a.a().a();i.cH(!0);var t=!_j.i.a(this.b());if(t){var n=new _cmc.h(0,this.b(),this.q());n.p=!0;n.m=!1;this.bh.bK().a(n)}else _j.e.a(_a.a.a,"Skip insert signature due to HasSignature={0};",t)},C:function(n,t){this.c.rpcl("CurrentStatus",this.p);if(this.c.a===2){this.t();this.bv();if(this.bj.eX&&this.a()){var i=new _cmc.h(2,this.b(),this.q());i.p=!0;this.bj.cD(i)}}},F:function(n){return n.replace(_mcp.p.c,'<img class="'+_mcp.p.d+'" '+"$2"+"$3")},E:function(n){var e=n.match(_mcp.p.b);if(!e)return n;for(var u=$("<div>"),o=e,s=o.length,i=0;i<s;++i){var f=o[i];u.html(f+"</a>");var r=u.find("a");r&&r.length===1&&(r[0].id="LPNoLP");var t=u.html();t=t.substr(0,t.length-4);n=n.replace(f,t)}return n},D:function(n,t){this.t();this.bv()},G:function(){var n=new RegExp("^\n{1,5}$");this.r=!this.k||!this.k.search(n);this.v=!this.f||this.r&&this.f.indexOf("<img")===-1}};_mcp.bP=function(n,t){this.u=Function.createDelegate(this,this.s);this.t=Function.createDelegate(this,this.r);this.v=Function.createDelegate(this,this.F);this.w=Function.createDelegate(this,this.z);_mcp.bP.initializeBase(this,[10,n]);this.m=new _j.g(this.w,this.bk());this.q=t};_mcp.bP.prototype={q:null,m:null,l:null,o:!1,p:!1,a:function(){return this.m},h:function(){return this.l},G:function(n){if(n!==this.l){this.l=n;this.bq("CloseConfirmDialogButtonData")}return n},i:function(){return this.o},k:function(n){if(n!==this.o){this.o=n;this.bq("IsCloseConfirmDialogShown")}return n},f:function(){return this.p},I:function(n){if(n!==this.p){this.p=n;this.bq("IsAppBarSetup")}return n},b:function(){_j.e.a(_a.a.a,"Setup appbar menu. Context: {0}",this.bj);if(!this.cd){var n=new _j.q;this.n(n,11);this.n(n,1);this.n(n,28);this.n(n,6);this.n(n,3);this.n(n,9);this.bh.dX.f(n.d);this.I(!0)}},g:function(){_j.e.a(_a.a.a,"InitTouchComponent:Context:{0}",this.bj);this.bh.bv.a()==="TouchNarrow"?this.E():this.bh.dX||this.A();this.bi.b(21);_mcp.G.prototype.g.call(this)},j:function(n,t,i){if(this.bh.bJ)return!1;else if(this.bh.br().j()){this.o||this.z();return!0}else if(this.bh.bb.bl()&&!this.x()){_j.e.a(_a.a.a,"Removing unedited reply forward draft if user clicks outside the form.");this.r();return!0}else{this.bh.R(!0);return!1}},br:function(){var t;_a.i.a(t={val:this.m}),this.m=t.val;if(this.l){this.l.f();this.l=null}var n;_a.i.a(n={val:this.l}),this.l=n.val;_mcp.G.prototype.br.call(this)},C:function(){return _a.g.b?null:new _y.f(_y.b.be(),_y.b.bf(),_u.P.j,this.bh.bz().h())},x:function(){return this.bh.bh().c()},A:function(){var e=new _y.f(_y.b.z(),_y.b.A(),_u.P.Y,this.bh.bh().a());var o=_y.f.a(_nbs.a.EN,this.m);var u=this.C();var r=this.D();var i=2;i+=u?1:0;i+=r?1:0;var n=new Array(i);var t=0;n[t++]=e;u&&(n[t++]=u);n[t++]=o;r&&(n[t++]=r);_j.e.a(_a.a.a,"Creating appbar. ContextId={0}",this.bj.b());var f=_y.k.a(this.bh,n,null);f.M("TouchNarrow"===_y.c.a.a());this.bh.fe(f)},E:function(){var t=this.q;if(t){var n=t.b();if(_a.k.a().b()){n.c(2);n.d(_nbs.a.Yv);n.a(t.a(_fm.a.b,_fm.a.b,this.m,_u.R.Mc));n.b(t.a(_fm.a.b,_fm.a.b,this.bh.bh().a(),_u.n.Re));n.g().a(!0)}else{n.c(1);n.d(_nbs.a.QJ);n.a(t.a(_y.b.a(),_y.b.a(),this.m,""));n.i(t.a(_fm.a.h,_fm.a.h,null,""));n.h(this.bh.bD().a());var i=this.bh.be().m();if(i&&i.d.length>0){if(i.d.length>1){n.b(t.a(_y.b.B(),_y.b.B(),null,""));n.l(new _fm.f(i.d))}else{var r=i.d[0].l;n.b(t.a(_y.b.B(),_y.b.B(),r,""))}n.f(t.a(_y.b.p(),_y.b.p(),this.bh.bh().a(),""))}else n.b(t.a(_y.b.p(),_y.b.p(),this.bh.bh().a(),""))}this.bh.ff(n)}},z:function(){_j.e.a(_a.a.a,"User hit close, decide whether to show the confirm dialog. Context:{0}",this.bj);if(this.x()){_j.e.a(_a.a.a,"Skipping close since send is in progress. This is considered a corner case since going to local store should be quick. If this occurs frequently, an UX solution is needed.");return}if(this.bh.br().j()){this.J();_j.e.a(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to show the dialog.");this.k(!0)}else if(this.bj.bl()){_j.e.a(_a.a.a,"Removing unedited reply forward draft on close.");this.r()}else{_j.e.a(_a.a.a,"Navigate away due to unmodified message.");this.y()}},s:function(){_j.e.a(_a.a.a,"Hide close confirm dialog");this.k(!1)},J:function(){if(!this.l){_j.e.a(_a.a.a,"Create close confirm dialog.");var n=new _j.k;_a.g.b||n.a(new _ff.d(new _j.g(this.v,this.bk()),_u.P.f,_nbs.a.pL,!0));n.a(new _ff.d(new _j.g(this.t,this.bk()),_u.n.Ku,_u.n.LS,_a.g.b));n.a(new _ff.d(new _j.g(this.u,this.bk()),_bcs.D.A,_u.n.LI));this.G(n)}},F:function(){_j.e.a(_a.a.a,"User select save and close");this.s();this.bh.bm().j().a()},r:function(){_j.e.a(_a.a.a,"User select discard and close");this.s();this.bh.br().k();this.y()},y:function(){this.bh.bp().a(this.bh,!1)},D:function(){if(this.bj.W())return null;var n=new _j.q;var o=this.bh.be();var t=o.t();if(t&&t.length>0)for(var r=t,e=r.length,i=0;i<e;++i){var u=r[i];n.c(u)}if(n.d.length===1){var f=n.d[0];return new _y.f(_y.b.O(),_y.b.P(),_u.P.R,f.a())}else return new _y.f(_y.b.O(),_y.b.P(),_u.P.R,null,n.d)},n:function(n,t){var r=null;var i=this.bi.b(t);if(i&&IMailComposeContextMenuProvider.isInstanceOfType(i)){_j.e.a(_a.a.a,"Getting app-bar items for type '{0}', IsInitialized = {1}",Object.getType(i).getName(),i.d());i.d()||i.g();r=i;n.h(r.O())}}};_mcp.N=function(n,t,i){this.J=Function.createDelegate(this,this.V);this.G=Function.createDelegate(this,this.P);this.D=Function.createDelegate(this,this.K);this.I=Function.createDelegate(this,this.T);this.E=Function.createDelegate(this,this.Q);this.s=Function.createDelegate(this,this.L);this.F=Function.createDelegate(this,this.x);_mcp.N.initializeBase(this,[12,n]);this.t=this.bi.a.bO;this.m=t;this.O=i};_mcp.N.a=function(n){if(n&&!n.eK){n.bc.b(3440);n.bc.a(3440,null);n.bf()}};_mcp.N.prototype={t:null,m:null,O:null,w:null,o:null,n:null,A:null,z:null,C:null,q:null,l:null,a:function(){this.q||(this.q=new _j.g(this.F,_a.a.a));return this.q},f:function(){return this.j()&&!this.bj.bk()},c:function(){var n=this.bj;return this.j()&&n.bk()&&!this.l&&!n.J()},j:function(){return this.i()&&this.bh.bn()&&!this.bj.I()},i:function(){var n=this.bj.a();return n===1||n===2||n===3},b:function(){return this.f()||this.c()},p:null,e:function(){return this.p},k:function(n){this.p=n;return n},g:function(){if(this.j()){var n=this.bh.bb;if(n.bk()&&n.J()){_j.e.a(_a.a.bc,"initializing upgrade component, user requested upgrade and upgrade failed, show the failure message");this.y();this.bh.bf()}}_mcp.G.prototype.g.call(this)},h:function(){_a.M.b(_a.a.a,"MailComposeUpgrade",3);this.o=_y.j.b(_a.a.a,"MailComposeUpgrade",!0);this.p=_y.j.b(_a.a.a,"MailComposeQuoteBody",!0);var r=this.bi.a;var n=r.bb;var u=n.b();this.w=u;if(!n.i()){if(!this.j()){var e=this;_j.o.a().a(_a.a.a,"ShowUpgradeMessage",function(){n.i()||n.J()||u!==e.w||_mcp.N.a(r)},5e3)}var t;t=this.m.b()||n.j()!=="HTML"?n.j()==="Text"?_h.b.q():_h.b.f():_h.b.K();if(t===_h.b.f()||t===_h.b.K()){t.BlockExternalImages=n.d().bj.HasBlockedImages;t.FilterHtmlContent=n.d().bj.HasBlockedImages}var i=r.bT.d(n,t);n.a()===12&&i.u(new _g.E(new _g.r("internalsubmission")));i.j(this.s);_j.e.a(_a.a.bc,"Begin upgrade, context:{0}; OriParentFolderId={1}",n,n.d()&&n.d().bj.ParentFolderId&&_g.b.a?_g.b.a.idToName(n.d().bj.ParentFolderId):"null");i.m("MailComposeUpgrade");if(n.bh()){var f=new _mcp.C(i);r.bq.a(f,this.E,this.I,null)}else r.bq.a(i,this.D,this.G,null)}},br:function(){var n;_a.i.a(n={val:this.q}),this.q=n.val;_mcp.G.prototype.br.call(this)},Q:function(n){var t=n;this.K(t.c)},T:function(n){var i=n;var t=i.c;t.x(this.s);this.P(t)},K:function(n){if(this.bo()){_j.e.a(_a.a.a,"MailComposeUpgradeComponent.CheckSystemUpgrade: viewModel is null or disposing, aborting logic.");return}var e=this.bh;var r=e.bb;var t=n;var h=e.br();var f=t.D;var i=n.h();var s=t.O?t.O.correlationId:null;var c=!!t.bi;if(this.t.a(i)){_j.e.a(_a.a.bc,"Check upgrade callback, resume discard for context {0}",i);h.e(i,f)}else if(i===r.b()){r.L(f);_j.e.a(_a.a.bc,"Context match, updated the draft id. Context:{0}; ResponseMessageBodyType={1}",r,c&&t.bi.I()?t.bi.I().a():"null");var u=e.bm();var o=e.bh();if(!u.c()&&o.c()){_j.e.a(_a.a.bc,"Skipping upgrade for contextId {0} since send was triggered during upgrade",i);this.r("SkipUpgrade",s,"Skip upgrade since send is in progress");o.e();return}if(u.c()&&u.h()){_j.e.a(_a.a.bc,"Skipping upgrade for contextId {0} since save and then send was triggered during upgrade",i);this.r("SkipUpgrade",s,"SkipUpgrade since saving is in progress");u.i();return}}if(t.bi){_j.e.a(_a.a.bc,"Check upgrade, action has response message, call complete upgrade. context:{0}; ActionItemId={1}",r,_h.ba.a(f));this.L(n)}else if(n.h()===r.b()){_j.e.a(_a.a.bc,"Check upgrade: action has id only, updated draft id. context:{0}; ActionItemId={1}",r,_h.ba.a(f));this.M()}},R:function(n){n.dy()&&this.bi.a.bc.a(3050)},L:function(n){if(this.bo()){_j.e.a(_a.a.a,"MailComposeUpgradeComponent.CompleteSystemUpgrade: viewModel is null or disposing, aborting logic.");return}var r=this.bh;var t=r.bb;var i=n;var o=i.O?i.O.correlationId:null;var f=n.h();i.x(this.s);if(f===t.b()){t.dJ(i.bi);t.fk=i.bi.cv();this.l=i.bi;t.gX(i.bi.bK());try{if(this.j())if(t.bk()){_j.e.a(_a.a.bc,"upgrade returned success, user already requested for upgrade, merge body and remove spinner");this.v();this.bt("IsWaitingForQuotedBody","IsOnDemandUpgradePending");r.bf()}else t.cK(!0);else this.v();i.bi.T()&&t.T(i.bi.T().e);var e=r.be();e.z()}finally{t.i()&&r.bc.b(3440);_j.e.a(_a.a.bc,"IsUpgraded for context is {0}",t.i())}this.R(t);r.bf();_j.e.a(_a.a.bc,"Complete upgrade context:{0}",t);var u=r.bm();u.c()?u.i():_a.br.a&&_j.o.a().c(_a.a.a,"SafeTriggerPolicyTipsIfNeededForOpenDraft",this.J);r.bi.a(_db.bD,new _mcp.bU(t.U().bj.ItemId.Id,r))}else _j.e.a(_a.a.bc,"MailComposeUpgrade failed since user switched view model context. ContextId={0}; Context{1}=",f,t)},x:function(){this.n=_y.j.b(_a.a.a,"MailComposeOnDemandUpgrade",!0);var n=this.bi.a.bb;n.dW(!0);if(this.l||n.U()&&n.i()){this.l||(this.l=n.U());_j.e.a(_a.a.bc,"user requests for quoted body, upgrade was successful, complete the body merge");this.v();this.bt("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending")}else if(n.J()){_j.e.a(_a.a.bc,"user requests for quoted body, upgrade failed, show error message");this.bt("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending");this.y();this.bh.bf();this.N()}else{_j.e.a(_a.a.bc,"user requests for quoted body, upgrade has yet to come back, show spinner");this.bt("ShouldShowQuoteBodyButton","IsWaitingForQuotedBody")}},v:function(){var n=this.bi.a.bb;var e=!1;if(this.m.b()){if(n.eH()){n.eP.a();n.D()===n.eH().a()&&(e=!0)}else n.fm=!0;n.fl=!0}if(this.bh.bn()&&this.j()&&this.l.I()&&n.j()!==this.l.I().a()&&this.m.b()){var f=this.l.I().bj.Value;if(n.j()==="HTML")n.fg(_a.y.b(f));else{var i;var o,r;r=_a.y.a(f,o={val:i}),i=o.val,r;n.fg(i);var h=this;n.fb=function(n){n.be().y(!1)}}}else if(this.m.b()||n.j()!=="HTML"){var u=this.l.I().bj.Value;n.fg(!this.m.b()&&n.j()==="Text"?_a.y.F(u):u)}else n.fg(this.l.bJ().bj.Value);if(_y.c.a.a()==="Mouse"||this.m.b()){var t=new _cmc.h(2,n.dq(),n.j()==="HTML");t.q=!1;t.v=!0;var c=this;t.w=function(){n.cK(!0)};this.bh.bK().a(t)}else n.cK(!0);if(e){n.eP.a();n.eH().r(n.D());var s=n.eJ;s&&n.eJ.r(n.D())}this.M()},P:function(n){var r=n;var u=r.O?r.O.correlationId:null;r.x(this.s);if(this.bo()){_j.e.a(_a.a.a,"MailComposeUpgradeComponent.OnUpgradeFailure: viewModel is null or disposing, aborting logic.");this.r("SkipUpgrade",u,"Skip upgrade since view mode is disposed");return}var s=this.bi;var i=s.a;var f=i.bb;var h=i.br();f.ep(!0);var t=n.h();if(this.t.a(t)){_j.e.a(_a.a.bc,"Resume discard for context {0}",t);h.e(t,r.D)}else if(t===f.b()){_j.e.a(_a.a.bc,"Recording on context upgrade failed");var e=i.bm();var o=i.bh();if(e.c()){if(e.h()){_j.e.a(_a.a.bc,"Skipping upgrade for context {0} since save and then send was triggered during upgrade",t);this.r("SkipUpgrade",u,"Skip upgrade since saving is in progress");e.i();return}_mcp.N.a(i)}else if(o.c()){_j.e.a(_a.a.bc,"Skipping upgrade for context {0} since send was triggered during upgrade",t);this.r("SkipUpgrade",u,"Skip upgrade since send is in progress");o.e();return}else _mcp.N.a(i);if(this.j()&&f.bk()){_j.e.a(_a.a.bc,"upgrade failed and user requested for upgrade, show the failure and trigger property changes to hide the spinner");this.bt("IsWaitingForQuotedBody","IsOnDemandUpgradePending");this.y();this.bh.bf()}}n.f()&&this.U(n.f(),t,u,f)},U:function(n,t,i,r){var f="UpgradeFailure_UnknownError";var u="";if(_g.L.a(n)){f=_g.L.b(n);u=n.FaultMessage}_j.e.b(_a.a.bc,"Upgrade failed. ContextId={0}, Context={1}, Server Error: {2}",t,r,u);this.r(f,i,u)},y:function(){var n=this.bi.a.bc;n.b(3450);n.a(3450,null)},r:function(n,t,i){this.A=n;this.z=t;this.C=i;if(this.o){_y.j.a(this.o,null,n,t,i);this.o=null;_a.M.a("MailComposeUpgrade")}if(this.p){_y.j.a(this.p,null,n,t,i);this.p=null}this.N()},M:function(){if(this.o){_y.j.a(this.o);this.o=null;_a.M.a("MailComposeUpgrade")}this.S()},S:function(){if(this.n){_y.j.a(this.n);this.n=null}},N:function(){if(this.n){_y.j.a(this.n,null,this.A,this.z,this.C);this.n=null}},V:function(){_mcp.G.a(this.bh,32)}};_mcp.bH=function(n,t){this.h=Function.createDelegate(this,this.j);_mcp.bH.initializeBase(this,[17,n]);if(_a.cA.a){var i=this;t.a(function(n){if(i.bo()){_j.e.a(_a.a.a,"MailComposeMailTipsComponent.ctor: viewModel is null or disposing, aborting logic.");return}var u=i.bh;var r=u.bd();var t=u.bc;if(r&&t){i.c=n.a(r,t);i.bj.V()&&i.c.f(i.bj.V().EmailAddress);if(i.e){i.i();i.e=!1}if(i.f){i.c.a();i.f=!1}}})}};_mcp.bH.prototype={c:null,e:!1,f:!1,g:function(){if(!_a.cA.a){_mcp.G.prototype.g.call(this);return}this.c?this.i():this.e=!0;_mcp.G.prototype.g.call(this)},a:function(n){if(_a.cA.a||!this.cd){if(n===32){var r=this.bi;var i=r.a;var t=i.bb;if(t.dj()){i.bc.b(4400);i.bc.a(4400);this.bh.bf()}if(!t.a()&&!t.bh()||t.a()===3||t.a()===11)return}this.d()||this.g();this.k()}},b:function(){if(_a.cA.a){this.d()||this.g();if(this.c){_j.e.a(_a.a.a,"Remove MailTips for deleted recipients");this.c.e()}else _j.e.a(_a.a.a,"MailTips for deleted recipients was called when MailTipsHandler hasn't been created, no operation needed")}},br:function(){if(this.c){this.c.c(null);this.c=null}_mcp.G.prototype.br.call(this)},i:function(){this.c.b();this.c.c(this.h)},k:function(){if(_a.cA.a)if(this.c){_j.e.a(_a.a.a,"Prepares to submit mailtips action");this.c.a()}else{_j.e.a(_a.a.a,"Remember to submit MailTips action once the MailTipsHandler is created");this.f=!0}},j:function(){if(_a.cA.a){this.bh.ds(this.c.d());this.bh.bf()}}};_mcp.bL=function(n,t){this.h=Function.createDelegate(this,this.i);_mcp.bL.initializeBase(this,[29,n]);if(t){var i=this;t.a(function(n){if(i.bo()){_j.e.a(_a.a.a,"MailComposePeopleRecommendationsComponent.ctor: viewModel is null or disposing, aborting logic.");return}var t=i.bh;i.c=n.a(i.bh.bd(),i.bh.bc);i.c.c(i.h);if(i.e){i.c.b();i.e=!1}if(i.f){i.c.a();i.f=!1}})}};_mcp.bL.prototype={c:null,e:!1,f:!1,g:function(){this.c?this.c.b():this.e=!0;_mcp.G.prototype.g.call(this)},b:function(n){this.d()||this.g();this.j()},a:function(){this.c&&this.c.e(!0)},br:function(){if(this.c){this.c.c(null);this.c=null}_mcp.G.prototype.br.call(this)},j:function(){if(this.c){_j.e.a(_a.a.a,"Prepares to submit PeopleRecommendations action");this.c.a()}else{_j.e.a(_a.a.a,"Remember to submit PeopleRecommendations action once the PeopleRecommendationsHandler is created");this.f=!0}},i:function(){this.bh.bf()}};_mcp.bN=function(n,t){this.p=Function.createDelegate(this,this.w);this.o=Function.createDelegate(this,this.v);this.n=Function.createDelegate(this,this.u);this.m=Function.createDelegate(this,this.t);this.l=Function.createDelegate(this,this.s);_mcp.bN.initializeBase(this,[23,n]);if(_a.br.a){var i=this;t.a(function(n){if(i.bo()){_j.e.a(_a.a.a,"MailComposePolicyTipsComponent.ctor: viewModel is null or disposing, aborting logic.");return}var t=i.bh;var f=t.bd();var u=t.be();var r=t.bc;if(f&&u&&r){i.f=n.a(f,u,r);i.f.h(i.l);i.f.d(i.m);i.f.c(i.n);i.f.e(i.o);i.f.f(i.p);if(i.i){i.f.b();i.i=!1}if(i.j){i.a(i.k);i.j=!1}}})}};_mcp.bN.prototype={h:null,f:null,i:!1,j:!1,k:0,g:function(){if(!_a.br.a){_mcp.G.prototype.g.call(this);return}this.f?this.f.b():this.i=!0;_mcp.G.prototype.g.call(this)},br:function(){this.h&&(this.h=_j.o.a().b(this.h));if(this.f){this.f.h(null);this.f.d(null);this.f.c(null);this.f.e(null);this.f.f(null);this.f=null}_mcp.G.prototype.br.call(this)},c:function(){if(!_a.br.a)return!1;switch(this.q()){case 1:return!1;case 2:case 3:return this.bi.a.bb.cp()===null&&this.bi.a.bb.co()===null;case 4:case 5:return this.bi.a.bb.co()===null;default:return!1}},b:function(){if(!_a.br.a)return"";switch(this.q()){case 2:case 3:return _u.P.Q;case 4:case 5:return _u.P.F;default:return""}},e:function(){if(_a.br.a){if(!this.f){_j.e.a(_a.a.F,"skip setting message sent flag since handler hasn't been created yet.");return}this.f.i(!0);if(this.bi.a.bb.cp()){var n=new _cmc.d(_a.a.F,"DlpPolicyTipOverridden",!1);n.b()}}},a:function(n){this.r(n,0)},x:function(n,t,i){_j.e.a(_a.a.a,"Prepares to submit policyTips action");var u;var r;if(n.eH()){u=_a.H.b(n.eH().f());r=_a.H.b(n.eH().a())}else{u=_a.H.b(n.A());r=_a.H.b(n.D())}this.f.g(i,n.p(),u,r,t)},r:function(n,t){if(_a.br.a&&!this.cd){if(!this.f){_j.e.a(_a.a.F,"Remember to resume triggering policy tips once the handler is created");this.k=n;this.j=!0;return}var f=this.bi;var e=f.a;var r=e.bb;this.d()||this.g();this.h&&(this.h=_j.o.a().b(this.h));var i=r.h();if(i){_bc.f.a(i)&&!_g.k.b&&(i=_g.k.a.q(i));if(_bc.f.a(i)){if(t<4){var u=this;this.h=_j.o.a().a(_a.a.F,"TriggerPolicyTipsIfNeeded",function(){u.r(n,t+1)},5e3)}}else this.x(r,n,i)}}},q:function(){this.d()||this.g();return this.f?this.f.a():0},s:function(){this.bh.bf()},t:function(n){var r=this.bi;var i=r.a;var t=i.bb;t.dI(n)},u:function(n){var r=this.bi;var i=r.a;var t=i.bb;t.dH(n)},v:function(){this.a(64)},w:function(n){var r=this.bi;var i=r.a;var t=i.bb;t.dG(n)}};_mcp.z=function(n,t){this.L=Function.createDelegate(this,this.bp);this.U=Function.createDelegate(this,this.bw);this.Q=Function.createDelegate(this,this.be);this.S=Function.createDelegate(this,this.bs);this.T=Function.createDelegate(this,this.bv);this.P=Function.createDelegate(this,this.bm);this.R=Function.createDelegate(this,this.bn);this.Z=Function.createDelegate(this,this.bl);this.ba=Function.createDelegate(this,this.bz);_mcp.z.initializeBase(this,[22,n]);this.J=!1;this.W=t;this.I=new _j.g(this.ba,_a.a.g);this.I.c(!1)};_mcp.z.a=function(n){switch(n){case 0:return 0;case 1:return 1;case 2:return 2;default:throw Error.argument();}};_mcp.z.prototype={M:null,N:0,J:!1,Y:!1,G:null,W:null,V:null,I:null,K:null,a:function(){return this.G},bx:function(n){if(this.G!==n){this.G=n;this.bt("ExtensibilityViewModel","ShouldShowAppsButton")}return n},h:function(){return this.I},l:function(){return!!this.G&&this.G.d()&&this.I.b&&(!this.G.v()||this.bh.bs())},k:function(){return this.G?this.G.b():!0},by:function(n){if(n!==this.Y){this.Y=n;this.bq("RequestCloseComposeForm")}return n},i:function(){this.K||(this.K=new _db.bE(this.bh.bc));return this.K},g:function(){if(!_a.g.b&&!this.d()){var n=this;this.W.a(function(t){if(!n.G){if(n.bo()){_j.e.a(_a.a.a,"MailComposeExtensibilityComponent.Initialize: viewModel is null or disposing, aborting logic.");return}var r=n.bh;n.V=t;n.bx(t.d(n,n.Z));var i=r.cr();n.G.r(i.a());n.G.z(r.bs());var u=r.bi;u.b(_a.dj,n.R);n.G.f();i.apcl(i.b(),n.P);n.G.h(n.T);n.G.g(n.S);n.G.a().j(n.Q);n.be(null,null);n.G.apcl("ShowAppsButton",n.U);_mcp.G.prototype.g.call(n);if(n.bj.fw()&&n.bj.fw().length>0){n.bb(n.bj.fw());n.bj.cA(null)}}})}},bb:function(n){if(!this.M){var s;var r=null;var o;if(this.bi.a.bb.i()){o=this.bi.b(5);r=o.a()}else _j.e.a(_a.a.g,"Attachment not added - well not upgraded.");if(!r&&this.N<10){var i=this;this.M=_j.o.a().a(this.bk(),"MailComposeExtensibilityComponent - add attachments from context on delay",function(){if(!i.cd){i.N++;i.M=null;i.bb(n)}},100*this.N)}else for(var t=0;t<n.length;t++)if(n[t][0]==="file")this.bc(r,n[t][2],n[t][1],!0);else if(n[t][0]==="item"){var u=new _g.A;u.q(new _g.g(n[t][2]));u.e(n[t][1]);var e,f;f=this.bd(r,u,e={val:s},!0),s=e.val,f}}},bf:function(){this.bq("ShouldShowAppsButton");if(this.bh.cs()){var n=this.bi.b(27);n.G(this.l())}},bw:function(n,t){this.bf()},bc:function(n,t,i,r){var f=this.V.b(t,i);var u=n.Y(f);u.A(r);return u},bd:function(n,t,i,r){i.val=0;var f=_y.F.b(t);var e=_a.d.b(_a.a.c,"AttachmentExtensibilityItemAttachments");var u=new _j.q;n.F(f,u,e);if(!u.d.length){_j.e.a(_a.a.g,"Attachment not added - max number exceeded.");i.val=9001;return null}u.d[0].A(r);return u.d[0]},c:function(){return _y.c.a.a()==="Mouse"?this.bi.a.bb.j():this.bi.a.bb.dr()?"HTML":"Text"},v:function(){return this.bi.a.bb.q()},A:function(n){this.bi.a.bb.z(n)},u:function(n,t,i){i.val=0;var r=new _cmc.p(n);this.bi.a.bb.cO(r);r.d&&(i.val=9016);t.val=r.e;return r.a},z:function(n,t,i){i.val=0;var r=new _cmc.u(n,!0,t);this.bi.a.bb.cO(r);r.s?i.val=2006:r.t&&(i.val=9016)},r:function(){this.by(!0);this.bq("RequestCloseComposeForm")},t:function(n){return this.bh.bd().G(_mcp.z.a(n))},D:function(n,t){return this.bg(n,t,!1)},y:function(n,t){this.bg(n,t,!0)},p:function(n,t,i){t.val=0;if(!this.bi.a.bb.i()){_j.e.a(_a.a.g,"Attachment not added - well not upgraded.");t.val=9005;return null}var r=this.bi.b(5);if(r.a())return this.bd(r.a(),n,t,i);else{_j.e.a(_a.a.g,"ComposeFormNotReadyForAttachments in mail module");t.val=9015;return null}},o:function(n,t,i){i.val=0;if(!this.bi.a.bb.i()){_j.e.a(_a.a.g,"Attachment not added - well not upgraded.");i.val=9005;return null}var u=this.bi.b(5);var r=u.a();if(r)return this.bc(r,n,t,!1);_j.e.c(_a.a.g,"ComposeFormNotReadyForAttachments in mail module");i.val=9015;return null},E:function(){return this.bi.a.bb.bo()?this.bi.a.bb.bo().Id:null},m:function(n,t){t&&(n=this.X(n));var i=new _cmc.h(0,n,t);i.m=!0;i.n=!0;this.O(i)},n:function(n,t){t&&(n=this.X(n));var i=new _cmc.h(1,n,t);this.O(i)},j:function(n,t){var r=this,i=this;this.bi.a.bm().b(function(t){n()},function(n){_j.e.a(_a.a.g,"SaveActionFailed: Error: {0}",n.F.message);t()})},s:function(n){var t=new _cmc.Q(n);this.bi.a.bb.cD(t);return t.a},x:function(n,t,i){i.val=0;t&&(n=this.X(n));var r=new _cmc.ba(n,t);this.bi.a.bb.cD(r);r.c&&(i.val=2006)},f:function(){return this.bi.a.bb.d()||this.bi.a.bb.U()},X:function(n){var u=this.bh.be().a();if(!u||!u.a())return n;for(var i=_mcp.z.b.exec(n);i;){if(i.length===2){var s=i[0];var f=i[1];var o=document.createElement("div");var h=$(o);h.html(s);for(var r=o.firstChild,e=0;e<u.a().x.length;e++){var t=u.a().x[e];if(t.a().bj.Name===f||t.a().bj.ContentId===f){r.src=t.U();r.setAttribute("originalSrc",t.a().bj.ContentId?t.a().bj.ContentId:"cid:"+f);t.a().a()&&r.setAttribute("size",t.a().a());_j.i.a(t.a().bj.ContentType)||r.setAttribute("contentType",t.a().bj.ContentType);n=n.replace(s,o.innerHTML);break}}}i=_mcp.z.b.exec(n)}return n},bz:function(){this.G&&this.G.A()},be:function(n,t){this.I.c(this.G.a().b);this.bf()},bv:function(){if(_y.c.a.a()==="TouchWide"&&this.G.m()){var n=this.bi.a;n.es(6)}},bs:function(){var n=this.bi.a;n.es(4)},O:function(n){this.bh.bK().a(n)},b:function(){return this.bi.a.bb.h()?this.bi.a.bb.h().Id:null},e:function(){this.bi.a.bb.P()||this.bi.a.bb.dM(new _j.k);return this.bi.a.bb.P()},w:function(){},C:function(){var n=new _cmc.s(null);this.O(n)},q:function(n){var t=new _cmc.s(n);this.O(t)},br:function(){var i=this.bi.a.cr();i.rpcl(i.b(),this.P);this.bh.bi.c(_a.dj,this.R);if(this.G){this.G.p(this.T);this.G.o(this.S);this.G.a().i(this.Q);this.G.rpcl("ShowAppsButton",this.U);this.G.k();this.G=null}if(this.I){this.I.c(!1);this.I.i(this.L);var t;_a.i.a(t={val:this.I}),this.I=t.val}var n;_a.i.a(n={val:this.K}),this.K=n.val;_mcp.G.prototype.br.call(this)},bg:function(n,t,i){i&&this.bh.bd().bd(_mcp.z.a(n));var e=this.bh.bd().G(_mcp.z.a(n));var u=t.d.length;if(u+e.x.length>500)return!1;n===2&&this.bi.a.bd().z().a();for(var r=0;r<u;r++){var f=t.d[r];this.bh.bd().U(f,_mcp.z.a(n))}return!0},bn:function(n){if(this.J){this.J=!1;this.G.e(!1)}},F:function(){this.l()?this.I.a():this.I.j(this.L)},bl:function(n){if(n===1){var r=window.document.body.clientWidth;if(r<1367){var i=this.bi.a.bi;i.a(_a.dC,new _a.dC(!0));this.J=!0}}else if(n===2&&this.J){var t=this.bi.a.bi;t.a(_a.dC,new _a.dC(!1));this.J=!1}this.bh.bf()},bm:function(n,t){var i=this.bi.a.cr();t===i.b()&&this.bA(i)},bA:function(n){this.G.r(n.a());n.a()&&this.G.e(!1)},bp:function(n,t){if(this.I.b){this.I.i(this.L);this.I.a()}}};_mcp.bE=function(n,t){this.i=Function.createDelegate(this,this.m);this.f=Function.createDelegate(this,this.k);this.h=Function.createDelegate(this,this.l);_mcp.bE.initializeBase(this,[30,n]);this.e=t};_mcp.bE.prototype={e:null,c:null,b:function(n){this.c=n;this.c.b(this.h);this.c.a(this.f);this.c.c(this.i)},a:function(n){if(this.e){var t=this;this.e.a(function(i){t.j(i,n)})}},br:function(){this.n();_mcp.G.prototype.br.call(this)},n:function(){if(this.c){this.c.e(this.h);this.c.d(this.f);this.c.f(this.i);this.c=null}},j:function(n,t){for(var r=Object.keys(t),f=r.length,u=new Array(f),i=0;i<f;i++)u[i]=t[r[i]];n.c(u)},m:function(n){var t=n.c();_zz.X.b(t,this.bj.eQ)},l:function(n){var t=n.c();var i=_zz.X.d(t);_zz.X.e(i,this.bj.eQ);_zz.X.c(t,this.bj.eQ)},k:function(n){var t=n.c();_zz.X.b(t,this.bj.eQ)}};_mcp.bx=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut){_a.b.b(e,"nativeBridge");this.a=n;this.b=i;this.c=r;this.v=u;this.s=t;this.h=f;this.e=e;this.f=o;this.m=s;this.o=h;this.p=c;this.r=l;this.x=a;this.k=v;this.g=y;this.l=p;this.u=w;this.j=b;this.n=k;this.z=d;this.A=g;this.d=nt;this.w=tt;this.y=it;this.i=rt;this.q=ut};_mcp.bx.prototype={a:null,i:null,b:null,c:null,v:null,s:null,h:null,e:null,f:null,m:null,o:null,p:null,x:null,k:null,g:null,l:null,u:null,A:null,j:null,d:null,q:null,r:null,w:null,y:null,n:null,z:null,t:function(n,t){switch(n){case 0:return new _mcp.bG(this.a,this.c,this.k,!!this.f);case 1:return new _mcp.f(this.a,this.b,this.d);case 2:return new _mcp.q(this.a,this.c,this.b,this.d);case 3:return new _mcp.D(this.a,this.c,this.b,this.d);case 4:return new _mcp.g(this.a,this.l,this.g);case 5:return new _mcp.m(this.a,this.s,this.b,this.c,this.v,this.a.a.df,this.r);case 6:return new _mcp.bF(this.a,this.c,this.b,this.d);case 7:return this.b&&this.b.a().bd().Enabled?new _mcp.I(this.a,this.c,this.b,this.d,this.a.a.bi):new _mcp.t(this.a,this.c,this.b,this.d,this.a.a.bi);case 8:return new _mcp.V(this.a,this.h,this.c,this.b,this.d);case 9:return new _mcp.bI(this.a,this.f,this.b,this.d);case 10:if("Mouse"!==t)return new _mcp.bP(this.a,this.i);break;case 11:return new _mcp.p(this.a,this.c,this.b,this.d,this.y);case 12:return new _mcp.N(this.a,this.c,this.b);case 13:if(this.e.b(this.e.f())&&this.e.f().a().f())return new _mcp.bM(this.a,this.e);break;case 20:if(this.e.b(this.e.f())&&this.e.f().a().a())return new _mcp.bK(this.a,this.e);break;case 14:return new _mcp.W(this.a,this.g);case 15:if("Mouse"===t)return new _mcp.bz(this.a,this.f,this.b,this.d);break;case 16:if("Mouse"===t)return new _mcp.H(this.a);else if("TouchNarrow"===t)return new _mcp.bA(this.a);break;case 18:return new _mcp.s(this.a,this.d);case 17:return new _mcp.bH(this.a,this.m);case 29:return new _mcp.bL(this.a,this.o);case 23:return new _mcp.bN(this.a,this.p);case 19:return new _mcp.v(this.a);case 21:if(this.e.b(this.e.m()))return new _mcp.bO(this.a,this.e);break;case 22:return new _mcp.z(this.a,this.a.a.di);case 24:if(this.c.b())return new _mcp.w(this.a,this.b,this.c,this.x);break;case 30:if(this.c.b()&&this.c.e())return new _mcp.bE(this.a,this.j);break;case 25:return t!=="Mouse"?new _mcp.bC(this.a):new _mcp.bB(this.a,this.f);case 27:if(t==="Mouse")return new _mcp.y(this.a,this.w,this.d,this.u);break;case 28:return new _mcp.bJ(this.a,this.f,this.b,this.d);case 31:return new _mcp.r(this.a);case 32:if(this.c.c())return new _mcp.bw(this.a,this.c,this.a.a.bi,this.q);break;case 34:if(this.b&&this.b.a()&&this.b.a().dM().Enabled)return new _mcp.bD(this.a,this.n,this.z);break}return null}};_mcp.X=function(n,t){this.c=n;this.d=t};_mcp.X.prototype={c:!1,d:!1,a:function(){return this.c},b:function(){return this.d}};_mcp.bg=function(){};_mcp.bQ=function(){};_mcp.bQ.prototype={a:function(n,t){var r=n;var i=null;switch(r){case"Normal":i=_nbs.a.pa;break;case"Personal":i=_nbs.a.Ug;break;case"Private":i=_nbs.a.MK;break;case"Confidential":i=_nbs.a.w;break;default:i=_nbs.a.pa;break}return i},b:function(n,t){throw Error.notImplemented();}};_mcp.j=function(n){_mcp.j.initializeBase(this,[n])};_mcp.j.prototype={a:null,l:function(){},k:function(){},o:function(n){},m:function(n){},n:function(n){},q:function(n){},p:function(n,t){t.val=3;this.a.a();return!0}};_mcp.d=function(){};_mcp.d.Q=function(){return _fm.b.a(_fm.a.A,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.d.R=function(){return _fm.b.a(_fm.a.A,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.d.S=function(){return _fm.b.a(_fm.a.A,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.d.O=function(){return _fm.b.a(_fm.a.bJ,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.d.A=function(){return _fm.b.a(_fm.a.bJ,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.d.F=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.d.o=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.d.B=function(){return _fm.b.a(_fm.a.t,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.d.C=function(){return _fm.b.a(_fm.a.t,_fm.WebfontSizes.a.b,"ms-fcl-nt-b")};_mcp.d.l=function(){return _fm.b.a(_fm.a.t,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_mcp.d.m=function(){return _fm.b.a(_fm.a.t,_fm.WebfontSizes.a.f,"ms-fcl-nd-b")};_mcp.d.n=function(){return _fm.b.a(_fm.a.t,_fm.WebfontSizes.a.e,"ms-fcl-ns-b")};_mcp.d.G=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.d.y=function(){return _fm.b.a(_fm.a.B,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.d.N=function(){return _fm.b.a(_fm.a.B,_fm.WebfontSizes.a.e,"ms-fcl-tp-b")};_mcp.d.z=function(){return _fm.b.a(_fm.a.B,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.d.H=function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.a,"ms-fcl-tp-b")};_mcp.d.J=function(){return _fm.b.a(_fm.a.K,_fm.WebfontSizes.a.g,"ms-fcl-ns-b")};_mcp.d.L=function(){return _fm.b.a(_fm.a.K,_fm.WebfontSizes.a.g,"ms-fcl-nd-b")};_mcp.d.b=function(){return _fm.b.a(_fm.a.z,_fm.WebfontSizes.a.g,"ms-fcl-ns-b")};_mcp.d.h=function(){return _fm.b.a(_fm.a.z,_fm.WebfontSizes.a.g,"ms-fcl-nd-b")};_mcp.d.K=function(){return _fm.b.a(_fm.a.K,_fm.WebfontSizes.a.g,"ms-fcl-nta-b")};_mcp.d.M=function(){return _fm.b.a(_fm.a.K,_fm.WebfontSizes.a.g,"ms-fcl-tp-b")};_mcp.d.f=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.d.g=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.d.a=function(){return _fm.b.a(_fm.a.bY,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.d.d=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-ns-b","ms-fcl-ns-b")};_mcp.d.e=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-bgc-ns","ms-fcl-ns-b","ms-fcl-w-b")};_mcp.d.p=function(){return _fm.b.a(_fm.a.ct,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_mcp.d.c=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-ns-b")};_mcp.d.D=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-nd-b")};_mcp.d.E=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-td-b")};_mcp.d.i=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-nta-b")};_mcp.d.u=function(){return _fm.b.a(_fm.a.bf,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.d.v=function(){return _fm.b.a(_fm.a.bf,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.d.w=function(){return _fm.b.a(_fm.a.bf,_fm.WebfontSizes.a.b,"ms-fcl-td-b")};_mcp.d.x=function(){return _fm.b.a(_fm.a.h,"ms-fcl-ns-b")};_mcp.d.t=function(){return _fm.e.a("insertpicture.png")};_mcp.d.q=function(){return _fm.b.a(_fm.a.be,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.d.r=function(){return _fm.b.a(_fm.a.be,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.d.s=function(){return _fm.b.a(_fm.a.be,_fm.WebfontSizes.a.b,"ms-fcl-td-b")};_mcp.d.P=function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.c)};_mcp.d.k=function(){return _fm.b.a(_fm.a.be,_fm.WebfontSizes.a.c)};_mcp.d.j=function(){return _fm.b.a(_fm.a.dv,_fm.WebfontSizes.a.c)};_mcp.d.I=function(){return _fm.b.a(_fm.a.g,_fm.WebfontSizes.a.c)};_mcp.F=function(n){this.b=Function.createDelegate(this,this.e);this.c=Function.createDelegate(this,this.d);_mcp.F.initializeBase(this,[n]);this.a=!1;_y.c.a.o(this.c)};_mcp.F.prototype={a:!1,f:function(n){if(this.a!==n){this.a=n;this.bq("DisplayEllipsis")}return n},d:function(){var n=this;_j.o.a().c(_a.a.a,"MailComposeAggregatedRecipientWell.UpdateEllipsisState",function(){var t=n.z.childNodes&&n.z.childNodes.length>0?n.z.childNodes[0]:null;var i=t&&t.childNodes&&t.childNodes.length>1?t.childNodes[1]:null;n.f(t?t.offsetWidth<i.offsetWidth:!1)})},I:function(){_j.c.prototype.I.call(this);this.d();if(this.W()&&_mcp.i.isInstanceOfType(this.W())){var n=this.W();n.bd().apcl("ShowAggregatedHeader",this.b)}},br:function(){if(this.W()&&_mcp.i.isInstanceOfType(this.W())){var n=this.W();n.bd().rpcl("ShowAggregatedHeader",this.b)}_y.c.a.p(this.c);_j.c.prototype.br.call(this)},e:function(n,t){this.d()}};_mcp.cd=function(n,t,i,r,u,f,e,o,s){this.fr=Function.createDelegate(this,this.gE);this.fA=Function.createDelegate(this,this.gI);this.dx=Function.createDelegate(this,this.gG);this.fs=Function.createDelegate(this,this.gF);_mcp.cd.initializeBase(this,[n,t,i,r,u,f,e,o]);this.cy=f;this.bd=i;this.dy=u;this.bZ=s};_mcp.cd.prototype={dy:null,bw:!1,cf:!1,bA:null,cD:null,bZ:!1,gH:function(n){this.bw=n;this.bt("EnableRichTextOptions","ShowOneRibbon");this.cz();return n},ci:function(n){this.cf=n;this.bq("HighlightEditorBorder");return n},fB:function(){return this.bd.h()},fC:function(){return this.bd.g()},gC:function(){return this.bd.a()||this.bd.g()},fD:function(){return this.gD()},cy:null,bd:null,dA:function(){return this.bZ&&this.bw},fE:function(){this.bA||(this.bA=new _zz.U(this.s(),this.ca(),"OneRibbon"));return this.bA},fR:function(){return!1},o:null,w:function(){_mcp.l.prototype.w.call(this);this.cC();if(this.o){this.o.h(this.h.InlineComposeBody,this.s(),this.h.InlineComposeHeaderWrapper,this.h.InlineComposeBottomEdge,this.h.OneRibbonFiller,this.h.AttachmentWellViewWrapper,this.dz());this.s()&&this.s().gT(this.o);this.h.EditorFocusHandler&&this.h.EditorFocusHandler.bf("focus",this.fs,"MailComposeDockableView");this.o.b(this.dx)}},I:function(){_mcp.l.prototype.I.call(this);if(this.C){this.h.InlineComposeBottomEdge=this.C.a("InlineComposeBottomEdge");this.h.InlineComposeBody=this.C.a("InlineComposeBody");this.h.InlineComposeHeaderWrapper=this.C.a("InlineComposeHeaderWrapper");this.h.OneRibbonFiller=this.C.a("OneRibbonFiller");this.h.OneRibbon=this.C.a("OneRibbon");this.h.Emoji=this.C.a("Emoji");this.h.EditorFocusHandler=this.C.a("EditorFocusHandler")}else{this.h.InlineComposeBottomEdge=null;this.h.InlineComposeBody=null;this.h.InlineComposeHeaderWrapper=null;this.h.OneRibbonFiller=null;this.h.OneRibbon=null;this.h.Emoji=null;this.h.EditorFocusHandler=null}},bW:function(){_mcp.l.prototype.bW.call(this);if(this.bA){this.bA.dispose();this.bA=null}if(this.o){this.o.a(this.dx);this.o.g()}this.h.EditorFocusHandler&&this.h.EditorFocusHandler.bj("focus","MailComposeDockableView")},fh:function(n,t){_mcp.l.prototype.fh.call(this,n,t);this.cC()},cr:function(n){_mcp.l.prototype.cr.call(this,n);this.ci(!0)},eP:function(n){switch(n.c()){case 7:this.i("SendButton");break;case 14:var t=this.h.Emoji;if(t&&!t.bm()&&_zz.r.isInstanceOfType(t)&&t.j){var i=t.z.querySelectorAll("button");i&&i.length>0&&i[0].click()}break;default:_mcp.l.prototype.eP.call(this,n);break}},cC:function(){this.gH(this.bC)},cz:function(){if(this.h){var n=this.h.OneRibbon;var t=this.h.OneRibbonFiller;n&&t&&this.dA()&&n.w()}},fF:function(){this.cD||(this.cD=new _j.g(this.fA,this.F()));return this.cD},bV:function(n){_mcp.l.prototype.bV.call(this,n);this.cz()},gI:function(){if(this.bw){this.bZ=!this.bZ;this.o&&this.o.k(this.fr,this.h.InlineComposeBottomEdge.z);this.bq("ShowOneRibbon");this.cz()}},gE:function(){var n=this.bZ?_zz.e.c(50):"0px";this.h.OneRibbonFiller.z.style.height=n},gG:function(){if(this.h){this.dB(this.h.ToReadWriteRecipientWellView);this.dB(this.h.CcReadWriteRecipientWellView);this.dB(this.h.BccReadWriteRecipientWellView)}},gF:function(n){n.b();n.c();this.i("EditorControl")},dB:function(n){if(_j.c.isInstanceOfType(n)){var t=n.W();t&&t.D().P(!1)}},gD:function(){var n=null;var t=this.dy.a();var u=t.ee().Enabled;var f=t.ef().Enabled;var i=t.eg().Enabled;var r=this.W();if((u||f||i)&&!r.eh().a()&&!r.bb.a()){var e=Math.floor(Math.random()*1001);e<200&&(u?n=_u.n.BL:f?n=_u.n.Ik:i&&(n=_u.n.Py))}_j.i.a(n)&&(n=this.bd.g()?_u.n.DF:_u.n.GR);return n}};_mcp.h=function(n){_mcp.h.initializeBase(this,[n])};_mcp.h.prototype={a:null,b:function(){this.a&&_rw.c.a(this.a.z)},I:function(){_j.c.prototype.I.call(this);this.a=this.C?this.C.a("FromPersona"):null}};_mcp.R=function(n,t,i,r,u,f,e,o,s){_mcp.R.initializeBase(this,[n,t,i,r,u,f,e,o,s])};_mcp.R.prototype={bv:!1,cp:function(){return 2},fq:function(n){if(n!==this.bv){this.bv=n;this.bq("ReadyToScroll")}return n},bN:function(){return 250},dz:function(){return!1},I:function(){_mcp.cd.prototype.I.call(this);this.h.ComposeControlWrapper=this.C?this.C.a("ComposeControlWrapper"):null},w:function(){_mcp.cd.prototype.w.call(this);this.cz();this.fq(!0)},G:function(){this.o=new _cmc.e(this.C.a("scrollRegionId"),this.C.a("TopDockPanelId"),this.C.a("bottomDockPanelId"),this.ca(),1);this.o.e(this.h.ComposeControlWrapper);_mcp.l.prototype.G.call(this)},M:function(){if(this.o){this.o.d();this.o=null}_mcp.l.prototype.M.call(this)},eO:function(n){_mcp.l.prototype.eO.call(this,n);this.ci(!1)}};_mcp.l=function(n,t,i,r,u,f,e,o){this.eH=Function.createDelegate(this,this.hW);this.eI=Function.createDelegate(this,this.hX);this.cL=Function.createDelegate(this,this.hG);this.fG=Function.createDelegate(this,this.gJ);this.dE=Function.createDelegate(this,this.eO);this.dM=Function.createDelegate(this,this.hg);this.dN=Function.createDelegate(this,this.eP);this.dD=Function.createDelegate(this,this.gR);this.dI=Function.createDelegate(this,this.gT);this.dH=Function.createDelegate(this,this.gS);this.dO=Function.createDelegate(this,this.hh);this.dL=Function.createDelegate(this,this.cr);this.ey=Function.createDelegate(this,this.hQ);this.eo=Function.createDelegate(this,this.hD);this.es=Function.createDelegate(this,this.hH);this.en=Function.createDelegate(this,this.hC);this.cn=Function.createDelegate(this,this.gp);this.ew=Function.createDelegate(this,this.hL);this.dT=Function.createDelegate(this,this.hl);this.fJ=Function.createDelegate(this,this.fm);this.dV=Function.createDelegate(this,this.fg);this.dU=Function.createDelegate(this,this.hm);this.ex=Function.createDelegate(this,this.hO);this.cP=Function.createDelegate(this,this.hN);this.cO=Function.createDelegate(this,this.hM);this.cN=Function.createDelegate(this,this.hK);this.cM=Function.createDelegate(this,this.hJ);this.eb=Function.createDelegate(this,this.hu);this.cQ=Function.createDelegate(this,this.hP);this.cH=Function.createDelegate(this,this.hv);this.cl=Function.createDelegate(this,this.hp);this.cE=Function.createDelegate(this,this.hs);this.ep=Function.createDelegate(this,this.fV);this.ez=Function.createDelegate(this,this.hR);this.dZ=Function.createDelegate(this,this.hr);this.el=Function.createDelegate(this,this.hA);this.eA=Function.createDelegate(this,this.hS);this.dX=Function.createDelegate(this,this.ho);this.em=Function.createDelegate(this,this.hB);this.dW=Function.createDelegate(this,this.hn);this.er=Function.createDelegate(this,this.hF);this.eq=Function.createDelegate(this,this.hE);this.et=Function.createDelegate(this,this.hI);this.dY=Function.createDelegate(this,this.hq);this.ee=Function.createDelegate(this,this.hz);this.ec=Function.createDelegate(this,this.hx);this.ed=Function.createDelegate(this,this.hy);this.eE=Function.createDelegate(this,this.hU);this.eF=Function.createDelegate(this,this.hV);this.cj=Function.createDelegate(this,this.gM);this.cS=Function.createDelegate(this,this.hY);this.x=Function.createDelegate(this,this.fM);this.dC=Function.createDelegate(this,this.gN);this.fI=Function.createDelegate(this,this.hi);this.cI=Function.createDelegate(this,this.hw);this.ea=Function.createDelegate(this,this.ht);this.ef=Function.createDelegate(this,this.fh);this.fH=Function.createDelegate(this,this.eR);this.cR=Function.createDelegate(this,this.hT);this.fK=Function.createDelegate(this,this.gs);this.dP=Function.createDelegate(this,this.hk);this.q={};_mcp.l.initializeBase(this,[n]);this.m=t;this.p=i;this.eK=r;this.bM=u;this.v=f;this.bU=e;this.fd=o;if(this.bM){this.fe=this.bM.a().m().Enabled;this.cs=this.bM.a().g().Enabled}this.cs&&this.v.b(IAddHashtagEvent,this.dP);this.h={};_j.e.a(_a.a.a,"View created with layout={0}",this.m)};_mcp.l.prototype={bC:!1,p:null,eK:null,bM:null,n:null,r:null,k:null,ct:null,j:null,bo:!1,dk:!1,dd:!1,db:!1,cc:!1,cw:!1,cx:!1,bP:!1,dv:!1,cu:!1,cb:!1,de:!1,bR:!1,dj:!1,bU:null,v:null,fd:null,bk:!1,df:!1,fe:!1,cs:!1,bL:null,bg:null,cX:null,dl:null,ff:!1,s:function(){return this.h?this.h.EditorControl:null},bN:function(){var n;n=this.m==="TouchNarrow"?50:100;return n},cp:function(){var t=this.m==="Mouse"||this.eL()?1:3;var i=this.W();if(i)if(i.bn())t=2;else{var n=i.bb;this.m==="Mouse"||this.eL()||n.i()&&(n.a()===1||n.a()===2||n.a()===3)&&(t=2)}return t},t:function(n){if(this.k!==n){this.ig(n,this.k);this.k=n;this.ih()}return n},fj:function(n){if(this.cX!==n){this.cX=n;this.v.a(_y.by,new _y.by(this.cX))}return n},fS:function(){return this.p.z()?"":_nbs.a.nk},gP:function(){return _y.c.a.i()||this.m==="Mouse"?!1:this.dk},du:function(n){if(this.dk!==n){this.dk=n;this.bq("IsToRecipientWellPeoplePickerButtonShown")}return n},fO:function(){return _y.c.a.i()||this.m==="Mouse"?!1:this.dd},dn:function(n){if(this.dd!==n){this.dd=n;this.bq("IsCcRecipientWellPeoplePickerButtonShown")}return n},fN:function(){return _y.c.a.i()||this.m==="Mouse"?!1:this.db},dm:function(n){if(this.db!==n){this.db=n;this.bq("IsBccRecipientWellPeoplePickerButtonShown")}return n},fQ:function(){var n=this.W();return n&&n.bb&&n.bt()?n.bb.bi()&&n.bt().a():!0},h:null,m:0,cT:null,fv:function(){return!0},dp:function(n){if(this.cb!==n){this.cb=n;this.bq("IsReadyToShowContent")}return n},dq:function(n){if(this.bR!==n){this.bR=n;this.bq("IsReadyToShowEditor");this.bR&&this.fn()}return n},fl:function(n){if(this.de!==n){this.de=n;this.bq("IsReadyToShowAppBarContent")}return n},u:function(n){if(this.bo!==n){this.bo=n;this.bq("ShouldPreventShiftTabDefault")}return n},hZ:function(n){this.dj=n;this.bq("IsTabAnchorNeeded");return n},eL:function(){return this.eK.b()},gQ:function(){return this.W()?this.W().cF:!1},eN:function(){return this.h.SubjectTextBox.L()},fP:function(){return this.cs||this.fe},gO:function(){return!this.p.b()||this.m!=="TouchNarrow"},F:function(){return _a.a.a},ca:function(){!this.dl&&this.W()&&this.W().bL()&&(this.dl=this.W().c());return this.dl},fk:function(n){if(this.bk!==n){this.bk=n;this.bX();this.be()}return n},fR:function(){return!0},eM:function(){return 500},cZ:function(){return 1500},fm:function(){this.ct?this.i(this.ct):this.ia()},ia:function(){if(!this.W()){_j.e.a(_a.a.a,"No data context yet, skipping set initial focus");return}var n=this.W();if(this.ic()){_j.e.a(_a.a.a,"Queue task to set initial focus to To well. Context:{0}",n.bb);if(this.p.b()||this.p.e()){var r=this.h.ComposeViewContent;r.J(!1);this.eJ();this.q&&this.q.ToRecipientWellControl&&this.q.ToRecipientWellControl.removeAttr("disabled");this.i("ToRecipientWellControl")}else if(this.p.a()||this.p.g()){var u=this;this.bg=_j.o.a().a(_a.a.a,"SetFocusToRecipientWell",function(){u.i("ToRecipientWellControl")},this.cZ())}else{var t=this;this.bg=_j.o.a().a(_a.a.a,"SetFocusToRecipientWell",function(){t.i("ToRecipientWellControl")},this.eM())}}else if(this.gu()){_j.e.a(_a.a.a,"Set initial focus to subject. Context: {0}",n.bb);this.i("SubjectTextBox");if(this.p.a()||this.p.g()){_j.e.a(_a.a.a,"Queue task to set initial focus to subject for IE. Context:{0}",n.bb);var i=this;this.bg=_j.o.a().a(_a.a.a,"SetFocusToSubject",function(){i.i("SubjectTextBox")},this.cZ())}}else{_j.e.a(_a.a.a,"Set initial focus to body. Context: {0}",n.bb);if(this.p.a()||this.p.g()){_j.e.a(_a.a.a,"Queue task to set initial focus to body for IE. Context:{0}",n.bb);this.bg=_j.o.a().a(_a.a.a,"SetFocusToEditor",this.fK,this.cZ())}else this.gs()}},ic:function(){var n=this.W();return n.bd().e()<1},gu:function(){return _j.i.a(this.h.SubjectTextBox.L().val())},f:function(n){},d:function(n){this.dv=!this.W();if(this.dv)_j.e.a(_a.a.a,"PostTransitionIn with null DataContext.");else{var t=this.W();var i=t.bt();if(i.d()){this.cu=!!this.h.EditorControl;this.cu?this.Y()?t.bL()&&!t.cz?t.apcl("IsReadyForViewInitialization",this.cR):this.w():_j.e.a(_a.a.a,"PostTransitionIn view not active yet. Context:{0}",t.bb):_j.e.a(_a.a.a,"PostTransitionIn template not applied yet. Context:{0}",t.bb)}else this.gt(i,t.bb);this.m==="Mouse"&&t.eP()}this.bP=!0},g:function(){this.bP=!1;_j.e.a(_a.a.a,"PreTransitionOut view");var n=this.k;this.ct=n;if(n&&n in this.h)switch(n){case"FromFieldControl":case"ToRecipientWellControl":case"CcRecipientWellControl":case"BccRecipientWellControl":case"SubjectTextBox":this.eJ();this.cc=!0;var t=this.q[n];if(t[0]===document.activeElement){_j.e.a(_a.a.a,"Blur from {0}",n);t.blur()}this.k=null;this.cc=!1;break;case"EditorControl":this.cc=!0;this.h.EditorControl.eQ();this.k=null;this.cc=!1;break}else _j.e.a(_a.a.a," Skip pre-transition out focus related processing for current focused control {0}, since it's not present in the controls dictionary",n)},e:function(){_j.e.a(_a.a.a,"PostTransitionOut view");this.du(!0);this.dn(!1);this.dm(!1);this.gq();this.dp(!1);this.dq(!1);this.fl(!1)},S:function(){this.bc();return!0},c:function(){var n=this.W();return n.bg.b(5).h()},b:function(n){var t=this.W();if(t){_cmc.m.e(n.a(),JsonParser.serialize(n))&&n.b(_cmc.m.c(n.a(),t.bb.h()));t.be().C(n)}},a:function(n){var i=this.W();if(i&&i.be()&&i.be().c(!0)&&i.be().a()){var t=i.be().a();t.P(n.d());t.Q(n.c());t.O(n.a());t.ce(n.f());t.cd(n.e());t.S(n.b());t.h().a()}},br:function(){_j.e.a(_a.a.a,"Disposing view");this.cs&&this.v.c(IAddHashtagEvent,this.dP);this.ie();this.ii();this.bW();this.q=null;this.h=null;this.k=null;var n=this.W();if(n){var t=n.bh();t&&!t.h()&&n.dispose()}_j.c.prototype.br.call(this)},I:function(){_j.c.prototype.I.call(this);var n=this.C;var t=null;this.W()&&(t=this.W());if(n){this.h.SubjectTextBox=n.a("SubjectTextBox");this.h.FromFieldControl=n.a("FromFieldControl");this.h.ToRecipientWellControl=n.a("ToRecipientWellControl");this.h.CcRecipientWellControl=n.a("CcRecipientWellControl");this.h.BccRecipientWellControl=n.a("BccRecipientWellControl");var i=n.a("EditorControl");this.h.EditorControl=i;this.h.ComposeViewContent=n.a("ComposeViewContent");i.fB=this.fR();i.gA=t.bn()?0:1;this.h.CancelConfirmDialog=n.a("CancelConfirmDialog");this.h.MessageBox=n.a("MessageBox");this.h.ComposeDockPanel=n.a("ComposeDockPanel");this.h.ToRecipientButton=n.a("ToRecipientButton");this.h.CcRecipientButton=n.a("CcRecipientButton");this.h.BccRecipientButton=n.a("BccRecipientButton");this.h.ToReadWriteRecipientWellView=n.a("ToReadWriteRecipientWellView");this.h.CcReadWriteRecipientWellView=n.a("CcReadWriteRecipientWellView");this.h.BccReadWriteRecipientWellView=n.a("BccReadWriteRecipientWellView");this.h.QuotedBodyHtmlLabel=n.a("QuotedBodyHtmlLabel");this.h.AttachmentWellViewWrapper=n.a("AttachmentWellViewWrapper");this.h.OnDemandUpgradeContainer=n.a("OnDemandUpgradeContainer");if(this.m==="Mouse"){this.h.SendButton=n.a("SendButton");this.h.DiscardButton=n.a("DiscardButton");this.h.InsertButton=n.a("InsertButton");t.bn()||(this.h.AppsButton=n.a("AppsButton"));this.h.AffordanceMenuButton=n.a("AffordanceMenuButton");this.h.OpenSeperateWindowButton=n.a("OpenSeperateWindowButton");this.h.ComposeAppsPane=n.a("ComposeAppsPane");this.h.MinAppBar=n.a("MinAppBar");this.bC=t.bb.j()==="HTML"}this.cT=new _j.g(this.fH,this.F());this.ib();if(this.bP&&!this.cu){_j.e.a(_a.a.a,"Applied template, already in view and template was not applied at PostTransitionIn, calling PostTransitionIn. Context:{0}",t?t.bb:"null");this.d(null)}else _j.e.a(_a.a.a,"Applying template. Context:{0}",!t||!t.bb?"null":t.bb.toString());this.h.EditorControl&&this.h.EditorControl.apcl("IsPlainTextContent",this.ef)}else{_j.e.a(_a.a.a,"Applying null template. Context:{0}",t?t.bb.toString():"null");this.h.SubjectTextBox=null;this.h.FromFieldControl=null;this.h.ToRecipientWellControl=null;this.h.CcRecipientWellControl=null;this.h.BccRecipientWellControl=null;this.h.EditorControl=null;this.h.CancelConfirmDialog=null;this.h.MessageBox=null;this.h.ComposeDockPanel=null;this.h.AttachmentWellViewWrapper=null;this.h.OnDemandUpgradeContainer=null}this.s()&&this.h.OnDemandUpgradeContainer&&(this.s().gB=this.h.OnDemandUpgradeContainer);this.gv()},by:function(){var t=new _b.e(this.fd);t.i("ShowAddressBook");var r=this;t.k=new _j.g(function(){r.i("ToRecipientWellControl")},this.F());var n=new _fc.g;n.a([t]);var i=_j.h.prototype.by.call(this);this.A(-1);return i?i.concat(n):[n]},Z:function(){_j.h.prototype.Z.call(this);if(this.W()){var t=this.W();var i=t.bb;var n=t.bt();i.apcl("IsUpgraded",this.ea);this.bC=i.j()==="HTML";if(this.dv)if(n.d()){_j.e.a(_a.a.a,"DataContext updated, PostTransitionIn with null DataContext and view model initialized, call PostTransitionIn with Context: {0}",t.bb);this.d(null)}else this.gt(n,i);n.c()||n.apcl("IsSecondInitializationComplete",this.cI);t.bd().bf(this.fI)}else _j.e.a(_a.a.a,"Updated DataContext to null")},G:function(){_j.c.prototype.G.call(this);if(this.bP&&this.W()&&this.cu){var t=this.W();var n=t.bt();n.d()&&this.w()}this.W()&&!this.W().bL()&&(_fc.g.a=this)},M:function(){this.gq();this.W()&&!this.W().bL()&&(_fc.g.a=null);_j.c.prototype.M.call(this)},co:function(){var n=this.W();if(this.cx){_j.e.a(_a.a.a,"Events already bound. Context:{0}",n.bb);return}if(this.p.b()){$(window.document.body).bind("mousedown",{uiComponent:"Body"},this.dC);var e=this;_j.o.a().a(_a.a.a,"RemoveBodyFocusHandler",function(){$(window.document.body).unbind("mousedown",e.dC)},1e3)}this.n=new _j.q;if(this.m==="Mouse"){this.n.c(new _mcp.l.a("DiscardButton",this.x));this.n.c(new _mcp.l.a("InsertButton",this.x));n.bn()||this.n.c(new _mcp.l.a("AppsButton",this.x));this.n.c(new _mcp.l.a("AffordanceMenuButton",this.x));this.n.c(new _mcp.l.a("OpenSeperateWindowButton",this.x));this.n.c(new _mcp.l.a("ToRecipientButton",this.x))}this.n.c(new _mcp.l.a("SubjectTextBox",this.x));this.n.c(new _mcp.l.a("FromFieldControl",this.x));this.n.c(new _mcp.l.a("ToRecipientWellControl",this.cS));this.n.c(new _mcp.l.a("CcRecipientWellControl",this.cS));this.n.c(new _mcp.l.a("BccRecipientWellControl",this.cS));this.n.c(new _mcp.l.a("AttachmentWellViewWrapper",this.x));this.r=new _j.q;this.r.c(new _mcp.l.a("FromFieldControl",this.cj));this.r.c(new _mcp.l.a("ToRecipientWellControl",this.cj));this.r.c(new _mcp.l.a("CcRecipientWellControl",this.cj));this.r.c(new _mcp.l.a("BccRecipientWellControl",this.cj));if(n.bL()){var t=this.ca();t.addEventListener("focus",this.eF,!0);t.addEventListener("blur",this.eE,!0);t.addEventListener("dragover",this.ed,!0);t.addEventListener("dragleave",this.ec,!0);t.addEventListener("drop",this.ee,!0)}else{for(var r=0;r<this.n.d.length;r++){var f=this.h[this.n.d[r].a];f&&_j.l.b(f.z,"focusin",this.n.d[r].c())}for(var i=0;i<this.r.d.length;i++)_j.l.b(this.h[this.r.d[i].a].z,"focusout",this.r.d[i].c())}this.fL();this.h.CancelConfirmDialog.apcl("IsHidden",this.dY);this.h.MessageBox.apcl("IsHidden",this.et);n.be().a()&&(this.bk=!n.be().a().m());this.be();n.bc.apcl("ActionPerformed",this.eq);n.bc.apcl("Count",this.er);n.be().p(this.dW);if(this.bU.b(this.bU.d())&&this.m==="TouchWide"){var u=n.bz().a();if(u){u.i(this.em);u.s(this.dX)}}n.bb.apcl("SelectedDataCallContext",this.eA);n.bb.apcl("EditorCallContext",this.el);n.bt().apcl("CanLoadPopoutSuccessfully",this.dZ);n.bz().apcl("RequestCloseComposeForm",this.ez);this.h.FromFieldControl.apcl("IsHidden",this.ep);this.h.CcRecipientWellControl.apcl("IsHidden",this.cE);this.h.BccRecipientWellControl.apcl("IsHidden",this.cl);this.gL();this.cx=!0},bW:function(){var n=this.W();var e=null;var i=null;if(n){i=n.bt();if(i){i.rpcl("IsInitialized",this.cH);i.rpcl("IsSecondInitializationComplete",this.cI)}else _j.e.b(_a.a.a,"MailComposeView.UnbindEvent - InitializerComponent was null.");e=n.bb;e?e.rpcl("IsUpgraded",this.ea):_j.e.b(_a.a.a,"MailComposeView.UnbindEvent - Context was null.");n.rpcl("ReadyToSetInitialFocus",this.cQ)}if(!this.cx){_j.e.a(_a.a.a,"Events aren't bound. Context:{0}",n?n.bb.toString():"null");return}if(this.h){this.h.CancelConfirmDialog&&this.h.CancelConfirmDialog.rpcl("IsHidden",this.dY);this.h.MessageBox&&this.h.MessageBox.rpcl("IsHidden",this.et);this.bX();this.h&&this.h.BccRecipientWellControl&&this.h.BccRecipientWellControl.rpcl("IsHidden",this.cl);this.h.CcRecipientWellControl&&this.h.CcRecipientWellControl.rpcl("IsHidden",this.cE);this.h.FromFieldControl&&this.h.FromFieldControl.rpcl("IsHidden",this.ep);if(n&&n.bL()){var t=this.ca();if(t&&!t.closed)try{t.removeEventListener("focus",this.eF,!0);t.removeEventListener("blur",this.eE,!0);t.removeEventListener("dragover",this.ed,!0);t.removeEventListener("dragleave",this.ec,!0);t.removeEventListener("drop",this.ee,!0)}catch(v){}}else{for(var o=0;o<this.n.d.length;o++)this.h[this.n.d[o].a]&&_j.l.c(this.h[this.n.d[o].a].z,"focusin");for(var f=0;f<this.r.d.length;f++)this.h[this.r.d[f].a]&&_j.l.c(this.h[this.r.d[f].a].z,"focusout")}this.h.EditorControl&&this.h.EditorControl.rpcl("IsPlainTextContent",this.ef)}if(n){_j.e.a(_a.a.a,"Unbind view events on view model. Context:{0}",n.bb);n.bD()&&n.bD().a()&&n.bD().a().rpcl("IsShown",this.eb);var r=n.bV();if(r){r.rpcl("DialogViewModel",this.cM);r.a()&&r.a().rpcl("IsShown",this.cN)}var u=n.bW();if(u){u.rpcl("DialogViewModel",this.cO);u.a()&&u.a().rpcl("IsShown",this.cP)}var l=n.bd();l&&l.rpcl("IsPeoplePickerShown",this.ex);var a=n.be();if(a){a.w(this.dW);if(n.be().a()){n.be().a().L(this.dU);n.be().a().cb(this.dV)}}if(this.bU.b(this.bU.d())&&this.m==="TouchWide"){var s=n.bz().a();if(s){s.q(this.em);s.y(this.dX)}}var c=n.bz();c&&c.rpcl("RequestCloseComposeForm",this.ez);i&&n.bt().rpcl("CanLoadPopoutSuccessfully",this.dZ);if(e){n.bb.rpcl("SelectedDataCallContext",this.eA);n.bb.rpcl("EditorCallContext",this.el)}var h=n.bc;if(h){h.rpcl("ActionPerformed",this.eq);h.rpcl("Count",this.er)}n.rpcl("IsReadyForViewInitialization",this.cR)}this.ij();this.cx=!1},bV:function(n){if(n===1||n===2){var i=n===1?"ComposeAppsPane":"MinAppBar";var t=this.h[i];t&&t.bm()&&this.i("ToRecipientWellControl")}this.fn();this.fi()},cr:function(n){_j.e.a(_a.a.a,"Focused in the RTE");this.k!=="EditorControl"&&this.t("EditorControl");this.bg&&(this.bg=_j.o.a().b(this.bg))},fM:function(n,t){var i=t.uiComponent;this.cY(i)},hY:function(n,t){this.fM(n,t);this.eQ()},gM:function(n,t){_j.e.a(_a.a.a,"User blured from {0}",this.k);if(this.W()&&_mcp.e.isInstanceOfType(this.W())&&!this.cc&&!this.W().bJ){var i=this.W().bd();if(this.k==="FromFieldControl"&&i&&i.m()){var o=i.m().c();_j.i.a(o)||i.M(o,!0)}var r=null;var s=!0;switch(this.k){case"ToRecipientWellControl":r=this.h.ToReadWriteRecipientWellView;break;case"CcRecipientWellControl":r=this.h.CcReadWriteRecipientWellView;break;case"BccRecipientWellControl":r=this.h.BccReadWriteRecipientWellView;break;default:s=!1;break}if(s&&r&&i&&i.l()){var e=r.W();e&&!e.eK&&e.D()&&!e.D().bJ()&&i.l().g()}if(_a.cA.a){var f=this;_j.o.a().a(this.F(),"Delayed MailTips retrieval",function(){if(f.W()&&!f.bG&&!f.cd){var n=f.W().cX();n&&n.a(1)}},100)}if(_a.br.a){var u=this;_j.o.a().a(this.F(),"Delayed PolicyTips retrieval",function(){if(u.W()&&!u.bG&&!u.cd){var n=u.W().cY();n&&n.a(1)}},100)}}},bc:function(){if(this.h&&this.Y()&&this.bP&&this.k&&this.W()&&!this.W().bJ){_j.e.a(_a.a.a,"Restore focus to {0}",this.k);this.i(this.k)}else _j.e.a(_a.a.a,"Skip restore focus, controls={0}; Active={1}; InView={2}; Name={3}; VM={4}",this.h?"non-null":"null",this.Y(),this.bP,this.k,this.W()?"non-null":"null")},i:function(n){this.eJ();switch(n){case"SubjectTextBox":case"BccRecipientWellControl":case"CcRecipientWellControl":case"ToRecipientWellControl":case"FromFieldControl":if(this.q&&this.q[n]){this.q[n].focus();this.t(n);this.eQ()}break;case"EditorControl":if(this.h&&this.h[n]){var i=this.h.EditorControl;i.bN(new _cmc.B(!1));this.t(n)}break;case"ToRecipientButton":case"CcRecipientButton":case"BccRecipientButton":case"OpenSeperateWindowButton":case"SendButton":case"DiscardButton":case"AppsButton":case"AffordanceMenuButton":if(this.h&&this.l(n)){this.h[n].S();this.t(n)}break;case"AttachmentWellViewWrapper":var t=this.W().be();if(this.h&&this.l(n)&&this.W()&&t&&t.s()>0){this.h[n].S();this.t(n)}break}},eJ:function(){if(this.q&&!("SubjectTextBox"in this.q)){this.q.SubjectTextBox=this.h.SubjectTextBox.L();this.q.FromFieldControl=this.h.FromFieldControl.L().find("input");this.q.ToRecipientWellControl=this.h.ToRecipientWellControl.L().find("input");this.q.CcRecipientWellControl=this.h.CcRecipientWellControl.L().find("input");this.q.BccRecipientWellControl=this.h.BccRecipientWellControl.L().find("input")}},fh:function(n,t){this.fL();var i=this.W();this.bC=i.bb.j()==="HTML";this.bC||this.fT();if(this.p.a())this.fm();else{_j.e.a(_a.a.a,"Queue task to set initial focus after EditorBodyType changed for non-IE browsers.");_j.o.a().a(_a.a.a,"ResetInitialFocusOnEditorBodyTypeChanged",this.fJ,this.eM())}},hC:function(n){this.bV(5)},hH:function(n){this.bV(3)},hl:function(n,t){this.bV(1)},gL:function(){var i=this.W();if(this.m==="Mouse"){this.h.ComposeAppsPane&&this.h.ComposeAppsPane.apcl("IsHidden",this.dT);this.h.MinAppBar&&this.h.MinAppBar.apcl("IsHidden",this.ew);if(_y.c.a.c())if(i.bL()){var r=this.ca();var n=_j.w.b(r);var t=this;n.c("resize",function(n){t.gp()})}else{_y.c.a.o(this.cn);this.v.b(_a.ce,this.en);this.v.b(_a.cP,this.es);_g.a.a().b().v(this.eo)}else _y.c.a.o(this.cn)}},ij:function(){var i=this.W();if(this.m==="Mouse"){this.h.ComposeAppsPane&&this.h.ComposeAppsPane.rpcl("IsHidden",this.dT);this.h.MinAppBar&&this.h.MinAppBar.rpcl("IsHidden",this.ew);if(_y.c.a.c())if(i.bL()){var t=this.ca();var n=_j.w.b(t);n.d("resize",null)}else{_y.c.a.p(this.cn);this.v.c(_a.ce,this.en);this.v.c(_a.cP,this.es);_g.a.a().b().A(this.eo)}else _y.c.a.p(this.cn)}},gN:function(n){var i=n.data;var t=i.uiComponent;if(t==="Body"){_j.e.a(_a.a.a,"MouseDown event on Body is being ignored to prevent hiding the keyboard.");n.preventDefault()}},ib:function(){this.h.FromFieldControl.dQ(this.ey);this.z.setAttribute("aria-label",_nbs.a.fJ)},hL:function(n,t){this.bV(2)},hr:function(n,t){this.bq("ShouldHideSpinner")},hS:function(n,t){var i=this.W();var u=this.k||this.ct;if(u==="SubjectTextBox"){i.bb.x().c("subject");this.h.SubjectTextBox.p(i.bb.x())}else if(u==="EditorControl"){if("EditorControl"in this.h){var r=this.h.EditorControl;if(r.bc)r.bN(i.bb.x());else if(_cmc.p.isInstanceOfType(i.bb.x()))i.bb.x().a=r.fA;else if(_cmc.u.isInstanceOfType(i.bb.x())){r.fA=i.bb.x().o;r.bN(i.bb.x())}}i.bb.x().c("body")}else i.bb.x().f(!0)},hR:function(n,t){var r=this.W();if(r){var u=r.bg;var i=null;if(this.m==="Mouse"){var e=u.b(19);i=e.l()}else{var f=u.b(10);i=f.a()}i&&i.b&&i.a();this.m==="TouchNarrow"&&r.bz().a().j()}},hA:function(n,t){if("EditorControl"in this.h){var i=this.W();this.h.EditorControl.bN(i.bb.df())}},ie:function(){var n=this.h.FromFieldControl;var r=this.h.ToRecipientWellControl;var i=this.h.CcRecipientWellControl;var t=this.h.BccRecipientWellControl;n&&n.gm(this.ey)},hQ:function(n){if(this.h.FromFieldControl===n){var t=n.L().find("input");t.attr("aria-labelledby","MailCompose.FromRecipientWellButton")}},hi:function(){var n=this.h.FromFieldControl;n&&n.b()},eQ:function(){var t=!0;switch(this.k){case"ToRecipientWellControl":this.du(!0);this.dn(!1);this.dm(!1);break;case"CcRecipientWellControl":this.dn(!0);this.du(!1);this.dm(!1);break;case"BccRecipientWellControl":this.dm(!0);this.dn(!1);this.du(!1);break;default:t=!1;break}if(t){var n=this.W().bd();n&&n.l()&&n.l().j()}},eR:function(){var n=!0;if(this.bo){switch(this.k){case"DiscardButton":this.i("SendButton");break;case"InsertButton":this.i("DiscardButton");n=!1;break;case"AppsButton":this.i("InsertButton");n=!1;break;case"AffordanceMenuButton":var i=this.h.AppsButton;i&&!i.bm()?this.i("AppsButton"):this.i("InsertButton");n=!1;break;case"OpenSeperateWindowButton":this.i("AffordanceMenuButton");n=!1;break;case"ToRecipientButton":var t=this.W();if(t.bd().Z()||t.bc.p.x.length)this.u(!1);else{var u=this.h.ComposeAppsPane;if(u.bm()){this.i("OpenSeperateWindowButton");n=!1}else this.u(!1)}break;case"ToRecipientWellControl":if(this.m==="Mouse"){this.i("ToRecipientButton");n=!1;this.u(!1)}else this.u(!1);break;case"CcRecipientWellControl":this.i("CcRecipientButton");break;case"BccRecipientWellControl":this.i("BccRecipientButton");break;case"AttachmentWellViewWrapper":this.i("SubjectTextBox");break}if(n){var r=this;_j.o.a().a(this.F(),"MailComposeView.HandleShiftTabOnRecipientWell",function(){r.u(!1)},100)}}},ih:function(){if(this.id()){var n=this.W();switch(this.k){case"ToRecipientWellControl":n.bd().c(1);n.bd().c(2);break;case"CcRecipientWellControl":n.bd().c(0);n.bd().c(2);break;case"BccRecipientWellControl":n.bd().c(0);n.bd().c(1);break;default:n.bd().c(0);n.bd().c(1);n.bd().c(2);break}}},hk:function(n){if(this.s()&&n.a()&&n.b()&&(n.c()===this.s().be()||n.c()===this.eN()[0])){var i=this.W();if(i){var t=i.bb;if(t){var r=t.cu();r[n.b()]=n.a()}}}},id:function(){return this.m==="Mouse"&&this.W()?!0:!1},hq:function(n,t){if(this.h.CancelConfirmDialog.bm()&&this.W()&&!this.W().bJ){_j.e.a(_a.a.a,"Restore focus on hide of cancel confirm dialog.");this.bc()}},hI:function(n,t){if(this.h.MessageBox.bm()){_j.e.a(_a.a.a,"Restore focus on hide of message box.");this.bc()}},hv:function(n,t){var i=this.W();if(i.bt().d()){this.df&&i.bt().rpcl("IsInitialized",this.cH);_j.e.a(_a.a.a,"Calling PostTransitionIn on initialize of Data Context.");this.d(null)}else _j.e.a(_a.a.a,"InitializerComponent.IsInitialized = false.")},ht:function(n,t){var i=this.W();i.bb.i()&&this.bq("EditorSizingMode")},hw:function(n,t){var i=this.W();i.bt().rpcl("IsSecondInitializationComplete",this.cI);this.m==="Mouse"&&i.bD()&&i.bD().a()&&i.bD().a().apcl("IsShown",this.eb);var u=i.bV();u.a()?u.a().apcl("IsShown",this.cN):u.apcl("DialogViewModel",this.cM);var r=i.bW();r.a()?r.a().apcl("IsShown",this.cP):r.apcl("DialogViewModel",this.cO);var f=i.bd();f&&f.apcl("IsPeoplePickerShown",this.ex)},hu:function(n,t){var i=this.W();if(!i.bD().a().q()){var u=i.bV();var r=i.bW();var f=this;_j.o.a().a(this.F(),"MailComposeView.OnContextMenuShownChanged",function(){var e=!u.a()||!u.a().p;var t=!r.a()||!r.a().p;var n=!i.bl||!i.bl.p;if(e&&n&&t){_j.e.a(_a.a.a,"Restore focus on hide of context menu");f.bc()}},100)}},hJ:function(n,t){var r=this.W();var i=r.bV();i.rpcl("DialogViewModel",this.cM);i.a().apcl("IsShown",this.cN)},hK:function(n,t){var r=this.W();var i=this;_j.o.a().a(this.F(),"MailComposeView.OnMessageOptionsShownChanged",function(){if(!r.bV().a().p){_j.e.a(_a.a.a,"Restore focus on hide of message options dialog");i.bc()}},100)},hM:function(n,t){var r=this.W();var i=r.bW();i.rpcl("DialogViewModel",this.cO);i.a().apcl("IsShown",this.cP)},hN:function(n,t){var r=this.W();var i=this;_j.o.a().a(this.F(),"MailComposeView.OnOmeOptionsShownChanged",function(){if(!r.bW().a().p){_j.e.a(_a.a.a,"Restore focus on hide of ome options dialog");i.bc()}},100)},hO:function(n,t){var i=this.W();if(!i.bd().ba()){_j.e.a(_a.a.a,"Restore focus on hide of people picker");this.bc()}},hE:function(n,t){this.bc()},hF:function(n,t){this.gv();this.fn()},gv:function(){var a=this.C.a("InfoBarControl");if(a){var f=this.W();if(f.bc.p.x.length>0){for(var l=new _y.cF,o=_nbs.a.Hj+". ",n,r=0;r<f.bc.p.x.length;r++){n="";var t=f.bc.p.x[r];if(_db.D.isInstanceOfType(t)){var h=t;h&&(n=h.g)}else if(_db.E.isInstanceOfType(t)){var e=t;e&&(n=e.g)}else if(_db.C.isInstanceOfType(t)){var i=t;if(i&&_y.fr.isInstanceOfType(i.g)){var u=i.g;u&&u.a()&&(n=u.a())}}if(n===""){var s=t;s&&(n=l.a(s.e,null))}o+=n+". "}var c=this.C.a("InfoBarControl").z;c.setAttribute("aria-label",o)}}},hn:function(n){n.a().D(this.dU);n.a().by(this.dV);this.fk(!n.a().m())},fg:function(n){this.fk(!n.m());this.s().jD=_j.l.g(this.h.AttachmentWellViewWrapper.z)},hm:function(n){if(n.bL()){n.cf(!1);this.t("EditorControl")}this.fk(!n.m());this.bc()},gt:function(n,t){if(this.df)_j.e.a(_a.a.a,"PostTransitionIn before DataContext was initialized. DataContext initialization handler is already setup. Context:{0}",t);else{_j.e.a(_a.a.a,"PostTransitionIn before DataContext was initialized. Adding handler to call PostTransitionIn after DataContext is initialized. Context:{0}",t);n.apcl("IsInitialized",this.cH);this.df=!0}},gK:function(){if(!this.cw){var i=this.W().dn();var r=this.W().dl();if("EditorControl"in this.h&&this.h.EditorControl){var n=this.h.EditorControl;n.hU(this.dL);n.cI(this.dO);n.jL(this.dH);n.hT(this.dI);n.b(this.dD);n.eP(this.dN);n.lD(this.dM);n.lA(this.dE);i&&i.j(n);r&&r.b(n)}if(this.p.a()){var t=this.C.a("TabAnchor");t&&_j.l.b(t.z,"focusin",this.fG)}this.cw=!0}},eO:function(n){},ii:function(){if(this.cw){if("EditorControl"in this.h&&this.h.EditorControl){var n=this.h.EditorControl;n.il(this.dL);n.cH(this.dO);n.jX(this.dH);n.ik(this.dI);n.e(this.dD);n.eq(this.dN);n.lU(this.dM);n.lR(this.dE)}if(this.p.a()){var t=this.C.a("TabAnchor");t&&_j.l.c(t.z,"focusin")}this.cw=!1}},gJ:function(n){this.i("EditorControl");n.b()},da:function(n){_j.i.a(this.j)||this.i(this.j);n.a(!0)},be:function(){this.j=null;this.bk&&(this.j="AttachmentWellViewWrapper");var n=this.W();n.bb.bu()||_j.i.a(this.j)&&this.l("SubjectTextBox")&&(this.j="SubjectTextBox");_j.i.a(this.j)&&this.l("BccRecipientWellControl")&&(this.j="BccRecipientWellControl");if(_j.i.a(this.j)&&this.l("CcRecipientWellControl")){this.j="CcRecipientWellControl";this.h.BccRecipientWellControl.rpcl("IsHidden",this.cl);this.h.BccRecipientWellControl.apcl("IsHidden",this.cl)}_j.i.a(this.j)&&this.l("ToRecipientWellControl")&&(this.j="ToRecipientWellControl");!_j.i.a(this.j)&&this.h&&this.h[this.j]&&_j.l.b(this.h[this.j].z,"keydown",this.cL)},bX:function(){!_j.i.a(this.j)&&this.h&&this.h[this.j]&&_j.l.c(this.h[this.j].z,"keydown")},l:function(n){if(!this.h)return!1;var t=this.h[n];return!!t&&!t.bm()},hp:function(n,t){this.l("BccRecipientWellControl")&&this.k&&this.i("BccRecipientWellControl");this.bX();this.be()},hs:function(n,t){this.h.CcRecipientWellControl.rpcl("IsHidden",this.cE);this.l("CcRecipientWellControl")&&this.k&&this.i("CcRecipientWellControl");this.bX();this.be()},fV:function(n,t){},hh:function(n){var t=this.W();if(t){t.bb.ei(n.f());t.bb.dK(n.e());t.bb.dT(n.c())}n.c()&&this.bq("ShouldHideSpinner")},gS:function(n){var i=this.W();if(i){var t=i.be().a().bf();t.b(n.c());t.a(n.c())}},gT:function(n){var t=this.W();if(t){var i=t.be().a();i.U(n.c())}},gR:function(n){this.fT()},eP:function(n){var i=this.W();if(i){var f=i.bg;switch(n.c()){case 1:var s=i.bh();var u=s.a();u&&u.b&&u.a();break;case 2:this.v&&this.v.a(_y.ev,new _y.ev);break;case 3:var r=i.bm().e();r&&r.b&&r.a();break;case 4:var t=null;if(this.m==="Mouse"){var o=f.b(19);t=o.a()}else{var e=f.b(10);t=e.a()}t&&t.b&&t.a();break;case 5:this.i("ToRecipientWellControl");break;case 8:this.da(n);break}}},hg:function(n){var t=this.W();if(t){var r=IGroupInlineComposeViewModel.isInstanceOfType(t)?8:0;var i=n.c().textContent;n.a(_zz.d.v(r,n.c().id,i,t.bi,t.bs(),9))}},fn:function(){var t=this.W();if(this.h&&t){var n;n=this.h.EditorControl;n&&n.bc&&t.cy&&this.cb&&this.bR&&n.fg()}},gq:function(){if(this.h&&this.h.EditorControl){var n=this.h.EditorControl;n.bc&&n.bN(new _cmc.f(!1))}},fT:function(){var t=this.W();if(this.bC&&this.h&&this.h.EditorControl){var n=this.h.EditorControl;if(n.bc&&!n.cT()){n.bN(new _cmc.bp);t.bb.cS(n.cb.b)}}else t.bb.cS(0)},hD:function(n,t){},gp:function(){this.bV(0)},fi:function(){if(this.h){var i=this.h.ToReadWriteRecipientWellView;var t=this.h.CcReadWriteRecipientWellView;var n=this.h.BccReadWriteRecipientWellView;this.fo(i);this.fo(t);this.fo(n)}},fo:function(n){if(n&&_rw.d.isInstanceOfType(n.W())){var t=n.W();t.bF(!0);t.bF(!1)}},hB:function(){var n=this.h.QuotedBodyHtmlLabel;if(n){this.h.QuotedBodyHtmlLabel.cG().on("touchstart",null,null,this.eI);this.h.QuotedBodyHtmlLabel.cG().on("touchend",null,null,this.eH)}},ho:function(){var n=this.h.QuotedBodyHtmlLabel;if(n){this.h.QuotedBodyHtmlLabel.cG().off("touchstart",null,this.eI);this.h.QuotedBodyHtmlLabel.cG().off("touchend",null,this.eH)}},hW:function(n){if(n.target.tagName==="A"){var t=n.target.getAttribute("href");this.bU.d().a(t);n.stopPropagation();n.preventDefault()}},hX:function(n){if(n.target.tagName==="A"){n.stopPropagation();n.preventDefault()}},w:function(){var n=this.W();var t=this.h.EditorControl;this.p.h()&&this.h&&this.h.SubjectTextBox&&_zz.M.c(this.h.SubjectTextBox.z,null);this.gK();this.m==="TouchNarrow"?this.fl(!1):this.fl(!0);this.s().gS(this);this.dp(!0);this.dq(!0);_j.e.a(_a.a.a,"PostTransitionIn active view. Context: {0}",n.bb);n.bb.bG()||this.gr()||this.W().apcl("ReadyToSetInitialFocus",this.cQ);this.co()},hT:function(n,t){var i=n;i.rpcl("IsReadyForViewInitialization",this.cR);this.w()},gs:function(){if(this.h&&this.h.EditorControl){var n=this.h.EditorControl;n.bN(new _cmc.B(!0));this.t("EditorControl")}},hV:function(n){if(Node.isInstanceOfType(n.target))for(var i=0;i<this.n.d.length;i++){var r=this.n.d[i];var t=this.h[r.a];if(t&&(n.target===t.z||t.z.contains(n.target))){this.cY(r.a);this.eQ();break}}return!0},hU:function(n){if(Node.isInstanceOfType(n.target))for(var t=0;t<this.r.d.length;t++){var r=this.r.d[t];var i=this.h[r.a];if(n.target===i.z||i.z.contains(n.target)){r.b(null,null);break}}return!0},hy:function(n){_b.r.b(n);var t=n.dataTransfer.types;this.fj(t);this.bL&&(this.bL=_j.o.a().b(this.bL));return!1},hx:function(n){if(!this.bL){var t=this;this.bL=_j.o.a().a(_a.a.f,"OnDragLeave",function(){t.fj(null);t.bL=null},50)}return!0},hz:function(n){_b.r.b(n);this.fj(null);return!1},fU:function(n){return n==="ToRecipientWellControl"||n==="BccRecipientWellControl"||n==="CcRecipientWellControl"},hj:function(){return!!this.bM&&this.bM.a().eO().Enabled},ig:function(n,t){if(this.hj()&&!this.fU(n)&&this.fU(t)){var i=this;_j.o.a().a(this.F(),"Delayed PeopleRecommendations recipients retrieval",function(){if(i.W()){var t=i.W();if(t&&!t.eK){var n=i.W().ea();n&&n.b(1)}}},100)}},cY:function(n){_j.e.a(_a.a.a,"Focused in {0}",n);this.t(n);this.u(n==="CcRecipientWellControl"||n==="BccRecipientWellControl"||n==="ToRecipientWellControl"||n==="ToRecipientButton"||n==="OpenSeperateWindowButton"||n==="AffordanceMenuButton"||n==="InsertButton"||n==="DiscardButton"||n==="AppsButton");if(this.W()&&_mcp.e.isInstanceOfType(this.W())){var i=this.W();if(this.k==="FromFieldControl"){var t=i.bd();t&&t.K(!1)}}},fL:function(){var n=this.W();n&&this.hZ(this.p.a()&&n.bb.j()==="Text"?!0:!1)},hG:function(n){var t=n.a();if(this.j!=="AttachmentWellViewWrapper"&&t===9&&!n.o()){this.i("EditorControl");this.gY(n)}},hP:function(n,t){this.gr()},gr:function(){var n=this.W();if(n&&!this.ff&&(n.cE||!(this.m==="Mouse"))){this.ff=!0;this.fm();n.rpcl("ReadyToSetInitialFocus",this.cQ);return!0}return!1}};_mcp.l.a=function(n,t){this.a=n;this.b=t};_mcp.l.a.prototype={a:null,b:null,c:function(){var n=this;return function(t){n.b(t,{uiComponent:n.a})}}};_mcp.bc=function(n){this.h=Function.createDelegate(this,this.p);this.g=Function.createDelegate(this,this.o);this.b={};_mcp.bc.initializeBase(this,[n])};_mcp.bc.prototype={c:null,a:null,d:null,e:function(){this.b.UpconvertButton.S();this.c="UpconvertButton";_mcp.n.isInstanceOfType(this.a)&&(this.a.bv=!0)},I:function(){_j.c.prototype.I.call(this);this.b.ShowCcButton=this.C.a("ShowCcButton");this.b.ShowBccButton=this.C.a("ShowBccButton");this.b.UpconvertButton=this.C.a("UpconvertButton")},eg:function(){_j.h.prototype.eg.call(this);this.q()},M:function(){this.i();_j.c.prototype.M.call(this)},br:function(){this.i();_j.c.prototype.br.call(this)},j:function(n){if(this.b[n]){this.b[n].S();this.c=n}},q:function(){this.d=this.X;this.a=this.d.X;_mcp.h.isInstanceOfType(this.a)&&(this.a=this.a.X);_mcp.n.isInstanceOfType(this.a)&&this.a.iq(this);_j.l.b(this.d.z,"focusout",this.g);_j.l.b(this.d.z,"keydown",this.h)},f:function(n){var t=this.b?this.b[n]:null;return!!t&&!t.bm()},p:function(n){var t=n.a();if(t===9&&n.g())if(this.b.UpconvertButton.eY()){this.c="UpconvertButton";this.n()}else if(this.b.ShowBccButton.eY()){this.c="ShowBccButton";this.k()}else if(this.b.ShowCcButton.eY()){this.c="ShowCcButton";this.l()}},n:function(){if(this.f("ShowBccButton")){this.j("ShowBccButton");_mcp.n.isInstanceOfType(this.a)&&(this.a.bv=!0)}else this.f("ShowCcButton")&&this.k()},k:function(){if(this.f("ShowCcButton")){this.j("ShowCcButton");_mcp.n.isInstanceOfType(this.a)&&(this.a.bv=!0)}else this.l()},l:function(){this.c=null;if(_mcp.n.isInstanceOfType(this.a)){this.a.ir();this.a.bv=!1}},i:function(){this.m();_j.l.c(this.d.z,"focusout");_j.l.c(this.d.z,"keydown")},o:function(n){this.m()},m:function(){this.c=null;_mcp.n.isInstanceOfType(this.a)&&(this.a.bv=!1)}};_mcp.n=function(n,t,i,r,u,f,e,o){this.gx=Function.createDelegate(this,this.im);this.gy=Function.createDelegate(this,this.io);this.fp=Function.createDelegate(this,this.il);this.gw=Function.createDelegate(this,this.ik);this.gz=Function.createDelegate(this,this.ip);_mcp.n.initializeBase(this,[n,t,i,r,u,f,e,o,!1])};_mcp.n.prototype={dw:!1,bY:null,bv:!1,eM:function(){return 0},cZ:function(){return 0},dz:function(){return!0},iq:function(n){n&&(this.bY=n)},ir:function(){if(this.l("FromFieldControl"))this.i("FromFieldControl");else{this.dw=!0;this.i("ToRecipientWellControl")}},I:function(){_mcp.cd.prototype.I.call(this);if(this.C){this.h.InsertPictureButton=this.C.a("InsertPictureButton");this.h.FormatButton=this.C.a("FormatButton");this.h.ShowOriginalMessage=this.C.a("ShowOriginalMessage");this.h.AggregatedReadOnlyHeader=this.C.a("AggregatedReadOnlyHeader");this.h.ReadWriteHeader=this.C.a("ReadWriteHeader");this.h.ComposeBodyContainer=this.C.a("ComposeBodyContainer")}else{this.h.InsertPictureButton=null;this.h.FormatButton=null;this.h.Emoji=null;this.h.ShowOriginalMessage=null;this.h.AggregatedReadOnlyHeader=null;this.h.ReadWriteHeader=null;this.h.ComposeBodyContainer=null}},w:function(){_mcp.i.isInstanceOfType(this.W())&&(this.o=this.W().b);_mcp.cd.prototype.w.call(this);var r=this.h.InlineComposeBody;var u=this.h.InlineComposeBottomEdge;var i=this.h.InlineComposeHeaderWrapper;var n=!!r&&!!this.s()&&!!i&&!!u;if(!n){var t="[MailInlineCompose: InitializeView] - One or more of inline compose control elements are null.";_j.e.c(this.F(),t);return}},ik:function(n){this.ce(!1);this.i("ToRecipientWellControl")},ce:function(n){if(this.W()&&_mcp.e.isInstanceOfType(this.W())){var t=this.W();t.bk().a("ShowFullRecipient");this.ci(n);t.bd().L(n)}},i:function(n){if(this.h)switch(n){case"Emoji":if(this.h[n]){this.h[n].S();this.t(n)}break;case"FormatButton":case"InsertPictureButton":case"ShowOriginalMessage":if(this.l(n)){this.h[n].S();this.t(n)}break;case"EditorControl":var t=this.h.EditorControl;this.bd.a()&&t.dd()||t.bN(new _cmc.B(!1));this.t(n);break;default:_mcp.l.prototype.i.call(this,n);break}},cr:function(n){_mcp.cd.prototype.cr.call(this,n);this.cy.a(IMailInlineComposeFocusEvent,new _mcp.bg)},be:function(){this.j=null;this.bk&&(this.j="AttachmentWellViewWrapper");!this.j&&this.l("BccRecipientWellControl")&&(this.j="BccRecipientWellControl");!this.j&&this.l("CcRecipientWellControl")&&(this.j="CcRecipientWellControl");!this.j&&this.l("ToRecipientWellControl")&&(this.j="ToRecipientWellControl");!_j.i.a(this.j)&&this.l(this.j)&&_j.l.b(this.h[this.j].z,"keydown",this.cL)},bX:function(){!_j.i.a(this.j)&&this.h&&this.h[this.j]&&_j.l.c(this.h[this.j].z,"keydown")},eR:function(){this.bo&&this.gA()},da:function(n){if(!_j.i.a(this.j)){this.bk||this.ce(!1);this.i(this.j);this.j!=="ToRecipientWellControl"||this.l("FromFieldControl")||this.bY.e()}n.a(!0)},cY:function(n){_j.e.a(_a.a.a,"Focused in {0}",n);this.t(n);var t=n==="CcRecipientWellControl"||n==="CcRecipientButton"||n==="BccRecipientWellControl"||n==="BccRecipientButton"||n==="ToRecipientWellControl"||n==="ToRecipientButton"||n==="FromFieldControl";this.u(t||n==="AttachmentWellViewWrapper");this.ci(!t);t&&this.cy.a(IMailInlineComposeFocusEvent,new _mcp.bg);if(this.W()&&_mcp.e.isInstanceOfType(this.W())){var r=this.W();if(this.k==="FromFieldControl"){var i=r.bd();i&&i.K(!1)}}},co:function(){_mcp.l.prototype.co.call(this);var i=this.h.ShowOriginalMessage;i&&_j.l.b(i.z,"keydown",this.gz);var t=this.h.AggregatedReadOnlyHeader;if(!t){var r="[MailInlineCompose: BindEvents] -  AggregatedReadOnlyHeader is null or undefined.";_j.e.c(this.F(),r);return}_j.l.b(t.z,"click",this.gw);t.apcl("IsHidden",this.fp);var n=this.h.ComposeBodyContainer;if(n){_j.l.b(n.z,"mouseover",this.gy);_j.l.b(n.z,"mouseout",this.gx)}},bW:function(){_mcp.cd.prototype.bW.call(this);var i=this.h.ShowOriginalMessage;i&&_j.l.c(i.z,"keydown");var t=this.h.AggregatedReadOnlyHeader;if(!t){var r="[MailInlineCompose: UnbindEvents] -  AggregatedReadOnlyHeader is null or undefined.";_j.e.b(this.F(),r);return}_j.l.c(t.z,"click");t.rpcl("IsHidden",this.fp);var n=this.h.ComposeBodyContainer;if(n){_j.l.c(n.z,"mouseover");_j.l.c(n.z,"mouseout")}},fV:function(n,t){this.bX();this.be();this.ce(!1)},cC:function(){_mcp.cd.prototype.cC.call(this);this.is(!this.bw)},fg:function(n){_mcp.l.prototype.fg.call(this,n);this.o&&this.o.c(1)},is:function(n){this.l("FormatButton")&&this.h.FormatButton.fz(n);this.l("InsertPictureButton")&&this.h.InsertPictureButton.fz(n);this.l("Emoji")&&this.h.Emoji.fz(n)},ip:function(n){var t=n.a();if(t===9&&!n.o()){this.i("SendButton");this.gY(n)}},gA:function(){if(!this.bv)switch(this.k){case"BccRecipientWellControl":this.i("BccRecipientButton");break;case"BccRecipientButton":this.l("CcRecipientWellControl")?this.i("CcRecipientWellControl"):this.l("FromFieldControl")?this.i("ToRecipientWellControl"):this.bY.e();break;case"CcRecipientWellControl":this.i("CcRecipientButton");break;case"CcRecipientButton":this.l("FromFieldControl")?this.i("ToRecipientWellControl"):this.bY.e();break;case"ToRecipientWellControl":this.dw?this.dw=!1:this.i("ToRecipientButton");break;case"ToRecipientButton":this.l("FromFieldControl")?this.bY.e():this.u(!1);break;case"FromFieldControl":this.bv||this.u(!1);break;case"ShowOriginalMessage":this.i("EditorControl");break;case"SendButton":this.i("ShowOriginalMessage");break;case"AttachmentWellViewWrapper":this.ce(!1);this.l("FromFieldControl")?this.i("ToRecipientWellControl"):this.bY.e();break;default:this.u(!1);break}},im:function(n){this.fq(!1)},io:function(n){this.fq(!0)},fq:function(n){var t=null;t=this.cf?"ms-border-color-themeTertiary":n?"ms-border-color-neutralTertiary":"ms-border-color-neutralTertiaryAlt";this.it(t)},it:function(n){if(!_j.i.a(n)){for(var i=this.h.InlineComposeBottomEdge,f=i.z.className.split(" "),u=f,e=u.length,t=0;t<e;++t){var r=u[t];r.startsWith("ms-border-color")&&i.bx(r)}i.bl(n)}},il:function(n,t){this.fi();this.fq(!1)}};_mcp.a=function(){};_mcp.a.$$cctor=function(){_mcp.a._I()};_mcp.a.fY=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span></span> </div><div> <div class='ms-font-weight-regular ms-font-color-neutralSecondaryAlt InfobarImmediateTextContainer'> <span class='_mcp_2'></span> <a class='_mcp_3 ms-font-weight-regular ms-font-color-themeDark ms-font-s'></a> <span class='ms-font-weight-regular ms-font-color-themeDark ms-font-s'></span> <a class='_mcp_3 ms-font-weight-regular ms-font-color-themeDark ms-font-s'></a> </div> </div><div> <span class='_mcp_4'></span> <span class='_mcp_4'></span> </div><div> <div class='_mcp_t ms-font-weight-regular ms-font-color-neutralDark'></div> </div><div> <button type='button' class='_mcp_g'></button> <div class='_mcp_v'></div> <div class='_mcp_e'></div> <div class='_mcp_e'></div> </div><div> <span class='_mcp_k ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_s'> <span class='_mcp_l ms-font-weight-regular ms-font-color-black'></span> <button type='button' class='_mcp_x ms-font-m'></button> </div> </div><div> <span class='_mcp_r'></span> <span class='_mcp_r'></span> </div><div> <span class='_mcp_r'></span> </div><div> <span class='_mcp_k ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_s'> <span class='_mcp_o _mcp_p _mcp_q ms-font-weight-regular ms-font-color-neutralSecondary'></span> <div></div> </div> </div><div> <span class='_mcp_k ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_s'> <span class='_mcp_q ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_k ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_s'> <div class='_mcp_9'></div> </div> </div><div> <button autoid=\"_mcp_5\" type='button'></button> <div></div> </div><div> <div class='_mcp_X _mcp_Y'></div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_h'></span> </div><div> <div class='_mcp_G'></div>  <div class='ms-bg-color-themePrimary'></div> <div class='_mcp_I'> <div class='_mcp_J ms-font-weight-regular ms-font-color-neutralPrimary'></div> <div>  <div class='_mcp_P'></div> <div class='_mcp_N'> <div class='_mcp_c'> <div class='_mcp_7 _mcp_O _mcp_d ms-border-color-neutralTertiary ms-bg-color-white'></div> </div> <div class='_mcp_7 _mcp_S _mcp_d ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_j ms-font-weight-regular ms-font-color-black _mcp_F'></button> <div> <div class='_mcp_E'> <button type='button'></button> </div> <div autoid=\"_mcp_0\" class='_mcp_a _mcp_y'></div> </div> <div> <div class='_mcp_a _mcp_y'></div> </div> </div> <div class='_mcp_7 _mcp_S _mcp_d ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_j ms-font-weight-regular ms-font-color-black _mcp_F'></button> <div> <div class='_mcp_E'> <button type='button'></button> </div> <div autoid=\"_mcp_1\" class='_mcp_a _mcp_y'></div> </div> <div> <div class='_mcp_a _mcp_y'></div> </div> </div> <div class='_mcp_7 _mcp_S _mcp_d ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_j ms-font-weight-regular ms-font-color-black _mcp_F'></button> <div> <div class='_mcp_E'> <button type='button'></button> </div> <div autoid=\"_mcp_2\" class='_mcp_a _mcp_y'></div> </div> <div> <div class='_mcp_a _mcp_y'></div> </div> </div> <div class='_mcp_7 _mcp_b _mcp_d ms-border-color-neutralTertiary ms-bg-color-white'> <div class='_mcp_s'> <button type='button' class='_mcp_x _mcp_n'></button> <span class='_mcp_x _mcp_m'></span> <span class='_mcp_x _mcp_m'></span> <span class='_mcp_x _mcp_m'></span> <button type='button' class='_mcp_x ms-font-xl'></button> <div class='_mcp_y'> <input autoid=\"_mcp_3\" class='_mcp_t _mcp_u ms-font-weight-regular ms-font-color-neutralSecondary'/> </div> </div> </div> <div> <div class='_mcp_8 ms-bg-color-white'></div> <div class='_mcp_8 ms-bg-color-white'></div> <div class='_mcp_8 ms-bg-color-white'></div> <div class='_mcp_8 ms-bg-color-white'></div> </div> <div> <div class='_mcp_7 ms-bg-color-white'> <div></div> </div> </div> <span></span> </div> <div class='_mcp_N ms-bg-color-white'> <div autoid=\"_mcp_4\" class='_mcp_z'></div> <div class='_mcp_K ms-border-color-neutralTertiary'></div> </div> <div class='_mcp_N ms-bg-color-white'> <span class='_mcp_B ms-font-weight-regular'></span> </div> </div> </div> <div></div> <div></div> <div></div> <div></div> <div></div> <div></div> <div class='_mcp_H'></div>  </div><div>  <span></span> </div><div> <div class='_mcp_B1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_c\" type='button' class='_mcp_p1'></button> <div class='_mcp_E1'></div> <div class='_mcp_l1'></div> <div class='_mcp_l1'></div> <div></div> </div><div> <span class='_mcp_t1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_x1'> <span autoid=\"_mcp_k\" class='_mcp_u1 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_J1'></span> <span class='_mcp_J1'></span> </div><div> <span class='_mcp_J1'></span> </div><div> <span class='_mcp_t1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_x1'> <div> <span class='_mcp_J1 _mcp_I1 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_K1'></span> <div></div> </div> </div> </div><div> <span class='_mcp_t1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_x1'> <span autoid=\"_mcp_l\" class='_mcp_I1 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div> </div><div> <span class='_mcp_t1 ms-font-weight-semibold ms-font-color-black _mcp_v1'></span> <div class='_mcp_x1'> <div class='_mcp_h1'></div> </div> </div><div> <button autoid=\"_mcp_m\" type='button'></button> <div></div> </div><div> <span class='_mcp_r1 ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_q1'></span> </div><div> <iframe autoid=\"_mcp_r\" class='_mcp_42'></iframe> </div><div> <div class='_mcp_52'> <button type='button' class='_mcp_62 _mcp_O1 ms-font-weight-regular'></button> <span></span> </div> </div><div> <button type='button' class='_mcp_s1 ms-font-weight-semibold'></button> <button type='button' class='_mcp_s1 ms-font-weight-semibold'></button> </div><div> <div class='_mcp_c1 _mcp_82'></div> </div><div> <div></div> <div class='_mcp_Y1'></div> <span class='_mcp_Y1'></span> <div class='_mcp_81 ms-bg-color-white'> <div class='_mcp_32'></div> <div></div> <div class='_mcp_91'>  <span class='_mcp_b1'> <div class='_mcp_T1'> <button autoid=\"_mcp_6\" type='button' class='_mcp_O1 ms-font-weight-regular sendButton'></button> <button type='button' class='_mcp_O1 ms-font-weight-regular sendButton'></button> </div> <div class='_mcp_T1'> <button autoid=\"_mcp_7\" type='button' class='_mcp_O1 ms-font-weight-regular closeButton'></button> </div> <div class='_mcp_T1'> <button autoid=\"_mcp_8\" type='button' class='_mcp_O1 ms-font-weight-regular includeButton'></button> </div> <div class='_mcp_T1'> <button autoid=\"_mcp_9\" type='button' class='_mcp_O1 ms-font-weight-regular _mcp_R1'></button> </div> <button autoid=\"_mcp_a\" type='button' class='_mcp_O1 ms-font-weight-regular'></button> </span> <span class='_mcp_c1'> <button autoid=\"_mcp_b\" type='button' class='_mcp_O1 ms-font-weight-regular'></button> </span> </div> <div class='_mcp_a1 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> <div class='_mcp_21'> <div class='_mcp_31 _mcp_61'></div> <div></div> <div class='_mcp_31 _mcp_51'> <div class='_mcp_71 ms-bg-color-white customScrollBar'>  <div class='_mcp_d1 ms-font-weight-regular'></div> <div class='_mcp_f1 _mcp_k1 ms-border-color-neutralTertiary _mcp_i1'></div> <div class='_mcp_f1 _mcp_i1 _mcp_k1 ms-border-color-neutralTertiary'> <button autoid=\"_mcp_d\" type='button' class='_mcp_s1 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_12'></button> <div class='_mcp_x1 _mcp_z1 _mcp_y1'> <div></div> <div autoid=\"_mcp_e\" class='_mcp_V1'></div> </div> <div class='_mcp_x1 _mcp_z1 _mcp_y1 _mcp_A1'> <div class='_mcp_V1'></div> </div>  </div> <div class='_mcp_f1 _mcp_i1 _mcp_k1 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_s1 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_12'></button> <div class='_mcp_x1 _mcp_z1 _mcp_y1'> <div autoid=\"_mcp_f\" class='_mcp_V1'></div> </div> <div class='_mcp_x1 _mcp_z1 _mcp_y1 _mcp_A1'> <div class='_mcp_V1'></div> </div>  </div> <div class='_mcp_f1 _mcp_i1 _mcp_k1 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_s1 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_12'></button> <div class='_mcp_x1 _mcp_z1 _mcp_y1'> <div autoid=\"_mcp_g\" class='_mcp_V1'></div> </div> <div class='_mcp_x1 _mcp_z1 _mcp_y1 _mcp_A1'> <div class='_mcp_V1'></div> </div>  </div> <div class='_mcp_f1'> <span class='_mcp_s1 ms-font-weight-semibold ms-font-color-black _mcp_w1 '></span> <span class='_mcp_s1 ms-font-weight-semibold ms-font-color-black _mcp_w1 '></span> </div> <div class='_mcp_f1 _mcp_g1 _mcp_k1 ms-border-color-neutralTertiary'> <div class='_mcp_x1'> <span class='_mcp_X1'></span> <span autoid=\"_mcp_h\" class='_mcp_W1'></span> <span autoid=\"_mcp_i\" class='_mcp_W1'></span> <span class='_mcp_W1'></span> <div class='_mcp_V1'> <input autoid=\"_mcp_j\" class='_mcp_B1 _mcp_C1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> <div class='_mcp_a2'> <div class='_mcp_j1'></div> <div class='_mcp_j1'></div> <div class='_mcp_j1'></div> <div class='_mcp_j1'></div> </div> <div class='_mcp_G1 ms-font-weight-regular ms-font-color-neutralPrimary'></div> </div> <span></span> <span></span> <div class='_mcp_L1'></div> <div class='_mcp_72 ms-border-color-neutralTertiary'></div> </div> </div> <div></div> <div class='_mcp_Z1 ms-bg-color-white'></div> <div autoid=\"_mcp_n\"></div> <div autoid=\"_mcp_o\"></div> <div></div> <div></div> <div></div>  <div autoid=\"_mcp_p\"></div> <div autoid=\"_mcp_q\"></div>      </div><div> <div class='_mcp_Q2 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_s\" type='button' class='ms-font-weight-semibold ms-font-s _mcp_D2'></button> <div class='_mcp_T2'></div> <div class='_mcp_A2'></div> <div class='_mcp_A2'></div> <div></div> </div><div> <span class='_mcp_H2 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_L2'> <span autoid=\"_mcp_y\" class='_mcp_I2 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_03'></span> <span class='_mcp_03'></span> </div><div> <span class='_mcp_03'></span> </div><div> <span class='_mcp_H2 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_L2'> <div> <span class='_mcp_03 _mcp_Z2 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_13'></span> <div></div> </div> </div> </div><div> <span class='_mcp_H2 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_L2'> <span autoid=\"_mcp_z\" class='_mcp_Z2 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div> </div><div> <span class='_mcp_H2 ms-font-weight-semibold ms-font-color-black _mcp_J2'></span> <div class='_mcp_L2'> <div class='_mcp_r2'></div> </div> </div><div> <span class='_mcp_m2'></span> <span class='_mcp_m2'></span> <button type='button' class='ms-font-s ms-font-weight-regular _mcp_m2'></button> <button type='button' class='ms-font-s ms-font-weight-regular _mcp_m2'></button> <button type='button' class='_mcp_m2 ms-border-color-neutralTertiary _mcp_n2'></button> </div><div> <div class='_mcp_l2'></div> </div><div> <div class='_mcp_b3'></div> <span class='_mcp_b3'></span> <div class='_mcp_c2 _mcp_w2 ms-border-color-neutralLight'> <div class='_mcp_d2 _mcp_g3'></div> <div class='_mcp_d2 _mcp_e2 ms-bg-color-white'> <div class='_mcp_g2'> <div class='_mcp_k2 ms-font-weight-regular'></div> </div> <div> <div class='_mcp_f2'> <div class='ms-bg-color-white customScrollBar _mcp_y2'>  <div class='_mcp_t2'> <div></div>  </div> <div> <div class='_mcp_o2 _mcp_p2 _mcp_w2 ms-border-color-neutralLight'></div> <div class='_mcp_o2 _mcp_s2'> <button autoid=\"_mcp_t\" type='button' class='_mcp_G2 ms-font-weight-semibold ms-font-s _mcp_e3'></button> <div class='_mcp_L2 _mcp_M2'> <div autoid=\"_mcp_u\" class='_mcp_83'></div> </div> <div class='_mcp_L2 _mcp_M2 _mcp_N2'> <div class='_mcp_83'></div> </div> <div></div>  </div> <div class='_mcp_o2 _mcp_s2 _mcp_x2 ms-border-color-neutralLight'> <button type='button' class='_mcp_G2 ms-font-weight-semibold ms-font-s _mcp_e3'></button> <div class='_mcp_L2 _mcp_M2'> <div autoid=\"_mcp_v\" class='_mcp_83'></div> </div> <div class='_mcp_L2 _mcp_N2'> <div class='_mcp_83'></div> </div>  </div> <div class='_mcp_o2 _mcp_s2 _mcp_x2 ms-border-color-neutralLight'> <button type='button' class='_mcp_G2 ms-font-weight-semibold ms-font-s _mcp_e3'></button> <div class='_mcp_L2 _mcp_M2'> <div autoid=\"_mcp_w\" class='_mcp_83'></div> </div> <div class='_mcp_L2 _mcp_N2'> <div class='_mcp_83'></div> </div>  </div> <div class='_mcp_o2'> <span class='_mcp_G2 ms-font-weight-semibold ms-font-color-black _mcp_K2 '></span> <span class='_mcp_G2 ms-font-weight-semibold ms-font-color-black _mcp_K2 '></span> </div> <div class='_mcp_o2 _mcp_q2 _mcp_w2 ms-border-color-neutralTertiary'> <span class='_mcp_G2 ms-font-weight-semibold ms-font-color-black _mcp_K2'></span> <div class='_mcp_L2'> <div class='_mcp_83'> <input autoid=\"_mcp_x\" class='_mcp_Q2 _mcp_R2 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> <div> <div class='_mcp_v2'></div> <div class='_mcp_v2'></div> <div class='_mcp_v2'></div> <div class='_mcp_v2'></div> </div> </div> </div> <div class='_mcp_w2 ms-border-color-themeTertiary'></div> </div> <span></span> <span></span> <div class='_mcp_z2'> <div>  <div class='_mcp_V2 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_W2 ms-border-color-neutralLight'></div> </div> <div></div> <div class='_mcp_23'> <div></div> </div> <div class='_mcp_k3'> <button autoid=\"_mcp_A\" type='button' class='ms-font-s ms-font-weight-regular'></button> <div></div> </div> <div class='_mcp_l3'></div> </div> </div> <div class='_mcp_g2 _mcp_x2 ms-bg-color-white'> <div class='_mcp_m3 ms-border-color-neutralTertiaryAlt'> <div class='_mcp_o3'></div> <div class='_mcp_n3'></div> <div class='_mcp_p3'></div> </div> <div class='_mcp_i2'>  <button type='button' class='_mcp_63'></button> <button type='button' class='_mcp_63'></button> <button type='button' class='_mcp_63'></button> <button type='button' class='_mcp_73'></button> <button type='button' class='_mcp_73 _mcp_r3'></button> <div></div> <button type='button' class='_mcp_73'></button> <button type='button' class='_mcp_73'></button> <button type='button' class='_mcp_73'></button> <span class='_mcp_t3 ms-font-weight-semilight ms-font-color-neutralSecondary'></span>  <div class='_mcp_u3'></div> </div> <div class='_mcp_j2 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> </div> </div> <div></div> <div class='_mcp_c3 ms-bg-color-white'></div> <div autoid=\"_mcp_B\"></div> <div></div> <div></div> <div autoid=\"_mcp_C\"></div> <div autoid=\"_mcp_D\"></div>  </div><div> <span class='_mcp_D3 _mcp_E3 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_G3'></div> </div><div> <span class='_mcp_J3'></span> <span class='_mcp_J3'></span> <button type='button' class='ms-font-s ms-font-weight-regular ms-font-color-neutralPrimary _mcp_J3 _mcp_K3'></button> </div><div> <span class='_mcp_D3 _mcp_E3 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_z3'></div> </div><div> <span class='_mcp_D3 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_A3'></div> </div><div> <span class='_mcp_D3 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_B3'></div> </div><div> <div class='_mcp_x3 _mcp_w3'> <div class='_mcp_y3'>  <div class='_mcp_z3'></div>  <div class='_mcp_A3'></div>  <div class='_mcp_B3'></div> </div> </div> <span>\n                ...\n            </span> </div><div> <div class='ms-font-color-neutralSecondary ms-font-s _mcp_F3'> <div class='_mcp_G3'></div> <div class='_mcp_G3'></div> <div class='_mcp_H3'></div> </div>  </div><div> <div class='_mcp_h4 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_E\" type='button' class='_mcp_44 ms-font-weight-semibold ms-font-s'></button> <div class='_mcp_k4'></div> <div class='_mcp_04'></div> <div class='_mcp_04'></div> <div></div> </div><div> <button autoid=\"_mcp_M\" type='button'></button> <div></div> </div><div> <span class='_mcp_64 ms-font-weight-regular'></span> <span class='_mcp_54'></span> </div><div> <iframe autoid=\"_mcp_R\" class='_mcp_H4'></iframe> </div><div> <div class='_mcp_I4'> <button type='button' class='_mcp_J4 _mcp_w4 ms-font-weight-regular'></button> <span></span> </div> </div><div> <button type='button' class='_mcp_74 ms-font-s ms-font-weight-regular'></button> <button type='button' class='_mcp_74 ms-font-s ms-font-weight-regular'></button> </div><div> <div class='_mcp_R4'></div> </div><div> <div></div> <div class='_mcp_C4'></div> <span class='_mcp_C4'></span> <div class='_mcp_T3 ms-bg-color-white'> <div class='_mcp_F4'></div> <div></div> <div class='_mcp_U3 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> <div class='_mcp_M3'> <div class='_mcp_N3 _mcp_G4'></div> <div></div> <div class='ms-border-color-neutralTertiary ms-bg-color-white _mcp_O3'></div> <div class='_mcp_N3'> <div class='_mcp_R3'> <div class='_mcp_S3 ms-bg-color-white customScrollBar'>  <div class='_mcp_V3 ms-font-weight-regular'></div> <div class='_mcp_W3 _mcp_Z3 ms-border-color-neutralTertiaryAlt _mcp_Y3'></div> <div class='_mcp_W3 _mcp_Y3 _mcp_Z3 ms-border-color-neutralTertiaryAlt'> <button autoid=\"_mcp_F\" type='button' class='_mcp_74 ms-font-weight-semibold ms-font-s _mcp_E4'></button> <div class='_mcp_c4 _mcp_e4 _mcp_d4'> <div></div> <div autoid=\"_mcp_G\" class='_mcp_z4'></div> </div> <div class='_mcp_c4 _mcp_e4 _mcp_d4 _mcp_f4'> <div class='_mcp_z4'></div> </div>  </div> <div class='_mcp_W3 _mcp_Y3 _mcp_Z3 ms-border-color-neutralTertiaryAlt'> <button type='button' class='_mcp_74 ms-font-weight-semibold ms-font-s _mcp_E4'></button> <div class='_mcp_c4 _mcp_e4 _mcp_d4'> <div autoid=\"_mcp_H\" class='_mcp_z4'></div> </div> <div class='_mcp_c4 _mcp_e4 _mcp_d4 _mcp_f4'> <div class='_mcp_z4'></div> </div>  </div> <div class='_mcp_W3 _mcp_Y3 _mcp_Z3 ms-border-color-neutralTertiaryAlt'> <button type='button' class='_mcp_74 ms-font-weight-semibold ms-font-s _mcp_E4'></button> <div class='_mcp_c4 _mcp_e4 _mcp_d4'> <div autoid=\"_mcp_I\" class='_mcp_z4'></div> </div> <div class='_mcp_c4 _mcp_e4 _mcp_d4 _mcp_f4'> <div class='_mcp_z4'></div> </div>  </div> <div class='_mcp_W3'> <span class='_mcp_74 ms-font-weight-semibold ms-font-color-black _mcp_b4 '></span> <span class='_mcp_74 ms-font-weight-semibold ms-font-color-black _mcp_b4 '></span> </div> <div class='_mcp_W3 _mcp_X3'> <div class='_mcp_c4'> <span class='_mcp_B4'></span> <span autoid=\"_mcp_J\" class='_mcp_A4'></span> <span autoid=\"_mcp_K\" class='_mcp_A4'></span> <span class='_mcp_A4'></span> <div class='_mcp_z4'> <input autoid=\"_mcp_L\" class='_mcp_g4 _mcp_i4 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> </div> <span></span> <span></span> <div> <div class='_mcp_U4 _mcp_S4 ms-bg-color-white'></div> </div> <div class='_mcp_t4'> <div class='_mcp_s4 _mcp_W4 ms-border-color-neutralTertiaryAlt'> <div class='_mcp_m4 ms-font-weight-regular ms-font-color-neutralPrimary ms-border-color-neutralTertiaryAlt'></div> <div></div> <div></div> <div class='_mcp_L4'></div> </div> <div class='_mcp_K4 ms-border-color-neutralTertiary'></div> <div class='_mcp_V4 _mcp_S4 ms-bg-color-white'> <div class='_mcp_N4 ms-border-color-neutralTertiaryAlt'> <div class='_mcp_P4'></div> <div class='_mcp_O4'></div> <div class='_mcp_Q4'></div> </div> <div class='_mcp_T4'>  <button type='button' class='_mcp_05'></button> <button type='button' class='_mcp_05'></button> <button type='button' class='_mcp_05'></button> <button type='button' class='_mcp_15'></button> <button type='button' class='_mcp_15 emojiAndInsertPictureButton'></button> <div></div> <button type='button' class='_mcp_15'></button> <button type='button' class='_mcp_15'></button> <button type='button' class='_mcp_15'></button> <span class='_mcp_Z4 ms-font-weight-semilight ms-font-color-neutralSecondary'></span>  <div class='_mcp_25'></div> </div> </div> </div> </div> </div> <div class='ms-border-color-neutralTertiary ms-bg-color-white _mcp_X4'></div> </div> <div></div> <div class='_mcp_D4 ms-bg-color-white'></div> <div autoid=\"_mcp_N\"></div> <div autoid=\"_mcp_O\"></div> <div></div> <div></div> <div></div>  <div autoid=\"_mcp_P\"></div> <div autoid=\"_mcp_Q\"></div>      </div><div> <button autoid=\"_mcp_V\" type='button' class='_mcp_65'></button> <button autoid=\"_mcp_W\" type='button' class='_mcp_65'></button> </div><div> <span class='_mcp_45 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div autoid=\"_mcp_S\" class='_mcp_55'></div> <button autoid=\"_mcp_T\" type='button' class='_mcp_65'></button> <button autoid=\"_mcp_U\" type='button' class='_mcp_65'></button>  <div></div> <div class='_mcp_75'></div>  </div><div> <span class='_mcp_85 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_95'></div> <button type='button' class='_mcp_a5'></button> <button type='button' class='_mcp_a5'></button>  </div><div> <div class='_mcp_d5'> <label></label> </div> <div class='_mcp_d5'> <label class='_mcp_j5'></label> <div class='_mcp_h5'> <input class='_mcp_f5'/> <input class='_mcp_f5'/> <input class='_mcp_f5'/> </div> </div> </div><div> <span class='_mcp_b5 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_e5'></div> <span class='_mcp_c5 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div><div> <span></span>  </div><div> <div class='_mcp_k5 ms-font-s ms-font-weight-regular ms-font-color-neutralSecondaryAlt InfobarImmediateTextContainer'> <div> <span class='_mcp_l5'></span> <a class='_mcp_m5 ms-font-weight-regular ms-font-color-themeDarkAlt ms-font-s'></a> <a class='_mcp_m5 ms-font-weight-regular ms-font-color-themeDarkAlt ms-font-s'></a> </div> <div> <div class='_mcp_o5'></div> <span class='_mcp_l5 ms-font-color-neutralDark'></span> </div> <div> <span class='_mcp_l5'></span> </div> <button type='button' class='_mcp_n5'></button> </div> </div><div> <div></div> </div><div> <div pictureSize=\"30\"> <span class='_mcp_A5'></span> </div> </div><div> <div class='_mcp_z5'></div> </div><div>  <div class='_mcp_p5'>  <div class='_mcp_q5 ms-bg-color-themePrimary'> <div class='_mcp_u5'> <span class='segoeui-light ms-font-xxl ms-font-color-white'></span> </div> <div class='_mcp_w5'> <div class='_mcp_B5'> <div class='_mcp_C5'> <div class='_mcp_D5'></div> </div> </div> <div class='_mcp_E5 ms-bg-color-themeLighter'> <span class='segoeui-semibold ms-font-m ms-font-color-themePrimary'></span> </div> </div> <div class='_mcp_v5'> <span class='segoeui-semilight ms-font-m ms-font-color-white'></span> <a class='_mcp_F5 segoeui-semilight ms-font-m ms-font-color-white'></a> </div> </div>  <div class='_mcp_r5'> <div class='_mcp_s5'></div> <div class='_mcp_t5'></div> </div> </div>  </div>";_j.h.a().appendChild(n);return n};_mcp.a.gq=function(n){return n.e()};_mcp.a.gr=function(n){return n.f()};_mcp.a.go=function(n){return n.b};_mcp.a.gp=function(n){return n.c};_mcp.a.gW=function(n){return n.b};_mcp.a.gV=function(n){return n.a};_mcp.a.d=function(n){return n.bd()};_mcp.a.F=function(n){return _mcp.f.isInstanceOfType(n)?n.bp:null};_mcp.a.db=function(n){return n.m()};_mcp.a.bg=function(n){return n.ct()};_mcp.a.bf=function(n){return n.a()};_mcp.a.E=function(n){return n.q()};_mcp.a.bh=function(n){return n.j()};_mcp.a.dc=function(n){return n.x()};_mcp.a.e=function(n){return n.bb};_mcp.a.be=function(n){return n.q()};_mcp.a.fO=function(n){return _mcp.l.isInstanceOfType(n)?n.gO():null};_mcp.a.T=function(n){return n.bD()};_mcp.a.P=function(n){return n.a()};_mcp.a.v=function(n){return n.dZ()};_mcp.a.eb=function(n){return n.e()};_mcp.a.bQ=function(n){return n.W()};_mcp.a.bW=function(n){return n.a()};_mcp.a.bX=function(n){return _mcp.g.isInstanceOfType(n)?n.j():null};_mcp.a.en=function(n){return _mcp.b.isInstanceOfType(n)?_u.P.P:null};_mcp.a.ea=function(n){return n.c()};_mcp.a.dZ=function(n){return n.b()};_mcp.a.K=function(n){return n.bP()};_mcp.a.eg=function(n){return n.a()};_mcp.a.df=function(n){return n.f()};_mcp.a.de=function(n){return n.c()};_mcp.a.gl=function(n){return n.c()};_mcp.a.dw=function(n){return n.bd};_mcp.a.dv=function(n){return n.u()};_mcp.a.w=function(n){return n.cb};_mcp.a.fQ=function(n){return n.de};_mcp.a.fv=function(n){return _a.g.b};_mcp.a.z=function(n){return n.bz()};_mcp.a.X=function(n){return n.a()};_mcp.a.bU=function(n){return n.b()};_mcp.a.gY=function(n){return n.eS()};_mcp.a.dq=function(n){return n.cJ};_mcp.a.bN=function(n){return n.ca};_mcp.a.er=function(n){return n.bH()};_mcp.a.gx=function(n){return n.a()};_mcp.a.bo=function(n){return n.bm()};_mcp.a.cm=function(n){return n.e()};_mcp.a.x=function(n){return n.bh()};_mcp.a.co=function(n){return _mcp.t.isInstanceOfType(n)?n.z:null};_mcp.a.cp=function(n){return n.dk()};_mcp.a.bm=function(n){return n.a()};_mcp.a.cl=function(n){return n.w()};_mcp.a.l=function(n){return n.X};_mcp.a.bB=function(n){return _mcp.l.isInstanceOfType(n)?n.cT:null};_mcp.a.I=function(n){return _mcp.l.isInstanceOfType(n)?n.bo:null};_mcp.a.bM=function(n){return n.bc};_mcp.a.q=function(n){return n.dV()};_mcp.a.bA=function(n){return n.dW()};_mcp.a.fM=function(n){return n.eL()};_mcp.a.bk=function(n){return n.E()};_mcp.a.S=function(n){return n.r()};_mcp.a.J=function(n){return n.Q()};_mcp.a.j=function(n){return n.dU()};_mcp.a.s=function(n){return n.v()};_mcp.a.hv=function(n){return n.gP()};_mcp.a.eo=function(n){return n.eV()};_mcp.a.Z=function(n){return n.a};_mcp.a.bT=function(n){return _rw.b.isInstanceOfType(n)?n.ek():null};_mcp.a.Y=function(n){return n.b};_mcp.a.R=function(n){return n.o()};_mcp.a.hu=function(n){return n.fO()};_mcp.a.bJ=function(n){return n.Q()};_mcp.a.Q=function(n){return n.n()};_mcp.a.ht=function(n){return n.fN()};_mcp.a.bl=function(n){return n.br()};_mcp.a.bL=function(n){return n.cr()};_mcp.a.gu=function(n){return n.e()};_mcp.a.cj=function(n){return n.a()};_mcp.a.dO=function(n){return n.s()};_mcp.a.dN=function(n){return n.o()};_mcp.a.cq=function(n){return n.dT()};_mcp.a.ck=function(n){return n.a()};_mcp.a.ch=function(n){return n.X()};_mcp.a.bE=function(n){return n.b};_mcp.a.dh=function(n){return _mcp.b.isInstanceOfType(n)?255:null};_mcp.a.dM=function(n){return n.bu()};_mcp.a.dJ=function(n){return n.bE()};_mcp.a.M=function(n){return n.be()};_mcp.a.ci=function(n){return n.a()};_mcp.a.gk=function(n){return n.m()};_mcp.a.G=function(n){return _mcp.b.isInstanceOfType(n)?n.fY():null};_mcp.a.bZ=function(n){return _mcp.b.isInstanceOfType(n)?n.fW():null};_mcp.a.cT=function(n){return n.D()};_mcp.a.cG=function(n){return n.cf()};_mcp.a.cS=function(n){return n.j()};_mcp.a.cH=function(n){return n.cT()};_mcp.a.dj=function(n){return n.bK()};_mcp.a.cX=function(n){return n.b()};_mcp.a.cF=function(n){return n.cb};_mcp.a.eA=function(n){return n.cp()};_mcp.a.ez=function(n){return n.bN()};_mcp.a.di=function(n){return n.dP()};_mcp.a.dd=function(n){return n.b()};_mcp.a.eV=function(n){return n.dq()};_mcp.a.dm=function(n){return n.bl};_mcp.a.gy=function(n){return n.h()};_mcp.a.gz=function(n){return n.i()};_mcp.a.t=function(n){return n.d()};_mcp.a.gt=function(n){return n.c()};_mcp.a.bx=function(n){return n.p};_mcp.a.by=function(n){return n.w};_mcp.a.bu=function(n){return n.o};_mcp.a.bv=function(n){return n.x};_mcp.a.bw=function(n){return n.n};_mcp.a.dn=function(n){return n.bV()};_mcp.a.da=function(n){return n.a()};_mcp.a.bH=function(n){return n.C};_mcp.a.bC=function(n){return n.bP};_mcp.a.ep=function(n){return n.bW()};_mcp.a.ed=function(n){return n.a()};_mcp.a.ha=function(n){return n.bJ};_mcp.a.A=function(n){return n.dY()};_mcp.a.bY=function(n){return _mcp.f.isInstanceOfType(n)?n.cm:null};_mcp.a.H=function(n){return n.dn()};_mcp.a.fd=function(n){return n.i()};_mcp.a.fb=function(n){return n.f()};_mcp.a.fc=function(n){return n.h()};_mcp.a.bV=function(n){return n.bF()};_mcp.a.ek=function(n){return _mcp.f.isInstanceOfType(n)?n.ez():null};_mcp.a.ee=function(n){return n.z()};_mcp.a.hd=function(n){return n.dr()};_mcp.a.fV=function(n){return n.eN()};_mcp.a.fP=function(n){return n.fP()};_mcp.a.eE=function(n){return n.j};_mcp.a.fT=function(n){return n.fQ()};_mcp.a.dk=function(n){return n.bt()};_mcp.a.cZ=function(n){return n.a()};_mcp.a.O=function(n){return n.bm()};_mcp.a.dl=function(n){return n.dp()};_mcp.a.fa=function(n){return n.a()};_mcp.a.fS=function(n){return n.gQ()};_mcp.a.eZ=function(n){return n.b()};_mcp.a.bn=function(n){return _mcp.f.isInstanceOfType(n)?n.dZ():null};_mcp.a.C=function(n){return n.br()};_mcp.a.bK=function(n){return n.a()};_mcp.a.gB=function(n){return _mcp.m.isInstanceOfType(n)?n.M:null};_mcp.a.dK=function(n){return n.W()};_mcp.a.fg=function(n){return _mcp.m.isInstanceOfType(n)?n.Q:null};_mcp.a.eY=function(n){return n.i()};_mcp.a.gm=function(n){return n.a()};_mcp.a.dU=function(n){return n.l()};_mcp.a.gZ=function(n){return n.eU()};_mcp.a.cr=function(n){return n.bp()};_mcp.a.gv=function(n){return n.b()};_mcp.a.dT=function(n){return n.k()};_mcp.a.dp=function(n){return n.cF};_mcp.a.dD=function(n){return n.l()};_mcp.a.eU=function(n){return n.w()};_mcp.a.gX=function(n){return n.bU};_mcp.a.gj=function(n){return n.i()};_mcp.a.dP=function(n){return n.p};_mcp.a.ce=function(n){return n.x.length};_mcp.a.ej=function(n){return _mcp.f.isInstanceOfType(n)?n.ea():null};_mcp.a.el=function(n){return _mcp.f.isInstanceOfType(n)?n.eb():null};_mcp.a.ei=function(n){return _mcp.f.isInstanceOfType(n)?n.dV():null};_mcp.a.eh=function(n){return _mcp.f.isInstanceOfType(n)?n.dU():null};_mcp.a.dL=function(n){return n.bL()};_mcp.a.fU=function(n){return n.fS()};_mcp.a.eB=function(n){return n.dj};_mcp.a.fR=function(n){return n.bR};_mcp.a.em=function(n){return _mcp.b.isInstanceOfType(n)?n.fB():null};_mcp.a.eq=function(n){return n.cG};_mcp.a.dQ=function(n){return n.f()};_mcp.a.dR=function(n){return n.h()};_mcp.a.fh=function(n){return _mcp.v.isInstanceOfType(n)?n.m:null};_mcp.a.fi=function(n){return _mcp.v.isInstanceOfType(n)?n.r:null};_mcp.a.cg=function(n){return n.z};_mcp.a.ef=function(n){return n.f()};_mcp.a.dG=function(n){return n.i()};_mcp.a.dH=function(n){return n.j()};_mcp.a.dE=function(n){return n.g()};_mcp.a.dF=function(n){return n.h()};_mcp.a.dW=function(n){return n.b()};_mcp.a.dV=function(n){return n.a()};_mcp.a.fm=function(n){return _mcp.q.isInstanceOfType(n)?n.z:null};_mcp.a.ca=function(n){return n.cf};_mcp.a.fe=function(n){return n.y()};_mcp.a.eT=function(n){return n.n()};_mcp.a.fI=function(n){return n.gC()};_mcp.a.fJ=function(n){return n.fD()};_mcp.a.fk=function(n){return _mcp.w.isInstanceOfType(n)?n.u:null};_mcp.a.fl=function(n){return _mcp.w.isInstanceOfType(n)?n.k():null};_mcp.a.gC=function(n){return _mcp.q.isInstanceOfType(n)?n.r:null};_mcp.a.cs=function(n){return n.dA()};_mcp.a.fK=function(n){return n.fE()};_mcp.a.gF=function(n){return _mcp.t.isInstanceOfType(n)?n.C:null};_mcp.a.ff=function(n){return _mcp.m.isInstanceOfType(n)?n.D:null};_mcp.a.eX=function(n){return n.h()};_mcp.a.du=function(n){return n.bw};_mcp.a.fN=function(n){return n.s()};_mcp.a.fL=function(n){return n.fF()};_mcp.a.gD=function(n){return _mcp.q.isInstanceOfType(n)?n.y:null};_mcp.a.bt=function(n){return n.q()};_mcp.a.dg=function(n){return _mcp.x.isInstanceOfType(n)?n.v:null};_mcp.a.he=function(n){return n.ec()};_mcp.a.gE=function(n){return n.bm};_mcp.a.cn=function(n){return n.d};_mcp.a.fo=function(n){return n.bl};_mcp.a.fn=function(n){return n.bn};_mcp.a.eW=function(n){return n.a()};_mcp.a.hp=function(n){return n.a};_mcp.a.fp=function(n){return _mcp.f.isInstanceOfType(n)?n.dX():null};_mcp.a.hc=function(n){return n.bn()};_mcp.a.fG=function(n){return n.fB()};_mcp.a.fH=function(n){return n.fC()};_mcp.a.hs=function(n){return n.bv};_mcp.a.hb=function(n){return n.bs()};_mcp.a.hr=function(n){return n.cp()};_mcp.a.hq=function(n){return n.bN()};_mcp.a.gw=function(n){return n.j()};_mcp.a.gn=function(n){return n.x()};_mcp.a.hg=function(n){return n.b};_mcp.a.hh=function(n){return n.i};_mcp.a.hi=function(n){return n.c};_mcp.a.hj=function(n){return n.j};_mcp.a.fz=function(n){return n.r()};_mcp.a.fy=function(n){return n.d};_mcp.a.eF=function(n){return n.b()};_mcp.a.fw=function(n){return n.e};_mcp.a.fA=function(n){return!_a.g.b};_mcp.a.fx=function(n){return n.f};_mcp.a.fB=function(n){return!_a.g.b};_mcp.a.hf=function(n){return n.h};_mcp.a.fF=function(n){return n.l()};_mcp.a.dr=function(n){return n.c};_mcp.a.et=function(n){return n.d()};_mcp.a.ev=function(n){return n.a};_mcp.a.eu=function(n){return n.e()};_mcp.a.ex=function(n){return n.d};_mcp.a.dx=function(n){return n.s()};_mcp.a.es=function(n){return n.c};_mcp.a.ds=function(n){return n.e};_mcp.a.dt=function(n){return n.f};_mcp.a.hn=function(n){return n.a};_mcp.a.gb=function(n){return n.a()};_mcp.a.hm=function(n){return n.g};_mcp.a.gI=function(n){return n.g};_mcp.a.gM=function(n){return n.E()};_mcp.a.fs=function(n){return n.d};_mcp.a.fr=function(n){return n.C()};_mcp.a.gQ=function(n){return n.g};_mcp.a.gh=function(n){return n.b()};_mcp.a.ge=function(n){return n.z};_mcp.a.gN=function(n){return n.l};_mcp.a.ft=function(n){return n.h};_mcp.a.gL=function(n){return n.A()};_mcp.a.gG=function(n){return n.f};_mcp.a.gH=function(n){return n.x()};_mcp.a.gK=function(n){return n.k};_mcp.a.gJ=function(n){return n.y()};_mcp.a.fq=function(n){return n.z()};_mcp.a.gP=function(n){return n.t()};_mcp.a.gT=function(n){return n.x()};_mcp.a.gS=function(n){return n.w()};_mcp.a.gR=function(n){return n.s};_mcp.a.gO=function(n){return n.d};_mcp.a.fu=function(n){return _mcp.J.isInstanceOfType(n)?n.v():null};_mcp.a.h=function(n,t){n.a(t)};_mcp.a.i=function(n,t){n.bb(t)};_mcp.a.f=function(n,t){n.ba(t)};_mcp.a.o=function(n,t){n.l(t)};_mcp.a.m=function(n,t){n.k(t)};_mcp.a.k=function(n,t){n.R(t)};_mcp.a.bj=function(n,t){n.c(t)};_mcp.a.W=function(n,t){n.r(t)};_mcp.a.bi=function(n,t){n.i(t)};_mcp.a.b=function(n,t){n.J(t)};_mcp.a.ec=function(n,t){n.f(t)};_mcp.a.dB=function(n,t){n.a(t)};_mcp.a.D=function(n,t){n.m(t)};_mcp.a.V=function(n,t){n.s(t)};_mcp.a.L=function(n,t){n.b(t)};_mcp.a.bq=function(n,t){n.d(t)};_mcp.a.y=function(n,t){n.a(t)};_mcp.a.cC=function(n,t){n.c(t)};_mcp.a.n=function(n,t){n.k=t};_mcp.a.N=function(n,t){n.m=t};_mcp.a.bs=function(n,t){n.l=t};_mcp.a.cE=function(n,t){n.f(t)};_mcp.a.r=function(n,t){n.R(t)};_mcp.a.bP=function(n,t){n.i(t)};_mcp.a.cW=function(n,t){n.z(t)};_mcp.a.bG=function(n,t){n.c(t)};_mcp.a.bF=function(n,t){n.a(t)};_mcp.a.gs=function(n,t){n.x(t)};_mcp.a.cf=function(n,t){n.gn(t)};_mcp.a.cM=function(n,t){n.im(t)};_mcp.a.cV=function(n,t){n.w(t)};_mcp.a.cJ=function(n,t){n.cE(t)};_mcp.a.cU=function(n,t){n.m(t)};_mcp.a.cL=function(n,t){n.cX(t)};_mcp.a.cY=function(n,t){n.a(t)};_mcp.a.cI=function(n,t){n.bN(t)};_mcp.a.cK=function(n,t){n.cr=t};_mcp.a.cO=function(n,t){n.cc(t)};_mcp.a.cN=function(n,t){n.cR=t};_mcp.a.cP=function(n,t){n.P=t};_mcp.a.cR=function(n,t){n.bK(t)};_mcp.a.cQ=function(n,t){n.bJ(t)};_mcp.a.cD=function(n,t){n.bT(t)};_mcp.a.dz=function(n,t){n.a(t)};_mcp.a.bS=function(n,t){n.c(t)};_mcp.a.bR=function(n,t){n.j(t)};_mcp.a.gA=function(n,t){n.k(t)};_mcp.a.u=function(n,t){n.a(t)};_mcp.a.bz=function(n,t){n.f(t)};_mcp.a.bb=function(n,t){n.l(t)};_mcp.a.bc=function(n,t){n.i(t)};_mcp.a.br=function(n,t){n.n(t)};_mcp.a.ba=function(n,t){n.j(t)};_mcp.a.bI=function(n,t){n.y(t)};_mcp.a.bD=function(n,t){n.dD(t)};_mcp.a.eJ=function(n,t){n.a(t)};_mcp.a.eL=function(n,t){n.E(t)};_mcp.a.p=function(n,t){n.bn(t)};_mcp.a.eS=function(n,t){n.n(t)};_mcp.a.U=function(n,t){n.dp(t)};_mcp.a.bp=function(n,t){n.a=t};_mcp.a.eK=function(n,t){n.u(t)};_mcp.a.fW=function(n,t){n.dq(t)};_mcp.a.dA=function(n,t){n.cN(t)};_mcp.a.dS=function(n,t){n.i(t)};_mcp.a.fj=function(n,t){n.s(t)};_mcp.a.cd=function(n,t){n.bC(t)};_mcp.a.dI=function(n,t){n.k(t)};_mcp.a.dY=function(n,t){n.e(t)};_mcp.a.dX=function(n,t){n.c(t)};_mcp.a.eN=function(n,t){n.dm=t};_mcp.a.eO=function(n,t){n.bl(t)};_mcp.a.eM=function(n,t){n.e=t};_mcp.a.bO=function(n,t){n.p(t)};_mcp.a.eR=function(n,t){n.m=t};_mcp.a.eP=function(n,t){n.p=t};_mcp.a.eQ=function(n,t){n.bv(t)};_mcp.a.bd=function(n,t){n.o(t)};_mcp.a.dC=function(n,t){n.R(t)};_mcp.a.fZ=function(n,t){n.x(t)};_mcp.a.hk=function(n,t){n.p(t)};_mcp.a.hl=function(n,t){n.q(t)};_mcp.a.eG=function(n,t){n.c(t)};_mcp.a.fE=function(n,t){n.o(t)};_mcp.a.eH=function(n,t){n.d(t)};_mcp.a.fC=function(n,t){n.m(t)};_mcp.a.fD=function(n,t){n.n(t)};_mcp.a.eI=function(n,t){n.a=t};_mcp.a.ew=function(n,t){n.f(t)};_mcp.a.ey=function(n,t){n.j(t)};_mcp.a.dy=function(n,t){n.l(t)};_mcp.a.ho=function(n,t){n.n(t)};_mcp.a.gc=function(n,t){n.c(t)};_mcp.a.gg=function(n,t){n.g(t)};_mcp.a.gU=function(n,t){n.a(t)};_mcp.a.gi=function(n,t){n.a(t)};_mcp.a.gf=function(n,t){n.d(t)};_mcp.a.ga=function(n,t){n.bk(t)};_mcp.a.gd=function(n,t){n.b(t)};_mcp.a.B=function(){_mcp.a.cw||(_mcp.a.cw=new _fc.l);return _mcp.a.cw};_mcp.a.c=function(){_mcp.a.ct||(_mcp.a.ct=new _fc.k);return _mcp.a.ct};_mcp.a.cc=function(){_mcp.a.cz||(_mcp.a.cz=new _n.y);return _mcp.a.cz};_mcp.a.cB=function(){_mcp.a.cx||(_mcp.a.cx=new _b.bD);return _mcp.a.cx};_mcp.a.fX=function(){_mcp.a.cy||(_mcp.a.cy=new _n.bd);return _mcp.a.cy};_mcp.a.cb=function(){_mcp.a.cu||(_mcp.a.cu=new _fce.t);return _mcp.a.cu};_mcp.a.eC=function(){_mcp.a.cv||(_mcp.a.cv=new _fce.I);return _mcp.a.cv};_mcp.a.eD=function(){_mcp.a.cA||(_mcp.a.cA=new _mcp.bQ);return _mcp.a.cA};_mcp.a._I=function(){var rt="AddOriginalAttachmentInfoBarView._tid1";new _j.d(rt,function(){_mcp.a.a[rt]===undefined&&(_mcp.a.a[rt]=[[[-1,0,["IncludeButtonText"],[_mcp.a.gq],null,"Text",null,_mcp.a.h,0,null,null,null]]]);var n=_mcp.a.g.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",_mcp.M,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_mcp.a.a);var it="AddOriginalAttachmentInfoBarView._tid2";new _j.d(it,function(){_mcp.a.a[it]===undefined&&(_mcp.a.a[it]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.n.LT]]]);var n=_mcp.a.g.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",_mcp.M,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_mcp.a.a);var ft="AddOriginalAttachmentInfoBarView";new _j.d(ft,function(){_mcp.a.a[ft]===undefined&&(_mcp.a.a[ft]=[[[-1,0,["InfoBarText"],[_mcp.a.gr],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,0,["AddAttachmentCommand"],[_mcp.a.go],null,"ClickCommand",null,_mcp.a.i,0,null,null,null]],null,[[-1,0,["DismissInfoBarCommand"],[_mcp.a.gp],null,"ClickCommand",null,_mcp.a.i,0,null,null,null]]]);var n=_mcp.a.g.childNodes[1].cloneNode(!0);var r=new _fc.e(_j.a.a(n,[0,3]));r.y("AddOriginalAttachmentInfoBarView._tid2");var i=new _fc.a(_j.a.a(n,[0,2]));i.a("|");var t=new _fc.e(_j.a.a(n,[0,1]));t.y("AddOriginalAttachmentInfoBarView._tid1");var u=new _fc.a(_j.a.a(n,[0,0]));return new _j.a(n,[u,t,i,r])},"",_mcp.M,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var ut="IrmDialogView";new _j.d(ut,function(){_mcp.a.a[ut]===undefined&&(_mcp.a.a[ut]=[[[-1,0,["Description"],[_mcp.a.gW],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,0,["ConversationOwner"],[_mcp.a.gV],null,"Text",null,_mcp.a.h,1,null,null,null]]]);var n=_mcp.a.g.childNodes[2].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i])},"",_mcp.bh,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var tt="MailComposeView._tid3._tid5";new _j.d(tt,function(){_mcp.a.a[tt]===undefined&&(_mcp.a.a[tt]=[[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp.a.d,_mcp.a.F],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var t=_mcp.a.g.childNodes[0].cloneNode(!0);var n=new _pe.d(t.children[0],_j.b.Instance.a(_a.q));n.j("_mcp_w ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.BasicDetailsPopup");n.T("MailCompose.FromRecipientWellButton");return new _j.a(t,[n])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var d="MailComposeView._tid3._tid6";new _j.d(d,function(){_mcp.a.a[d]===undefined&&(_mcp.a.a[d]=[[[-1,0,["RecipientComponent","FromFindRecipientViewModel"],[_mcp.a.d,_mcp.a.db],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var t=_mcp.a.g.childNodes[3].cloneNode(!0);var n=new _fp.f(t.children[0],_j.b.Instance.a(_y.a),_j.b.Instance.a(_j.j));n.T("MailCompose.FromRecipientWellButton");return new _j.a(t,[n])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var k="MailComposeView._tid3";new _j.d(k,function(){_mcp.a.a[k]===undefined&&(_mcp.a.a[k]=[[[-1,4,null,null,null,"ImageId",null,_mcp.a.o,0,null,null,null,_b.j.b()],[-1,4,null,null,null,"Text",null,_mcp.a.m,0,null,null,null,_nbs.a.OT],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.k,0,null,null,null,_nbs.a.nC],[-1,5,["SendAsContextMenuComponent","Menu","IsShown"],[_mcp.a.bg,_mcp.a.bf,_mcp.a.E],null,"contextMenu",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp.a.d,_mcp.a.F],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.B(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp.a.d,_mcp.a.F],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.B(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp.a.d,_mcp.a.F],null,"IsHidden",null,_mcp.a.b,1,new _j.r([_mcp.a.B(),_mcp.a.c()],[null,null]),null,!0],[-1,5,["RecipientComponent","ShouldHighlightFromAsInvalid"],[_mcp.a.d,_mcp.a.dc],null,"_mcp_f",null,null,0,null,null,null]]]);var t=_mcp.a.g.childNodes[4].cloneNode(!0);var u=new _j.c(t.children[3]);u.y("MailComposeView._tid3._tid6");var f=new _j.c(t.children[2]);var r=new _j.c(t.children[1]);r.y("MailComposeView._tid3._tid5");var n=new _fc.b(t.children[0]);n.y("MailComposeView.FromButtonTemplate");n.f("ms-bg-color-neutralLighter");n.c("ms-bg-color-neutralLight");n.d("ms-font-color-white ms-bg-color-themePrimary");n.O("MailCompose.FromRecipientWellButton");n.A(0);var i=new _fce.f(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));i.U(_j.f.a(["SendAsContextMenuComponent","Menu"],[_mcp.a.bg,_mcp.a.bf],null,"MenuDataContext",null,_mcp.a.bj,1)).U(_j.f.a(["SendAsContextMenuComponent","Menu","IsShown"],[_mcp.a.bg,_mcp.a.bf,_mcp.a.E],_mcp.a.W,"IsShown",_mcp.a.bh,_mcp.a.bi,2,null,null,!1));i.a=3;i.b=1;n.D([i]);return new _j.a(t,[n,r,f,u]).l({FromPersona:r})},"",_mcp.e,_mcp.h,function(n){return new _mcp.h(n)},!1,!0,!1,0,_mcp.a.a);var nt="MailComposeView._tidb";new _j.d(nt,function(){_mcp.a.a[nt]===undefined&&(_mcp.a.a[nt]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.P.b]],[[-1,0,["Context","Subject"],[_mcp.a.e,_mcp.a.be],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_mcp.a.o,0,null,null,null,_mcp.d.x()],[-1,1,["HideSubjectAffordanceButton"],[_mcp.a.fO],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]]]);var t=_mcp.a.g.childNodes[5].cloneNode(!0);var i=new _fc.b(_j.a.a(t,[1,1]));var n=new _fce.f(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));n.U(_j.f.a(["ContextMenuComponent","Menu"],[_mcp.a.T,_mcp.a.P],null,"MenuDataContext",null,_mcp.a.bj,1)).U(_j.f.a(["ContextMenuComponent","Menu","IsShown"],[_mcp.a.T,_mcp.a.P,_mcp.a.E],_mcp.a.W,"IsShown",_mcp.a.bh,_mcp.a.bi,2,null,null,!1));n.a=3;n.b=5;i.D([n]);var u=new _fc.a(_j.a.a(t,[1,0]));var r=new _fc.a(t.children[0]);return new _j.a(t,[r,u,i])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var g="MailComposeView._tidd._tide";new _j.d(g,function(){_mcp.a.a[g]===undefined&&(_mcp.a.a[g]=[[[-1,0,["MeetingComponent","SenderDetailsViewModel"],[_mcp.a.v,_mcp.a.eb],_mcp.a.ec,"DataContext",_mcp.a.bQ,_mcp.a.f,2,null,null,null]],[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp.a.v,_mcp.a.bW],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var i=_mcp.a.g.childNodes[6].cloneNode(!0);var t=new _pe.d(i.children[1],_j.b.Instance.a(_a.q));t.j("_mcp_l ms-font-weight-regular ms-font-color-black bidi");t.y("PersonaView.PresenceBasicDetailsPopup");var n=new _pe.d(i.children[0],_j.b.Instance.a(_a.q));n.j("_mcp_l ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.PresenceBasicDetailsPopup");return new _j.a(i,[n,t])},"",_mcp.e,_b.l,function(n){return new _b.l(n)},!1,!0,!1,0,_mcp.a.a);var at="MailComposeView._tidd._tidf";new _j.d(at,function(){_mcp.a.a[at]===undefined&&(_mcp.a.a[at]=[[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp.a.v,_mcp.a.bW],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var t=_mcp.a.g.childNodes[7].cloneNode(!0);var n=new _pe.d(t.children[0],_j.b.Instance.a(_a.q));n.j("_mcp_l ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.PresenceBasicDetailsPopup");return new _j.a(t,[n])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var lt="MailComposeView._tidd";new _j.d(lt,function(){_mcp.a.a[lt]===undefined&&(_mcp.a.a[lt]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.el]],[[-1,4,null,null,null,"FormatString",null,_mcp.a.dB,0,null,null,null,_u.n.QE],[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp.a.v,_mcp.a.bX],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp.a.v,_mcp.a.bX],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]]]);var n=_mcp.a.g.childNodes[8].cloneNode(!0);var i=new _j.c(_j.a.a(n,[1,1]));i.y("MailComposeView._tidd._tidf");var t=new _b.l(_j.a.a(n,[1,0]));t.y("MailComposeView._tidd._tide");var r=new _fc.a(n.children[0]);return new _j.a(n,[r,t,i])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var yt="MailComposeView._tidg";new _j.d(yt,function(){_mcp.a.a[yt]===undefined&&(_mcp.a.a[yt]=[[[-1,0,["Context","WhenLabel"],[_mcp.a.e,_mcp.a.en],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,0,["MeetingComponent","MeetingCalendarTimePeriod"],[_mcp.a.v,_mcp.a.ea],null,"Text",null,_mcp.a.h,1,null,null,null]]]);var n=_mcp.a.g.childNodes[9].cloneNode(!0);var i=new _fc.a(_j.a.a(n,[1,0]));var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var vt="MailComposeView._tidh";new _j.d(vt,function(){_mcp.a.a[vt]===undefined&&(_mcp.a.a[vt]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.P.I]],[[-1,0,["MeetingComponent","LocationViewModel"],[_mcp.a.v,_mcp.a.dZ],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var t=_mcp.a.g.childNodes[10].cloneNode(!0);var n=new _j.c(_j.a.a(t,[1,0]));n.y("LocationView");n.K(!0);var i=new _fc.a(t.children[0]);return new _j.a(t,[i,n])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var ct="MailComposeView._tidj";new _j.d(ct,function(){_mcp.a.a[ct]===undefined&&(_mcp.a.a[ct]=[[[-1,4,null,null,null,"ImageId",null,_mcp.a.o,0,null,null,null,_b.j.a()],[-1,4,null,null,null,"HoveredImageId",null,_mcp.a.D,0,null,null,null,_n.b.f()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.V,0,null,null,null,_n.b.f()],[-1,4,null,null,null,"Text",null,_mcp.a.m,0,null,null,null,_nbs.a.lM],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.k,0,null,null,null,_nbs.a.lM],[-1,0,["UpgradeComponent","CompleteBodyUpgradeCommand"],[_mcp.a.K,_mcp.a.eg],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,0,["UpgradeComponent","ShouldShowQuoteBodyButton"],[_mcp.a.K,_mcp.a.df],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp.a.L,0,null,null,0,0],[-1,4,null,null,null,"BusyText",null,_mcp.a.bq,0,null,null,null,_nbs.a.lM],[-1,0,["UpgradeComponent","IsWaitingForQuotedBody"],[_mcp.a.K,_mcp.a.de],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var t=_mcp.a.g.childNodes[11].cloneNode(!0);var n=new _fce.h(t.children[1],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));n.a=0;n.A(-1);var i=new _fc.b(t.children[0]);i.A(0);return new _j.a(t,[i,n])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var ot="MailComposeView._tidk";new _j.d(ot,function(){_mcp.a.a[ot]===undefined&&(_mcp.a.a[ot]=[[[-1,0,["IsXOwaExtensibilityActive"],[_mcp.a.gl],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var t=_mcp.a.g.childNodes[12].cloneNode(!0);var n=new _j.c(t.children[0]);n.y("XComposeExtensibilityView");return new _j.a(t,[n])},"",_y.fK,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var et="MailComposeView.FromButtonTemplate";new _j.d(et,function(){_mcp.a.a[et]===undefined&&(_mcp.a.a[et]=[[[-1,1,["Text"],[_mcp.a.dw],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,1,["CurrentImageId"],[_mcp.a.dv],null,"Id",null,_mcp.a.y,1,null,null,null]]]);var n=_mcp.a.g.childNodes[13].cloneNode(!0);var i=new _fc.d(n.children[1],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i]).l({Label:t,Image:i})},"",Object,_fc.b,function(n){return new _fc.b(n)},!1,!1,!1,0,_mcp.a.a);var ht="MailComposeView";new _j.d(ht,function(){_mcp.a.a[ht]===undefined&&(_mcp.a.a[ht]=[[[-1,4,null,null,null,"SpinnerSize",null,_mcp.a.L,0,null,null,0,1],[-1,1,["IsReadyToShowContent"],[_mcp.a.w],null,"IsBusy",null,_mcp.a.cC,1,_mcp.a.c(),null,!1]],[[-1,1,["IsReadyToShowAppBarContent"],[_mcp.a.fQ],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,5,["GenericMailMode"],[_mcp.a.fv],null,"_mcp_R",null,null,0,_mcp.a.c(),null,null]],[[-1,5,["ExtensibilityComponent","ExtensibilityViewModel","AppPaneIsHidden"],[_mcp.a.z,_mcp.a.X,_mcp.a.bU],null,"_mcp_Z",null,null,0,_mcp.a.c(),null,null],[-1,5,["IsReadyToShowAppBarContent"],[_mcp.a.fQ],null,"_mcp_Q",null,null,1,null,null,null],[-1,5,["GenericMailMode"],[_mcp.a.fv],null,"_mcp_U",null,null,0,null,null,null],[-1,5,["DisableMomemtumScrolling"],[_mcp.a.gY],null,"_mcp_M",null,null,0,null,null,null]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp.a.L,0,null,null,0,0],[-1,0,["ToolbarMessage"],[_mcp.a.dq],null,"BusyText",null,_mcp.a.bq,1,null,null,null],[-1,0,["ShouldShowToolbarMessage"],[_mcp.a.bN],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,1,["IsReadyToShowContent"],[_mcp.a.w],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["InfoBarViewModel"],[_mcp.a.bM],null,"DataSource",null,_mcp.a.cE,1,null,null,null],[-1,5,["IsFirefox"],[_mcp.a.q],null,"_mcp_W",null,null,0,null,null,null],[-1,5,["IsInternetExplorer"],[_mcp.a.bA],null,"_mcp_V",null,null,0,null,null,null]],[[-1,5,["DoesSupportRichText"],[_mcp.a.fM],null,"_mcp_6",null,null,1,null,null,null]],[[-1,0,["Context","IsFromShown"],[_mcp.a.e,_mcp.a.bk],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp.a.m,0,null,null,null,_u.n.Bp],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.k,0,null,null,null,_nbs.a.Th],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.S,_mcp.a.J],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp.a.q],null,"_mcp_W",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp.a.j],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.s],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp.a.o,0,null,null,null,_mcp.d.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.V,0,null,null,null,_mcp.d.e()],[-1,1,["IsToRecipientWellPeoplePickerButtonShown"],[_mcp.a.hv],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.S,_mcp.a.J],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp.a.eo],null,"_mcp_T",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.r,0,null,null,null,_nbs.a.bk],[-1,0,["RecipientComponent","To","ReadWriteRecipientWellViewModel"],[_mcp.a.d,_mcp.a.S,_mcp.a.Z],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bT],null,"_mcp_T",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.s],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["RecipientComponent","To","ReadOnlyRecipientWellViewModel"],[_mcp.a.d,_mcp.a.S,_mcp.a.Y],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bT],null,"Android",null,null,0,null,null,null]],null,[[-1,4,null,null,null,"Text",null,_mcp.a.m,0,null,null,null,_u.n.MR],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.k,0,null,null,null,_nbs.a.jJ],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.R,_mcp.a.J],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp.a.q],null,"_mcp_W",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp.a.j],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.s],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp.a.o,0,null,null,null,_mcp.d.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.V,0,null,null,null,_mcp.d.e()],[-1,1,["IsCcRecipientWellPeoplePickerButtonShown"],[_mcp.a.hu],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.R,_mcp.a.J],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp.a.eo],null,"_mcp_T",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.r,0,null,null,null,_nbs.a.Xv],[-1,0,["RecipientComponent","Cc","ReadWriteRecipientWellViewModel"],[_mcp.a.d,_mcp.a.R,_mcp.a.Z],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bT],null,"_mcp_T",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.s],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["RecipientComponent","Cc","ReadOnlyRecipientWellViewModel"],[_mcp.a.d,_mcp.a.R,_mcp.a.Y],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bT],null,"_mcp_T",null,null,0,null,null,null]],[[-1,0,["Context","IsBccShown"],[_mcp.a.e,_mcp.a.bJ],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp.a.m,0,null,null,null,_u.n.JW],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.k,0,null,null,null,_nbs.a.ia],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.Q,_mcp.a.J],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp.a.q],null,"_mcp_W",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp.a.j],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.s],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp.a.o,0,null,null,null,_mcp.d.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.V,0,null,null,null,_mcp.d.e()],[-1,1,["IsBccRecipientWellPeoplePickerButtonShown"],[_mcp.a.ht],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.Q,_mcp.a.J],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp.a.eo],null,"_mcp_T",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.r,0,null,null,null,_nbs.a.RJ],[-1,0,["RecipientComponent","Bcc","ReadWriteRecipientWellViewModel"],[_mcp.a.d,_mcp.a.Q,_mcp.a.Z],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bT],null,"_mcp_T",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.s],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["RecipientComponent","Bcc","ReadOnlyRecipientWellViewModel"],[_mcp.a.d,_mcp.a.Q,_mcp.a.Y],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bT],null,"_mcp_T",null,null,0,null,null,null]],[[-1,0,["Context","IsMeetingForward"],[_mcp.a.e,_mcp.a.bl],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,4,null,null,null,"ImageId",null,_mcp.a.o,0,null,null,null,_mcp.d.a()],[-1,0,["ComplianceComponent","ShowIrmInformationCommand"],[_mcp.a.bL,_mcp.a.gu],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,0,["ComplianceComponent","IsIrmProtected"],[_mcp.a.bL,_mcp.a.cj],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp.a.y,0,null,null,null,_n.b.T()],[-1,0,["Context","SmimeSignMessage"],[_mcp.a.e,_mcp.a.dO],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp.a.y,0,null,null,null,_n.b.Y()],[-1,0,["Context","SmimeEncryptMessage"],[_mcp.a.e,_mcp.a.dN],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["ImportanceComponent","IsNormalImportance"],[_mcp.a.cq,_mcp.a.ck],null,"IsHidden",null,_mcp.a.b,1,null,null,!0],[-1,0,["Context","Importance"],[_mcp.a.e,_mcp.a.ch],null,"Id",null,_mcp.a.y,1,_mcp.a.cc(),!1,null]],[[-1,4,null,null,null,"ImageId",null,_mcp.a.o,0,null,null,null,_mcp.d.x()],[-1,1,["HideSubjectAffordanceButton"],[_mcp.a.fO],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,4,null,null,null,"Placeholder",null,_mcp.a.bP,0,null,null,null,_nbs.a.nk],[-1,0,["Context","Subject"],[_mcp.a.e,_mcp.a.be],_mcp.a.cW,"Text",_mcp.a.bE,_mcp.a.bG,2,null,null,null],[-1,0,["Context","MaxSubjectLength"],[_mcp.a.e,_mcp.a.dh],null,"MaxLength",null,_mcp.a.bF,1,null,null,0]],[[-1,0,["Context","ShowMeetingReadonlyFields"],[_mcp.a.e,_mcp.a.dM],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp.a.e,_mcp.a.bl],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp.a.e,_mcp.a.bl],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],null,[[-1,0,["Context","HasLocation"],[_mcp.a.e,_mcp.a.dJ],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel","ShouldBeHidden"],[_mcp.a.M,_mcp.a.ci,_mcp.a.gk],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel"],[_mcp.a.M,_mcp.a.ci],_mcp.a.gs,"DataContext",_mcp.a.bQ,_mcp.a.f,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.GT],[-1,0,["Context","IsPrintRestricted"],[_mcp.a.e,_mcp.a.G],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,5,["Context","IsPrintRestricted"],[_mcp.a.e,_mcp.a.G],null,"noScreen:hiddenMsg",null,null,0,null,null,null]],null,[[-1,4,null,null,null,"EditorAriaLabel",null,_mcp.a.cK,0,null,null,null,_nbs.a.Op],[-1,1,["EditorSizingMode"],[_mcp.a.eA],null,"SizingMode",null,_mcp.a.cO,1,null,null,0],[-1,1,["EditorMinHeight"],[_mcp.a.ez],null,"MinHeight",null,_mcp.a.cN,1,null,null,0],[-1,1,["IsReadyToShowContent"],[_mcp.a.w],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp.a.e,_mcp.a.bZ],null,"IsCopyRestricted",null,_mcp.a.cf,1,null,null,!1],[-1,0,["Context","IsPrintRestricted"],[_mcp.a.e,_mcp.a.G],null,"IsPrintRestricted",null,_mcp.a.cM,1,null,null,!1],[-1,0,["Context","EditorContent"],[_mcp.a.e,_mcp.a.cT],_mcp.a.cV,"Content",_mcp.a.cG,_mcp.a.cJ,2,null,null,null],[-1,0,["Context","BodyType"],[_mcp.a.e,_mcp.a.cS],_mcp.a.cU,"IsPlainTextContent",_mcp.a.cH,_mcp.a.cL,2,_mcp.a.cB(),null,!1],[-1,0,["EditorComponent","EditorCallContext"],[_mcp.a.dj,_mcp.a.cX],_mcp.a.cY,"CallContext",_mcp.a.cF,_mcp.a.cI,2,null,null,null],[-1,5,["Context","IsPrintRestricted"],[_mcp.a.e,_mcp.a.G],null,"noPrint",null,null,0,null,null,null]],[[-1,1,["IsReadyToShowContent"],[_mcp.a.w],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,5,["UpgradeComponent","IsOnDemandUpgradePending"],[_mcp.a.K,_mcp.a.dd],null,"_mcp_L",null,null,0,_mcp.a.c(),null,null]],[[-1,1,["DoesSupportRichText"],[_mcp.a.fM],null,"IsHidden",null,_mcp.a.b,1,null,null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp.a.e,_mcp.a.bZ],null,"TextSelectionType",null,_mcp.a.cD,1,_mcp.a.fX(),null,0]],[[-1,0,["Context","IsCopyRestricted"],[_mcp.a.e,_mcp.a.bZ],null,"IsCopyRestricted",null,_mcp.a.cf,1,null,null,!1],[-1,0,["Context","QuotedBody"],[_mcp.a.e,_mcp.a.eV],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.B(),null,!0],[-1,0,["Context","QuotedBody"],[_mcp.a.e,_mcp.a.eV],null,"Html",null,_mcp.a.dz,1,null,null,null]],[[-1,0,["ExtensibilityComponent","ExtensibilityViewModel"],[_mcp.a.z,_mcp.a.X],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,0,["AppPaneIsHidden"],[_mcp.a.bU],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["MessageBoxViewModel"],[_mcp.a.dm],null,"DataContext",null,_mcp.a.f,1,null,null,null]],[[-1,4,null,null,null,"DialogTitle",null,_mcp.a.bS,0,null,null,null,_nbs.a.HV],[-1,0,["TouchComponent","CloseConfirmDialogButtonData"],[_mcp.a.er,_mcp.a.gy],null,"ButtonDataList",null,_mcp.a.bR,1,null,null,null],[-1,0,["TouchComponent","IsCloseConfirmDialogShown"],[_mcp.a.er,_mcp.a.gz],_mcp.a.gA,"IsShown",_mcp.a.t,_mcp.a.u,2,null,null,!1]],[[-1,0,["ComplianceComponent","DialogViewModel"],[_mcp.a.bL,_mcp.a.gt],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,0,["IsShown"],[_mcp.a.bx],_mcp.a.bz,"IsShown",_mcp.a.t,_mcp.a.u,2,null,null,!1],[0,0,["Title"],[_mcp.a.by],null,"DialogTitle",null,_mcp.a.bb,1,null,null,null],[0,0,["CloseCommand"],[_mcp.a.bu],null,"CloseCommand",null,_mcp.a.bc,1,null,null,null],[0,0,["ContentDataContext"],[_mcp.a.bv],null,"ContentDataContext",null,_mcp.a.br,1,null,null,null],[0,0,["FooterButtons"],[_mcp.a.bw],null,"ButtonDataList",null,_mcp.a.ba,1,null,null,null]],[[-1,0,["MessageOptionsComponent","DialogViewModel"],[_mcp.a.dn,_mcp.a.da],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,0,["IsBusy"],[_mcp.a.bH],_mcp.a.bI,"IsBusy",_mcp.a.bC,_mcp.a.bD,2,null,null,!1],[0,0,["IsShown"],[_mcp.a.bx],_mcp.a.bz,"IsShown",_mcp.a.t,_mcp.a.u,2,null,null,!1],[0,0,["Title"],[_mcp.a.by],null,"DialogTitle",null,_mcp.a.bb,1,null,null,null],[0,0,["CloseCommand"],[_mcp.a.bu],null,"CloseCommand",null,_mcp.a.bc,1,null,null,null],[0,0,["ContentDataContext"],[_mcp.a.bv],null,"ContentDataContext",null,_mcp.a.br,1,null,null,null],[0,0,["FooterButtons"],[_mcp.a.bw],null,"ButtonDataList",null,_mcp.a.ba,1,null,null,null]],[[-1,0,["OmeComponent","DialogViewModel"],[_mcp.a.ep,_mcp.a.ed],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,0,["IsBusy"],[_mcp.a.bH],_mcp.a.bI,"IsBusy",_mcp.a.bC,_mcp.a.bD,2,null,null,!1],[0,0,["IsShown"],[_mcp.a.bx],_mcp.a.bz,"IsShown",_mcp.a.t,_mcp.a.u,2,null,null,!1],[0,0,["Title"],[_mcp.a.by],null,"DialogTitle",null,_mcp.a.bb,1,null,null,null],[0,0,["CloseCommand"],[_mcp.a.bu],null,"CloseCommand",null,_mcp.a.bc,1,null,null,null],[0,0,["ContentDataContext"],[_mcp.a.bv],null,"ContentDataContext",null,_mcp.a.br,1,null,null,null],[0,0,["FooterButtons"],[_mcp.a.bw],null,"ButtonDataList",null,_mcp.a.ba,1,null,null,null]],[[-1,0,["IsNavigatingAway"],[_mcp.a.ha],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var n=_mcp.a.g.childNodes[14].cloneNode(!0);var hi=new _j.h(n.children[9]);var kt=new _fce.n(n.children[8],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));kt.c("OmeExpirationView");var bt=new _fce.n(n.children[7],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));bt.c("MessageOptionsView");var pt=new _fce.n(n.children[6],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));pt.c("IrmDialogView");var st=new _b.n(n.children[5],_j.b.Instance.a(_y.a),_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.b));st.g(!1);var rt=new _j.c(n.children[4]);rt.y("MessageBoxDefaultView");var at=new _j.c(n.children[3]);at.y("MailComposeView._tidk");var dt=new _b.o(_j.a.a(n,[2,1,3,0]),_j.b.Instance.a(_a.f));var fr=new _j.h(_j.a.a(n,[2,1,3]));var et=new _j.c(_j.a.a(n,[2,1,2,1]));et.y("MailComposeView._tidj");var t=_j.b.Instance.a(_j.bG.$$(_zz.p)).a(_j.a.a(n,[2,1,2,0]));t.bV("_mcp_A ms-font-weight-regular ms-font-color-neutralPrimary customScrollBar");t.K(!0);t.A(-1);t.cs="0";var yt=new _zz.B(_j.b.Instance.a(_b.a),_j.b.Instance.a(_zz.j),_j.b.Instance.a(_ff.b));yt.k="PasteFlyout";var tr=new _zz.y;var nr=new _zz.D(_j.b.Instance.a(_a.x),_j.b.Instance.a(_ff.b));var it=new _zz.x(_j.b.Instance.a(_b.a),_j.b.Instance.a(_zz.j),_j.b.Instance.a(_ff.b),_j.b.Instance.a(_a.f),_j.b.Instance.a(_j.cc.$$(IFindRecipientAtMentionSuggestionViewModelFactory)));it.U(_j.f.a(["AtMentionComponent"],[_mcp.a.di],null,"MentionsHandler",null,_mcp.a.cP,1)).U(_j.f.a(["Context","Subject"],[_mcp.a.e,_mcp.a.be],null,"Topic",null,_mcp.a.cR,1)).U(_j.f.b(_cmc.a.b,null,null,null,"Scenario",null,_mcp.a.cQ,0));it.k="MentionsPicker";t.D([yt,tr,nr,it]);var ur=new _j.h(_j.a.a(n,[2,1,2]));var ki=new _fc.a(_j.a.a(n,[2,1,1,7]));var o=new _j.c(_j.a.a(n,[2,1,1,6,0,0]));o.y("AttachmentWellViewWrapper");o.cq(!0);o.K(!0);var er=new _j.h(_j.a.a(n,[2,1,1,6]));var ri=new _j.c(_j.a.a(n,[2,1,1,5,3]));ri.y("MailComposeView._tidh");var ii=new _j.c(_j.a.a(n,[2,1,1,5,2]));ii.y("MailComposeView._tidg");var ni=new _j.c(_j.a.a(n,[2,1,1,5,1]));ni.y("MailComposeView._tidd");var vt=new _j.c(_j.a.a(n,[2,1,1,5,0]));vt.y("MailComposeView._tidb");var yi=new _j.h(_j.a.a(n,[2,1,1,5]));var c=new _cmc.o(_j.a.a(n,[2,1,1,4,0,5,0]));c.g("ms-font-color-neutralTertiary");c.A(0);var ti=new _fc.b(_j.a.a(n,[2,1,1,4,0,4]));var s=new _fce.f(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));s.U(_j.f.a(["ContextMenuComponent","Menu"],[_mcp.a.T,_mcp.a.P],null,"MenuDataContext",null,_mcp.a.bj,1)).U(_j.f.a(["ContextMenuComponent","Menu","IsShown"],[_mcp.a.T,_mcp.a.P,_mcp.a.E],_mcp.a.W,"IsShown",_mcp.a.bh,_mcp.a.bi,2,null,null,!1));s.a=3;s.b=5;ti.D([s]);var ui=new _fc.d(_j.a.a(n,[2,1,1,4,0,3]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var ei=new _fc.d(_j.a.a(n,[2,1,1,4,0,2]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var si=new _fc.d(_j.a.a(n,[2,1,1,4,0,1]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var oi=new _fc.b(_j.a.a(n,[2,1,1,4,0,0]));var pi=new _j.h(_j.a.a(n,[2,1,1,4]));var v=new _j.c(_j.a.a(n,[2,1,1,3,2,0]));v.y("ReadOnlyRecipientWellView");v.cq(!0);v.K(!0);var sr=new _j.h(_j.a.a(n,[2,1,1,3,2]));var l=new _j.c(_j.a.a(n,[2,1,1,3,1,1]));l.y("ReadWriteRecipientWellView");l.E(26);l.cq(!0);var a=new _fc.b(_j.a.a(n,[2,1,1,3,1,0,0]));a.j=!0;a.A(-1);a.N(!0);var bi=new _j.h(_j.a.a(n,[2,1,1,3,1,0]));var wi=new _j.h(_j.a.a(n,[2,1,1,3,1]));var i=new _fc.b(_j.a.a(n,[2,1,1,3,0]));i.f("ms-bg-color-neutralLighter");i.c("ms-bg-color-neutralLight");i.d("ms-font-color-white ms-bg-color-themePrimary");i.A(-1);var gt=new _j.h(_j.a.a(n,[2,1,1,3]));var h=new _j.c(_j.a.a(n,[2,1,1,2,2,0]));h.y("ReadOnlyRecipientWellView");h.cq(!0);h.K(!0);var gi=new _j.h(_j.a.a(n,[2,1,1,2,2]));var f=new _j.c(_j.a.a(n,[2,1,1,2,1,1]));f.y("ReadWriteRecipientWellView");f.cq(!0);f.E(26);f.K(!0);var g=new _fc.b(_j.a.a(n,[2,1,1,2,1,0,0]));g.j=!0;g.A(-1);g.N(!0);var di=new _j.h(_j.a.a(n,[2,1,1,2,1,0]));var ai=new _j.h(_j.a.a(n,[2,1,1,2,1]));var u=new _fc.b(_j.a.a(n,[2,1,1,2,0]));u.f("ms-bg-color-neutralLighter");u.c("ms-bg-color-neutralLight");u.d("ms-font-color-white ms-bg-color-themePrimary");u.A(-1);var lt=new _j.h(_j.a.a(n,[2,1,1,2]));var ft=new _j.c(_j.a.a(n,[2,1,1,1,2,0]));ft.y("ReadOnlyRecipientWellView");ft.K(!0);var or=new _j.h(_j.a.a(n,[2,1,1,1,2]));var e=new _j.c(_j.a.a(n,[2,1,1,1,1,1]));e.y("ReadWriteRecipientWellView");e.E(26);e.K(!0);var nt=new _fc.b(_j.a.a(n,[2,1,1,1,1,0,0]));nt.j=!0;nt.A(-1);nt.N(!0);var ir=new _j.h(_j.a.a(n,[2,1,1,1,1,0]));var rr=new _j.h(_j.a.a(n,[2,1,1,1,1]));var r=new _fc.b(_j.a.a(n,[2,1,1,1,0]));r.f("ms-bg-color-neutralLighter");r.c("ms-bg-color-neutralLight");r.d("ms-font-color-white ms-bg-color-themePrimary");r.A(0);var ut=new _mcp.h(_j.a.a(n,[2,1,1,0,0]));ut.y("MailComposeView._tid3");var fi=new _j.h(_j.a.a(n,[2,1,1]));var k=_j.b.Instance.a(_j.bG.$$(_db.g)).a(_j.a.a(n,[2,1,0]));k.d="_mcp_D";k.A(0);var p=new _j.h(_j.a.a(n,[2,1]));p.A(-1);var wt=new _fc.g;var ot=new _fc.c;ot.U(_j.f.a(["TouchComponent","CloseCommand"],[_mcp.a.er,_mcp.a.gx],null,"Command",null,_mcp.a.n,1));ot.i("ESC");var y=new _fc.c;y.U(_j.f.a(["SaveComponent","SaveCommand"],[_mcp.a.bo,_mcp.a.cm],null,"Command",null,_mcp.a.n,1));y.i("S");y.j=2;var b=new _fc.c;b.U(_j.f.a(["SendComponent","AltSSendCommand"],[_mcp.a.x,_mcp.a.co],null,"Command",null,_mcp.a.n,1)).U(_j.f.a(["DoesSupportAltSForSend"],[_mcp.a.cp],null,"PreventDefault",null,_mcp.a.N,1,null,null,!1));b.i("S");b.j=4;var w=new _fc.c;w.U(_j.f.a(["SendComponent","SendCommand"],[_mcp.a.x,_mcp.a.bm],null,"Command",null,_mcp.a.n,1));w.i("ENTER");w.j=2;var d=new _fc.c;d.U(_j.f.a(["RecipientComponent","ResolveCommand"],[_mcp.a.d,_mcp.a.cl],null,"Command",null,_mcp.a.n,1));d.i("K");d.j=2;var tt=new _fc.c;tt.V(_j.f.a(["ContextParent","ContextParent","ShiftTabCommand"],[_mcp.a.l,_mcp.a.l,_mcp.a.bB],null,"Command",null,_mcp.a.n,1)).V(_j.f.a(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp.a.l,_mcp.a.l,_mcp.a.I],null,"PreventDefault",null,_mcp.a.N,1,null,null,!1)).V(_j.f.a(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp.a.l,_mcp.a.l,_mcp.a.I],null,"StopPropagation",null,_mcp.a.bs,1,null,null,!1));tt.i("TAB");tt.j=1;wt.a([ot,y,b,w,d,tt]);p.D([wt]);var ci=new _fce.h(_j.a.a(n,[2,0]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));var li=new _fce.g(n.children[2],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));var vi=new _j.h(n.children[1]);var ct=new _fce.h(n.children[0],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));ct.a=0;ct.d("");return new _j.a(n,[ct,vi,li,ci,p,k,fi,ut,r,rr,ir,nt,e,or,ft,lt,u,ai,di,g,f,gi,h,gt,i,wi,bi,a,l,sr,v,pi,oi,si,ei,ui,ti,c,yi,vt,ni,ii,ri,er,o,ki,ur,t,et,fr,dt,at,rt,st,pt,bt,kt,hi]).l({ComposeViewContent:p,InfoBarControl:k,FromFieldControl:ut,ToRecipientButton:r,ToRecipientWellControl:e,CcRecipientWellControl:lt,CcRecipientButton:u,BccRecipientWellControl:gt,BccRecipientButton:i,SubjectTextBox:c,AttachmentWellViewWrapper:o,EditorControl:t,OnDemandUpgradeContainer:et,QuotedBodyHtmlLabel:dt,MessageBox:rt,CancelConfirmDialog:st})},"",_mcp.e,_mcp.l,function(n){return new _mcp.l(n,_j.b.Instance.a(_j.bd),_j.b.Instance.a(_j.n),_j.b.Instance.a(_a.C),_j.b.Instance.a(_a.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_a.B),_j.b.Instance.a(_b.d))},!0,!1,!1,0,_mcp.a.a);var st="MailComposeAggregatedRecipientWellView._tidr1";new _j.d(st,function(){_mcp.a.a[st]===undefined&&(_mcp.a.a[st]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.n.On]],[[-1,0,["RecipientComponent"],[_mcp.a.d],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var t=_mcp.a.g.childNodes[42].cloneNode(!0);var n=new _rw.n(t.children[1]);n.e=0;n.d="calc(100% - 150px)";var i=new _fc.a(t.children[0]);return new _j.a(t,[i,n])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var e="MailComposeAggregatedRecipientWellView._tids1";new _j.d(e,function(){_mcp.a.a[e]===undefined&&(_mcp.a.a[e]=[[[-1,0,["ImportanceComponent","IsNormalImportance"],[_mcp.a.cq,_mcp.a.ck],null,"IsHidden",null,_mcp.a.b,1,null,null,!0],[-1,0,["Context","Importance"],[_mcp.a.e,_mcp.a.ch],null,"Id",null,_mcp.a.y,1,_mcp.a.cc(),!1,null]],[[-1,4,null,null,null,"Id",null,_mcp.a.y,0,null,null,null,_mcp.d.a()],[-1,0,["ComplianceComponent","IsIrmProtected"],[_mcp.a.bL,_mcp.a.cj],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"ImageId",null,_mcp.a.o,0,null,null,null,_mcp.d.q()],[-1,4,null,null,null,"HoveredImageId",null,_mcp.a.D,0,null,null,null,_mcp.d.r()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.V,0,null,null,null,_mcp.d.s()],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.k,0,null,null,null,_nbs.a.Br],[-1,4,null,null,null,"Title",null,_mcp.a.p,0,null,null,null,_nbs.a.Br],[-1,0,["ShouldShowExpandButton"],[_mcp.a.he],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["NavigationComponent","UpconvertOnMoreOptionsCommand"],[_mcp.a.cr,_mcp.a.fm],null,"ClickCommand",null,_mcp.a.i,1,null,null,null]]]);var n=_mcp.a.g.childNodes[43].cloneNode(!0);var t=new _fc.b(n.children[2]);t.c("ms-font-color-black");t.A(-1);var r=new _fc.d(n.children[1],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var i=new _fc.d(n.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));return new _j.a(n,[i,r,t])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var f="MailComposeAggregatedRecipientWellView.ReadOnlyAggregatedWellTemplate._tidt1";new _j.d(f,function(){_mcp.a.a[f]===undefined&&(_mcp.a.a[f]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.n.On]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.dC,0,null,null,null,_u.n.SY],[-1,0,["To","AggregatedRecipientWellViewModel"],[_mcp.a.gE,_mcp.a.cn],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var n=_mcp.a.g.childNodes[44].cloneNode(!0);var t=new _rw.e(n.children[1]);t.y("ReadOnlyRecipientWellExpandCollapseView");var i=new _fc.a(n.children[0]);return new _j.a(n,[i,t])},"",_mcp.f,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var s="MailComposeAggregatedRecipientWellView.ReadOnlyAggregatedWellTemplate._tidu1";new _j.d(s,function(){_mcp.a.a[s]===undefined&&(_mcp.a.a[s]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.n.PO]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.dC,0,null,null,null,_u.n.Mq],[-1,0,["Cc","AggregatedRecipientWellViewModel"],[_mcp.a.fo,_mcp.a.cn],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var n=_mcp.a.g.childNodes[45].cloneNode(!0);var t=new _rw.e(n.children[1]);t.y("ReadOnlyRecipientWellExpandCollapseView");var i=new _fc.a(n.children[0]);return new _j.a(n,[i,t])},"",_mcp.f,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var o="MailComposeAggregatedRecipientWellView.ReadOnlyAggregatedWellTemplate._tidv1";new _j.d(o,function(){_mcp.a.a[o]===undefined&&(_mcp.a.a[o]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.n.RC]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.dC,0,null,null,null,_u.n.BS],[-1,0,["Bcc","AggregatedRecipientWellViewModel"],[_mcp.a.fn,_mcp.a.cn],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var n=_mcp.a.g.childNodes[46].cloneNode(!0);var t=new _rw.e(n.children[1]);t.y("ReadOnlyRecipientWellExpandCollapseView");var i=new _fc.a(n.children[0]);return new _j.a(n,[i,t])},"",_mcp.f,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var u="MailComposeAggregatedRecipientWellView.ReadOnlyAggregatedWellTemplate";new _j.d(u,function(){_mcp.a.a[u]===undefined&&(_mcp.a.a[u]=[null,[[-1,0,["Cc","AggregatedRecipientWellViewModel","Recipients","Count"],[_mcp.a.fo,_mcp.a.cn,_mcp.a.eW,_mcp.a.ce],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.cb(),null,!0]],[[-1,0,["Bcc","AggregatedRecipientWellViewModel","Recipients","Count"],[_mcp.a.fn,_mcp.a.cn,_mcp.a.eW,_mcp.a.ce],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.cb(),null,!0]],[[-1,5,["DisplayEllipsis"],[_mcp.a.hp],null,"_mcp_C3:hidden",null,null,1,null,null,null]]]);var n=_mcp.a.g.childNodes[47].cloneNode(!0);var f=new _j.h(n.children[1]);var r=new _j.c(_j.a.a(n,[0,0,2]));r.A(-1);r.y("MailComposeAggregatedRecipientWellView.ReadOnlyAggregatedWellTemplate._tidv1");var t=new _j.c(_j.a.a(n,[0,0,1]));t.A(-1);t.y("MailComposeAggregatedRecipientWellView.ReadOnlyAggregatedWellTemplate._tidu1");var i=new _j.c(_j.a.a(n,[0,0,0]));i.A(-1);i.y("MailComposeAggregatedRecipientWellView.ReadOnlyAggregatedWellTemplate._tidt1");return new _j.a(n,[i,t,r,f])},"",_mcp.f,_mcp.F,function(n){return new _mcp.F(n)},!1,!1,!1,0,_mcp.a.a);var t="MailComposeAggregatedRecipientWellView";new _j.d(t,function(){_mcp.a.a[t]===undefined&&(_mcp.a.a[t]=[[[-1,0,["RecipientComponent"],[_mcp.a.d],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,0,["IsCompactRecipientWellEnabled"],[_mcp.a.fp],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["RecipientComponent","IsCompactRecipientWellEnabled"],[_mcp.a.d,_mcp.a.fp],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["ShouldApplyInlineCompose"],[_mcp.a.hc],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,5,["IsFirefox"],[_mcp.a.q],null,"_mcp_I3",null,null,0,null,null,null]]]);var n=_mcp.a.g.childNodes[48].cloneNode(!0);var u=new _j.c(_j.a.a(n,[0,2]));u.y("MailComposeAggregatedRecipientWellView._tids1");var r=new _j.c(_j.a.a(n,[0,1]));r.y("MailComposeAggregatedRecipientWellView._tidr1");var i=new _mcp.F(_j.a.a(n,[0,0]));i.y("MailComposeAggregatedRecipientWellView.ReadOnlyAggregatedWellTemplate");return new _j.a(n,[i,r,u])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var n="MessageOptionsView._tidc2";new _j.d(n,function(){_mcp.a.a[n]===undefined&&(_mcp.a.a[n]=[[[-1,4,null,null,null,"Text",null,_mcp.a.m,0,null,null,null,_nbs.a.Mw],[-1,0,["SmimeEncryptMessage"],[_mcp.a.hg],_mcp.a.hk,"IsChecked",_mcp.a.bt,_mcp.a.bd,2,null,null,!1],[-1,0,["SmimeEncryptMessageIsEnabled"],[_mcp.a.hh],null,"IsEnabled",null,_mcp.a.bO,1,null,null,!1]],[[-1,4,null,null,null,"Text",null,_mcp.a.m,0,null,null,null,_nbs.a.Ne],[-1,0,["SmimeSignMessage"],[_mcp.a.hi],_mcp.a.hl,"IsChecked",_mcp.a.bt,_mcp.a.bd,2,null,null,!1],[-1,0,["SmimeSignMessageIsEnabled"],[_mcp.a.hj],null,"IsEnabled",null,_mcp.a.bO,1,null,null,!1]]]);var t=_mcp.a.g.childNodes[58].cloneNode(!0);var r=new _fc.h(t.children[1],_j.b.Instance.a(_ff.a));var i=new _fc.h(t.children[0],_j.b.Instance.a(_ff.a));return new _j.a(t,[i,r])},"",_mcp.P,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var r="MessageOptionsView.SensitivityTemplate";new _j.d(r,function(){_mcp.a.a[r]===undefined&&(_mcp.a.a[r]=[[[-1,1,["DataContext"],[_mcp.a.bQ],null,"Text",null,_mcp.a.h,1,_mcp.a.eD(),null,null]]]);var n=_mcp.a.g.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",Object,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var i="MessageOptionsView";new _j.d(i,function(){_mcp.a.a[i]===undefined&&(_mcp.a.a[i]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.VN]],[[-1,0,["SensitivityOptions"],[_mcp.a.fz],null,"Options",null,_mcp.a.eG,1,null,null,null],[-1,0,["Sensitivity"],[_mcp.a.fy],_mcp.a.fE,"SelectedValue",_mcp.a.eF,_mcp.a.eH,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.m,0,null,null,null,_nbs.a.YF],[-1,0,["IsDeliveryReceiptRequested"],[_mcp.a.fw],_mcp.a.fC,"IsChecked",_mcp.a.bt,_mcp.a.bd,2,null,null,!1],[-1,0,["ShowDeliveryReceiptRequest"],[_mcp.a.fA],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp.a.m,0,null,null,null,_nbs.a.ba],[-1,0,["IsReadReceiptRequested"],[_mcp.a.fx],_mcp.a.fD,"IsChecked",_mcp.a.bt,_mcp.a.bd,2,null,null,!1],[-1,0,["ShowReadReceiptRequest"],[_mcp.a.fB],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["ShowSmimeOptions"],[_mcp.a.hf],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var n=_mcp.a.g.childNodes[59].cloneNode(!0);var r=new _j.c(n.children[4]);r.y("MessageOptionsView._tidc2");var f=new _fc.h(n.children[3],_j.b.Instance.a(_ff.a));var e=new _fc.h(n.children[2],_j.b.Instance.a(_ff.a));var t=new _fce.k(n.children[1]);t.a("MessageOptionsView.SensitivityTemplate");var u=new _fc.a(n.children[0]);return new _j.a(n,[u,t,e,f,r])},"",_mcp.P,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var p="OmeExpirationView._tidd2";new _j.d(p,function(){_mcp.a.a[p]===undefined&&(_mcp.a.a[p]=[[[-1,4,null,null,null,"Title",null,_mcp.a.p,0,null,null,null,_nbs.a.Yn],[-1,4,null,null,null,"Text",null,_mcp.a.m,0,null,null,null,_nbs.a.Yn],[-1,4,null,null,null,"Data",null,_mcp.a.eI,0,null,null,null,0]],[[-1,4,null,null,null,"Title",null,_mcp.a.p,0,null,null,null,_nbs.a.KP],[-1,4,null,null,null,"Text",null,_mcp.a.m,0,null,null,null,_nbs.a.KP],[-1,4,null,null,null,"Data",null,_mcp.a.eI,0,null,null,null,1],[-1,0,["IsOmeTimeExpirationEnabled"],[_mcp.a.fF],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,5,["IsOmeTimeExpirationEnabled"],[_mcp.a.fF],null,"_mcp_i5",null,null,0,_mcp.a.c(),null,null]],[[-1,4,null,null,null,"TextSelectionType",null,_mcp.a.cD,0,null,null,0,2],[-1,0,["FirstTextBox","MaxLength"],[_mcp.a.dr,_mcp.a.et],null,"MaxLength",null,_mcp.a.bF,0,null,null,0],[-1,0,["FirstTextBox","TextInput"],[_mcp.a.dr,_mcp.a.ev],_mcp.a.ew,"Text",_mcp.a.bE,_mcp.a.bG,2,null,null,null],[-1,0,["FirstTextBox","PlaceholderText"],[_mcp.a.dr,_mcp.a.eu],null,"Placeholder",null,_mcp.a.bP,0,null,null,null],[-1,0,["IsTimeExpirationSelected"],[_mcp.a.ex],_mcp.a.ey,"IsEnabled",_mcp.a.dx,_mcp.a.dy,2,null,null,!1],[-1,5,["FirstTextBox","IsYear"],[_mcp.a.dr,_mcp.a.es],null,"_mcp_g5",null,null,0,null,null,null]],[[-1,4,null,null,null,"TextSelectionType",null,_mcp.a.cD,0,null,null,0,2],[-1,0,["SecondTextBox","MaxLength"],[_mcp.a.ds,_mcp.a.et],null,"MaxLength",null,_mcp.a.bF,0,null,null,0],[-1,0,["SecondTextBox","PlaceholderText"],[_mcp.a.ds,_mcp.a.eu],null,"Placeholder",null,_mcp.a.bP,0,null,null,null],[-1,0,["SecondTextBox","TextInput"],[_mcp.a.ds,_mcp.a.ev],_mcp.a.ew,"Text",_mcp.a.bE,_mcp.a.bG,2,null,null,null],[-1,0,["IsTimeExpirationSelected"],[_mcp.a.ex],_mcp.a.ey,"IsEnabled",_mcp.a.dx,_mcp.a.dy,2,null,null,!1],[-1,5,["SecondTextBox","IsYear"],[_mcp.a.ds,_mcp.a.es],null,"_mcp_g5",null,null,0,null,null,null]],[[-1,4,null,null,null,"TextSelectionType",null,_mcp.a.cD,0,null,null,0,2],[-1,0,["ThirdTextBox","MaxLength"],[_mcp.a.dt,_mcp.a.et],null,"MaxLength",null,_mcp.a.bF,0,null,null,0],[-1,0,["ThirdTextBox","PlaceholderText"],[_mcp.a.dt,_mcp.a.eu],null,"Placeholder",null,_mcp.a.bP,0,null,null,null],[-1,0,["ThirdTextBox","TextInput"],[_mcp.a.dt,_mcp.a.ev],_mcp.a.ew,"Text",_mcp.a.bE,_mcp.a.bG,2,null,null,null],[-1,0,["IsTimeExpirationSelected"],[_mcp.a.ex],_mcp.a.ey,"IsEnabled",_mcp.a.dx,_mcp.a.dy,2,null,null,!1],[-1,5,["ThirdTextBox","IsYear"],[_mcp.a.dt,_mcp.a.es],null,"_mcp_g5",null,null,0,null,null,null]]]);var n=_mcp.a.g.childNodes[61].cloneNode(!0);var u=new _fc.i(_j.a.a(n,[1,1,2]));var f=new _fc.i(_j.a.a(n,[1,1,1]));var e=new _fc.i(_j.a.a(n,[1,1,0]));var t=new _j.h(_j.a.a(n,[1,1]));var i=new _fce.j(_j.a.a(n,[1,0]));var r=new _fce.j(_j.a.a(n,[0,0]));return new _j.a(n,[r,i,t,e,f,u])},"",_mcp.ba,_fce.i,function(n){return new _fce.i(n)},!1,!0,!1,0,_mcp.a.a);var y="OmeExpirationView";new _j.d(y,function(){_mcp.a.a[y]===undefined&&(_mcp.a.a[y]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.oW]],[[-1,0,["SelectedOption"],[_mcp.a.hn],_mcp.a.ho,"SelectedOptionData",_mcp.a.gb,_mcp.a.gc,2,null,null,null]],[[-1,0,["ErrorText"],[_mcp.a.hm],null,"Text",null,_mcp.a.h,1,null,null,null]]]);var n=_mcp.a.g.childNodes[62].cloneNode(!0);var i=new _fc.a(n.children[2]);i.J(!1);var t=new _fce.i(n.children[1]);t.y("OmeExpirationView._tidd2");var r=new _fc.a(n.children[0]);return new _j.a(n,[r,t,i])},"",_mcp.ba,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var b="GroupCreateSuggestionInfoBarView._tide2";new _j.d(b,function(){_mcp.a.a[b]===undefined&&(_mcp.a.a[b]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.FZ]]]);var n=_mcp.a.g.childNodes[63].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",_mcp.O,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_mcp.a.a);var w="GroupCreateSuggestionInfoBarView._tidf2";new _j.d(w,function(){_mcp.a.a[w]===undefined&&(_mcp.a.a[w]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.Mr]]]);var n=_mcp.a.g.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",_mcp.O,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_mcp.a.a);var v="GroupCreateSuggestionInfoBarView";new _j.d(v,function(){_mcp.a.a[v]===undefined&&(_mcp.a.a[v]=[[[-1,0,["BeforeCreateGroupStatus"],[_mcp.a.gI],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["InfoBarText"],[_mcp.a.gM],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,0,["HasExistingGroup"],[_mcp.a.fs],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["HasExistingGroup"],[_mcp.a.fs],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["ReplaceWithGroupClickCommand"],[_mcp.a.gN],null,"ClickCommand",null,_mcp.a.i,1,null,null,null]],[[-1,0,["IsCreatingGroupStatus"],[_mcp.a.ft],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp.a.L,0,null,null,0,0],[-1,0,["IsCreatingGroupStatus"],[_mcp.a.ft],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["CreatingGroupText"],[_mcp.a.gL],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,0,["AfterCreateGroupStatus"],[_mcp.a.gG],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["AfterCreateGroupText"],[_mcp.a.gH],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_mcp.a.p,0,null,null,null,_u.R.Ox],[-1,0,["CloseCommand"],[_mcp.a.gK],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,0,["Close"],[_mcp.a.gJ],null,"ImageId",null,_mcp.a.o,0,null,null,null],[-1,0,["CloseHover"],[_mcp.a.fq],null,"HoveredImageId",null,_mcp.a.D,0,null,null,null],[-1,0,["CloseHover"],[_mcp.a.fq],null,"PressedImageId",null,_mcp.a.V,0,null,null,null]]]);var n=_mcp.a.g.childNodes[64].cloneNode(!0);var f=new _fc.b(_j.a.a(n,[0,3]));var s=new _fc.a(_j.a.a(n,[0,2,0]));var l=new _j.h(_j.a.a(n,[0,2]));var h=new _fc.a(_j.a.a(n,[0,1,1]));var r=new _fce.h(_j.a.a(n,[0,1,0]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));r.a=0;var c=new _j.h(_j.a.a(n,[0,1]));var u=new _fc.e(_j.a.a(n,[0,0,2]));u.y("GroupCreateSuggestionInfoBarView._tidf2");var i=new _fc.e(_j.a.a(n,[0,0,1]));var t=new _b.F(_j.b.Instance.a(_b.p),_j.b.Instance.a(_b.a),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.b));t.U(_j.f.a(["GroupCreateSuggestionPeekViewModel"],[_mcp.a.fr],null,"PeekDataContext",null,_mcp.a.gg,1)).U(_j.f.a(["GroupCreateSuggestionPeekViewModel","IsShown"],[_mcp.a.fr,_mcp.a.gQ],_mcp.a.gU,"IsShown",_mcp.a.gh,_mcp.a.gi,2,null,null,!1)).V(_j.f.a(["DOMElement"],[_mcp.a.ge],null,"AnchorElement",null,_mcp.a.gf,1));t.f("GroupCreateSuggestionPeekView");t.l(1);i.D([t]);i.y("GroupCreateSuggestionInfoBarView._tide2");var e=new _fc.a(_j.a.a(n,[0,0,0]));var o=new _j.h(_j.a.a(n,[0,0]));return new _j.a(n,[o,e,i,u,c,r,h,l,s,f])},"",_mcp.O,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var c="GroupCreateSuggestionPeekView._tidg2";new _j.d(c,function(){_mcp.a.a[c]===undefined&&(_mcp.a.a[c]=[null]);var t=_mcp.a.g.childNodes[65].cloneNode(!0);var n=new _fce.d(t.children[0]);return new _j.a(t,[n]).l({ListPanel:n})},"",_mcp.J,_fce.a,function(n){return new _fce.a(n,_j.b.Instance.a(_ff.a))},!1,!0,!1,0,_mcp.a.a);var h="GroupCreateSuggestionPeekView.GroupMemberMemberPersonaTemplate._tidh2";new _j.d(h,function(){_mcp.a.a[h]===undefined&&(_mcp.a.a[h]=[null]);var t=_mcp.a.g.childNodes[66].cloneNode(!0);var n=new _pe.d(_j.a.a(t,[0,0]),_j.b.Instance.a(_a.q));n.y("PersonaView.DisplayPicturePopup");return new _j.a(t,[n])},"",_bc.n,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var a="GroupCreateSuggestionPeekView.GroupMemberMemberPersonaTemplate";new _j.d(a,function(){_mcp.a.a[a]===undefined&&(_mcp.a.a[a]=[null]);var t=_mcp.a.g.childNodes[67].cloneNode(!0);var n=new _j.c(t.children[0]);n.y("GroupCreateSuggestionPeekView.GroupMemberMemberPersonaTemplate._tidh2");return new _j.a(t,[n])},"",_bc.n,_fce.e,function(n){return new _fce.e(n)},!1,!1,!1,0,_mcp.a.a);var l="GroupCreateSuggestionPeekView";new _j.d(l,function(){_mcp.a.a[l]===undefined&&(_mcp.a.a[l]=[null,[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.Dx]],null,[[-1,0,["GroupMemberPersonas"],[_mcp.a.gP],null,"DataSource",null,_mcp.a.ga,1,null,null,null]],[[-1,0,["ShowPersonasTotalNumber"],[_mcp.a.gT],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["PersonasTotalNumber"],[_mcp.a.gS],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.af]],[[-1,4,null,null,null,"Text",null,_mcp.a.m,0,null,null,null,_nbs.a.e],[-1,0,["LearnMoreLinkURL"],[_mcp.a.gR],null,"Href",null,_mcp.a.gd,1,null,null,null]],[[-1,0,["GroupCreationViewModel"],[_mcp.a.gO],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,0,["IsCreateGroupPaneLoading"],[_mcp.a.fu],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp.a.L,0,null,null,0,0],[-1,0,["IsCreateGroupPaneLoading"],[_mcp.a.fu],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var n=_mcp.a.g.childNodes[68].cloneNode(!0);var r=new _fce.h(_j.a.a(n,[0,1,1]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));r.a=0;var u=new _j.c(_j.a.a(n,[0,1,0]));u.y("CreateGroupSuggestionView");var t=new _fc.e(_j.a.a(n,[0,0,2,1]));t.o(!1);t.a("_blank");var s=new _fc.a(_j.a.a(n,[0,0,2,0]));var h=new _fc.a(_j.a.a(n,[0,0,1,1,0]));var c=new _j.h(_j.a.a(n,[0,0,1,1]));var i=new _fce.a(_j.a.a(n,[0,0,1,0,0,0]),_j.b.Instance.a(_ff.a));i.t("GroupCreateSuggestionPeekView.GroupMemberMemberPersonaTemplate");i.y("GroupCreateSuggestionPeekView._tidg2");var e=new _j.h(_j.a.a(n,[0,0,1,0]));var f=new _fc.a(_j.a.a(n,[0,0,0,0]));var o=new _j.h(n.children[0]);return new _j.a(n,[o,f,e,i,c,h,s,t,u,r])},"",_mcp.J,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a)};_mcp.L.registerClass("_mcp.L",_db.f);_mcp.bq.registerClass("_mcp.bq",_h.fb);_mcp.S.registerClass("_mcp.S",_a.cT);_mcp.bd.registerClass("_mcp.bd",_h.cO.$$(_gg.rA,_gg.rC));MailComposeComponent.registerClass("MailComposeComponent",null,_a.ib,_j.ce);_mcp.T.registerClass("_mcp.T");_mcp.U.registerClass("_mcp.U");_mcp.A.registerClass("_mcp.A",_a.iX);_mcp.bu.registerClass("_mcp.bu");_mcp.bt.registerClass("_mcp.bt",_h.fb);_mcp.bv.registerClass("_mcp.bv",null,_h.bT,_h.eo);_mcp.C.registerClass("_mcp.C",_h.cO.$$(_gg.sp,_g.dA));_mcp.br.registerClass("_mcp.br",_h.fb);_mcp.bs.registerClass("_mcp.bs",_h.fb,_a.ft);_mcp.M.registerClass("_mcp.M",_y.hv);_mcp.K.registerClass("_mcp.K",null,IMailComposeActionFactory);_mcp.bi.registerClass("_mcp.bi",null,IMailComposeContextFactory);_mcp.bk.registerClass("_mcp.bk",null,IMailComposeViewModelFactory,_bc.Y);_mcp.bl.registerClass("_mcp.bl",_mcp.bk,IMailInlineComposeViewModelFactory,IMailComposeViewModelFactory,_bc.Y);_mcp.O.registerClass("_mcp.O",_y.hv);_mcp.J.registerClass("_mcp.J",_a.bB,_y.eT,_a.iN,_j.bq,Sys.IDisposable);_mcp.bh.registerClass("_mcp.bh",_a.bB);_mcp.Y.registerClass("_mcp.Y",_j.R,_y.hp);_mcp.b.registerClass("_mcp.b",_a.iX,_g.kd,_y.cL,_bc.bH,IContext,_j.bq,Sys.IDisposable,_dg.ICalendarTimePeriod);_mcp.E.registerClass("_mcp.E",null,IMailComposeDiscardManager);_mcp.c.registerClass("_mcp.c",_a.dR);_mcp.bT.registerClass("_mcp.bT");_mcp.e.registerClass("_mcp.e",_y.hO,_y.i,_y.z,_bc.r,_a.iN,_j.bq,Sys.IDisposable,_y.dw,_y.cI,_bc.j,_bc.o,_y.y,IMailComposeOverridable);_mcp.u.registerClass("_mcp.u",_mcp.e);_mcp.i.registerClass("_mcp.i",_mcp.e);_mcp.k.registerClass("_mcp.k");_mcp.bm.registerClass("_mcp.bm",_a.bB,_y.hq);_mcp.bn.registerClass("_mcp.bn",null,IMailResponseViewModelFactory);_mcp.P.registerClass("_mcp.P",_a.bB);_mcp.ba.registerClass("_mcp.ba",_a.bB);_mcp.Z.registerClass("_mcp.Z");_mcp.bb.registerClass("_mcp.bb");_mcp.bV.registerClass("_mcp.bV");_mcp.G.registerClass("_mcp.G",_j.R,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bw.registerClass("_mcp.bw",_mcp.G,_mcp.cb,IMailComposeComponent,_j.bq,Sys.IDisposable,_y.go);_mcp.m.registerClass("_mcp.m",_mcp.G,IMailComposeAttachmentComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,_y.gy,IMailComposeOverridable);_mcp.o.registerClass("_mcp.o",_mcp.G,IMailComposeContextMenuProvider);_mcp.x.registerClass("_mcp.x",_mcp.o,IMailComposeSaveComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,IMailComposeContextMenuProvider,IMailComposeOverridable);_mcp.V.registerClass("_mcp.V",_mcp.x,IMailComposeAutoSaveComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.y.registerClass("_mcp.y",_mcp.G,IMailComposeCommandingBarComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.D.registerClass("_mcp.D",_mcp.o,IMailComposeComplianceComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.by.registerClass("_mcp.by",null,Sys.IDisposable);_mcp.bz.registerClass("_mcp.bz",_mcp.o,IMailComposeContentConversionComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.H.registerClass("_mcp.H",_mcp.G,IMailComposeContextMenuComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bA.registerClass("_mcp.bA",_mcp.H,IMailComposeContextMenuComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.t.registerClass("_mcp.t",_mcp.G,IMailComposeSendComponent,IMailComposeOverridable);_mcp.I.registerClass("_mcp.I",_mcp.t);_mcp.v.registerClass("_mcp.v",_mcp.G,IMailComposeDiscardComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bB.registerClass("_mcp.bB",_mcp.G,IMailComposeEditorComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bC.registerClass("_mcp.bC",_mcp.bB);_mcp.bD.registerClass("_mcp.bD",_mcp.G,_mcp.cc,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bF.registerClass("_mcp.bF",_mcp.o,IMailComposeImportanceComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.w.registerClass("_mcp.w",_mcp.G,IMailComposeLinkPreviewComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.W.registerClass("_mcp.W",_mcp.G,IMailComposeCalendaringInfobarComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bG.registerClass("_mcp.bG",_mcp.G,IMailComposeInitializerComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.g.registerClass("_mcp.g",_mcp.G,IMailComposeMeetingComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bI.registerClass("_mcp.bI",_mcp.o,IMailComposeMessageOptionsComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.q.registerClass("_mcp.q",_mcp.o,IMailComposeNavigationComponent);_mcp.bJ.registerClass("_mcp.bJ",_mcp.o,IMailComposeOmeComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.bK.registerClass("_mcp.bK",_mcp.G,IMailComposePALGenericAttachmentComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bM.registerClass("_mcp.bM",_mcp.G,IMailComposePhotoComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.f.registerClass("_mcp.f",_mcp.o,_y.hS,IMailComposeRecipientComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,_rw.q);_mcp.r.registerClass("_mcp.r",_mcp.G,IMailComposeRecipientSummarizationComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.B.registerClass("_mcp.B",_j.R);_mcp.s.registerClass("_mcp.s",_mcp.G,IMailComposeSendAsContextMenuComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bO.registerClass("_mcp.bO",_mcp.G,IMailComposeShareAttachmentComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.p.registerClass("_mcp.p",_mcp.o,IMailComposeSignatureComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.bP.registerClass("_mcp.bP",_mcp.G,IMailComposeTouchComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.N.registerClass("_mcp.N",_mcp.G,IMailComposeUpgradeComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bH.registerClass("_mcp.bH",_mcp.G,IMailComposeMailTipsComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bL.registerClass("_mcp.bL",_mcp.G,IMailComposePeopleRecommendationsComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bN.registerClass("_mcp.bN",_mcp.G,IMailComposePolicyTipsComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.z.registerClass("_mcp.z",_mcp.G,_y.eX,_y.eW,_y.ha,IMailComposeExtensibilityComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bE.registerClass("_mcp.bE",_mcp.G,IMailComposeHashtagComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bx.registerClass("_mcp.bx");_mcp.bQ.registerClass("_mcp.bQ",null,_j.bR);_mcp.j.registerClass("_mcp.j",_j.h,_b.bB);_mcp.F.registerClass("_mcp.F",_j.c);_mcp.l.registerClass("_mcp.l",_j.c,_ff.k,_y.gk);_mcp.cd.registerClass("_mcp.cd",_mcp.l);_mcp.h.registerClass("_mcp.h",_j.c);_mcp.R.registerClass("_mcp.R",_mcp.cd);_mcp.bc.registerClass("_mcp.bc",_j.c);_mcp.n.registerClass("_mcp.n",_mcp.cd);MailComposeComponent.$$cctor();_mcp.b.bU=new _a.e("ViewModelId",String,_mcp.b);_mcp.b.b=new _a.e("Operation",_y.l,_mcp.b);_mcp.b.k=new _a.e("Mode",_y.dD,_mcp.b);_mcp.b.bq=new _a.e("OriginalId",_g.g,_mcp.b);_mcp.b.bp=new _a.e("OriginalDocumentId",Number,_mcp.b);_mcp.b.br=new _a.e("OriginalItem",_g.h,_mcp.b);_mcp.b.G=new _a.e("DraftId",_g.g,_mcp.b);_mcp.b.bO=new _a.e("StoreId",String,_mcp.b);_mcp.b.bP=new _a.e("Subject",String,_mcp.b,"");_mcp.b.bC=new _a.e("SelectedDataCallContext",_h.cU,_mcp.b);_mcp.b.I=new _a.e("EditorCallContext",_h.cU,_mcp.b);_mcp.b.J=new _a.e("EditorContent",String,_mcp.b,"");_mcp.b.s=new _a.e("BodyType",String,_mcp.b);_mcp.b.n=new _a.e("ToRecipients",_j.Q,_mcp.b);_mcp.b.m=new _a.e("SpeechResultRecipients",_j.Q,_mcp.b);_mcp.b.bQ=new _a.e("ToQueryString",String,_mcp.b);_mcp.b.g=new _a.e("CcRecipients",_j.Q,_mcp.b);_mcp.b.u=new _a.e("CcQueryString",String,_mcp.b);_mcp.b.f=new _a.e("BccRecipients",_j.Q,_mcp.b);_mcp.b.r=new _a.e("BccQueryString",String,_mcp.b);_mcp.b.l=new _a.e("AutoAddSignature",Boolean,_mcp.b,!0);_mcp.b.T=new _a.e("Importance",String,_mcp.b,"Normal");_mcp.b.by=new _a.e("QuotedBody",String,_mcp.b);_mcp.b.bH=new _a.e("SmimeContent",String,_mcp.b);_mcp.b.bJ=new _a.e("SmimeErrorCode",Number,_mcp.b);_mcp.b.bK=new _a.e("SmimeRecipientCerts",Array,_mcp.b);_mcp.b.bL=new _a.e("SmimeSigningCert",String,_mcp.b);_mcp.b.o=new _a.e("AttachmentsToAdd",Array,_mcp.b);_mcp.b.Z=new _a.e("IsComplete",Boolean,_mcp.b);_mcp.b.i=new _a.e("IsMeeting",Boolean,_mcp.b);_mcp.b.bd=new _a.e("IsMeetingForward",Boolean,_mcp.b);_mcp.b.bk=new _a.e("IsReplyAllOnBcc",Boolean,_mcp.b);_mcp.b.bo=new _a.e("Location",_dg.d,_mcp.b);_mcp.b.Q=new _a.e("HasLocation",Boolean,_mcp.b);_mcp.b.V=new _a.e("InternetMessageId",String,_mcp.b);_mcp.b.bz=new _a.e("Recurrence",_dg.r,_mcp.b);_mcp.b.bj=new _a.e("IsRecurringMaster",Boolean,_mcp.b);_mcp.b.bN=new _a.e("Start",_a.c,_mcp.b);_mcp.b.K=new _a.e("End",_a.c,_mcp.b);_mcp.b.cc=new _a.e("IsAllDayEventProperty",Boolean,_mcp.b);_mcp.b.M=new _a.e("From",_g.O,_mcp.b);_mcp.b.bD=new _a.e("Sender",_g.O,_mcp.b);_mcp.b.bn=new _a.e("IsUpgraded",Boolean,_mcp.b);_mcp.b.bb=new _a.e("IsFromShown",Boolean,_mcp.b);_mcp.b.X=new _a.e("IsCcShown",Boolean,_mcp.b);_mcp.b.W=new _a.e("IsBccShown",Boolean,_mcp.b);_mcp.b.bu=new _a.e("ParentFolderNameToPost",String,_mcp.b);_mcp.b.bt=new _a.e("ParentFolderIdToPost",_g.l,_mcp.b);_mcp.b.d=new _a.e("AttachmentCollection",_j.k,_mcp.b);_mcp.b.e=new _a.e("AttachmentProviderFiles",_j.k,_mcp.b);_mcp.b.p=new _a.e("AttachmentsToHide",Array,_mcp.b);_mcp.b.F=new _a.e("DocLinks",_a.j,_mcp.b);_mcp.b.bT=new _a.e("UpgradeFailed",Boolean,_mcp.b);_mcp.b.q=new _a.e("Baseline",_mcp.c,_mcp.b);_mcp.b.P=new _a.e("HasBeenSavedByUser",Boolean,_mcp.b);_mcp.b.O=new _a.e("HasBeenAutoSaved",Boolean,_mcp.b);_mcp.b.bR=new _a.e("UnpromotedEmojiCountProperty",Number,_mcp.b);_mcp.b.bS=new _a.e("UnpromotedInlineImageCountProperty",Number,_mcp.b);_mcp.b.bl=new _a.e("IsReplyForward",Boolean,_mcp.b);_mcp.b.H=new _a.e("Draft",_g.h,_mcp.b);_mcp.b.N=new _a.e("GroupEmailAddress",_g.f,_mcp.b);_mcp.b.bB=new _a.e("RightsManagementLicenseData",_g.cK,_mcp.b);_mcp.b.z=new _a.e("ComplianceId",String,_mcp.b);_mcp.b.Y=new _a.e("IsClassified",Boolean,_mcp.b);_mcp.b.w=new _a.e("ClassificationGuid",String,_mcp.b);_mcp.b.y=new _a.e("Classification",String,_mcp.b);_mcp.b.v=new _a.e("ClassificationDescription",String,_mcp.b);_mcp.b.x=new _a.e("ClassificationKeep",Boolean,_mcp.b);_mcp.b.bF=new _a.e("Sensitivity",String,_mcp.b,"Normal");_mcp.b.ba=new _a.e("IsDeliveryReceiptRequested",Boolean,_mcp.b);_mcp.b.bi=new _a.e("IsReadReceiptRequested",Boolean,_mcp.b);_mcp.b.bI=new _a.e("SmimeEncryptMessage",Boolean,_mcp.b);_mcp.b.bM=new _a.e("SmimeSignMessage",Boolean,_mcp.b);_mcp.b.A=new _a.e("ConversationId",_g.g,_mcp.b);_mcp.b.bs=new _a.e("ParentConversationNodeId",String,_mcp.b);_mcp.b.t=new _a.e("CalendarItemModelType",_h.dw,_mcp.b);_mcp.b.bf=new _a.e("IsOccurrenceReferencingMaster",Boolean,_mcp.b);_mcp.b.bh=new _a.e("IsPoppedOutFromReadingPane",Boolean,_mcp.b);_mcp.b.bc=new _a.e("IsLoadedDraft",Boolean,_mcp.b);_mcp.b.bV=new _a.e("WasCleanNewMessageBeforePopout",Boolean,_mcp.b);_mcp.b.S=new _a.e("HideIncludeEntrypoint",Boolean,_mcp.b,!1);_mcp.b.bW=new _a.e("WasSavingBeforePopout",Boolean,_mcp.b,!1);_mcp.b.be=new _a.e("IsMovedToDraftFromOutbox",Boolean,_mcp.b,!1);_mcp.b.bw=new _a.e("PerfContext",_a.bH,_mcp.b,null);_mcp.b.bv=new _a.e("PerfContextE2E",_a.bH,_mcp.b,null);_mcp.b.bX=new _a.e("WaterfallTraceStarted",Boolean,_mcp.b,null);_mcp.b.bA=new _a.e("RichTextEditorSupported",Boolean,_mcp.b,null);_mcp.b.E=new _a.e("DlpSenderOverride",String,_mcp.b,null);_mcp.b.D=new _a.e("DlpFalsePositive",String,_mcp.b,null);_mcp.b.C=new _a.e("DlpDetectedClassification",String,_mcp.b,null);_mcp.b.L=new _a.e("ExplicitLogonUser",String,_mcp.b,null);_mcp.b.U=new _a.e("IncludeOriginalFromInToRecipients",Boolean,_mcp.b,!1);_mcp.b.h=new _a.e("ExtendedPropertyCollection",_j.k,_mcp.b,null);_mcp.b.bg=new _a.e("IsOnDemandUpgradeRequested",Boolean,_mcp.b,!1);_mcp.b.bm=new _a.e("IsResumingSendFailure",Boolean,_mcp.b,!1);_mcp.b.R=new _a.e("HasSentViaNotification",Boolean,_mcp.b,!1);_mcp.b.bE=new _a.e("SendFailureInfobarMessageId",_bc.E,_mcp.b,45);_mcp.b.bG=new _a.e("SentFromMailComposeInlineReply",Boolean,_mcp.b);_mcp.b.bx=new _a.e("PopoutPerfContext",_a.bH,_mcp.b);_mcp.b.B=new _a.e("DiagnosticContent",String,_mcp.b);_mcp.b.c="UseOverride";_mcp.b.cb=new RegExp("(\r)?\n","gi");_mcp.b.a=null;_mcp.b.$$cctor();_mcp.c.u=new _a.e("Subject",String,_mcp.c,"");_mcp.c.m=new _a.e("EditorContent",String,_mcp.c,"");_mcp.c.h=new _a.e("ToRecipients",_j.k,_mcp.c);_mcp.c.v=new _a.e("ToQueryString",String,_mcp.c);_mcp.c.e=new _a.e("CcRecipients",_j.k,_mcp.c);_mcp.c.k=new _a.e("CcQueryString",String,_mcp.c);_mcp.c.d=new _a.e("BccRecipients",_j.k,_mcp.c);_mcp.c.j=new _a.e("BccQueryString",String,_mcp.c);_mcp.c.o=new _a.e("Importance",String,_mcp.c,"Normal");_mcp.c.n=new _a.e("From",_g.f,_mcp.c);_mcp.c.l=new _a.e("ComplianceId",String,_mcp.c);_mcp.c.r=new _a.e("Sensitivity",String,_mcp.c,"Normal");_mcp.c.p=new _a.e("IsDeliveryReceiptRequested",Boolean,_mcp.c);_mcp.c.q=new _a.e("IsReadReceiptRequested",Boolean,_mcp.c);_mcp.c.s=new _a.e("SmimeEncryptMessage",Boolean,_mcp.c);_mcp.c.t=new _a.e("SmimeSignMessage",Boolean,_mcp.c);_mcp.c.c=new _a.e("AttachmentCollection",_j.k,_mcp.c);_mcp.c.g=new _a.e("ExtendedPropertyCollection",_j.k,_mcp.c,null);_mcp.c.f=new _a.bv(_g.f);_mcp.c.$$cctor();_mcp.e.b=null;_mcp.k.a=_a.a.a;_mcp.bm.a=_a.a.a;_mcp.m.a=new _a.e("AttachmentWellViewModel",_y.bj,_mcp.m);_mcp.V.a=new _a.bg("Auto");_mcp.y.a=_a.a.eH;_mcp.D.a=new _y.h(_u.P.d,null,null);_mcp.H.a=new _a.e("Menu",_fm.f,_mcp.H);_mcp.W.a=[6800,3200,3205,3210,3215,3220,3100,3105,3110,3115,3120,3250,3255,3260];_mcp.g.c=new _a.e("FromDetailsViewModel",_bc.n,_mcp.g);_mcp.g.d=new _a.e("SenderDetailsViewModel",_bc.n,_mcp.g);_mcp.g.b=null;_mcp.g.a=null;_mcp.q.b=[84,85,86,87];_mcp.B.b=7;_mcp.B.a=1;_mcp.x.b=new _a.bg("Group");_mcp.x.a=[60,40,43,1001,700,50,800,88,89];_mcp.s.b=10;_mcp.s.c=new _a.e("Menu",_fm.f,_mcp.s);_mcp.t.a=[62,45,46,47,700,55,70,65,97,66,75,800,88,80,48,89,90,91,92,93,94,98,99,100];_mcp.p.f="<P><BR></P>";_mcp.p.e=new RegExp("[\n\r]+","g");_mcp.p.c=new RegExp("(<img )([^>]*src=[\"']?data:image/[^<]+;base64,[a-zA-Z0-9+/=&#;]+[\"']?)([^>]*>)","gi");_mcp.p.b=new RegExp("(<[aA] [^>]*>)","gi");_mcp.p.d="EmojiInsert";_mcp.z.b=new RegExp("<img(?:[^>]*?)src=['\"]cid:([^\"']*?)[\"'](?:[^>]*?)>","gim");_mcp.X.a=new _mcp.X(!0,!1);_mcp.a.g=_mcp.a.fY();_mcp.a.cw=null;_mcp.a.ct=null;_mcp.a.cz=null;_mcp.a.cx=null;_mcp.a.cy=null;_mcp.a.cu=null;_mcp.a.cv=null;_mcp.a.cA=null;_mcp.a.a={};_mcp.a.$$cctor();
window.scriptsLoaded['microsoft.owa.mail.compose.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.mail.compose.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
