try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.linkpreview.js'] = (new Date()).getTime();
Type.registerNamespace("_lp");_lp.c=function(){};_lp.c.c=function(){return _fm.e.a("play.png")};_lp.c.d=function(){return _fm.e.a("play_filled.png")};_lp.c.j=function(){return _fm.b.a(_fm.a.eb,_fm.WebfontSizes.a.a)};_lp.c.i=function(){return _fm.b.a(_fm.a.ec,_fm.WebfontSizes.a.a)};_lp.c.e=function(){return _fm.b.a(_fm.a.bO,_fm.WebfontSizes.a.k,"ms-font-color-yellow")};_lp.c.f=function(){return _fm.b.a(_fm.a.bN,_fm.WebfontSizes.a.k,"ms-font-color-yellow")};_lp.c.a=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.l,"ms-font-color-white")};_lp.c.b=function(){return _fm.b.a(_fm.a.bo,_fm.WebfontSizes.a.l,"ms-font-color-white")};_lp.c.h=function(){return _fm.b.a(_fm.a.x,_fm.WebfontSizes.a.b)};_lp.c.g=function(){return _fm.b.a(_fm.a.ea,_fm.WebfontSizes.a.b)};_lp.b=function(n,t,i,r,u,f){this.bx=Function.createDelegate(this,this.cH);this.bf=Function.createDelegate(this,this.cL);this.be=Function.createDelegate(this,this.cK);this.bd=Function.createDelegate(this,this.cJ);this.bz=Function.createDelegate(this,this.cV);this.by=Function.createDelegate(this,this.cI);this.bw=Function.createDelegate(this,this.cy);this.M=Function.createDelegate(this,this.cU);this.L=Function.createDelegate(this,this.cT);this.D=Function.createDelegate(this,this.bK);this.bv=Function.createDelegate(this,this.cl);this.bu=Function.createDelegate(this,this.ck);this.A={};this.Z=n;this.V=t;this.bN=r;this.O="Mouse"===r.a();this.bk=i;this.F=u;this.R=f;this.bM=this.F.a().M().Enabled;this.bm=this.F.a().bD().Enabled;this.bo=this.F.a().N().Enabled;this.W=this.z("ms-font-color-neutralSecondary ms-bg-color-themeLighterAlt",["color","background-color"]);this.bp=this.z("ms-font-color-neutralDark ms-bg-color-themeLight",["color","background-color"])};_lp.b.m=function(n,t,i,r,u,f){return new _lp.b(n,t,i,r,u,f)};_lp.b.d=function(n,t,i,r){var u=!1;try{t.startsWith(_lp.b.j)&&_lp.b.k(n);n.src=t;u=!0}catch(f){_j.e.c(_a.a.e,"Setting src in {0}. Exception: {1} Url: {2} ImageUrl: {3}",r,f.message,i,t)}return u};_lp.b.a=function(n){var t=_a.c.get_utcNow().x().toString()+Math.random();return n+"_"+t};_lp.b.k=function(n){n.className="EmojiInsert";n.alt="imageData"};_lp.b.i=function(n){var t=null;n&&n.parentNode&&n.parentNode.parentNode&&n.parentNode.parentNode.parentNode?t=n.parentNode.parentNode.parentNode:_j.e.b(_a.a.e,"Cannot get imageTableCell because of null objects");return t};_lp.b.g=function(n,t,i){for(var f=n.split("&"),r=new Sys.StringBuilder,u=0;u<f.length;u++){var e=f[u];switch(e.substring(0,2)){case"w=":r.append("w="+t);break;case"h=":r.append("h="+i);break;default:r.append(e);break}u!==f.length-1&&r.append("&")}return r.toString()};_lp.b.n=function(){if(!_lp.b.c){if(!window.document)return!1;var n=window.document.createElement("video");_lp.b.c=!!n.canPlayType;if(!_lp.b.c){_lp.e.a().j();_j.e.c(_a.a.e,"IsMotionThumbnailBrowserSupported: The video element is unplayable.")}}return _lp.b.c};_lp.b.prototype={Z:null,V:null,O:!1,bk:!1,bM:!1,bm:!1,bo:!1,R:null,x:null,G:null,bN:null,F:null,W:null,bp:null,d:function(n){this.x=n;return n},h:function(){for(var i=Object.keys(this.A),t=new Array(i.length),n=0;n<t.length;n++)t[n]=this.A[i[n]];return t},a:function(n){return this.A[n]},v:function(n,t){if(n in this.A){this.A[t]=this.A[n];delete this.A[n]}},cg:function(n,t){var r=new _g.ex;r.Url=n;var i=this.bC(r);i&&i.e(t);return i},m:function(n,t){var i;var f,u;_lp.i.a(n,f={val:n},u={val:i}),n=f.val,i=u.val;var r=this.cg(t,n);r&&r.A(i);return n},r:function(n){if(!_j.i.a(n)){var t=this.A[n];return!!t&&!!t.a()&&t.b()!=null}return!1},bC:function(n){var t=null;if(!_j.i.a(n.Url))if(n.Url in this.A)t=this.A[n.Url];else{t=new _lp.i(n);this.A[n.Url]=t}return t},X:function(n,t,i,r){var f=!1;i.val=0;r.val=0;var u=window.document.createElement("img");if(_lp.b.d(u,n,t,"TryGetImageDimensions")){f=!0;i.val=u.width;r.val=u.height}return f},bV:function(n){var t=document.createElement("div");t.innerHTML=n;t.style.display="inline-block";var i=document.createElement("div");i.appendChild(t);return i.innerHTML},bG:function(n,t,i){return this.bL(n,t,i)},p:function(n,t){var r=null;var i=0;t.val=!1;var o,f,e;if(e=this.Y(n,o={val:r},f={val:i}),r=o.val,i=f.val,e){var u=this.cu(n);u?i===1?this.N(u,r,i):(i===2||i===3)&&(this.x&&r in this.x?this.N(u,r,i):t.val=!0):_j.e.b(_a.a.e,"AddPlayButton: Image anchor was not found")}},e:function(n,t){var i=null;var f=$(n).find(t);if(f.length>0){i=window.document.createElement("a");i.style.fontFamily="'wf_segoe-ui_normal', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif";i.style.fontWeight="normal";i.style.position="relative";i.style.styleFloat="right";i.style.cursor="pointer";i.style.padding="8px";i.style.cssText+="float: right";i.style.cssText+=this.W;var r=$(i);r.mouseenter(this.bu);r.mouseleave(this.bv);r.css("-moz-user-select","none");r.css("-khtml-user-select","none");r.css("-webkit-user-select","none");r.css("-ms-user-select","none");var u=f.get(0);u.appendChild(i);u.parentNode.style.position="relative"}return i},q:function(n){this.cO(n);this.cN(n);var i=n.find("a[id^='LPImageAnchor'] img");if(i&&i.length===1){var r=i[0];_j.e.a(_a.a.e,"Unbinding ImageLoad.  Image src= "+r.src);i.unbind("load",this.D);var t=_lp.b.i(r);if(!t)return;if(t.style.display==="none"){_j.e.a(_a.a.e,"Removing image because Display is set to none.  Image src= "+r.src);t.parentNode.removeChild(t)}else if(!r.src){_j.e.b(_a.a.e,"Removing image because image src is null");t.parentNode.removeChild(t)}}},cO:function(n){var t=n.find("div[id^='LPPlayButtonContainer']");if(t&&t.length===1){var u=t[0];if(_b.g.a(u.parentNode.id,"LPImageAnchor")){var i=u.parentNode;$(i).unbind("click",this.Z);$(i).unbind("click",this.V);var r=this.bI(n[0]);r?i.href=r.href:_j.e.b(_a.a.e,"RemovePlayButton: Preview anchor was not found")}else _j.e.b(_a.a.e,"RemovePlayButton: Play button parent is not an image anchor");t.remove()}},u:function(n,t){t.val=null;var l=null;var c=null;var h=null;var y=null;var v=null;var a=null;var s,u,r,i,o,e,f;return f=this.P(n,t,s={val:l},u={val:c},r={val:h},i={val:y},o={val:v},e={val:a}),l=s.val,c=u.val,h=r.val,y=i.val,v=o.val,a=e.val,f},s:function(n){if(!n.href)return!1;var u=-1;var r=n.innerHTML.toLowerCase();var t;var i=_a.T.d(n.href)&&!!(t=new _a.T(n.href)).a&&r.indexOf(t.a.toLowerCase())>u;_j.e.a(_a.a.e,"hrefMatchesLinkText {0} for {1}",i,n.href);return i},i:function(n,t,i,r,u,f){i.val=null;r.val=null;u.val=null;f.val=null},b:function(n){switch(n){case 1:return _nbs.a.Fw;case 2:return _nbs.a.kN;case 5:return _nbs.a.fw;case 6:return _nbs.a.Mt}return""},Y:function(n,t,i){t.val=null;i.val=0;if(this.cQ(n)){t.val=this.cC(n.id);i.val=this.cB(n.id)}return!!t.val},N:function(n,t,i){var o=$(n).find("div[id^='LPPlayButtonContainer']");if(o.length>0){_j.e.a(_a.a.e,"Play button already added. Not adding another");return}i===1?n.href=this.bQ(t):(i===2||i===3)&&(n.href=t);this.bS(n,i);var r=this.w(8);var s=this.w(9);r.appendChild(s);n.appendChild(r);this.bR(n);var e=$(n).find("video");if(e.length>0){var f=e[0].paused;Boolean.isInstanceOfType(f)&&!f&&(r.style.display="none")}var u=$(n).parents("div[id^='LPImageContainer']");u.unbind("mouseenter",this.L).mouseenter(this.L);u.unbind("mouseleave",this.M).mouseleave(this.M)},bS:function(n,t){t===1?$(n).bind("click",this.Z):(t===2||t===3)&&$(n).bind("click",this.V)},bR:function(n){},bq:function(n){},ck:function(n){if(n.target){var t=$(n.target);t[0].style.cssText+=this.bp}},cl:function(n){if(n.target){var t=$(n.target);t[0].style.cssText+=this.W}},br:function(n,t){t.val=null;var g=null;var s=null;var h=0;var i=null;var u=null;var r=null;if(_b.g.a(n.id,"LPUrlAnchor"))u=n;else{var nt=_b.g.b(n);if(!nt)return!1;u=this.bI(nt);if(!u)return!1}var e,o,k,d,ut;var rt,tt,it,b,a,c,l,v;if(!(v=this.P(u,rt={val:i},tt={val:e},it={val:o},b={val:k},a={val:r},c={val:d},l={val:ut}),i=rt.val,e=tt.val,o=it.val,k=b.val,r=a.val,d=c.val,ut=l.val,v))return!1;if(r){var f=$(r).find("img");if(f.length===1&&f[0]){var ft=f[0];g=ft.src}}var w,p,y;(_b.g.a(i.id,"LPBorder_YT")||_b.g.a(i.id,"LPBorder_VT")||_b.g.a(i.id,"LPBorder_BVT"))&&!(y=this.Y(i,w={val:s},p={val:h}),s=w.val,h=p.val,y)&&_j.e.b(_a.a.e,"Can't get playerUrl for {0}",n.href);t.val=new _b.bO(i,e,o,r,g,s,h);return!0},P:function(n,t,i,r,u,f,e,o){t.val=null;i.val=null;r.val=null;u.val=null;f.val=null;e.val=null;o.val=null;if(!_b.g.a(n.id,"LPUrlAnchor")){_j.e.a(_a.a.e,"ValidatePreview: Anchor element id is invalid for {0}",n.href);return!1}if(!this.K(n,n,"div","Invalid url container",u))return!1;var s;var l,a;if(a=this.bU(u.val,n,t,i,r,u,f,l={val:s},e,o),s=l.val,a)return!0;if(s&&!t.val){var h,c;return c=this.bU(s,n,t,i,r,u,f,h={val:s},e,o),s=h.val,c}return!1},bU:function(n,t,i,r,u,f,e,o,s,h){i.val=null;r.val=null;u.val=null;f.val=null;e.val=null;o.val=null;s.val=null;h.val=null;var l;var y,p;if(!(p=this.K(n,t,"td","Invalid table cell",y={val:l}),l=y.val,p)||!this.K(l,t,"tr","Invalid table row",s))return!1;var c;var v,a;(a=this.K(s.val,t,"tbody","Invalid table body",v={val:c}),c=v.val,a)||(c=s.val);return this.K(c,t,"table","Invalid table",o)?this.K(o.val,t,"div","Invalid border",i)?this.cS(i.val,t,r,u,f,e,h)?!0:!1:!1:!1},cS:function(n,t,i,r,u,f,e){i.val=null;r.val=null;u.val=null;f.val=null;e.val=null;if(!_b.g.a(n.id,"LPBorder")){_j.e.a(_a.a.e,"ValidatePreview: Border element id is invalid for {0}",t.href);return!1}if(!this.bl(n,"div")){_j.e.a(_a.a.e,"ValidatePreview: Border element tag name is invalid for {0}",t.href);return!1}if(n.children.length!==1&&n.children.length!==2){_j.e.a(_a.a.e,"ValidatePreview: Border element child count is invalid for {0}",t.href);return!1}var c=n.children[0];if(!this.bl(c,"table")){_j.e.a(_a.a.e,"ValidatePreview: Parent is not a table for {0}",t.href);return!1}var s=c.getElementsByTagName("div");if(s.length<2||s.length>12){_j.e.a(_a.a.e,"ValidatePreview: Expected number of divs not found for {0}",t.href);return!1}for(var h=0;h<s.length;h++){var o=s[h].id;if(_b.g.a(o,"LPDescription"))r.val=s[h];else if(_b.g.a(o,"LPTitle"))i.val=s[h];else if(_b.g.a(o,"LPImageContainer")||_b.g.a(o,"LPBestFitImageContainer")||_b.g.a(o,"LPImageAlbumContainer"))f.val=s[h];else if(_b.g.a(o,"LPOverlayID"))e.val=s[h];else if(_b.g.l(o))continue;else{_j.e.a(_a.a.e,"ValidatePreview: Unexpected div with id {0} found for {1}",o,t.href);return!1}}return!0},bl:function(n,t){return!!n&&!!n.tagName&&n.tagName.toLowerCase()===t.toLowerCase()},bL:function(n,t,i){return n.__type===_g.cq._dataContractName?this.cq(n):n.__type===_gg.bQ._dataContractName&&this.bo?this.cn(n,i):this.cr(n,t)},H:function(n){var t=window.document.createElement("td");n&&(t.id=_lp.b.a(n));return t},C:function(n,t,i,r){var u=n.find(String.format("td[id^='{0}']",t));if(u&&u.length===1){var f=u[0];f.colSpan=i;if(r){f.style.display="table-cell";if(t==="ImageCell"){var o=u.find("div[id^='LPImageContainer']");var e=u.find("div[id^='LPImageContainer']");o.width(e.width());o.height(e.height())}}else f.style.display="none"}},bs:function(n,t){var i=$(n);if(t){this.C(i,"TitleCell",3,!0);this.C(i,"ImageCell",1,!0);this.C(i,"TextCell",2,!0);this.C(i,"UrlLinkCell",2,!0);this.C(i,"LPRemovePreviewContainer",1,!0);this.C(i,"LPExpandDescriptionContainer",1,!0);this.C(i,"LPOptionsContainer",1,!0)}else if(!t){this.C(i,"TitleCell",2,!0);this.C(i,"ImageCell",1,!1);this.C(i,"TextCell",2,!0);this.C(i,"UrlLinkCell",1,!0);this.C(i,"LPRemovePreviewContainer",1,!0);this.C(i,"LPExpandDescriptionContainer",1,!0);this.C(i,"LPOptionsContainer",1,!0)}},cr:function(n,t){var h=this.F.a().cj().Enabled;var c=n.__type===_g.cH._dataContractName||this.bO(n);var r=this.w(1);r.setAttribute("cellspacing",0);var s=this.I(r);n.ImageUrl&&this.bB(n,n.Url,n.ImageUrl,s,c,!1);var i=this.H("TextCell");i.style.verticalAlign="top";i.style.position="relative";i.style.padding="0px";var a=this.y(null,21);i.appendChild(a);if(h){var v=this.y(null,22);i.appendChild(v)}if(n.Title){var e=this.y(null,5);var o=this.E(n.Url,7);o.textContent=_ff.g.b(n.Title);e.appendChild(o);i.appendChild(e)}if(n.Url){var l=this.y(new _a.T(n.Url).a,20);i.appendChild(l)}if(n.Description){var f=this.y(_ff.g.b(n.Description),6);i.appendChild(f);h&&this.ch(n.Url,f,t)}s.appendChild(i);var u=this.S(n);u.appendChild(r);this.bs(u,!1);return u},I:function(n){var t=window.document.createElement("tr");$(t).css("border-spacing","0px");this.bT(t);n.appendChild(t);return t},cq:function(n){var r=n;if(!r.Photos)return null;if(r.Photos.length===1){var s=this.S(n);return this.bA(n,r.Photos,s)?s:null}var t=this.w(1);t.style.width="90%";var v=this.I(t);var a=this.I(t);var y=this.I(t);if(!this.bA(n,r.Photos,a))return null;var i=this.H(null);i.colSpan=2;var l=this.y(null,21);i.appendChild(l);if(n.Title){var f=this.y(null,5);var e=this.E(n.Url,7);e.style.verticalAlign="top";e.textContent=_ff.g.b(n.Title);var u=document.createElement("img");u.style.marginTop="-10px";_lp.b.k(u);u.src=_lp.b.h;f.appendChild(u);f.appendChild(e);i.appendChild(f)}if(n.Description){var h=this.y(_ff.g.b(n.Description),6);i.appendChild(h)}v.appendChild(i);var c=this.H(null);y.appendChild(c);var o=this.S(n);o.appendChild(t);return o},cn:function(n,t){var f=this.w(1);f.setAttribute("cellspacing",0);var e=this.I(f);n.PreviewImageInBase64&&this.bB(n,n.Url,n.PreviewImageInBase64,e,!1,!1);var i=this.H("TextCell");i.style.verticalAlign="top";i.style.position="relative";i.style.padding="0px";var s=this.y(null,21);i.appendChild(s);var o=this.y(null,23);i.appendChild(o);this.cf(n,i);if(n.Description){var h=this.y(_ff.g.b(n.Description),6);i.appendChild(h)}e.appendChild(i);var r=this.S(n);r.appendChild(f);var u=this.A[n.Url];u&&u.a()&&this.t(u,r,t);this.bs(r,!1);return r},cf:function(n,t){var o=window.document.createElement("table");t.appendChild(o);var e=this.I(o);var h=this.H(null);e.appendChild(h);if(n.ItemIcon){var s=window.document.createElement("img");s.src=n.ItemIcon;var r=this.cm(n.Url);r.appendChild(s);h.appendChild(r);r.style.marginRight="10px"}var i=this.H(null);e.appendChild(i);if(n.Title){var f=this.y(null,5);var u=this.E(n.Url,7);var l=n.FileType?"."+n.FileType:"";u.textContent=_ff.g.b(n.Title)+l;f.appendChild(u);i.appendChild(f)}var c=this.y("",20);i.appendChild(c)},ch:function(n,t,i){if(!this.bn()&&i){var r={};r.dataType="json";r.url="https://bing-blink.azurewebsites.net/api/blink/summary";r.data=String.format("url={0}",encodeURI(n));r.type="GET";var f=this;r.error=function(n,i,r){f.U(t,i)};var u=this;r.success=function(n,r,f){u.ci(t,i,n,r,f)};$.ajax(r)}},ci:function(n,t,i,r,u){if(i){var e=this.cA(i);if(!e){this.U(n,"parsing error");return}for(var o=new Sys.StringBuilder,f=0;f<e.length;f++)if(e[f])f<e.length-1?o.append(e[f]+"<br/><br/>"):o.append(e[f]);else continue;if(o.isEmpty())this.U(n,"no snippets");else{n.setAttribute("altdesc",o.toString());t&&t(_b.g.b(n));this.U(n,"success")}}},U:function(n,t){var i=new _a.o;var r=_a.d.b(_a.a.e,"LinkPreviewSummarizationAction");var u=$(_b.g.b(n)).find("a[id^='LPUrlAnchor']");i.b("U",_db.h.b(u,"href",100));i.b("Status",t);r.j=i.toString();_a.d.a(r)},cA:function(n){var a="Status";var e="Succeed";var h="Data";var s="StaticScore";var c="Text";var t=[];if(n[a]===e)for(var l=n[h],u=l,o=u.length,r=0;r<o;++r){var f=u[r];var v=f[s];if(t.length===3)break;Array.add(t,f)}if(!t.length)return null;for(var i=0;i<t.length;i++)t[i]=t[i][c];return t},bA:function(n,t,i){var s=!1;_j.e.a(_a.a.e,"Adding images for {0}",n.Url);var e=t.length>1;var u;u=this.w(e?12:11);for(var o=t,h=o.length,f=0;f<h;++f){var c=o[f];this.cp(c,n,u,!e,e)&&(s=!0)}var r=this.H(null);r.style.position="relative";r.style.display="table-cell";r.appendChild(u);r.colSpan=2;i.appendChild(r);return s},bB:function(n,t,i,r,u,f){var e=this.H("ImageCell");f||(e.style.width="250px");e.style.position="relative";e.style.display="none";e.style.paddingRight=20+"px";e.colSpan=2;r.appendChild(e);_j.e.a(_a.a.e,"Adding image for {0}",t);var o=null;var h=f?11:2;o=this.w(h);var s=this.bF(n,o,t,i,u,f,!1);if(!s){_j.e.b(_a.a.e,"Image anchor null for image URL {0}.",i);return}e.appendChild(o)},cp:function(n,t,i,r,u){var f=null;if(r)if(!n.MimeType||n.MimeType.startsWith("image"))f=n.ImageUrl;else return null;else f=n.MimeType&&n.MimeType==="none"?_lp.b.l:n.ThumbnailUrl;var o=null;if(f){o=this.bF(t,i,n.PhotoPageUrl,f,!1,r,u);if(!n.MimeType||n.MimeType.startsWith("image")){var e=document.createElement("img");e.src=n.ImageUrl;e.style.display="none";e.id=_lp.b.a("LPFullsizeImageID");o.appendChild(e)}}return o},bF:function(n,t,i,r,u,f,e){var a;var y;var v,w,p;if(!(p=this.X(r,i,v={val:a},w={val:y}),a=v.val,y=w.val,p))return null;var s=null;if(u)s=this.co(n,3);else{var k=e?16:3;s=this.E(i,k)}t.appendChild(s);var o=null;var b=f?13:e?14:4;o=this.w(b);o.id=_lp.b.a("LPThumbnailImageID");s.appendChild(o);var l=$(o);var h=_lp.b.g(r,250,140);if(this.T(n)){_lp.b.d(o,h,i,"LinkPreviewBuilder.CreateImageLink");this.bh(n.MotionThumbnailUrl,t,s)}else{l.bind("load",this.D);if(!_lp.b.d(o,h,i,"LinkPreviewBuilder.CreateImageLink")){l.unbind("load",this.D);return null}}if(u){var c=$(t);c.unbind("mouseenter",this.L).mouseenter(this.L);c.unbind("mouseleave",this.M).mouseleave(this.M)}return s},co:function(n,t){var i=null;if(this.O){i=this.w(t);var u=0;var r=null;if(n.__type===_g.cH._dataContractName){u=1;r=n.PlayerUrl}else if(n.__type===_g.cD._dataContractName){r=n.Url;u=2}else if(n.__type===_gg.bj._dataContractName){r=n.Url;u=3}this.N(i,r,u);i.target="_blank"}else i=this.E(n.Url,t);return i},S:function(n){var r=window.document.createElement("div");var i=null;var u=0;if(n.__type===_g.cH._dataContractName){i=n.PlayerUrl;u=1}else if(n.__type===_g.cD._dataContractName){i=n.Url;u=2}else if(n.__type===_gg.bj._dataContractName){i=n.Url;u=3}var t;t=i?this.cs(i,u):n.__type===_g.cq._dataContractName?"LPBorder_PT":"LPBorder_GT";var f=this.bC(n);if(f){r.id=n.__type===_gg.bQ._dataContractName?t+f.l(n.Id):_lp.b.a(t);f.e(r.id)}this.B(r,10);return r},cQ:function(n){return this.O&&(_b.g.a(n.id,"LPBorder_YT")||_b.g.a(n.id,"LPBorder_VT")||_b.g.a(n.id,"LPBorder_BVT"))},cE:function(n){return _b.g.a(n.id,"LPBorder_PT")},cC:function(n){var r=n.split("_");var i;var u=0;if(r[0]!=="LPBorder"){_j.e.b(_a.a.e,"BorderId {0} is not video",n);return null}else if(r.length===2||r.length===3){i=r[1];if(i.startsWith("YT"))u=2;else if(i.startsWith("VT"))u=2;else if(i.startsWith("BVT"))u=3;else{_j.e.b(_a.a.e,"BorderId {0} is missing video type",n);return null}}else{_j.e.b(_a.a.e,"BorderId {0} has wrong number of segments",n);return null}var t=i.substr(u);if(t.length>300||t.length<30){_j.e.b(_a.a.e,"Video url {0} is invalid",t);return null}t=this.J(t,"-","+");t=this.J(t,":","/");t=this.J(t,"\\.","=");var f=_a.bl.a(t);if(i.startsWith("YT")&&!f.startsWith("https://www.youtube.com/embed/")){_j.e.b(_a.a.e,"Player url {0} is invalid",f);return null}return this.bQ(f)},cs:function(n,t){t===1;var i=_a.bl.b(n);i=this.J(i,"//+","-");i=this.J(i,"/",":");i=this.J(i,"=",".");return t===2?"LPBorder_VT"+i:t===3?"LPBorder_BVT"+i:"LPBorder_YT"+i},cB:function(n){var t=n.split("_");var i;if(t[0]!=="LPBorder"){_j.e.b(_a.a.e,"BorderId {0} is not video",n);return 0}else if(t.length===2||t.length===3){i=t[1];return i.startsWith("VT")?2:i.startsWith("BVT")?3:1}else{_j.e.b(_a.a.e,"BorderId {0} has wrong number of segments",n);return 0}},J:function(n,t,i){var r=new RegExp(t,"g");return n.replace(r,i)},bQ:function(n){this.bk||(n=n.replace("autoplay=1","autoplay=0"));return n},bK:function(n){var r=n.target;var i;var t;var o,s,h;if(h=this.X(r.src,"",o={val:t},s={val:i}),t=o.val,i=s.val,h){if(i<=0||t<=0){_j.e.b(_a.a.e,"Image dimension was invalid for src {0}, height {1}, width {2)",r.src,i,t);return}_j.e.a(_a.a.e,"Loading image for src {0}, height {1}, width {2)",r.src,i,t);var u=!1;var f=!1;if(r.parentNode&&r.parentNode.parentNode){u=_b.g.a(r.parentNode.parentNode.id,"LPBestFitImageContainer");f=_b.g.a(r.parentNode.parentNode.id,"LPImageAlbumContainer")}if(!u&&!f){if(t>i){if(t>250){i=Math.floor(i*250/t);t=250}}else if(i>t){if(i>250){t=Math.floor(t*250/i);i=250}}else if(t>250){t=250;i=250}r.width=t;r.height=i;r.style.width=t.toString()+"px";r.style.height=i.toString()+"px"}var e=_lp.b.i(r);if(e){var c=_b.g.b(e);this.bs(c,!0)}}},bI:function(n){var i=null;var t=$(n).find("a[id^='LPUrlAnchor']");t&&t.length===1&&(i=t[0]);return i},cu:function(n){var t=this.bH(n);if(!t||!t.length){_j.e.b(_a.a.e,"FindImageAnchor: no image anchors found under ancestor "+n.toString());return null}t.length>1&&_j.e.b(_a.a.e,"FindImageAnchor: more than one anchor found under ancestor "+n.toString()+". Returning the first.");return t[0]},bH:function(n){var i=null;var t=$(n).find("a[id^='LPImageAnchor']");t.length>0&&(i=t.toArray());return i},ct:function(n){return this.bi("div[id^='LPDescription']",n)},cw:function(n){return this.bi("div[id^='LPTitle']",n)},cv:function(n){return this.bi("a[id^='LPImageAnchor'] img",n)},bi:function(n,t){var r=null;var i=$(t).find(n);i.length===1&&i[0]&&(r=i[0]);return r},y:function(n,t){var i=this.w(t);n&&(i.innerHTML=n);return i},E:function(n,t){var i=this.w(t);i.href=n;i.target="_blank";this.bq(i);return i},cm:function(n){var t=window.document.createElement("a");t.href=n;t.target="_blank";this.bq(t);return t},w:function(n){var t;var i;switch(n){case 1:t="LPContainer";i="table";break;case 2:t="LPImageContainer";i="div";break;case 11:t="LPBestFitImageContainer";i="div";break;case 12:t="LPImageAlbumContainer";i="div";break;case 3:case 16:case 15:t="LPImageAnchor";i="a";break;case 5:t="LPTitle";i="div";break;case 6:t="LPDescription";i="div";break;case 7:t="LPUrlAnchor";i="a";break;case 4:case 13:case 14:t=null;i="img";break;case 8:t="LPPlayButtonContainer";i="div";break;case 9:t=null;i="span";break;case 17:t=null;i="video";break;case 18:t=null;i="source";break;case 19:t=null;i="button";break;case 20:t="LPMetadata";i="div";break;case 21:t="LPRemovePreviewContainer";i="div";break;case 22:t="LPExpandDescriptionContainer";i="div";break;case 23:t="LPOptionsContainer";i="div";break;default:throw Error.notImplemented("Type not implemented for "+n);}var r=window.document.createElement(i);t&&(r.id=_lp.b.a(t));this.B(r,n);return r},z:function(n,t){var i=document.createElement("SPAN");i.style.display="none";document.body.appendChild(i);var e=$(i);e.attr("class",n);for(var o="",f=t,s=f.length,r=0;r<s;++r){var u=f[r];o+=String.format("{0}: {1};",u,e.css(u))}document.body.removeChild(i);return o},B:function(n,t){switch(t){case 10:n.style.marginBottom="20px";n.style.overflow="auto";n.style.display="";n.style.width="100%";n.style.textIndent="0px";break;case 1:n.style.width="90%";n.style.backgroundColor="#FFFFFF";n.style.position="relative";n.style.overflow="auto";n.style.paddingTop="20px";n.style.paddingBottom="20px";n.style.marginTop="20px";n.style.borderTopWidth="1px";n.style.borderTopStyle="dotted";n.style.cssText+=this.z("ms-border-color-neutralTertiaryAlt",["border-top-color"]);n.style.borderBottom=n.style.borderTop;break;case 2:n.style.backgroundColor="#FFFFFF";n.style.height="auto";n.style.position="relative";n.style.margin="auto";n.style.display="table";break;case 12:n.style.marginTop="10px";n.style.backgroundColor="#FFFFFF";n.style.height="auto";n.style.position="relative";break;case 11:n.style.marginTop="2px";n.style.backgroundColor="#FFFFFF";n.style.height="auto";n.style.width="auto";n.style.position="relative";n.style.display="table";break;case 3:case 15:n.style.display="table-cell";n.style.textAlign="center";break;case 16:n.style.display="inline-block";n.style.textAlign="center";n.style.width="90px";n.style.height="90px";n.style.verticalAlign="middle";n.style.overflow="hidden";n.style.margin="5px";n.style.backgroundColor="#DADADA";break;case 14:n.style.display="inline-block";n.style.width="90px";n.style.height="90px";n.style.borderWidth="0px";n.setAttribute("aria-label",_u.n.Kl);break;case 4:case 17:n.style.display="inline-block";n.style.maxWidth="250px";n.style.maxHeight="250px";n.style.height="auto";n.style.width="auto";n.style.borderWidth="0px";n.setAttribute("aria-label",_u.n.Kl);n.style.verticalAlign="bottom";break;case 13:n.style.display="inline-block";n.style.marginLeft="auto";n.style.marginRight="auto";n.style.height="auto";n.style.width="auto";n.style.maxWidth="100%";n.style.borderWidth="0px";n.setAttribute("aria-label",_u.n.Kl);break;case 5:n.style.top="0px";n.style.cssText+=this.z("ms-font-xl ms-font-weight-light ms-font-color-themePrimary",["color","font-weight","font-size","font-family"]);n.style.lineHeight=n.style.fontSize;break;case 6:n.style.display="block";n.style.cssText+=this.z("ms-font-m ms-font-color-neutralSecondary",["color","font-weight","font-family"]);n.style.fontSize=14+"px";n.style.lineHeight=20+"px";n.style.maxHeight=100+"px";n.style.overflow="hidden";break;case 7:n.style.textDecoration="none";break;case 8:n.style.top="50%";n.style.marginTop="-20px";n.style.position="absolute";n.style.left="0px";n.style.right="0px";n.style.marginLeft="auto";n.style.marginRight="auto";break;case 9:n.className=_lp.c.c().b;n.style.color="#FFFFFF";break;case 18:break;case 19:n.style.position="absolute";n.style.right="0px";n.style.bottom="0px";n.style.width="30px";n.style.height="30px";n.style.border="0";n.style.cursor="pointer";n.style.backgroundColor="rgba(0, 0, 0, 0.56)";n.style.cssText+=this.z("ms-font-color-neutralLight",["color"]);break;case 20:n.style.margin="10px 0px 16px 0px";n.style.cssText+=this.z("ms-font-m ms-font-color-neutralSecondary",["color","font-weight","font-family"]);n.style.fontSize=14+"px";n.style.lineHeight=n.style.fontSize;break;case 21:case 22:case 23:n.style.styleFloat="right";break;default:throw Error.notImplemented("Style settings not implemented for "+t);}},bT:function(n){n.setAttribute("valign","top")},K:function(n,t,i,r,u){u.val=n.parentNode;if(!this.bl(u.val,i)){_j.e.a(_a.a.e,r+" for {0}",t.href);u.val=null}return!!u.val},f:function(n,t,i,r,u,f,e){_j.e.a(_a.a.e,"Adding link preview for {0}",n.Url);this.l(t);if(this.bO(n)&&this.x){var l=this.bj(n,!0);l=this.bV(l);var a=new _lp.k(l);this.T(n)&&(a.b=n.MotionThumbnailUrl);this.x[n.Url]=a}if(n.__type===_g.cq._dataContractName&&this.x){var o=n;if(o.Photos)for(var s=0;s<o.Photos.length;s++){var p=o.Photos[s];this.x[p.PhotoPageUrl]=new _lp.j(o.Photos,s)}if(this.cM(i,n.Id))return}if(_b.g.m(n))this.cR(n,i);else{var v=$(i).find("#"+n.Id);if(!v.is("a")){_j.e.b(_a.a.e,"Anchor for preview {0} not found",n.Url);return}var h=this.bG(n,u,f);if(!h)return;var c=v[0];c.id=this.cj(c.id,n);r&&(h=r(h));var y=!r;this.cD(c,h,y)}e&&e.a(_a.bO,new _a.bO("LP"))},cj:function(n,t){var i=this.A[t.Url];if(i&&i.r){var r=i.B("doclink");n.indexOf(r)<0&&(n+=r)}return n},cM:function(n,t){var v=$(n).find("#"+t.replace(".","\\."));if(!v.is("a"))return!1;var k=v[0];var a=null;var l=null;var y=null;var b=null;var w=null;var p=null;var i=null;var e,r,u,h,f,o,s,c;if(!(c=this.P(k,e={val:a},r={val:l},u={val:y},h={val:b},f={val:w},o={val:p},s={val:i}),a=e.val,l=r.val,y=u.val,b=h.val,w=f.val,p=o.val,i=s.val,c))return!1;i&&i.parentNode.removeChild(i);return!0},l:function(n){if(this.G&&this.G.d.length>0){var t=this.cx(this.G);t&&n(t)}},o:function(n){var t=this.cG(n);this.bD(t)},bD:function(n){this.G||(this.G=new _j.q);for(var t=0;t<this.G.d.length;t++)if(this.G.d[t].Url===n.Url)return;if(!this.G.g(n)){_j.e.a(_a.a.e,"Adding GetLinkPreview request for "+n.Url+" to request queue.");this.G.c(n)}},cG:function(n){var t=null;t=new _g.cS;t.Id="UpdateOEmbed__"+n.id;t.Url=n.href;return t},cF:function(n){var t=null;t=new _g.cS;t.Id=n.id;t.Url=n.href;return t},cx:function(n){if(!n||!n.d.length)return null;var t=n.d[0];n.i(0);t.RequestStartTimeMilliseconds=_a.c.a().h();return t},cR:function(n,t){var f=n.Id.split("__")[1];var r=this.bj(n,!0);if(r){if(this.x){r=this.bV(r);var k=new _lp.k(r);this.T(n)&&(k.b=n.MotionThumbnailUrl);this.x[n.Url]=k}f=f.replace(".","\\.");var rt=$(t).find("#"+f);var d=rt[0];if(d){var u=null;var w=null;var b=null;var tt=null;var i=null;var it=null;var g=null;var nt,p,s,h,o,e,v,y;if(!(y=this.P(d,nt={val:u},p={val:w},s={val:b},h={val:tt},o={val:i},e={val:it},v={val:g}),u=nt.val,w=p.val,b=s.val,tt=h.val,i=o.val,it=e.val,g=v.val,y))return;var c=!1;var l;this.p(u,l={val:c}),c=l.val;i.style.position="relative";if(this.T(n)){var a=$(i).find("a[id^='LPImageAnchor']")[0];a.style.textDecoration="none";this.bh(n.MotionThumbnailUrl,i,a)}}}},cD:function(n,t,i){_j.e.a(_a.a.e,"Inserting link preview for {0}",n.href);var f=this.cP(n);if(f){_j.e.a(_a.a.e,"Inserting before new line element {0}",f);n.parentNode.insertBefore(t,f)}else{var r=n.parentNode;if(!r.parentNode){_j.e.b(_a.a.e,"Could not insert link preview because of undefined parent node of link parent node {0}",r);return}if(r.nextSibling){_j.e.a(_a.a.e,"Inserting before link parent node next sibling {0}",r.nextSibling);r.parentNode.insertBefore(t,r.nextSibling)}else{_j.e.a(_a.a.e,"Appending to child to link parent node {0}",r);r.parentNode.appendChild(t)}}if(i){var u=t.nextSibling;if(u&&u.tagName&&u.tagName.toLowerCase()==="br"){_j.e.a(_a.a.e,"Removing preview next sibling which is a br tag");t.parentNode.removeChild(u)}}else if(!_a.k.a().H){var e=document.createElement("br");t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e)}},cP:function(n){for(var i=null,t=n.nextSibling;t;){if(t.tagName)switch(t.tagName.toLowerCase()){case"div":case"br":case"p":i=t;break}t=i?null:t.nextSibling}return i},bn:function(){return!1},g:function(n){if(n in this.x){var t=this.x[n];if(t.a===1)return t.c}return null},k:function(n){if(n in this.x){var t=this.x[n];if(t.a===2)return!0}return!1},j:function(n,t,i){t.val=null;i.val=-1;var r=this.x[n];if(r.a===2){t.val=r.c;i.val=r.b;return!0}return!1},bO:function(n){return this.bj(n,!1)?!0:!1},bj:function(n,t){var i=null;n.__type===_gg.bj._dataContractName?i=n.EmbeddedHtml:n.__type===_g.cD._dataContractName&&(i=n.EmbeddedHtml);if(t&&i){var u=$("<div>");u.html(i);var r=u.find("iframe");if(r.length>0){r[0].setAttribute("width",480+"px");r[0].setAttribute("height",385+"px")}i=u.html()}return i},t:function(n,t,i){_j.e.a(_a.a.e,"SubmitGetSharingInfoAction");if(this.R&&this.bm&&n&&n.a()&&!_j.i.a(n.a().a())){var u=new _db.J(n.a().a());var r=this;this.R.a(u,function(u){r.cz(u,n,t,i)},this.bw,null)}},cz:function(n,t,i,r){_j.e.a(_a.a.e,"GetSharingInfoSucceeded");if(_db.J.isInstanceOfType(n)){var e=n;var f=e.g;if(f){var u=t.a();u.l(f.CanShareInternally);u.j(f.CanCreateOrganizationEditLink);u.k(f.CanCreateOrganizationViewLink);if(u.b()){switch(t.i()){case 1:t.c(2);break;case 3:t.c(u.d()?6:0);break;case 2:t.c(u.e()?5:0);break}f.IsOrganizationEditLinkAvailable&&u.h(f.OrganizationEditLink);f.IsOrganizationViewLinkAvailable&&u.i(f.OrganizationViewLink);u.c(e.c.attachmentUrl)}else t.c(0);t.o(u);r&&r(_b.g.b(i))}}},cy:function(n){_j.e.a(_a.a.e,"GetSharingInfoFailed")},c:function(n,t,i,r,u){},T:function(n){return this.F.a().ea().Enabled&&this.O&&_lp.b.n()&&n.__type===_gg.bj._dataContractName&&!_j.i.a(n.MotionThumbnailUrl)},bh:function(n,t,i){var o=$(i);var u=o.find("video");var r=null;if(u.length>0){r=u[0];this.B(r,17)}else{r=this.w(17);u=$(r);i.appendChild(r)}u.hide();var e=u.find("source");var f=null;if(e.length>0){f=e[0];this.B(r,18)}else{f=this.w(18);e=$(f);f.setAttribute("Src",n);r.appendChild(f)}e.bind("error",this.by);u.bind("loadedmetadata",this.bz);r.muted=!1;this.bE(t,r);t.style.display=""},n:function(n){var r=$(n);var i=r.find("div[id^='LPImageContainer']");var t=r.find("a[id^='LPImageAnchor'] video");this.bg([i,t])&&this.bE(i[0],t[0])},cN:function(n){var i=n.find("div[id^='LPImageContainer']");var t=i.find("button");if(t.length>0){t.unbind("click",this.bd);t.unbind("mouseenter",this.be);t.unbind("mouseleave",this.bf);t.remove()}},cV:function(n){var r=n.currentTarget;if(r.tagName.toLowerCase()==="video"){var o=r.videoWidth;var e=r.videoHeight;_j.e.a(_a.a.e,"VideoMetadataLoad video original dimensions: "+o+","+e);if(Number.isInstanceOfType(o)&&Number.isInstanceOfType(e)){var t=$(r.parentNode).find("img");if(!t.length){_lp.e.a().i(r);return}var f=t[0];var c=f.src;var a=o;var l=e;var i=250;var u=Math.round(l*i/a);if(f.width!==i||f.height!==u){var v=_lp.b.g(c,i,u);t.bind("load",this.D);_lp.b.d(f,v,c,"LinkPreviewBuilder.VideoMetadataLoad")||t.unbind("load",this.D)}var s=$(r);s.width(i);s.height(u);t.width(i);t.height(u);var h=t.parents("div[id^='LPImageContainer']");t&&i>h.width()&&h.width(i);s.click(this.bx)}}},bt:function(n,t){n.muted=_lp.b.b;if(_lp.b.b){t.removeClass(_lp.b.f);t.addClass(_lp.b.e)}else{t.removeClass(_lp.b.e);t.addClass(_lp.b.f)}},cT:function(n){if(n.target){_j.e.a(_a.a.e,"VideoContainerMouseEnterHandler target: "+n.target);var e=$(n.target);var a=e[0].id.startsWith("LPImageContainer")?e:e.parents("div[id^='LPImageContainer']");var i;var t;var u;var r;var c,l,h,s;this.bJ(a,c={val:i},l={val:t},h={val:u},s={val:r}),i=c.val,t=l.val,u=h.val,r=s.val;if(!i.length&&t.length>0){t.removeClass(_lp.c.c().b);t.addClass(_lp.c.d().b)}else if(this.bg([i,u,t,r])){var f=i[0];var o=f.networkState;if(Number.isInstanceOfType(o)&&o!==1){_lp.e.a().l(f,o);_j.e.b(_a.a.e,"VideoContainerMouseEnterHandler: The network state is invalid.")}else{this.bt(f,r);u.hide();i.show();f.currentTime=0;i.trigger("play");r.show();t.hide()}}else _j.e.b(_a.a.e,"VideoContainerMouseEnterHandler: Did not know how to process target "+n.target)}},cU:function(n){this.bP(n,!0)},cH:function(n){_lp.e.a().e=!0;this.bP(n,!1)},cI:function(n){var t=$(n.target).parents("video");t.length>0&&_lp.e.a().k(t[0]);_j.e.c(_a.a.e,"MotionThumbnailErrorHandler: An error occurred.")},cJ:function(n){if(n.target&&n.target.tagName.toLowerCase()==="button"){var t=n.target;var u=$(t);var r=$(t.parentNode).find("video");var i=r[0];_lp.b.b=!_lp.b.b;this.bt(i,u);_lp.e.a().m()}},cK:function(n){if(n.target&&n.target.tagName.toLowerCase()==="button"){var t=n.target;t.style.backgroundColor="rgba(0, 0, 0, 0.9)";t.style.cssText+=this.z("ms-font-color-white",["color"])}},cL:function(n){if(n.target&&n.target.tagName.toLowerCase()==="button"){var t=n.target;t.style.backgroundColor="rgba(0, 0, 0, 0.56)";t.style.cssText+=this.z("ms-font-color-neutralLight",["color"])}},bE:function(n,t){var f=$(n);var i=f.find("button");var r=null;if(i.length>0){r=i[0];this.B(r,19)}else{r=this.w(19);i=$(r);n.appendChild(r)}i.unbind("click").click(this.bd);i.mouseenter(this.be);i.mouseleave(this.bf);this.bt(t,i);var u=t.paused;Boolean.isInstanceOfType(u)&&u&&i.hide()},bP:function(n,t){if(n.target){_j.e.a(_a.a.e,"PauseVideo target: "+n.target);var e=$(n.target);var a=e[0].id.startsWith("LPImageContainer")?e:e.parents("div[id^='LPImageContainer']");var i;var r;var f;var u;var l,c,o,s;this.bJ(a,l={val:i},c={val:r},o={val:f},s={val:u}),i=l.val,r=c.val,f=o.val,u=s.val;if(!i.length&&r.length>0){r.removeClass(_lp.c.d().b);r.addClass(_lp.c.c().b)}else if(this.bg([i,f,r,u])){i.trigger("pause");u.hide();r.show();i.hide();f.show();var h=i[0];t&&_lp.e.a().h(h,this.bn());h.currentTime=0}else _j.e.b(_a.a.e,"PauseVideo: Did not know how to process target "+n.target)}},bJ:function(n,t,i,r,u){t.val=n.find("a[id^='LPImageAnchor'] video");i.val=n.find("div[id^='LPPlayButtonContainer'] span");r.val=n.find("a[id^='LPImageAnchor'] img");u.val=n.find("button")},bg:function(n){for(var r=n,u=r.length,t=0;t<u;++t){var i=r[t];if(!i||!i.length)return!1}return!0}};_lp.l=function(){};_lp.l.prototype={a:function(n,t,i,r,u,f){return _lp.b.m(n,t,i,r,u,f)},b:function(n,t,i,r,u,f){var e=null;switch(u.a()){case"TouchNarrow":e=new _lp.n(n,t,i,r,u,f);break;default:e=new _lp.h(n,t,i,r,u,f);break}return e},c:function(n,t,i){return new _lp.d(n,t,i)}};function LinkPreviewComponent(){}LinkPreviewComponent.$$cctor=function(){_a.u.a().a(LinkPreviewComponent)};LinkPreviewComponent.prototype={a:function(n,t,i){n.e(_lp.l).b(ILinkPreviewBuilderFactory)},b:function(){return null}};_lp.i=function(n){this.z=[];this.y=n.Url;this.r=n.__type===_gg.bQ._dataContractName;if(this.r){var t=n;switch(t.DataProviderType){case 32:this.s=0;break}this.x=t.LinkType;this.a().c(encodeURI(t.LinkingUrl))}};_lp.i.a=function(n,t,i){t.val=n;i.val="";var r;var u;if((r=t.val.indexOf("["))>-1&&(u=t.val.indexOf("]"))>r){i.val=t.val.substring(r+1,u);t.val=t.val.substring(0,r)+t.val.substring(u+1,t.val.length)}};_lp.i.prototype={w:null,t:null,b:function(){return this.t},c:function(n){this.t=n;return n},v:!1,h:function(){return this.v},n:function(n){this.v=n;return n},r:!1,d:function(){return this.r},s:null,f:function(){return this.s},a:function(){this.w||(this.w=new _lp.p);return this.w},o:function(n){this.w=n;return n},x:0,i:function(){return this.x},g:function(){return this.r&&this.s!=null&&!this.s?_nbs.a.aS:null},y:null,j:function(){return this.y},e:function(n){Array.add(this.z,n)},p:function(n,t){if(this.r){var i=this;Array.forEach(this.z,function(i){var u=i;var f=$(n).find(String.format("[id^='{0}']",u));var r=f.find(String.format("[id^='{0}']","LPMetadata"));r.length>0&&r.text(t)})}},q:function(n){_j.i.a(this.g())||this.p(n,String.format(_nbs.a.Ms,this.g()))},m:function(){var n=new Sys.StringBuilder;if(this.r){n.append(this.u(2,"doclink"));this.s!=null&&n.append(this.u(3,(this.s==null?0:this.s).toString()));this.t!=null&&n.append(this.u(4,(this.t==null?0:this.t).toString()));this.v&&n.append(this.u(5,"1"));if(!_j.i.a(this.a().a())){var t=this.a().a();if(t.startsWith("https://")){t=t.slice(8);n.append(this.u(6,t))}}}return n.isEmpty()?"":"["+n+"]"},A:function(n){for(var o=n.split("|"),u=o,s=u.length,r=0;r<s;++r){var e=u[r];var i=e.split(":");if(i.length===2){var f=i[0];var t=i[1];switch(Number.parseInvariant(f)){case 1:break;case 2:this.r=t==="doclink";break;case 3:this.s=Number.parseInvariant(t);break;case 4:this.t=Number.parseInvariant(t);break;case 5:this.v=!!Number.parseInvariant(t);break;case 6:this.a().c("https://"+t);break}}}},k:function(n){return this.C(n,1)},l:function(n){return this.u(1,n)},B:function(n){return this.u(2,n)},u:function(n,t){return"|"+n+":"+t},C:function(n,t){for(var o=n.split("|"),u=o,f=u.length,i=0;i<f;++i){var e=u[i];var r=e.split(":");if(r.length===2&&r[0]===t.toString())return r[1]}return""}};_lp.q=function(n){this.a=n};_lp.q.prototype={a:0};_lp.m=function(){_lp.m.initializeBase(this,[3])};_lp.j=function(n,t){_lp.j.initializeBase(this,[2]);this.c=n;this.b=t};_lp.j.prototype={c:null,b:0};_lp.k=function(n){_lp.k.initializeBase(this,[1]);this.c=n;this.b=null};_lp.k.prototype={c:null,b:null};_lp.d=function(n,t,i){this.r=Function.createDelegate(this,this.y);this.s=Function.createDelegate(this,this.C);this.q=Function.createDelegate(this,this.x);this.t=Function.createDelegate(this,this.J);this.v=Function.createDelegate(this,this.K);_lp.d.initializeBase(this);this.a=i;if(!_j.i.a(n)){this.l=n;this.D(t);if(!this.b||!this.b.x.length)return;if(this.a in _lp.d.a){switch(_lp.d.a[this.a]){case 0:this.w(!1);break;case 1:this.f(!1);break}this.e=!0}this.o=new _j.g(this.v,_a.a.G);this.n=new _j.g(this.t,_a.a.G);this.j=new _j.g(this.q,_a.a.G);this.p=new _j.g(this.s,_a.a.G)}};_lp.d.prototype={l:null,a:null,d:null,b:null,o:null,n:null,j:null,p:null,h:!0,i:!0,g:!0,c:!1,e:!1,F:function(n){if(this.d!==n){this.d=n;this.et("RatingBarViewModel")}return n},G:function(n){if(this.b!==n){this.b=n;this.et("Snippets")}return n},w:function(n){if(this.h!==n){this.h=n;this.et("ShowFeedbackOptions")}return n},f:function(n){if(this.i!==n){this.i=n;this.et("ShowLikeDislikeOptions")}return n},m:function(n){if(this.g!==n){this.g=n;this.et("ShowAddCommentButton")}return n},E:function(n){if(this.c!==n){this.c=n;this.et("MinimizeSummary")}return n},eM:function(){this.e||this.k(null);this.A()},D:function(n){var t=null;var e=JsonParser.deserialize(n);if(e&&e.length>0)for(var s=e,c=s.length,f=0;f<c;++f){var h=s[f];var i=h.entities;if(i){for(var r=0;r<i.length;r++){var u=i[r];if(u&&u["@type"]==="EmailMessageMetadata"){var o=u.summary;_j.i.a(o)||(t=o.split("\n"));break}}if(t)break}}t&&this.I(t)},I:function(n){if(n&&n.length>0){this.G(new(_ff.w.$$(String)));for(var i=n,u=i.length,t=0;t<u;++t){var r=i[t];this.b.a(r)}}},K:function(){this.m(!1);this.f(!1);_lp.d.a[this.a]=0;this.k(!0)},J:function(){this.m(!0);this.f(!1);_lp.d.a[this.a]=1;this.k(!1)},x:function(){this.d||this.F(new _lp.f(this.a,this.r));this.d.d(!0)},C:function(){var n=this.a in _lp.d.a&&!_lp.d.a[this.a];this.w(!this.c&&!n)},y:function(n,t){this.f(!1);this.m(!1);_lp.d.a[this.a]=0;this.z(n,t)},k:function(n){if(this.b){var r=_a.d.b(_a.a.G,"EmailSummarizationAction");var t=new _a.o;var i=0;var u=this;this.b.p(function(n){i+=n.toString().length});t.b("TYPE","General");t.b("IM",this.a);t.a("SSC",this.b.x.length);t.a("SCC",i);t.a("MCC",this.l.length);n!=null&&t.c("L",n);r.j=t.toString();_a.d.a(r);this.e=!0}},z:function(n,t){var r=_a.d.b(_a.a.G,"EmailSummarizationAction");var i=new _a.o;i.b("TYPE","Feedback");i.b("IM",this.a);_j.i.a(n)||i.b("F",n);t>0&&i.a("R",t);r.j=i.toString();_a.d.a(r)},A:function(){var t=_a.d.b(_a.a.G,"EmailSummarizationAction");var n=new _a.o;n.b("TYPE","ExpandedState");n.b("IM",this.a);n.c("SM",this.c);t.j=n.toString();_a.d.a(t)}};_lp.e=function(){this.f=0;this.g=0;this.e=!1;this.a=new _a.o;this.b=_a.d.b(_a.a.e,"LinkPreviewMotionThumbnail")};_lp.e.a=function(){_lp.e.b||(_lp.e.b=new _lp.e);return _lp.e.b};_lp.e.prototype={b:null,a:null,f:0,g:0,e:!1,m:function(){_lp.b.b?this.f+=1:this.g+=1},h:function(n,t){var r;var i;var f,u;this.d(n,f={val:r},u={val:i}),r=f.val,i=u.val;var s=t?"R":"C";var o=_lp.b.b?"M":"UM";var e=this.e?"Y":"N";this.a.b("P",s);this.a.b("U",r);this.a.b("S",i);this.a.a("M",this.f);this.a.a("UM",this.g);this.a.b("FS",o);this.a.b("C",e);this.a.b("TS",n.currentTime.toString());this.a.b("TT",n.duration.toString());this.c()},i:function(n){var i;var t;var u,r;this.d(n,u={val:i},r={val:t}),i=u.val,t=r.val;this.a.b("U",i);this.a.b("S",t);this.b.k="ImageLoadError";this.b.m="The image failed to load, so the video was not loaded";this.c()},k:function(n){var i;var t;var u,r;this.d(n,u={val:i},r={val:t}),i=u.val,t=r.val;this.a.b("U",i);this.a.b("S",t);this.b.k="VideoLoadError";this.b.m="The video failed to load";this.c()},j:function(){this.b.k="VideoElementUnplayableError";this.b.m="Cannot play the video DOM element";this.c()},l:function(n,t){var u;var r;var f,e;this.d(n,f={val:u},e={val:r}),u=f.val,r=e.val;var i;switch(t){case 0:i="The element has not yet been initialized";break;case 1:i="The element's resource selection algorithm is active and has selected a resource, but it is not actually using the network at this time";break;case 2:i="The user agent is actively trying to download data";break;case 3:i="The element's resource selection algorithm is active, but it has not yet found a resource to use";break;default:i="The video cannot be played due to a network error";break}this.a.b("U",u);this.a.b("S",r);this.b.k="VideoNetworkError";this.b.m=i;this.c()},c:function(){this.b.j=this.a.toString();_a.d.a(this.b);_lp.e.b=null},d:function(n,t,i){var r=$(n);var f=r.find("source");var u=r.parents("a[id^='LPImageAnchor']");t.val=_db.h.b(u,"href",100);i.val=_db.h.b(f,"src",100)}};_lp.n=function(n,t,i,r,u,f){_lp.n.initializeBase(this,[n,t,i,r,u,f])};_lp.n.prototype={br:function(n,t){t.val=null;var f=null;var e=null;var c=null;var r=null;var u=0;var i=null;i=_b.g.b(n);if(!i)return!1;f=this.cw(i);if(!f)return!1;e=this.ct(i);if(!e)return!1;var l=this.cv(i);l&&(c=l.src);var h,o,s;!_b.g.a(i.id,"LPBorder_YT")&&!_b.g.a(i.id,"LPBorder_VT")||(s=this.Y(i,h={val:r},o={val:u}),r=h.val,u=o.val,s)||_j.e.b(_a.a.e,"Can't get playerUrl for {0}",n.href);t.val=new _b.bO(i,f,e,null,c,r,u);return!0},bL:function(n,t,i){return n.__type===_g.cq._dataContractName?this.cY(n):this.cZ(n)},cZ:function(n){var t=this.w(10);(n.ImageUrl||n.__type===_gg.bQ._dataContractName&&n.PreviewImageInBase64)&&this.cW(n,t);if(n.Title){var r=this.y(null,5);var i=this.E(n.Url,7);i.innerHTML=n.Title;r.appendChild(i);t.appendChild(r)}if(n.Url){var e=new _a.T(n.Url);var f=this.y(e.a,20);t.appendChild(f)}if(n.Description){var u=this.y(n.Description,6);t.appendChild(u)}return t},cY:function(n){var t=this.w(10);var u=n;if(n.Title){var r=this.y(null,5);var i=this.E(n.Url,7);i.textContent=n.Title;r.appendChild(i);t.appendChild(r)}if(n.Description){var f=this.y(n.Description,6);t.appendChild(f)}u.Photos&&this.cX(n,u.Photos,t);return t},cW:function(n,t){_j.e.a(_a.a.e,"Adding image for {0}",n.Url);var i=this.w(4);$(i).bind("load",this.D);var f=n.__type===_gg.bQ._dataContractName&&n.PreviewImageInBase64?n.PreviewImageInBase64:n.ImageUrl;if(!_lp.b.d(i,f,n.Url,"NarrowReadingPanePreviewBuilder.AddImage")){$(i).unbind("load",this.D);return}var u=this.E(n.Url,3);u.appendChild(i);var r=this.w(2);r.appendChild(u);r.style.display="none";t.appendChild(r)},cX:function(n,t,i){_j.e.a(_a.a.e,"Adding images for {0}",n.Url);var e=this.w(t.length===1?11:12);e.style.display="none";for(var o=t,h=o.length,f=0;f<h;++f){var s=o[f];var r=null;var u=null;if(t.length===1){r=this.w(13);$(r).bind("load",this.D);r.src=s.ImageUrl;u=this.E(n.Url,15)}else{r=this.w(14);$(r).bind("load",this.D);r.src=s.ThumbnailUrl;u=this.E(n.Url,16)}u.appendChild(r);e.appendChild(u)}i.appendChild(e)},bK:function(n){var t=n.target;var r;var i;var o,f,e;if(e=this.X(t.src,"",o={val:i},f={val:r}),i=o.val,r=f.val,e){if(r<=0||i<=0){_j.e.b(_a.a.e,"Image dimension was invalid for src {0}, height {1}, width {2)",t.src,r,i);return}_j.e.a(_a.a.e,"Loading image for src {0}, height {1}, width {2)",t.src,r,i);var u=t.parentNode.parentNode;u.style.display="block";_b.g.a(u.id,"LPImageAlbumContainer")||(u.style.width=$(t).css("width"));u.style.height=$(t).css("height")}},w:function(n){var t;var i;switch(n){case 10:t="LPBorder";i="div";break;case 2:t="LPImageContainer";i="div";break;case 11:t="LPBestFitImageContainer";i="div";break;case 12:t="LPImageAlbumContainer";i="div";break;case 3:case 16:case 15:t="LPImageAnchor";i="a";break;case 4:case 13:case 14:t=null;i="img";break;case 5:t="LPTitle";i="div";break;case 6:t="LPDescription";i="div";break;case 7:t="LPUrlAnchor";i="a";break;case 17:t=null;i="video";break;case 18:t=null;i="source";break;case 19:t=null;i="button";break;case 20:t="LPMetadata";i="div";break;default:throw Error.notImplemented("Type not implemented for "+n);}var r=window.document.createElement(i);t&&(r.id=_lp.b.a(t));this.da(r,n);return r},da:function(n,t){switch(t){case 10:n.style.borderTopColor="#CCCCCC";n.style.borderTopWidth="1px";n.style.borderTopStyle="dotted";n.style.borderBottom=n.style.borderTop;n.style.width="95%";n.style.marginTop="20px";n.style.marginBottom="20px";n.style.backgroundColor="#FFFFFF";n.style.padding="20px 0 20px 0";break;case 2:n.style.backgroundColor="#FFFFFF";n.style.maxWidth="95%";n.style.width="250px";n.style.height="140px";n.style.position="relative";n.style.display="block";n.style.margin="auto";break;case 11:n.style.backgroundColor="#FFFFFF";n.style.position="relative";n.style.marginTop="20px";break;case 12:n.style.backgroundColor="#FFFFFF";n.style.position="relative";n.style.marginTop="20px";n.style.width="auto";n.style.overflow="hidden";break;case 3:case 15:break;case 16:n.style.display="table-cell";break;case 4:case 17:n.style.display="block";n.style.margin="auto";n.style.maxWidth="250px";n.style.maxHeight="140px";break;case 14:n.style.maxHeight="140px";n.style.borderWidth="0px";break;case 13:n.style.display="block";n.style.marginRight="auto";n.style.marginLeft="auto";n.style.maxWidth="250px";n.style.height="auto";n.style.borderWidth="0px";break;case 5:n.style.marginTop="10px";n.style.cssText+=this.z("ms-font-xl ms-font-weight-light ms-font-color-themePrimary",["color","font-weight","font-size","font-family"]);n.style.lineHeight=n.style.fontSize;break;case 7:n.style.textDecoration="none";break;default:this.B(n,t);break}}};_lp.f=function(n,t){this.j=Function.createDelegate(this,this.p);this.k=Function.createDelegate(this,this.q);this.n=Function.createDelegate(this,this.t);this.m=Function.createDelegate(this,this.s);this.l=Function.createDelegate(this,this.r);this.b=new(_ff.w.$$(_lp.g));_lp.f.initializeBase(this);this.o=n;this.f=t;for(var i=1;i<=5;i++)this.b.a(new _lp.g(i,this.l,this.m,this.n));this.h=new _j.g(this.k,_a.a.G);this.g=new _j.g(this.j,_a.a.G)};_lp.f.prototype={o:null,f:null,h:null,g:null,e:!1,a:null,c:null,d:function(n){if(this.e!==n){this.e=n;this.et("ShowRatingView")}return n},i:function(n,t){for(var i=0;i<this.b.x.length;i++){var r=this.b.x[i];r.f(!t&&i<n)}},s:function(n){this.i(n,!1)},t:function(n){this.a?this.i(this.a.a,!1):this.i(n,!0)},r:function(n){this.a=this.b.x[n-1]},q:function(){this.d(!1);if(!_j.i.a(this.c)||this.a){var n=this.a?this.a.a:-1;this.f(this.c,n)}},p:function(){this.d(!1)}};_lp.o=function(n){_lp.o.initializeBase(this,[n])};_lp.o.prototype={b:!1,a:null,bD:function(){return _j.h.prototype.bD.call(this)},cW:function(n){!n&&this.bD()&&this.a&&this.a.b&&this.a.a();_j.h.prototype.cW.call(this,n);return n},q:function(n){if(n!==this.b){this.b=n;this.w()}return n},o:function(n){if(n!==this.a){this.a=n;this.bq("HoverOutCommand")}return n},w:function(){this.Y()&&(!this.t()&&this.ca?this.bk(this.ca):this.bg&&this.cr?this.bk(this.cr):(this.bD()||this.b)&&this.cp?this.bk(this.cp):this.cj?this.bk(this.cj):this.dO())}};_lp.g=function(n,t,i,r){_lp.g.initializeBase(this);this.a=n;var e=this;this.c=new _j.g(function(){t(e.a)},_a.a.G);var f=this;this.d=new _j.g(function(){i(f.a)},_a.a.G);var u=this;this.e=new _j.g(function(){r(u.a)},_a.a.G)};_lp.g.prototype={a:0,c:null,d:null,e:null,b:!1,f:function(n){if(n!==this.b){this.b=n;this.et("IsHighlighted")}return n}};_lp.h=function(n,t,i,r,u,f){this.bW=Function.createDelegate(this,this.dn);this.bX=Function.createDelegate(this,this.dp);this.bZ=Function.createDelegate(this,this.dr);this.bY=Function.createDelegate(this,this.dq);this.cd=new _j.q;_lp.h.initializeBase(this,[null,null,r,u,f,null]);this.bb=n;this.bc=t;this.ba=i};_lp.h.prototype={bb:null,bc:null,ba:null,dt:function(n){n.setAttribute("PreviewInformation",1)},di:function(n,t,i){var f=null;var b=null;var y=null;var d=null;var u=null;var p=null;var yt=null;t.val=!1;i.val=!1;var kt=0;n=this.cb(n);var pt,ht,st,et,ct,lt,at,ot;if(!(ot=this.P(n,pt={val:f},ht={val:b},st={val:y},et={val:d},ct={val:u},lt={val:p},at={val:yt}),f=pt.val,b=ht.val,y=st.val,d=et.val,u=ct.val,p=lt.val,yt=at.val,ot))return!1;if(u){var l=this.bH(u);if(!l){_j.e.a(_a.a.e,"Image anchors not found for {0}",n.href);return!1}for(var a=null,vt=0,wt=l,dt=wt.length,v=0;v<dt;++v){var r=wt[v];if(!r){_j.e.a(_a.a.e,"Image anchor not found for {0}",n.href);return!1}var s=r.getElementsByTagName("img");var c=r.getElementsByTagName("span");if(s.length===2&&this.cE(f)){a||(a=new Array(l.length));var k;this.db(r,a,k={val:vt}),vt=k.val}else if(s.length!==1){_j.e.a(_a.a.e,"Unexpected img count {0} for {1}",s.length,n.href);return!1}var h=_b.g.a(u.id,"LPBestFitImageContainer");var g=_b.g.a(u.id,"LPImageAlbumContainer");if(c.length!==1)_j.e.a(_a.a.e,"Unexpected span count {0} for {1}",c.length,n.href);else{c[0].style.height="auto";c[0].style.width=h?"auto":"140px"}this.B(s[0],h?13:g?14:4);if(h)this.B(r,15);else if(g){this.B(r,16);kt++}else this.B(r,3);var bt=_b.g.a(u.id,"LPImageAlbumContainer");bt||h?this.B(u,12):this.B(u,2);var w=!1;var o=null;var e=0;var rt,ut,ft;if(ft=this.Y(f,rt={val:o},ut={val:e}),o=rt.val,e=ut.val,ft)if(e===1)this.N(r,o,e);else if(e===2||e===3)if(this.x&&o in this.x){var nt=this.x[o].b;if(nt){var tt=$(u).find("a[id^='LPImageAnchor']");tt.length>0&&this.bh(nt,u,tt[0])}this.N(r,o,e);w=!0}else t.val=!0;if(!w){r.setAttribute("PreviewInformation",2);this.Q(r)}}}this.df(y);this.bT(p);$(f).find("[id^='LPRemovePreviewContainer']").remove();$(f).find("[id^='LPExpandDescriptionContainer']").remove();$(f).find("[id^='LPOptionsContainer']").remove();n.setAttribute("PreviewInformation",2);this.Q(n);if(this.F.a()&&this.F.a().N().Enabled){this.m(f.id,n.href);var it=this.A[n.href];it&&it.d()&&(this.x[n.href]=new _lp.m)}_j.e.a(_a.a.e,"Finished fixing link preview markup for {0}",n.href);return!0},db:function(n,t,i){var r=new _g.dE;var e=$(n);var f=e.find(String.format("[id^='{0}']","LPThumbnailImageID"));f&&f.length>0&&(r.ThumbnailUrl=f[0].src);var u=e.find(String.format("[id^='{0}']","LPFullsizeImageID"));u&&u.length>0&&(r.ImageUrl=u[0].src);r.PhotoPageUrl=n.href;if(r.ThumbnailUrl&&r.ImageUrl){t[i.val]=r;this.x[r.PhotoPageUrl]=new _lp.j(t,i.val);i.val++}},dg:function(n){var r;var t;n=this.cb(n);var f,u;if(!(u=_lp.b.prototype.br.call(this,n,f={val:t}),t=f.val,u))return null;var i;if(t.c===1&&t.g){_j.e.a(_a.a.e,"Constructing YouTubeLinkPreview object for {0}",n.href);i=new _g.cH;i.PlayerUrl=t.g}else if(t.c===2){_j.e.a(_a.a.e,"Constructing OEmbedVideoPreview object for {0}",n.href);i=new _g.cD;i.EmbeddedHtml=null}else if(t.c===3){_j.e.a(_a.a.e,"Constructing BingVideoLinkPreview object for {0}",n.href);i=new _gg.bj;i.EmbeddedHtml=null}else if(this.dm(t.e))i=this.dh(t.e);else{_j.e.a(_a.a.e,"Constructing LinkPreview object for {0}",n.href);i=new _g.ex}t.b&&(i.Title=t.b.innerText);t.a&&(i.Description=t.a.innerHTML);i.Url=n.href;i.ImageUrl=t.f;i.IsVideo=_b.g.a(t.d.id,"LPBorder_YT")||_b.g.a(t.d.id,"LPBorder_VT");r=this.bG(i,null,null);_j.e.a(_a.a.e,"Finished creating narrow format preview for {0}",n.href);return r},df:function(n){if(this.F.a().cj().Enabled&&n&&n.id&&n.id.endsWith("_summary")){var t=window.document.createElement("div");t.innerText=_u.n.Ba;t.style.marginRight="10%";t.style.fontSize="12px";t.style.lineHeight=20+"px";t.style.cssText+=this.z("ms-font-m ms-font-color-neutralSecondary",["color","font-weight","font-family"]);$(t).css("float","right");var i=_b.g.b(n);i.appendChild(t);t.appendChild(this.ca(!0));t.appendChild(this.ca(!1))}},ca:function(n){var i=window.document.createElement("div");i.style.cursor="pointer";var t=$(i);t.mouseenter(this.bY);t.mouseleave(this.bZ);if(n){i.style.marginLeft="10px";t.addClass(_lp.c.h().a());t.click(this.bX)}else{i.style.marginLeft="5px";t.addClass(_lp.c.g().a());t.click(this.bW)}return i},dp:function(n){n.target&&this.ce(n.target,!0)},dn:function(n){n.target&&this.ce(n.target,!1)},ce:function(n,t){var e=$(n);e[0].style.cssText+=this.z("ms-font-color-neutralDark",["color"]);n.setAttribute("clicked","true");for(var r=e.siblings("div"),i=0;i<r.length;i++)if(r[i].getAttribute("clicked")==="true"){r[i].setAttribute("clicked","false");r[i].style.cssText+=this.z("ms-font-color-neutralSecondary",["color"])}var u=new _a.o;var f=_a.d.b(_a.a.e,"ReadingPaneLinkPreviewAction");var o=$(_b.g.b(n)).find("a[id^='LPUrlAnchor']");u.b("U",_db.h.b(o,"href",100));u.c("Liked",t);f.j=u.toString();_a.d.a(f)},dq:function(n){if(n.target){var t=$(n.target);t[0].style.cssText+=this.z("ms-font-color-neutralDark",["color"])}},dr:function(n){if(n.target){var t=$(n.target);t[0].style.cssText+=n.target.getAttribute("clicked")==="true"?this.z("ms-font-color-neutralDark",["color"]):this.z("ms-font-color-neutralSecondary",["color"])}},dh:function(n){for(var e=new _g.cq,f=new _j.q,u=0;u<n.childNodes.length;u++){var t=n.childNodes[u];if(_b.g.a(t.id,"LPImageAnchor")){var i=new _g.dE;var r=null;r=t.childNodes[0].tagName.toLowerCase()==="span"?t.childNodes[0].childNodes[0].src:t.childNodes[0].src;i.ThumbnailUrl=r;i.ImageUrl=r;i.PhotoPageUrl=t.href;f.c(i)}}e.Photos=f.j();return e},dm:function(n){return n?_b.g.a(n.id,"LPImageAlbumContainer")||_b.g.a(n.id,"LPBestFitImageContainer")?!0:!1:!1},Q:function(n){var t=n.getAttribute("PreviewInformation");if(t===(3).toString()){_j.e.a(_a.a.e,"Adding YouTube handler for {0}",n.href);$(n).bind("click",this.bc)}else if(t===(4).toString()||t===(5).toString()){_j.e.a(_a.a.e,"Adding OEmbed video handler for {0}",n.href);$(n).bind("click",this.ba)}else if(t===(2).toString()){_j.e.a(_a.a.e,"Adding handler for {0}",n.href);$(n).bind("click",this.bb)}},ds:function(n){var t=n.getAttribute("PreviewInformation");if(t===(3).toString()){_j.e.a(_a.a.e,"Removing YouTube handler for {0}",n.href);$(n).unbind("click",this.bc)}else if(t===(4).toString()){_j.e.a(_a.a.e,"Removing oembed video handler for {0}",n.href);$(n).unbind("click",this.ba)}else if(t===(2).toString()){_j.e.a(_a.a.e,"Removing handler for {0}",n.href);$(n).unbind("click",this.bb)}this.cd.f()},du:function(n){var t=n.find("a[id^='LPImageAnchor'] img");t&&t.length===1&&t.unbind("load",this.D)},bq:function(n){n.setAttribute("PreviewInformation",2);this.Q(n)},bS:function(n,t){var i=3;t===1?i=3:t===2?i=4:t===3&&(i=5);n.setAttribute("PreviewInformation",i);this.Q(n)},bR:function(n){n.setAttribute("tabindex","-1")},cb:function(n){var u=n;var t=n.parentNode;if(!t){_j.e.a(_a.a.e,"Anchor parent is null for {0}. Skipping rest of FixAnchor",n.href);return n}if(_b.g.a(n.id,"LPUrlAnchor")&&t.tagName.toLowerCase()==="pre"){_j.e.a(_a.a.e,"Anchor parent is not Div for {0}",n.href);var i=window.document.createElement("div");i.id=_lp.b.a("LPTitle");this.B(i,5);var f=n.cloneNode(!0);i.appendChild(f);var o=t.parentNode;if(!o){_j.e.c(_a.a.e,"Anchor grandparent is null for {0}.",n.href);return n}o.replaceChild(i,t);u=f;_j.e.a(_a.a.e,"Replaced anchor parent with Div for {0}",n.href)}else if(_b.g.a(n.id,"LPUrlAnchor")&&t.tagName.toLowerCase()==="span"&&t.parentNode&&t.parentNode.tagName.toLowerCase()==="font"&&t.parentNode.parentNode&&_b.g.a(t.parentNode.parentNode.id,"LPTitle")){var e=t.parentNode.parentNode;this.B(e,5);var s=t.parentNode;var r=n.cloneNode(!0);this.B(r,7);e.replaceChild(r,s);u=r;_j.e.a(_a.a.e,"Replaced title child with anchor for {0}",n.href)}return u},c:function(n,t,i,r,u){for(var o=t,d=0,s=[],l=[],nt=[],a=0;a<n.length;a++){var f=n[a];var e=f;if(_b.g.a(f.id,"LPNoLP")||_b.g.a(f.id,"NoLP")){_j.e.a(_a.a.e,"Message was created in compose; no previews will be generated");o=!1}else if(_b.g.e(f.id)){_j.e.a(_a.a.e,"Message was created in compose; no previews will be generated hashtag and mentions");o=!1}else if(_b.g.a(f.id,"LPlnk")||_b.g.a(f.id,"lnk")){_j.e.a(_a.a.e,"Preview request was generated; no previews will be generated");o=!1}else if(_b.g.a(f.id,"LPImageAnchor")){var tt=_b.g.d(e);this.cc(e,t,tt);this.dk(e,t)}else if(_b.g.a(f.id,"LPUrlAnchor")){var k=_b.g.d(e);var c=!1;var h=!1;this.cc(e,t,k);if(t&&!k)if(i==="Mouse"||i==="TouchWide"){var g,y,v;v=this.di(e,g={val:c},y={val:h}),c=g.val,h=y.val,v}else{var b=_b.g.b(e);if(b){var w=this.dg(e);if(w){Array.add(l,w);Array.add(nt,b)}}}if(c)this.o(e);else if(h)this.bD(this.cF(e));else{_j.e.a(_a.a.e,"Message has previews created in compose; no previews will be generated");o=!1}}else if(o){_j.e.a(_a.a.e,"AnchorTagProtocolsToInterceptForLinkPreview is non-null; checking links");if(this.dl(f,_lp.h.a)){d++;o=d<=1;if(o){var p=this.dj(f,t,u);p&&Array.add(s,p)}else _j.e.a(_a.a.e,"Message has more than one link; no previews will be generated")}}}if(o&&s.length>0){_j.e.a(_a.a.e,"Setting get link preview requests for count: {0}",s.length);r(s)}l.length>0&&this.dd(nt,l);var it=this;this.l(function(n){var t=[];Array.add(t,n);r(t)})},cc:function(n,t,i){t?i&&this.Q(n):this.ds(n)},dj:function(n,t,i){var r=null;t&&(r=this.de(n,i));return r},de:function(n,t){var i=null;if(!_b.g.d(n)&&this.s(n)&&!this.dc(n,t)){_j.e.a(_a.a.e,"Creating link preview request for {0}",n.href);n.id=_b.g.f();this.dt(n);i=new _g.cS;i.Id=n.id;i.Url=n.href;_db.h.f(i)}return i},dc:function(n,t){for(var r=!1,i=n,u=0;u<10;u++){i=i.parentNode;if(!i||i===t)break;var f=i.tagName.toLowerCase();switch(f){case"td":case"tr":case"table":_j.e.a(_a.a.e,"Anchor {0} is in a table",n.href);r=!0;break}if(r)break}return r},dk:function(n,t){if(!t){var i=_b.g.b(n);i&&this.du($(i))}},dl:function(n,t){var f=!1;var r=null;try{r=n.protocol}catch(c){var e=n.outerHTML;var s=e?" OuterHTML: "+e:"";_j.e.c(_a.a.e,"IsLinkPreviewProtocol exception: "+c.message+"."+s)}if(r)for(var u=t,h=u.length,i=0;i<h;++i){var o=u[i];if(r===o){f=!0;break}}return f},dd:function(n,t){for(var i=0;i<n.length;i++){var r=n[i];r.parentNode.replaceChild(t[i],r)}},bn:function(){return!0},i:function(n,t,i,r,u,f){var o=null;i.val=null;r.val=null;u.val=null;f.val=null;if(_b.g.a(n.id,"LPUrlAnchor")||_b.g.a(n.id,"LPImageAnchor"))o=n;else if(n.parentNode&&n.parentNode.parentNode){var k=n.parentNode.parentNode;var y=$(k).find(String.format("{0}[href='{1}']","a[id^='LPUrlAnchor']",t));if(y){var c=y[0];c&&c.href===n.href&&(o=c)}}if(o){var e=null;var w,p;if(p=this.br(o,w={val:e}),e=w.val,p){var b=new RegExp("\\s+","g");i.val=$(e.b).text().trim().replace(b," ");r.val=$(e.a).text().trim().replace(b," ");u.val=e.f}if(u.val){var h,s;u.val=u.val.trim();var l,a,v;v=this.X(u.val,"",l={val:h},a={val:s}),h=l.val,s=a.val,v;f.val=String.format("{0}x{1}",h,s)}}}};_lp.p=function(){};_lp.p.prototype={r:null,b:function(){return this.r},l:function(n){this.r=n;return n},n:!1,d:function(){return this.n},j:function(n){this.n=n;return n},o:!1,e:function(){return this.o},k:function(n){this.o=n;return n},p:null,f:function(){return this.p},h:function(n){this.p=n;return n},q:null,g:function(){return this.q},i:function(n){this.q=n;return n},m:null,a:function(){return this.m},c:function(n){this.m=n;return n}};_lp.a=function(){};_lp.a.$$cctor=function(){_lp.a._I()};_lp.a.s=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_ml_8'></span> <button type='button' class='_ml_3 _ml_8'></button> <button type='button' class='_ml_3'></button> </div><div> <span class='_ml_8'></span> <button type='button' class='_ml_3'></button> </div><div> <div></div> <div></div> </div><div> <li> <span></span> </li> </div><div><div class='_ml_7'></div></div><div> <ul class='_ml_6'> <div>  </div> </ul> </div><div> <div class='_ml_9 ms-bg-color-themeLighterAlt'> <button type='button' class='_ml_2'></button> <button type='button' class='_ml_a ms-font-color-themePrimary'></button> <div class='_ml_4 ms-font-color-neutralSecondary'></div> </div> <div></div> <div></div> </div><div> <div class='_ml_5 ms-border-color-themePrimary'></div> </div><div> <button type='button'></button> </div><div><div class='_ml_f'></div></div><div> <span class='_ml_e ms-font-color-themePrimary'></span> <br/> <span></span> <div>  </div> <span></span> <br/> <textarea class='_ml_c ms-border-color-themePrimary'></textarea> <br/> <button type='button' class='_ml_b ms-font-weight-regular ms-font-color-black'></button> <button type='button' class='_ml_b _ml_g ms-font-weight-regular ms-font-color-white'></button> </div><div>  <div></div> </div><div> <div autoid=\"_ml_0\" class='_ml_d ms-border-color-themePrimary'></div> </div>";_j.h.a().appendChild(n);return n};_lp.a.K=function(n){return n.o};_lp.a.J=function(n){return n.n};_lp.a.H=function(n){return n.g};_lp.a.F=function(n){return n.j};_lp.a.o=function(n){return n.i};_lp.a.B=function(n){return n.W()};_lp.a.p=function(n){return n.b};_lp.a.q=function(n){return n.p};_lp.a.i=function(n){return n.c};_lp.a.l=function(n){return n.q()};_lp.a.I=function(n){return n.h};_lp.a.G=function(n){return n.d};_lp.a.X=function(n){return n.b};_lp.a.U=function(n){return n.c};_lp.a.V=function(n){return n.d};_lp.a.W=function(n){return n.e};_lp.a.L=function(n){return n.b};_lp.a.O=function(n){return n.c};_lp.a.w=function(n){return n.b};_lp.a.M=function(n){return n.g};_lp.a.N=function(n){return n.h};_lp.a.P=function(n){return n.e};_lp.a.u=function(n){return n.d()};_lp.a.e=function(n,t){n.a(t)};_lp.a.c=function(n,t){n.bb(t)};_lp.a.d=function(n,t){n.k(t)};_lp.a.f=function(n,t){n.J(t)};_lp.a.n=function(n,t){n.i(t)};_lp.a.y=function(n,t){n.v(t)};_lp.a.z=function(n,t){n.bc(t)};_lp.a.A=function(n,t){n.bR(t)};_lp.a.k=function(n,t){n.l(t)};_lp.a.j=function(n,t){n.m(t)};_lp.a.t=function(n,t){n.s(t)};_lp.a.r=function(n,t){n.E(t)};_lp.a.m=function(n,t){n.o(t)};_lp.a.C=function(n,t){n.ba(t)};_lp.a.T=function(n,t){n.q(t)};_lp.a.D=function(n,t){n.iI(t)};_lp.a.S=function(n,t){n.o(t)};_lp.a.E=function(n,t){n.bn(t)};_lp.a.Q=function(n,t){n.c=t};_lp.a.x=function(n,t){n.c(t)};_lp.a.R=function(n,t){n.d(t)};_lp.a.v=function(n,t){n.a(t)};_lp.a.h=function(){_lp.a.g||(_lp.a.g=new _fc.l);return _lp.a.g};_lp.a._I=function(){var o="MessageSummarizationView._tid1._tid2._tid3";new _j.d(o,function(){_lp.a.a[o]===undefined&&(_lp.a.a[o]=[[[-1,4,null,null,null,"Text",null,_lp.a.e,0,null,null,null,_u.n.Jx]],[[-1,4,null,null,null,"Text",null,_lp.a.d,0,null,null,null,_u.R.IU],[-1,0,["SummaryLikedClickCommand"],[_lp.a.K],null,"ClickCommand",null,_lp.a.c,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_lp.a.d,0,null,null,null,_u.R.Pc],[-1,0,["SummaryDislikedClickCommand"],[_lp.a.J],null,"ClickCommand",null,_lp.a.c,1,null,null,null]]]);var n=_lp.a.b.childNodes[0].cloneNode(!0);var i=new _fc.b(n.children[2]);i.f("ms-font-color-themePrimary");i.c("ms-font-color-themeDark");var t=new _fc.b(n.children[1]);t.f("ms-font-color-themePrimary");t.c("ms-font-color-themeDark");var r=new _fc.a(n.children[0]);return new _j.a(n,[r,t,i])},"",_lp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_lp.a.a);var e="MessageSummarizationView._tid1._tid2._tid4";new _j.d(e,function(){_lp.a.a[e]===undefined&&(_lp.a.a[e]=[[[-1,4,null,null,null,"Text",null,_lp.a.e,0,null,null,null,_u.n.DB]],[[-1,4,null,null,null,"Text",null,_lp.a.d,0,null,null,null,_u.n.Dj],[-1,0,["ShowAddCommentButton"],[_lp.a.H],null,"IsHidden",null,_lp.a.f,1,_lp.a.h(),null,!0],[-1,0,["AddCommentClickCommand"],[_lp.a.F],null,"ClickCommand",null,_lp.a.c,1,null,null,null]]]);var t=_lp.a.b.childNodes[1].cloneNode(!0);var n=new _fc.b(t.children[1]);n.f("ms-font-color-themePrimary");n.c("ms-font-color-themeDark");var i=new _fc.a(t.children[0]);return new _j.a(t,[i,n])},"",_lp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_lp.a.a);var s="MessageSummarizationView._tid1._tid2";new _j.d(s,function(){_lp.a.a[s]===undefined&&(_lp.a.a[s]=[[[-1,0,["ShowLikeDislikeOptions"],[_lp.a.o],null,"IsHidden",null,_lp.a.f,1,_lp.a.h(),null,!0]],[[-1,0,["ShowLikeDislikeOptions"],[_lp.a.o],null,"IsHidden",null,_lp.a.f,1,null,null,!0]]]);var n=_lp.a.b.childNodes[2].cloneNode(!0);var i=new _j.c(n.children[1]);i.y("MessageSummarizationView._tid1._tid2._tid4");var t=new _j.c(n.children[0]);t.y("MessageSummarizationView._tid1._tid2._tid3");return new _j.a(n,[t,i])},"",_lp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_lp.a.a);var c="MessageSummarizationView._tid1._tid5._tid6";new _j.d(c,function(){_lp.a.a[c]===undefined&&(_lp.a.a[c]=[[[-1,1,["DataContext"],[_lp.a.B],null,"Text",null,_lp.a.e,1,null,null,null]]]);var n=_lp.a.b.childNodes[3].cloneNode(!0);var t=new _fc.a(_j.a.a(n,[0,0]));return new _j.a(n,[t])},"",String,_fce.e,function(n){return new _fce.e(n)},!1,!0,!1,0,_lp.a.a);var h="MessageSummarizationView._tid1._tid5";new _j.d(h,function(){_lp.a.a[h]===undefined&&(_lp.a.a[h]=[[[-1,0,["Snippets"],[_lp.a.p],null,"DataSource",null,_lp.a.n,1,null,null,null]]]);var t=_lp.a.b.childNodes[5].cloneNode(!0);var n=new _jc.a(_j.a.a(t,[0,0]));n.c(function(){var t=_lp.a.b.childNodes[4].cloneNode(!0).childNodes[0];var n=new _fce.e(t);n.y("MessageSummarizationView._tid1._tid5._tid6");return n});return new _j.a(t,[n])},"",_lp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_lp.a.a);var f="MessageSummarizationView._tid1";new _j.d(f,function(){_lp.a.a[f]===undefined&&(_lp.a.a[f]=[[[-1,4,null,null,null,"CheckedImageId",null,_lp.a.y,0,null,null,null,_lp.c.a()],[-1,4,null,null,null,"HoveredCheckedImageId",null,_lp.a.z,0,null,null,null,_lp.c.a()],[-1,4,null,null,null,"PressedCheckedImageId",null,_lp.a.A,0,null,null,null,_lp.c.a()],[-1,4,null,null,null,"ImageId",null,_lp.a.k,0,null,null,null,_lp.c.b()],[-1,4,null,null,null,"HoveredImageId",null,_lp.a.j,0,null,null,null,_lp.c.b()],[-1,4,null,null,null,"PressedImageId",null,_lp.a.t,0,null,null,null,_lp.c.b()],[-1,0,["ToggleExpandCollapseCommand"],[_lp.a.q],null,"ClickCommand",null,_lp.a.c,1,null,null,null],[-1,0,["MinimizeSummary"],[_lp.a.i],_lp.a.r,"IsChecked",_lp.a.l,_lp.a.m,2,null,null,!1]],[[-1,4,null,null,null,"Text",null,_lp.a.d,0,null,null,null,_u.n.Bt],[-1,0,["ToggleExpandCollapseCommand"],[_lp.a.q],null,"ClickCommand",null,_lp.a.c,1,null,null,null],[-1,0,["MinimizeSummary"],[_lp.a.i],_lp.a.r,"IsChecked",_lp.a.l,_lp.a.m,2,null,null,!1]],[[-1,0,["ShowFeedbackOptions"],[_lp.a.I],null,"IsHidden",null,_lp.a.f,1,_lp.a.h(),null,!0]],[[-1,0,["MinimizeSummary"],[_lp.a.i],null,"IsHidden",null,_lp.a.f,1,null,null,!0]],[[-1,0,["RatingBarViewModel"],[_lp.a.G],null,"DataContext",null,_lp.a.C,1,null,null,null]]]);var n=_lp.a.b.childNodes[6].cloneNode(!0);var i=new _j.c(n.children[2]);i.y("RatingBarView");i.K(!0);var r=new _j.c(n.children[1]);r.y("MessageSummarizationView._tid1._tid5");var u=new _j.c(_j.a.a(n,[0,2]));u.y("MessageSummarizationView._tid1._tid2");var e=new _fc.j(_j.a.a(n,[0,1]));var t=new _fc.j(_j.a.a(n,[0,0]));t.f("ms-bg-color-themePrimary");t.c("ms-bg-color-themeDark");return new _j.a(n,[t,e,u,r,i])},"",_lp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_lp.a.a);var t="MessageSummarizationView";new _j.d(t,function(){_lp.a.a[t]===undefined&&(_lp.a.a[t]=[[[-1,0,["Snippets"],[_lp.a.p],null,"IsHidden",null,_lp.a.f,1,_lp.a.h(),null,!0]]]);var i=_lp.a.b.childNodes[7].cloneNode(!0);var n=new _j.c(i.children[0]);n.y("MessageSummarizationView._tid1");return new _j.a(i,[n])},"",_lp.d,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_lp.a.a);var n="RatingBarView._tid7._tid8._tid9";new _j.d(n,function(){_lp.a.a[n]===undefined&&(_lp.a.a[n]=[[[-1,4,null,null,null,"ImageId",null,_lp.a.k,0,null,null,null,_lp.c.e()],[-1,4,null,null,null,"HoveredImageId",null,_lp.a.j,0,null,null,null,_lp.c.f()],[-1,0,["IsHighlighted"],[_lp.a.X],null,"IsHighlighted",null,_lp.a.T,1,null,null,!1],[-1,0,["ClickCommand"],[_lp.a.U],null,"ClickCommand",null,_lp.a.c,1,null,null,null],[-1,0,["HoverCommand"],[_lp.a.V],null,"HoverCommand",null,_lp.a.D,1,null,null,null],[-1,0,["HoverOutCommand"],[_lp.a.W],null,"HoverOutCommand",null,_lp.a.S,1,null,null,null]]]);var t=_lp.a.b.childNodes[8].cloneNode(!0);var i=new _lp.o(t.children[0]);return new _j.a(t,[i])},"",_lp.g,_fce.e,function(n){return new _fce.e(n)},!1,!0,!1,0,_lp.a.a);var i="RatingBarView._tid7._tid8";new _j.d(i,function(){_lp.a.a[i]===undefined&&(_lp.a.a[i]=[[[-1,4,null,null,null,"Text",null,_lp.a.e,0,null,null,null,_u.n.Jy]],[[-1,4,null,null,null,"Text",null,_lp.a.e,0,null,null,null,_u.n.DP]],[[-1,0,["Buttons"],[_lp.a.L],null,"DataSource",null,_lp.a.n,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_lp.a.e,0,null,null,null,_u.n.GG]],[[-1,4,null,null,null,"Title",null,_lp.a.E,0,null,null,null,_u.n.Qp],[-1,0,["FeedbackText"],[_lp.a.O],_lp.a.Q,"Text",_lp.a.w,_lp.a.x,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_lp.a.d,0,null,null,null,_u.R.Jl],[-1,0,["FeedbackCancelClickCommand"],[_lp.a.M],null,"ClickCommand",null,_lp.a.c,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_lp.a.d,0,null,null,null,_u.n.Re],[-1,0,["FeedbackSubmitClickCommand"],[_lp.a.N],null,"ClickCommand",null,_lp.a.c,1,null,null,null]]]);var n=_lp.a.b.childNodes[10].cloneNode(!0);var r=new _fc.b(n.children[9]);r.f("ms-bg-color-themePrimary ms-border-color-themePrimary");r.c("ms-bg-color-themeDark ms-border-color-themeDark");var t=new _fc.b(n.children[8]);t.f("ms-bg-color-neutralLighter ms-border-color-neutralLighter");t.c("ms-bg-color-neutralLight ms-border-color-neutralLight");var f=new _fce.r(n.children[6]);f.a(3800);var s=new _fc.a(n.children[4]);var u=new _jc.a(n.children[3]);u.c(function(){var t=_lp.a.b.childNodes[9].cloneNode(!0).childNodes[0];var n=new _fce.e(t);n.y("RatingBarView._tid7._tid8._tid9");return n});var o=new _fc.a(n.children[2]);var e=new _fc.a(n.children[0]);return new _j.a(n,[e,o,u,s,f,t,r])},"",_lp.f,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_lp.a.a);var u="RatingBarView._tid7";new _j.d(u,function(){_lp.a.a[u]===undefined&&(_lp.a.a[u]=[null]);var t=_lp.a.b.childNodes[11].cloneNode(!0);var n=new _j.c(t.children[0]);n.y("RatingBarView._tid7._tid8");return new _j.a(t,[n]).l({PopupContent:n})},"",_lp.f,_fce.l,function(n){return new _fce.l(n,_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b))},!1,!0,!1,0,_lp.a.a);var r="RatingBarView";new _j.d(r,function(){_lp.a.a[r]===undefined&&(_lp.a.a[r]=[[[-1,0,["ShowRatingView"],[_lp.a.P],_lp.a.R,"IsShown",_lp.a.u,_lp.a.v,2,null,null,!1]]]);var t=_lp.a.b.childNodes[12].cloneNode(!0);var n=new _fce.l(t.children[0],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));n.e(!0);var i=new _fce.q(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_ff.b));n.b(i);n.y("RatingBarView._tid7");return new _j.a(t,[n])},"",_lp.f,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_lp.a.a)};_lp.b.registerClass("_lp.b",null,ILinkPreviewBuilder);_lp.l.registerClass("_lp.l",null,ILinkPreviewBuilderFactory);LinkPreviewComponent.registerClass("LinkPreviewComponent",null,_a.ib,_j.ce);_lp.i.registerClass("_lp.i",null,_b.ch);_lp.q.registerClass("_lp.q");_lp.m.registerClass("_lp.m",_lp.q);_lp.j.registerClass("_lp.j",_lp.q);_lp.k.registerClass("_lp.k",_lp.q);_lp.d.registerClass("_lp.d",_a.bB);_lp.h.registerClass("_lp.h",_lp.b);_lp.n.registerClass("_lp.n",_lp.h);_lp.f.registerClass("_lp.f",_a.bB);_lp.o.registerClass("_lp.o",_fc.b);_lp.g.registerClass("_lp.g",_a.bB);_lp.b.j="data:image/";_lp.b.h="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3FpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo5MDE0MDIyZC00NzE1LTFkNGUtYTQ2Ny00ZjRkODMxYzU1NjgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEQ2RDQ5NzMzMTZGMTFFNUIxRDRDOEM3RjY3MkY2MUIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEQ2RDQ5NzIzMTZGMTFFNUIxRDRDOEM3RjY3MkY2MUIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjY2Y2U5YmFhLWY0NTAtZTc0Yi05ZWUwLWFiNmRmNTEzNjFjMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5MDE0MDIyZC00NzE1LTFkNGUtYTQ2Ny00ZjRkODMxYzU1NjgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5VyyW6AAADHklEQVR42mL8//8/w2AGTAyDHIw6cNg7kAWZw8jISFXD356oqwNSjUQq/wvEcULmjctQREG5GIap7bi3Jxv+/Hp/+z8x4Nvjff+Bev4guweEaRLF4JBjZKrjVYtmZhVQIUoPp4wjiGKmeRokx3F0yyTUdhxGJgFaIAekDgCxItkm/v/H8PnmYpoVM5Q5jg7l4KBy3GhNMurAUQeOOnDUgUOtwUpl8O/hy1/+M7e+ucXExCDFDGwNMzIxMEoJsX7wMufzlxFhqyNkAKgBTZMQ/P3n/5Si6Q/Fpm56rfbn7/8jgkJi+/kERfeJS8rvvfPs59ZJ61/f/v7rnwPBdgewwUqLELxTOfdJHQsLyzJFRUWP1NRUBjExMbjky5cvJZYvX764fuGViR3J0m7A0N1F1zS4/sh7oKVME62trT0qKipQHAcC4uLiDLm5uQzGxsb5FXOf6jIyscXSzYFvPv7xO379m4akpGRsXFwcAzMzM1Z1IPGkpCQGYWHhrtKZ9/cBhbSA+DTWdIjcWXp3sp6inlPjoqeiX38yrASGkJO+vj5B9Tt27GBYs2bNeiCzH4hfAPEfIH4CxPxz5859Q+1c/OPLj/+fOTk57XV0dIjSAEwGDED1gbdv3w58//49g6CgIAOQzfD27dtNycnJqUBHvqKaA4G5dQqwWDAERi8zrqhFB7y8vAz29vZgDC+b/v1j2Lp1q9/GjRsVgY40pdiBf//9X3Xs6pf2zSc+8QO5E11cXCirOYDZ2tfXl+HNmze6R48ezaPIgcAEe6liztMMYMhNkZOTi7KysmIwNTWlSoyAQhXowBCKHHjhzrdsoOOKzczMooDRwUBs1BIDJCQkQJQKRQ7ceebjTSC1MTw8nKqOg6VFUAqiqBw0UuH6CCoSODg4qF4dgXIzEJxCCUEh80aShrd2zUxSACbqg2fPnnUCpT9qgW/fvjGsWLECxJxOaS5+CsTJS5cuvfj7928+UOEsICBAtmGfP38Gh9zq1atBZWETsBzcykjJsBtsPBGYQUBDJu1AbElh5/81EB8BhRzQcbsxqrrRFjUZACDAABMKUHGGjz9/AAAAAElFTkSuQmCC";_lp.b.l="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAABaCAYAAAA4qEECAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuOWwzfk4AAAG6SURBVHhe7dCxbSRREMRQuUrtorwYLsG9WbdAT4TQC9B4Do2Z6v/1er3yCzDGhzE+jPFhjA9jfBjjwxgfxvgwxocxPozxYYwPY3wY48MYH8b4MMaHMT6M8WGMD2N8GOPDGB/G+DDGhzE+jJ/o+8+/v4/XT+w3TRg/zfNIP37kt/2uCeMneR5IeeS3/bYJ46d4Hkd75Lf9vgnjJ3geRn3kt/2HCaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5swxocxPozxYYwPY3wY48MYH8b4MMaHMT6M8WGMD2N8GOPDGB/G+DDGhzE+jPFhjA9jfBjjwxgfxvgwxocxPozxYYwPY3wY48MY2+vrP6Ok5QzJOY3aAAAAAElFTkSuQmCC";_lp.b.b=!0;_lp.b.c=null;_lp.b.e=_lp.c.i().a();_lp.b.f=_lp.c.j().a();LinkPreviewComponent.$$cctor();_lp.d.a={};_lp.e.b=null;_lp.h.a=["http:","https:"];_lp.a.b=_lp.a.s();_lp.a.g=null;_lp.a.a={};_lp.a.$$cctor();
window.scriptsLoaded['microsoft.owa.core.linkpreview.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.linkpreview.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
