try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.mail.common.js'] = (new Date()).getTime();
Type.registerNamespace("_mco");_mco.h=function(){};_mco.h.a=function(n){for(var u=n.querySelectorAll("span[id^='OWAHT']"),r=0;r<u.length;r++){var t=u[r];var i=document.createElement("a");i.setAttribute("href",t.textContent);i.setAttribute("ID",t.id);i.setAttribute("class","hashtagAnchor");i.protocol="http:";t.parentNode.replaceChild(i,t);t.setAttribute("class","hashtag");i.appendChild(t)}};_mco.c=function(){};_mco.c.a=function(n,t){var r;if(n&&n.b()>0){var i;if(t&&t.Mailbox)i=t.Mailbox;else{var u=_g.a.a().c();i=new _g.f;i.EmailAddress=u.bj.UserEmailAddress;i.Name=u.bj.UserDisplayName}var f=_mco.c.b(i);r=new Array(0);n.n(function(n){var t=n;t.CreatedBy=f;Array.add(r,t)})}else r=new Array(0);return r};_mco.c.b=function(n){var t;return t=new _dg.bq,t.PrimaryEmailAddress=n.EmailAddress,t.Name=n.Name,t.EmailAddress=n.EmailAddress,t.RoutingType=n.RoutingType,t.MailboxType=n.MailboxType,t.ItemId=n.ItemId,t.SipUri=n.SipUri,t.Submitted=n.Submitted,t.OriginalDisplayName=n.OriginalDisplayName,t.EmailAddressIndex=n.EmailAddressIndex,t.RelevanceScore=n.RelevanceScore,t};_mco.c.c=function(n){var t=$(n);t.find("a[id^='OWAAM']").attr("class","mention")};_mco.f=function(n,t){this.w=Function.createDelegate(this,this.G);this.u=Function.createDelegate(this,this.E);this.v=Function.createDelegate(this,this.F);this.y=Function.createDelegate(this,this.I);this.x=Function.createDelegate(this,this.H);this.r=Function.createDelegate(this,this.B);this.p=Function.createDelegate(this,this.z);this.q=Function.createDelegate(this,this.A);this.t=Function.createDelegate(this,this.D);this.s=Function.createDelegate(this,this.C);if(t.a().eB().Enabled&&n.g()){this.o=_a.H.c();this.a="?guid="+this.o+"&PartID=ExoProd";this.h="https://1.perf.msedge.net/cold.gif"+this.a;this.i="https://4.perf.msedge.net/cold.gif"+this.a;this.m="https://1.perf.msedge.net/hot.gif"+this.a;this.n="https://4.perf.msedge.net/hot.gif"+this.a;this.f="https://outlook.office365.com/owa/auth/current/themes/resources/lgnexlogo.gif"+this.a;this.e="https://outlook.live.com/owa/auth/current/themes/resources/lgnexlogo.gif"+this.a;this.g="https://edge.outlook.office365.com/owa/auth/current/themes/resources/lgnexlogo.gif"+this.a;this.k="https://outlook.office365.com/owa/auth/current/themes/resources/lgnbotm.gif"+this.a;this.j="https://outlook.live.com/owa/auth/current/themes/resources/lgnbotm.gif"+this.a;this.l="https://edge.outlook.office365.com/owa/auth/current/themes/resources/lgnbotm.gif"+this.a;this.c={};var f=new Image;f.onload=this.s;f.src=this.h;var e=new Image;e.onload=this.t;e.src=this.i;var u=new Image;u.onload=this.q;u.src=this.f;var i=new Image;i.onload=this.p;i.src=this.e;var r=new Image;r.onload=this.r;r.src=this.g}};_mco.f.prototype={o:null,a:null,h:null,i:null,m:null,n:null,f:null,e:null,g:null,k:null,j:null,l:null,c:null,C:function(){var n=new Image;n.onload=this.x;n.src=this.m;this.b(this.h,"t-a-cold")},D:function(){var n=new Image;n.onload=this.y;n.src=this.n;this.b(this.i,"t-b-cold")},H:function(){this.b(this.m,"t-a-hot");this.d()},I:function(){this.b(this.n,"t-b-hot");this.d()},A:function(){var n=new Image;n.onload=this.v;n.src=this.k;this.b(this.f,"t-cafe-cold")},z:function(){var n=new Image;n.onload=this.u;n.src=this.j;this.b(this.e,"t-live-cold")},B:function(){var n=new Image;n.onload=this.w;n.src=this.l;this.b(this.g,"t-edgecafe-cold")},F:function(){this.b(this.k,"t-cafe-hot");this.d()},E:function(){this.b(this.j,"t-live-hot");this.d()},G:function(){this.b(this.l,"t-edgecafe-hot");this.d()},b:function(n,t){if(_a.S.e()){var i=_a.S.j(n);this.c[t]=i?Math.floor(i.responseEnd-i.startTime).toString():""}},d:function(){Object.keys(this.c).length===10&&this.J()},J:function(){var n="{";n=n+String.format('"Guid":"{0}"',this.o);n=n+String.format(',"PartID":"ExoProd"');var u=this.c;for(var i in u){var r={key:i,value:u[i]};n=n+String.format(',"{0}":"{1}"',r.key,r.value)}n+="}";var f=encodeURIComponent(n);var t=new Sys.Net.WebRequest;t.set_url("https://1.perf.msedge.net/exoprodci?p="+f);t.set_httpVerb("Get");t.invoke()}};_mco.i=function(){};_mco.i.a=function(n,t){if(n&&n.f()){var u=_a.d.b(_a.a.ci,"InfoBarCount");u.o(new _a.bg(t));var o=n.f();var i=o.x.length;var r=new _a.o;r.a("T",i);if(i>0){var f="";var e=0;o.p(function(n){var t=n;f+=t.e.toString();e!==i-1&&(f+=",");e++});r.b("IDs",f)}u.j=r.toString();_a.d.a(u)}};function MailCommonComponent(){}MailCommonComponent.$$cctor=function(){_a.u.a().a(MailCommonComponent)};MailCommonComponent.prototype={a:function(n,t,i){var r=this;n.b(_mco.f,function(){return new _mco.f(n.a(_a.x),n.a(_a.f))}).a()},b:function(){return[new _j.x(_mco.f,2,1)]}};_mco.a=function(n,t,i,r){this.w=Function.createDelegate(this,this.bB);this.x=Function.createDelegate(this,this.bJ);_mco.a.initializeBase(this,[2]);this.j=n;this.bD=n;this.bv=i;this.bc="CreateMessageForCompose";t&&(this.bl=_g.n.c(t));r&&(this.bi=r)};_mco.a.b=function(n){if(!n||!n.Mailbox){var i=_mco.a.g(null);if(i){n=new _g.O;n.Mailbox=new _g.f;n.Mailbox.EmailAddress=i}}if(!n||!n.Mailbox)return null;var t=_mco.a.f(n);if(t){n.Mailbox.Name=t.DisplayName;n.Mailbox.RoutingType="SMTP"}return n};_mco.a.g=function(n){var f=_g.a.a().c().bj.UserEmailAddress;var e=_g.a.a().A;var t;t=e?n?null:_g.a.a().c().bj.DefaultFromAddress:_g.a.a().a().bj.SendAddressDefault;if(!_j.i.a(t)){var u=_mco.a.j(t);u||(u=_mco.a.p(t));if(u)return u.EmailAddress;if(e){var a=_g.a.a().c().b();var v=_g.a.a().c().a();if(a&&a.g(t)||v&&v.g(t))return t}if(t===f)return null}if(n){var i=_g.j.isInstanceOfType(n)?n:null;if(i&&(_mco.a.c(i.m(),f)||_mco.a.c(i.o(),f)))return null;var p=_mco.a.j(n.hE());if(p)return p.EmailAddress;var w=_g.a.a().c().b();var b=_g.a.a().c().a();var k=_g.a.a().c().e();var r;var o,h,l,c,s,y;if(e&&i&&((h=_mco.a.n(i,w,o={val:r}),r=o.val,h)||(c=_mco.a.n(i,b,l={val:r}),r=l.val,c)||(y=_mco.a.r(i,k,s={val:r}),r=s.val,y)))return r}return null};_mco.a.e=function(n,t){var r=_mco.a.f(n);if(r){var i=new _g.U;i.ExtendedFieldURI=_g.c.w();i.Value=r.SubscriptionGuid;_mco.a.d(t,i)}else _mco.a.q(t,_g.c.w())};_mco.a.d=function(n,t){if(n.ExtendedProperty){for(var i=0;i<n.ExtendedProperty.length;i++)if(n.ExtendedProperty[i].ExtendedFieldURI.PropertySetId===t.ExtendedFieldURI.PropertySetId&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyTag===t.ExtendedFieldURI.PropertyTag&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyId===t.ExtendedFieldURI.PropertyId&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyName===t.ExtendedFieldURI.PropertyName&&n.ExtendedProperty[i].ExtendedFieldURI.DistinguishedPropertySetId===t.ExtendedFieldURI.DistinguishedPropertySetId){n.ExtendedProperty[i]=t;return}var r=[];Array.addRange(r,n.ExtendedProperty);Array.add(r,t);n.ExtendedProperty=r}else{n.ExtendedProperty=new Array(1);n.ExtendedProperty[0]=t}};_mco.a.q=function(n,t){var r=!1;if(n.ExtendedProperty){for(var u=[],i=0;i<n.ExtendedProperty.length;i++){if(n.ExtendedProperty[i].ExtendedFieldURI.PropertySetId===t.PropertySetId&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyTag===t.PropertyTag&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyId===t.PropertyId&&n.ExtendedProperty[i].ExtendedFieldURI.DistinguishedPropertySetId===t.DistinguishedPropertySetId){r=!0;continue}Array.add(u,n.ExtendedProperty[i])}r&&(n.ExtendedProperty=u)}};_mco.a.j=function(n){if(!n)return null;for(var i=_g.a.a().c().e(),r=i?i.b():0,t=0;t<r;t++)if(n===i.a(t).SubscriptionGuid)return i.a(t);return null};_mco.a.p=function(n){if(!n)return null;for(var i=_g.a.a().c().e(),r=i?i.b():0,t=0;t<r;t++)if(n===i.a(t).EmailAddress)return i.a(t);return null};_mco.a.f=function(n){if(!n||!n.Mailbox)return null;for(var i=_g.a.a().c().e(),r=i?i.b():0,t=0;t<r;t++)if(i.a(t).EmailAddress===n.Mailbox.EmailAddress)return i.a(t);return null};_mco.a.o=function(n,t,i,r){if(_g.bd.isInstanceOfType(n)){var o=n;var e=new _g.cY;e.Subject=o.bj.Subject;e.Body=new _g.s(o.I().a()==="HTML"?"HTML":"Text",o.I().bj.Value);e.Importance=o.bK();var s=_mco.a.b(o.bj.From);e.From=s;_mco.a.e(s,e);e.Sensitivity=o.bP();_mco.a.e(s,e);_mco.a.i(e,o);return e}else{var u=n;var f=new _g.N;f.Subject=u.bj.Subject;f.Body=new _g.s(u.I().a()==="HTML"?"HTML":"Text",u.I().bj.Value);u.eN()&&(f.DocLinks=u.eN().f());f.Body.BodyType==="HTML"&&(f.Body.Value=_a.H.f(f.Body.Value,!0));if(u.bG()){f.ItemClass=u.bj.ItemClass;f.MimeContent=u.bj.MimeContent}else _db.f.b(u,f);f.Importance=u.bK();var h=_mco.a.b(u.bj.From);f.From=h;u.bj.Sender&&(f.Sender=u.bj.Sender);_mco.a.e(h,f);f.ToRecipients=_db.f.a(u.m());f.CcRecipients=_db.f.a(u.o());f.BccRecipients=_db.f.a(u.v());f.Sensitivity=u.bP();f.IsDeliveryReceiptRequested=u.bj.IsDeliveryReceiptRequested;f.IsReadReceiptRequested=u.bj.IsReadReceiptRequested;u.bj.InternetMessageId&&(f.InternetMessageId=u.bj.InternetMessageId);if(t){if(r===1){t.d()&&(f.AtAllMention=u.bj.AtAllMention);t.c()&&u.bX()&&(f.MentionsEx=_mco.c.a(u.bX(),u.bj.From));t.e()&&u.cv()&&(f.AppliedHashtags=u.cv().f())}!r&&t.i()&&(f.PendingSocialActivityTagIds=u.cU().f())}_mco.a.i(f,u);_mco.a.k(f,u);_mco.a.l(f,u);_mco.a.m(f,u);_mco.a.h(f,u);return f}};_mco.a.i=function(n,t){if(t.dt()){_mco.a.a(n,_g.c.J(),t.dt().toString());_mco.a.a(n,_g.c.F(),t.ed());_mco.a.a(n,_g.c.D(),t.eb());_mco.a.a(n,_g.c.E(),t.ec())}};_mco.a.l=function(n,t){var i=t.bL()?_g.c.a(t.bL().f(),_g.c.c()):null;if(i){_mco.a.a(n,_g.c.c(),i.bj.Value);i.dispose()}};_mco.a.m=function(n,t){var i=t.bL()?_g.c.a(t.bL().f(),_g.c.b()):null;if(i){_mco.a.a(n,_g.c.b(),i.bj.Value);i.dispose()}};_mco.a.k=function(n,t){t.df()&&_mco.a.a(n,_g.c.I(),t.df());t.cT()&&_mco.a.a(n,_g.c.H(),t.cT());t.ds()&&_mco.a.a(n,_g.c.G(),t.ds())};_mco.a.h=function(n,t){if(t.bL())for(var r=0,o=t.bL().b();r<o;r++){var e=t.bL().a(r);var i;var u,f;(f=_h.G.c(e,u={val:i}),i=u.val,f)&&_mco.a.d(n,i);e.dispose()}};_mco.a.a=function(n,t,i){var r=new _g.U;r.ExtendedFieldURI=t;r.Value=i;_mco.a.d(n,r)};_mco.a.n=function(n,t,i){i.val=null;if(t)for(var r=0;r<t.b();r++){i.val=t.a(r);if(_mco.a.c(n.m(),i.val)||_mco.a.c(n.o(),i.val))return!0}return!1};_mco.a.r=function(n,t,i){i.val=null;if(t)for(var u=0;u<t.b();u++){var r=t.a(u);if(_mco.a.c(n.m(),r.EmailAddress)||_mco.a.c(n.o(),r.EmailAddress)){i.val=r.EmailAddress;return!0}}return!1};_mco.a.c=function(n,t){t=t?t.toLowerCase():null;if(t&&n)for(var i=0;i<n.b();i++)if(n.a(i).EmailAddress&&n.a(i).EmailAddress.toLowerCase()===t)return!0;return!1};_mco.a.prototype={l:null,j:null,bv:null,bi:null,bA:function(n){if(!this.l){this.l=n;this.bu("ResponseSuccess",n);_h.CreateItemResponseProcessor.e(this.x);_h.CreateItemResponseProcessor.c(this.w)}},bz:function(n){if(this.l){this.bI("ResponseSuccess",this.l);_h.CreateItemResponseProcessor.d(this.x);_h.CreateItemResponseProcessor.b(this.w);this.l=null}},bj:function(){if(!this.be)switch(this.y){case 0:this.be=_g.b.a.nameToId("drafts");break;default:this.be=_g.b.a.nameToId("outbox");break}var n;_db.f.d(this.j.I(),n={val:this.bw},this.bo),this.bw=n.val;return[_mco.a.o(this.j,this.bv,this.bi,this.y)]},bb:function(){var n=_db.f.prototype.bb.call(this);var t=this.j.bA();t&&(n.rightsManagementLicenseData=_db.f.c(t));n.explicitLogonUser=this.Q;n.itemPartsOrderDescending=_g.a.a().a().n()!=="ChronologicalNewestOnBottom";this.y===1&&(n.actionName=this.bc+"Send");n.setServiceUnavailableOnTransientError=!0;return n},bJ:function(n,t){var i=n.a;var f=t;var u=new _g.eT;var r=i.itemIds[n.b];this.bO("ResponseSuccess",this)},bB:function(n){var t=n.id;if(this.O.id===t){this.bz(this.l);_h.CreateItemResponseProcessor.d(this.x);_h.CreateItemResponseProcessor.b(this.w)}}};_mco.d=function(n,t,i,r){this.cf=Function.createDelegate(this,this.cp);this.ch=Function.createDelegate(this,this.cw);_mco.d.initializeBase(this,[2]);this.bV=n;this.bV.ReferenceItemId=_g.g.a(t);this.cn=i;this.cm=r;this.bc="CreateResponse"};_mco.d.a=function(n){var t=null;if(_g.cI.isInstanceOfType(n))t=new _g.bG;else if(_g.cx.isInstanceOfType(n))t=new _g.bN;else if(_g.cw.isInstanceOfType(n))t=new _g.bx;else throw Error.invalidOperation("SmartResponseItem type is not supported.");return t};_mco.d.b=function(n,t,i,r,u,f,e){if(t){if(_g.j.isInstanceOfType(t)){var o=t;var s=n;if(o.bj.ItemId)if(i)s.UpdateResponseItemId=_bc.OutboxItemContext.a(o.bj.ItemId,_a.a.A);else if(r)s.UpdateResponseItemId=_bc.OutboxItemContext.a(r,_a.a.A);else{s.UpdateResponseItemId=new _g.g(o.bj.ItemId.Id);s.UpdateResponseItemId.ChangeKey=o.bj.ItemId.ChangeKey}o.bj.InternetMessageId&&(s.InternetMessageId=o.bj.InternetMessageId);var l=_mco.a.b(o.bj.From);_mco.a.e(l,s);s.From=l;o.bj.Sender&&(s.Sender=o.bj.Sender);o.m()&&(s.ToRecipients=_db.f.a(o.m()));o.o()&&(s.CcRecipients=_db.f.a(o.o()));o.v()&&(s.BccRecipients=_db.f.a(o.v()));if(u){if(e===1){u.d()&&(s.AtAllMention=o.bj.AtAllMention);u.c()&&o.bX()&&(s.MentionsEx=_mco.c.a(o.bX(),o.bj.From));u.e()&&o.cv()&&(s.AppliedHashtags=o.cv().f())}!e&&u.i()&&(s.PendingSocialActivityTagIds=o.cU().f())}s.IsDeliveryReceiptRequested=o.bj.IsDeliveryReceiptRequested;s.IsReadReceiptRequested=o.bj.IsReadReceiptRequested;var c=_g.bt.isInstanceOfType(t)?t.c():t.I();s.NewBodyContent=new _g.s(c.a()==="HTML"?"HTML":"Text",c.bj.Value);!u.b()&&s.UpdateResponseItemId&&s.NewBodyContent.BodyType==="HTML"&&_j.i.a(s.NewBodyContent.Value)&&(s.NewBodyContent.Value="<BR />");s.UpdateResponseItemId;_db.f.b(o,s);_mco.a.h(n,o)}else if(_g.bd.isInstanceOfType(t)){var a=n;var h=_g.bt.isInstanceOfType(t)?t.c():t.I();a.NewBodyContent=new _g.s(h.a()==="HTML"?"HTML":"Text",h.bj.Value)}n.Subject=t.bj.Subject;n.Importance=t.bK();n.Sensitivity=t.bP();_mco.a.i(n,t);e===1&&_mco.a.k(n,t)}return n};_mco.d.prototype={cn:null,cm:null,bV:null,bA:null,bi:null,bv:0,bB:null,bz:null,bJ:!1,j:function(n){if(!this.bB){this.bB=n;this.bu("ResponseSuccess",n);_h.CreateItemResponseProcessor.e(this.ch);_h.CreateItemResponseProcessor.c(this.cf)}},x:function(n){if(this.bB){this.bI("ResponseSuccess",this.bB);_h.CreateItemResponseProcessor.d(this.ch);_h.CreateItemResponseProcessor.b(this.cf);this.bB=null}},bK:function(n){this.bA=n;this.bD=n;return n},l:function(){var n=this.bh();var t=n.Body;n=null;return t},w:function(n){this.cG(n)},bb:function(){var n=_db.f.prototype.bb.call(this);var t=this.bA.bA();t&&(n.rightsManagementLicenseData=_db.f.c(t));if(!!(!!this.bz&!!this.bm)){n.parentConversationNodeId=this.bz;n.conversationId=new _g.g(this.bm.Id)}var i=_g.b.a.nameToId("inbox");n.inboxFolderId=new _g.l(i.Id);n.explicitLogonUser=this.Q;this.y===1&&(n.actionName=this.bc+"Send");n.setServiceUnavailableOnTransientError=!0;return n},bj:function(){if(!this.be)switch(this.y){case 0:this.be=_g.b.a.nameToId("drafts");break;default:this.be=_g.b.a.nameToId("outbox");break}var n;_db.f.d(this.bA.I(),n={val:this.bw},this.bo),this.bw=n.val;this.bV.ReferenceItemDocumentId=this.bv;!this.bv;return[_mco.d.b(this.bV,this.bA,this.bs,this.bE,this.cn,this.cm,this.y)]},bh:function(){var n=_db.f.prototype.bh.call(this);this.bJ&&_g.a.a().a().q()!=="AlwaysSend"&&(n.Body.ShouldSuppressReadReceipt=!0);n.Body.SendOnNotFoundError=!0;return n},cG:function(n){_db.f.prototype.cG.call(this,n);var t=n.Items[0];if(this.y)this.y===1&&this.bA.bj.ItemId&&_db.bh.a(this.bA.bj.ItemId,!1);else if(this.bk)(t.Body||t.NormalizedBody)&&this.co(t);else{var i=t.ItemId;_h.c.y(i)}},co:function(n){var t=_g.h.b(n);this.bi=t},cw:function(n,t){var r=n.a;var f=t;var u=new _g.eT;var i=r.itemIds[n.b];if(i&&this.D&&u.a(this.D,i)){this.co(f.Items[0]);this.bO("ResponseSuccess",this)}},cp:function(n){var i=n.id;var t=this.O;if(t&&t.id===i){this.x(this.bB);_h.CreateItemResponseProcessor.d(this.ch);_h.CreateItemResponseProcessor.b(this.cf)}}};_mco.g=function(n,t,i){_mco.g.initializeBase(this,[t]);this.c=n;this.i=n.bj.ItemId;this.g=i};_mco.g.prototype={i:null,c:null,g:null,K:function(){return this.W("V2015_10_15")},I:function(n){var t=new _g.bI(_h.b.e());t.ItemIds=[new _g.g(this.i.Id)];t.ItemShape.AdditionalProperties=[new _g.d("AppliedHashtags")];var i=new _g.bM(this.J);i.clientStoreItem=0;var r=new _g.bH(this.K(),t);n.a(r,i,this.G,this.E)},cG:function(n){if(n.ResponseClass==="Success"&&n.Items&&!(n.Items.length<1)){var f=n.Items[0];if(f){var r=f.AppliedHashtags;var e=r?r.length:0;if(e>0){for(var i=new _a.j,t=0;t<e;t++)i.c(r[t]);this.c.eQ(i);var u=_h.d.a().a(this.i.Id);u&&u.eQ(i)}}}}};_mco.b=function(n,t,i){this.bD=Function.createDelegate(this,this.bZ);this.bE=Function.createDelegate(this,this.ca);_mco.b.initializeBase(this,[2]);this.g=n;this.be=t;this.bU=i;this.y=0;this.bJ=n.I().bj.Value;this.bl="AutoResolve";this.by=_g.b.a.nameToId("outbox");this.v="UpdateMessageForCompose"};_mco.b.a=function(n,t,i,r){var f=new _g.v(i);var u=new _g.N;r(u,t);f.Item=u;Array.add(n,f)};_mco.b.k=function(n,t){n.Sensitivity=t.bP()};_mco.b.i=function(n,t){n.IsDeliveryReceiptRequested=t.bj.IsDeliveryReceiptRequested};_mco.b.j=function(n,t){n.IsReadReceiptRequested=t.bj.IsReadReceiptRequested};_mco.b.h=function(n,t){_mco.a.a(n,_g.c.J(),t.dt().toString())};_mco.b.d=function(n,t){_mco.a.a(n,_g.c.F(),t.ed())};_mco.b.b=function(n,t){_mco.a.a(n,_g.c.D(),t.eb())};_mco.b.c=function(n,t){_mco.a.a(n,_g.c.E(),t.ec())};_mco.b.g=function(n,t){_mco.a.a(n,_g.c.I(),t.df())};_mco.b.f=function(n,t){_mco.a.a(n,_g.c.H(),t.cT())};_mco.b.e=function(n,t){_mco.a.a(n,_g.c.G(),t.ds())};_mco.b.prototype={bU:null,g:null,bk:null,bh:null,m:null,bR:!1,bQ:null,bo:null,bp:null,bT:!1,bi:null,be:null,c:function(n){this.bh=n;return n},bY:function(n){if(!this.bi){this.bi=n;this.bu("ResponseSuccess",n);_db.UpdateItemResponseProcessor.e(this.bE);_db.UpdateItemResponseProcessor.d(this.bD)}},bV:function(n){if(this.bi){this.bI("ResponseSuccess",this.bi);_db.UpdateItemResponseProcessor.c(this.bE);_db.UpdateItemResponseProcessor.b(this.bD);this.bi=null}},bc:function(){_h.cL.prototype.bc.call(this);var n=this.w;var t=this.g.bA();if(t){n.rightsManagementLicenseData=_db.f.c(t);n.isUpdatingRightsManagementLicenseData=!0}if(_g.j.isInstanceOfType(this.g)&&this.m){n.outboxItemId=new _g.g(this.m.Id);n.outboxItemId.ChangeKey=this.m.ChangeKey;var r=_g.b.a.nameToId("drafts");n.parentFolderId=new _g.l(r.Id)}if(_g.j.isInstanceOfType(this.g)&&this.bh){n.resendItemId=new _g.g(this.bh.Id);n.resendItemId.ChangeKey=this.bh.ChangeKey}if(!!(!!this.bp&!!this.bo)){n.parentConversationNodeId=this.bp;n.conversationId=new _g.g(this.bo.Id)}var i=_g.b.a.nameToId("inbox");n.inboxFolderId=new _g.l(i.Id);n.bodySubstring=this.bQ;n.itemPartsOrderDescending=_g.a.a().a().n()!=="ChronologicalNewestOnBottom";this.y===1&&(n.actionName=this.v+"Send");n.setServiceUnavailableOnTransientError=!0},cG:function(n){if(this.bR)throw Error.invalidOperation("Expected only one response message.");this.bR=!0;if(this.y)this.y===1&&_db.bh.a(this.g.bj.ItemId,!1);else{this.bk=n.Items[0].ItemId;_h.c.y(this.bk)}this.m&&_h.c.d([this.m],!1)},x:function(){var i=new _g.bq;var r;r=this.m?_bc.OutboxItemContext.a(this.m,_a.a.A):this.bh?_bc.OutboxItemContext.a(this.bh,_a.a.A):this.g.bj.ItemId;i.ItemId=new _g.g(r.Id);i.ItemId.ChangeKey=r.ChangeKey;this.g.I().a()==="HTML"&&this.g.I().b(_a.H.f(this.g.I().bj.Value,!1));if(this.bT&&this.g.I().a()==="HTML"){this.bN=!0;var l=_a.y.h(this.g.I().bj.Value);this.g.I().b(l)}var n=[];if(this.g.bG()){var ht=this;_mco.b.a(n,this.g,new _g.d("MimeContent"),function(n,t){n.MimeContent=t.bj.MimeContent})}else if(this.g.T()&&this.g.T().b()>0){var h=_db.f.g(this.g.T());if(h.length>0){var it=this;_mco.b.a(n,this.g,new _g.d("Attachments"),function(n,t){n.Attachments=h})}}if(this.g.eN()){var rt=this;_mco.b.a(n,this.g,new _g.d("DocLinks"),function(n,t){n.DocLinks=t.eN().f()})}if(this.g.bj.ItemClass){var tt=this;_mco.b.a(n,this.g,new _g.d("ItemClass"),function(n,t){n.ItemClass=t.bj.ItemClass})}var t=null;t=_g.j.isInstanceOfType(this.g)?this.g.bj.From:this.g.bj.From;t=_mco.a.b(t);var v=_mco.a.f(t);if(v){var g=this;_mco.b.a(n,this.g,_g.c.w(),function(n,i){_mco.a.e(t,n)})}else Array.add(n,new _g.bf(_g.c.w()));if(_g.j.isInstanceOfType(this.g)){if(t){var nt=this;_mco.b.a(n,this.g,new _g.d("From"),function(n,i){n.From=t})}else Array.add(n,new _g.bf(new _g.d("From")));var ut=this;_mco.b.a(n,this.g,new _g.d("CcRecipients"),function(n,t){n.CcRecipients=_db.f.a(t.o())});var st=this;_mco.b.a(n,this.g,new _g.d("BccRecipients"),function(n,t){n.BccRecipients=_db.f.a(t.v())});var k=this;_mco.b.a(n,this.g,new _g.d("ToRecipients"),function(n,t){n.ToRecipients=_db.f.a(t.m())});if(this.be){if(this.y===1){if(this.be.d()){var ot=this;_mco.b.a(n,this.g,new _g.d("AtAllMention"),function(n,t){n.AtAllMention=t.bj.AtAllMention})}if(this.be.c()){var ft=this;_mco.b.a(n,this.g,new _g.d("MentionsEx"),function(n,t){var i=t;n.MentionsEx=_mco.c.a(i.bX(),i.bj.From)})}if(this.be.e()){var et=this;_mco.b.a(n,this.g,new _g.d("AppliedHashtags"),function(n,t){n.AppliedHashtags=t.cv().f()})}}if(!this.y&&this.be.i()){var d=this;_mco.b.a(n,this.g,new _g.d("PendingSocialActivityTagIds"),function(n,t){n.PendingSocialActivityTagIds=t.cU().f()})}}_mco.b.a(n,this.g,new _g.d("IsReadReceiptRequested"),_mco.b.j);_mco.b.a(n,this.g,new _g.d("IsDeliveryReceiptRequested"),_mco.b.i);this.g.bL()&&_g.c.a(this.g.bL().f(),_g.c.c())&&_mco.b.a(n,this.g,_g.c.c(),_mco.a.l);this.g.bL()&&_g.c.a(this.g.bL().f(),_g.c.b())&&_mco.b.a(n,this.g,_g.c.b(),_mco.a.m)}var y=this;_mco.b.a(n,this.g,new _g.d("Subject"),function(n,t){n.Subject=t.bj.Subject});var p=this;_mco.b.a(n,this.g,new _g.d("Importance"),function(n,t){n.Importance=t.bK()});var w=this;_mco.b.a(n,this.g,new _g.d("Body"),function(n,t){n.Body=new _g.s(t.I().a()==="HTML"?"HTML":"Text",t.I().bj.Value)});_mco.b.a(n,this.g,new _g.d("Sensitivity"),_mco.b.k);if(this.g.dt()){_mco.b.a(n,this.g,_g.c.J(),_mco.b.h);_mco.b.a(n,this.g,_g.c.F(),_mco.b.d);_mco.b.a(n,this.g,_g.c.D(),_mco.b.b);_mco.b.a(n,this.g,_g.c.E(),_mco.b.c)}if(this.y===1){_j.i.d(this.g.df())||_mco.b.a(n,this.g,_g.c.I(),_mco.b.g);_j.i.d(this.g.cT())||_mco.b.a(n,this.g,_g.c.H(),_mco.b.f);this.g.ds()&&_mco.b.a(n,this.g,_g.c.G(),_mco.b.e)}if(this.g.bL())for(var e=0,a=this.g.bL().b();e<a;e++){var s=this.g.bL().a(e);var u;var o,c;if(c=_h.G.c(s,o={val:u}),u=o.val,c){var b=this;_mco.b.a(n,this.g,u.ExtendedFieldURI,function(n,t){_mco.a.d(n,u)})}s.dispose()}i.Updates=new Array(n.length);for(var f=0;f<n.length;f++)i.Updates[f]=n[f];return[i]},bm:function(){var n=_h.cL.prototype.bm.call(this);n.Body.PromoteInlineAttachments=this.g.I().a()==="Text";n.Body.SendOnNotFoundError=!0;return n},ca:function(n,t){var i=n.a;var f=t;var u=new _g.eT;var r=i.itemIds[n.b];this.bO("ResponseSuccess",this)},bZ:function(n){var t=n.id;if(this.O.id===t){this.bV(this.bi);_db.UpdateItemResponseProcessor.c(this.bE);_db.UpdateItemResponseProcessor.b(this.bD)}}};_mco.e=function(){};_mco.e.registerInterface("_mco.e");_mco.k=function(){};_mco.k.registerInterface("_mco.k");var ITailoredEntityViewModelFactory=function(){};ITailoredEntityViewModelFactory.registerInterface("ITailoredEntityViewModelFactory");_mco.j=function(){};_mco.j.registerInterface("_mco.j");_mco.l=function(){};var ICalendarCoauthoringMessageViewModelFactory=function(){};ICalendarCoauthoringMessageViewModelFactory.registerInterface("ICalendarCoauthoringMessageViewModelFactory");_mco.f.registerClass("_mco.f");MailCommonComponent.registerClass("MailCommonComponent",null,_a.ib,_j.ce);_mco.a.registerClass("_mco.a",_db.f);_mco.d.registerClass("_mco.d",_db.f,_h.eu,_h.es,IActionBase,_h.bC,_h.et);_mco.g.registerClass("_mco.g",_h.cO.$$(_g.ev,_g.dA));_mco.b.registerClass("_mco.b",_h.cL,_h.ex,_h.ew);MailCommonComponent.$$cctor();_mco.d.c=_a.a.A;
window.scriptsLoaded['microsoft.owa.mail.common.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.mail.common.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
