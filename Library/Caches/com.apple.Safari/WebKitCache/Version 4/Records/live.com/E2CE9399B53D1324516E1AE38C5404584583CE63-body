try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.calendar.locationwell.js'] = (new Date()).getTime();
var IDurationChangedEvent=function(){};IDurationChangedEvent.registerInterface("IDurationChangedEvent");Type.registerNamespace("_lw");_lw.l=function(n,t,i){this.q=n;this.m=t;this.l=1;this.k=0;this.i=new _j.q;this.p=i};_lw.l.prototype={g:null,n:!1,i:null,h:!1,p:null,q:null,m:null,l:0,k:0,s:function(){return!!this.p&&this.p.a().eH().Enabled},f:function(){if(!this.s()){_j.e.a(_a.a.bp,"FindLocationFeedbackManager.StartOrResumeSession:AddEntityFeedback not enabled. Skip starting session.");return}try{if(this.h){var n=this.o("SessionResumed");this.j(n,!1);this.n=!1;_j.e.a(_a.a.bp,"Session resumed. Session id: {0}",this.g)}else{this.g=_a.H.c();var t=this.o("SessionStarted");this.j(t,!0);this.h=!0;_j.e.a(_a.a.bp,"Session started. Session id: {0}",this.g)}}catch(i){this.g="";_j.e.d(_a.a.bp,i,"Session failed to start or resume.")}},c:function(){try{if(this.h){var n=this.o("SessionEnded");this.j(n,!0);_j.e.a(_a.a.bp,"Session ended. Session id: {0}",this.g);this.g=""}}catch(t){_j.e.d(_a.a.bp,t,"Session failed to end. Session Id: {0}",this.g);this.g=""}},d:function(){if(this.h&&!this.n)try{var n=this.o("SessionPaused");this.j(n,!1);this.n=!0;_j.e.a(_a.a.bp,"Session paused. Session id: {0}",this.g)}catch(t){_j.e.d(_a.a.bp,t,"Session failed to pause. Session Id: {0}",this.g)}},a:function(n,t,i,r,u,f,e){if(this.h){_a.b.a(r,"locationIndex");_a.b.a(r,"location");try{var o={};var s={};s[i]=r;o.QueryString=t;o.EmailAddressAndPositionIndex=s;o.QueryStringLength=_j.i.a(t)?0:t.length;o.LocationSource=f;o.ScenarioName="LocationWell";o.RelevanceHints=Sys.Serialization.JavaScriptSerializer.serialize([e]);var c=Sys.Serialization.JavaScriptSerializer.serialize(Object.keys(s));var h=this.r(u,"EntityAdded",c,n,Sys.Serialization.JavaScriptSerializer.serialize(o));this.j(h,!1);_j.e.a(_a.a.bp,"Added Entity. Session id: {1}",this.g)}catch(l){_j.e.d(_a.a.bp,l,"Session failed to AddEntity. Session Id: {0}",this.g)}}},e:function(n,t){try{if(this.h){var r=Sys.Serialization.JavaScriptSerializer.serialize([n]);var i={};i.ScenarioName="LocationWell";i.RelevanceHints=Sys.Serialization.JavaScriptSerializer.serialize([t]);var f=Sys.Serialization.JavaScriptSerializer.serialize(i);var u=this.r("","EntityRemoved",r,0,f);this.j(u,!1);_j.e.a(_a.a.bp,"Removed entity {0}. Session id: {1}",r,this.g)}}catch(e){_j.e.d(_a.a.bp,e,"Session failed to RemoveEntity. Session Id: {0}",this.g)}},b:function(n,t,i,r){try{if(this.h){var u={};u.QueryString=_j.i.a(n)?"":n;u.QueryStringLength=_j.i.a(n)?0:n.length;u.ScenarioName="LocationWell";u.RelevanceHints=Sys.Serialization.JavaScriptSerializer.serialize(r);var o=Sys.Serialization.JavaScriptSerializer.serialize(u);var e=Sys.Serialization.JavaScriptSerializer.serialize(t);var f=this.r(i,"TransactionCompleted",e,0,o);this.j(f,!1);_j.e.a(_a.a.bp,"CompleteTransaction. Session id: {0}",this.g)}}catch(s){_j.e.d(_a.a.bp,s,"Session failed to CompleteTransaction. Session Id: {0}",this.g)}},j:function(n,t){this.i.c(n);if(t||this.i.d.length>=10){this.q.a(new _fp.t(this.i.j()));_j.e.a(_a.a.bp,"Submitted {0} entities.",this.i.d.length);this.i.f()}},o:function(n){if(_j.i.a(this.g))throw Error.invalidOperation("Session not started");var i={};i.ScenarioName="LocationWell";var u=Sys.Serialization.JavaScriptSerializer.serialize(i);var t;var r=(t=new _gg.bS,t.ClientEventTimeUtc=_a.c.get_utcNow().i(),t.ClientEventTimeLocal=_a.c.a().i(),t.ClientSessionId=this.g,t.ClientVersion=this.m,t.ClientId=this.l,t.EntrySequenceNumber=this.k,t.TransactionId="",t.EventType=n,t.TargetEntityList="",t.EntityAddSource=0,t.JsonPropertyBag=u,t.EntityType=4,t.ScenarioName="LocationWell",t);this.k++;return r},r:function(n,t,i,r,u){if(_j.i.a(this.g))throw Error.invalidOperation("Session not started");var f;var e=(f=new _gg.bS,f.ClientEventTimeUtc=_a.c.get_utcNow().i(),f.ClientEventTimeLocal=_a.c.a().i(),f.ClientSessionId=this.g,f.ClientVersion=this.m,f.ClientId=this.l,f.EntrySequenceNumber=this.k,f.TransactionId=n,f.EventType=t,f.TargetEntityList=i,f.EntityAddSource=r,f.JsonPropertyBag=u,f.EntityType=4,f.ScenarioName="LocationWell",f);this.k++;return e}};function CalendarLocationWellComponent(){}CalendarLocationWellComponent.$$cctor=function(){_a.u.a().a(CalendarLocationWellComponent)};CalendarLocationWellComponent.prototype={a:function(n,t,i){var u=this,r=this;n.b(ILocationWellViewModelFactory,function(){return new _lw.q(n.a(_a.C),n.d(IPlacePickerViewModelFactory),n.a(_y.a),n.a(_a.Z),n.a(_a.x),n.a(_a.cX),n.a(_j.j))}).a().c(function(t){t.h=n.a(_pe.e)})},b:function(){return[]}};_lw.r=function(n,t){this.d=n;this.c=t};_lw.r.prototype={d:null,c:0,b:function(){return this.d},a:function(){return this.c}};_lw.o=function(){};_lw.o.prototype={none:0,plainText:1,autosuggest:2,bingMap:3,addRoom:4};_lw.o.registerEnum("_lw.o",!1);_lw.c=function(n){_lw.c.initializeBase(this);n&&this.er(n)};_lw.c.$$cctor=function(){_a.m.c(_lw.c,Object,function(n){return new _lw.c(n)})};_lw.c.prototype={d:function(){return this.ev(_lw.c.d)},a:function(){return this.ev(_lw.c.b)},c:function(){return this.ev(_lw.c.c)},b:function(){return this.ev(_lw.c.a)},e:function(){return this.d()?this.d():this.a()?this.a():this.c()?this.c():this.b()?this.b():""}};_lw.g=function(n){_lw.g.initializeBase(this);n&&this.er(n)};_lw.g.$$cctor=function(){_a.m.c(_lw.g,Object,function(n){return new _lw.g(n)})};_lw.g.prototype={a:function(){return this.ev(_lw.g.a)},b:function(){return this.ev(_lw.g.b)}};_lw.b=function(n){_lw.b.initializeBase(this);if(n){this.er(n);this.b()==="s:PostalAddress"&&this.f(new _lw.c(n))}};_lw.b.$$cctor=function(){_a.m.c(_lw.b,Object,function(n){return new _lw.b(n)})};_lw.b.prototype={b:function(){return this.ev(_lw.b.e)},e:function(){return this.ev(_lw.b.d)},a:function(){return this.ev(_lw.b.a)},f:function(n){this.eu(_lw.b.a,n);return n},c:function(){return this.ev(_lw.b.b)},d:function(){return this.ev(_lw.b.c)||this.a().e()}};_lw.j=function(n){this.d=n};_lw.j.b=function(n){var i=new _pc.a(null,!0,null);i.dp(4);var r;i.cF(n.d());var u;u=n.b()==="s:LocalBusiness"?"Business":n.b()==="s:PostalAddress"?"Home":"Other";if(n.b()!=="s:BusinessEntityType"){var t;r=(t=new _dg.e,t.z(u),t.i(n.a().d()),t.l(n.a().a()),t.o(n.a().c()),t.m(n.a().b()),t.n(null),t.h("LocationServices"),t.r(n.e()),t);if(n.c()){r.x(n.c().a());r.y(n.c().b())}i.bS(new(_pc.p.$$(_dg.e)));i.r().e(r,"0")}return i};_lw.j.prototype={a:null,b:0,d:null,c:null,f:function(){var n={};this.a.c()&&(n.ul=String.format("{0},{1},{2}",this.a.a,this.a.b,this.a.e));n.mr=this.b;n.types=this.d;n.q=this.c;n.appId="9D33F208D8235F41FFEDA38FBCB2DFD324BA0664";return n},e:function(n,t,i,r){this.c=n;this.a=i;this.b=t;var u={};u.type="GET";u.url="https://platform.bing.com/geo/autosuggest/V1/";u.data=this.f();u.dataType="jsonp";u.jsonp="cb";var f=this;u.success=function(n,t,i){var u=f.g(n);r(u)};var e=this;u.error=function(n,t,i){_j.e.b(_lw.j.a,"Bing Autosuggest Response timed out")};$.ajax(u)},g:function(n){var i=new _lw.h(n);var t=new _j.q;var r=this;i.a().p(function(n){t.c(_lw.j.b(n))});return t}};_lw.h=function(n){_lw.h.initializeBase(this);n&&this.er(n)};_lw.h.$$cctor=function(){_lw.h.a.b(new _a.bv(_lw.b))};_lw.h.prototype={a:function(){return this.ev(_lw.h.a)}};_lw.m=function(n){_lw.m.initializeBase(this);this.g=n;this.c=new _gg.sS(this.J);this.c.shouldPrecedeOfflineSyncActions=this.i();this.c.id=n.Id};_lw.m.prototype={g:null,c:null,i:function(){return!1},I:function(n){n.bk(this.g,this.c,this.l,this.j)}};_lw.n=function(n){_lw.n.initializeBase(this,[n])};_lw.n.prototype={b:function(n){var i=_j.t.b(_bc.c,n.PersonaTypeString);var t=null;switch(i){case 4:var r=n.BusinessAddressesArray;t=n.BusinessAddressesArray[0].Value.LocationUri;break;case 1:t=_pc.l.prototype.b.call(this,n);break;case 3:t=n.EmailAddress.EmailAddress;break}return t}};_lw.e=function(){};_lw.e.g=function(){var n=new(_h.ds.$$(_lw.k))(_lw.e.b);return _h.c.b(n,_h.h.a(),function(n){return new _lw.k(n)})};_lw.e.e=function(n,t,i,r,u,f,e){return _lw.e.a(n,6,null,null,0,null)};_lw.e.d=function(n,t,i,r,u,f,e){return _lw.e.a(n,8,null,null,0,null)};_lw.e.c=function(n){return _lw.e.a(n,1,null,null,0,null)};_lw.e.f=function(n,t,i,r,u){return _lw.e.a(n,16,t,i,r,u)};_lw.e.a=function(n,t,i,r,u,f){var e=new _gg.bV;e.Query=n;e.Sources=t;e.RequiredAttendees=i;e.OptionalAttendees=r;if((t&16)==16&&f){e.MeetingTimeSlot=f;e.ResolveAvailability=!0}e.MaxResults=u?u:12;return new _lw.i(e)};_lw.k=function(n){_lw.k.initializeBase(this,[n,null,!0,null])};_lw.k.prototype={bw:function(){return _a.a.eS},bJ:function(n){var t=n;this.j=!0;return new _lw.n(t.L)},E:function(n){return _lw.e.c("")}};_lw.i=function(n,t){_lw.i.initializeBase(this);this.j=n;this.i=t?t:new _j.k};_lw.i.prototype={j:null,i:null,c:function(){return this.i},g:function(){return"Default"},I:function(n){var t=new _gg.uv(this.J);t.owsVersion="V2_66";n.bq(this.j,t,this.G,this.E)},cQ:function(n,t,i){try{for(var f=new Array(n.length),u=0;u<n.length;u++){var r=new _pc.a(null,!0,null);r.er(n[u]);if(r.d())r.df(2);else{r.df(1);r.cT(_h.i.f())}f[u]=r}this.i.f();f.length>0&&this.i.m(f);t()}catch(e){i(e)}}};_lw.p=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.bR=Function.createDelegate(this,this.cN);this.bQ=Function.createDelegate(this,this.cx);this.cr=Function.createDelegate(this,this.en);this.cp=Function.createDelegate(this,this.em);this.bP=Function.createDelegate(this,this.cw);this.bq=Function.createDelegate(this,this.dv);this.bs=Function.createDelegate(this,this.gv);this.br=Function.createDelegate(this,this.fR);this.cu=Function.createDelegate(this,this.gw);this.cs=Function.createDelegate(this,this.cD);this.cv=Function.createDelegate(this,this.cL);this.bH=new _a.by;_lw.p.initializeBase(this,[n,t,r,u,!1,v,c,e,null,i,null,0,null,null,"",null,""]);this.R=_j.i.c(_lws.CalLWStrings.E,"");this.Q=t;this.bI=f;this.lv("");this.bN=new _j.g(this.cv,_a.a.T);this.bJ=new _j.g(this.cs,_a.a.T);this.bK=o;this.c=!0;this.apcl("QueryString",this.cu);this.bO=s;this.bj=h;this.bG=new _lw.j("address,business,place");this.M=l;this.bl="";this.u="";this.bL=e;this.bm=new _j.k;this.bn=new _j.k;s&&this.bf(_lws.CalLWStrings.D);this.d={};this.v=a;if(this.v){this.v.b(IAttendeesChangedEvent,this.br);this.v.b(IDurationChangedEvent,this.bs)}};_lw.p.prototype={Q:null,bI:null,bO:!1,bJ:null,bN:null,N:!1,R:null,bh:null,bp:!0,c:!1,bj:!1,bg:null,O:null,bK:null,M:null,bL:null,d:null,bG:null,bn:null,bm:null,v:null,W:!1,bk:!1,cH:function(n){this.bk!==n&&(this.bk=n);return n},js:function(){return!1},hT:function(){return"https://go.microsoft.com/fwlink/?LinkId=260597"},hV:function(){return!this.eo&&!this.Q.bs.x.length},jn:function(){return this.N},bM:function(n){if(this.N!==n){this.N=n;this.N&&this.dT(_lws.CalLWStrings.F);this.et("IsLearnMoreButtonHighlighted")}return n},ed:function(){return this.bj&&!!this.dh&&_fp.c.prototype.ed.call(this)},gX:function(n){_fp.c.prototype.gX.call(this,n);return n},bl:null,bF:null,u:null,jq:function(){return this.bJ},jr:function(){return this.bp},cG:function(n){if(this.bp!==n){this.bp=n;this.et("ShowUseThisLocationButton")}return n},ju:function(){return this.R},hx:function(n){if(this.R!==n){this.R=n;this.c&&this.dT(this.R);this.et("UseThisLocationString")}return n},jt:function(){return this.bN},jp:function(){return this.c},bo:function(n){if(this.c!==n){this.c=n;this.c&&this.dT(this.R);this.et("IsUseThisLocationButtonHighlighted")}return n},hU:function(){return _lws.CalLWStrings.B},dD:function(){return this.dm.a().K().Enabled},bi:function(){return!!this.dm&&this.dm.a().eD().Enabled&&this.dm.a().bK().Enabled&&this.bk},ec:function(){return this.bi()&&(!this.dh||this.dh.trim()==="")},cP:function(n){n&&!this.fQ(n)&&this.Q.bs.a(n)},gq:function(){this.dC&&this.bi()&&_j.i.a(this.dh)&&this.fb()},hr:function(){if(this.dC){this.W=!0;if((!this.dh||this.dh.trim()==="")&&this.bi()){_j.e.a(_a.a.T,"PerformSearch with no query");this.fb()}else _fp.c.prototype.hr.call(this)}},fK:function(){if(this.eS()){_j.e.b(_a.a.T,"OnBlur set last query to null."+this.es);this.bh=null;this.gU()}this.W=!1;_fp.c.prototype.fK.call(this)},hQ:function(n){var i;var u,r;if(n&&(r=this.cI(n,u={val:i}),i=u.val,r)){this.Q.bs.o(i);var t=new _gg.hT;n.d()&&n.d().Id&&!n.d().Id.startsWith("CLPID:")?t.EntityId=n.d().Id:t.Id=n.gz();var f=new _lw.m(t);this.dP.a(f)}},fQ:function(n){var r;var i,t;return t=this.cI(n,i={val:r}),r=i.val,t},gu:function(){if(this.bi()){this.bh=null;this.dh&&this.dh!==""||this.fb()}},cC:function(n){var i=this.di.l(this.A());var t=this.di.x[i];n.val=t.bR.gv();return this.cA(t)},cA:function(n){var t="";t=n.bR.gs()&&n.bR.gs()!==undefined?n.bR.gs():n.bR.Q()&&n.bR.Q().bj.LocationUri?n.bR.Q().bj.LocationUri:n.X();return t},ii:function(){this.bM(!1);this.dF(!1);this.dE(-1);this.dw(-1);this.bo(!0)},cI:function(n,t){t.val=-1;if(_pc.a.isInstanceOfType(n))for(var u=n.gz(),f=n.c(),i=0;i<this.Q.bs.x.length;i++){var r=this.Q.bs.x[i];if(u&&r.gz()===u||r.c()===f){t.val=i;return!0}}return!1},eH:function(n){var t=new _pe.h(n,_pe.c.e,!1,this.eL,this.dW,8,0,null,!1);t.g(1,_cc.S.b,"");return t},gP:function(){this.P(!1);this.dw(-1);this.dE(-1);if(this.eS()){this.bh=null;this.gU()}this.bi()&&(this.W=!1);if(this.M&&this.A()&&this.A().a()&&!_j.i.a(this.A().a().c())){var r="Cache";var u=2;if(this.O&&this.O.g(this.A())){r="Bing";u=8}var e=this.di.l(this.A());var n;var t,i;var f=(i=this.cC(t={val:n}),n=t.val,i);this.M.a(u,this.bl,f,e,this.u,r,n)}},is:function(){return!1},hN:function(){if(this.c)return!0;if(!this.di.x.length&&this.dJ){this.dF(!1);this.bo(!0);return!0}if(!this.eP){this.dE(-1);this.dw(-1);this.bo(!0);return!0}if(this.N){this.bM(!1);this.dF(!0);return!0}return _fp.c.prototype.hN.call(this)},hM:function(){if(this.c){this.bo(!1);if(!this.di.x.length){this.dF(!0);return!0}this.dE(0);this.dw(0);return!0}if(this.dJ&&this.hV()){this.dF(!1);this.bM(!0);return!0}return this.N?!0:_fp.c.prototype.hM.call(this)},eS:function(){return!!this.dm&&this.dm.a().bK().Enabled&&this.bk},gh:function(){this.c?this.cL():this.N?this.cD():_fp.c.prototype.gh.call(this)},fb:function(){if(this.dh!==this.bh&&(this.ep||this.ec())){this.bh=this.dh;this.W=!0;if(this.d&&this.dh in this.d){for(var i=this.d[this.dh],r=new _j.q,n=0;n<=i.x.length;n++)r.c(i.x[n]);var u=this.cJ(r.d);this.cF(u)}else if(this.dh.length<this.ig){var e=this.cz(this.bm);var f=this.cz(this.bn);var t=_lw.e.f(this.dh,f,e,this.dK,this.bF);t.b(this.bq);this.ee(!0);this.dP.a(t)}}},hy:function(n){if(!n){this.fs=null;return}this.fs=new _j.q;for(var t=0,i=n.d.length;t<i;t++)this.fs.c(this.eH(n.d[t]))},it:function(){_fp.c.prototype.it.call(this);this.cG(!1);this.bj=!1;this.ex("ShowLearnMoreLink","ShowInformationButton")},jw:function(){this.cG(!0);this.bj=!0;this.ex("ShowLearnMoreLink","ShowInformationButton")},cz:function(n){if(n){var t=new Array(0);var i=this;n.p(function(n){var i=n;i.bj.Mailbox&&!_j.i.b(i.bj.Mailbox.EmailAddress)&&t.push(n.bj.Mailbox.EmailAddress)});return t}return null},ij:function(n,t,i){this.ir(this.dK,this.bP,t)},ew:function(){if(this.v){this.v.c(IAttendeesChangedEvent,this.br);this.v.c(IDurationChangedEvent,this.bs)}_fp.c.prototype.ew.call(this)},hz:function(n,t){this.bK.b(this.cp,this.cr);this.ee(!0);this.bG.e(this.dh,n,this.bH.a,t)},dv:function(n){n.k(this.bq);var r=n;var i=r.L;r.O&&(this.u=r.O.activityId);this.ee(!1);var f=new _j.q;if(i&&i.length>0){for(var e=new _j.q,u=i,s=u.length,t=0;t<s;++t){var o=u[t];e.c(new _pc.a(o,!0,null))}f=this.cJ(e.d);this.cx(n)}this.cF(f)},cF:function(n){this.cw(n);this.ff();this.fW();this.P(this.W)},cJ:function(n){var u=new _j.q;if(n&&n.length>0)for(var r=n,e=r.length,t=0;t<e;++t){var i=r[t];if(i&&i!==undefined){var f=this.bL.j(i,8,!1,0,5,!1);u.c(f)}}return u},cx:function(n){n.k(this.bQ);var t=n;n.F||!_j.i.b(this.dh)&&this.d&&t.i.x.length>0&&(this.d[this.dh]=t.i)},cN:function(n){for(var c=new _j.q,e=new _j.q,f=new _j.q,u=this.dK-this.bg.d.length,h=this.bg.d,a=h.length,r=0;r<a;++r){var t=h[r];t.bR.Q()&&t.bR.Q().bj.LocationUri&&c.c(t.bR.Q().bj.LocationUri);e.c(this.cA(t));f.c(t.bR.gv())}this.O=new _j.q;for(var s=n.d,v=s.length,i=0;i<v;++i){var o=s[i];if(!u)break;if(u>0&&!this.bg.g(o)&&!c.g(o.r().c(0).bj.LocationUri)){var l=this.eH(o);this.O.c(l);e.c(l.bR.r().c(0).bj.LocationUri);f.c("BingAutoSuggest");u--}}this.dV();this.di.m(this.bg.d);this.di.m(this.O.d);this.M&&this.M.b(this.dh,e.j(),_j.i.a(this.u)?_a.H.c():this.u,f.j());this.ee(!1);this.fW()},cw:function(n){this.O=new _j.q;if(this.dD()&&n.d.length<this.dK&&this.dh){this.bg=n;this.hz(this.dK,this.bR)}else{this.dV();this.di.m(n.d);if(this.M){for(var i=new _j.q,f=new _j.q,u=n.d,e=u.length,r=0;r<e;++r){var t=u[r];t.bR.Q()&&t.bR.Q().bj.LocationUri?i.c(t.bR.Q().bj.LocationUri):i.c(t.bR.c());f.c(t.bR.gv())}this.M.b(this.dh,i.j(),_j.i.a(this.u)?_a.H.c():this.u,f.j())}}},em:function(n){this.bH=n},en:function(n){},cD:function(){this.bI.a(this.hT(),null,null,!1)},fR:function(n){this.cy();n.b()?this.bm=n.a():this.bn=n.a()},gv:function(n){_cc.a.C()&&this.cy()},cy:function(){if(this.d)for(var t=Object.keys(this.d),r=t.length,n=0;n<r;++n){var i=t[n];delete this.d[i]}},cL:function(){this.P(!1)},gw:function(n,t){this.hx(_j.i.c(_lws.CalLWStrings.E,this.dh));this.ex("ShowLearnMoreLink","ShowInformationButton")}};_lw.f=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.X=Function.createDelegate(this,this.br);this.Y=Function.createDelegate(this,this.bs);this.Z=Function.createDelegate(this,this.bt);this.bb=Function.createDelegate(this,this.bv);this.W=Function.createDelegate(this,this.bq);this.T=Function.createDelegate(this,this.bo);this.F=Function.createDelegate(this,this.bn);this.U=Function.createDelegate(this,this.bp);this.ba=Function.createDelegate(this,this.bu);this.S=Function.createDelegate(this,this.bk);_lw.f.initializeBase(this);_a.b.b(u,"owaShell");_a.b.b(s,"clientSettings");this.x=new _j.g(this.S,_lw.f.a);this.C=new _j.g(this.ba,_lw.f.a);this.R=[new _fm.d(_lws.CalLWStrings.G,null,this.x)];this.N=i;this.O=t;this.r=r;this.s=u;this.v=f;this.D=e;this.K=o;this.I=s;this.M=h;this.J=a;this.t=c;this.E=l;this.n=v;this.p=y;this.bj();this.bz();this.bm(n);this.apcl("Placeholder",this.U);this.p&&this.p.b(IDurationChangedEvent,this.F)};_lw.f.b=function(n){return!n.Q()||n.Q().b()!=="Resource"};_lw.f.prototype={K:null,I:null,t:!1,x:null,C:null,R:null,O:null,N:null,D:null,s:null,w:null,E:!1,m:null,k:null,j:null,M:null,r:null,l:null,v:null,q:!1,z:null,o:0,n:null,J:null,p:null,A:!1,bi:function(n){this.ey("OnPlacePickerClosed",n)},bw:function(n){if(n!==this.z){this.z=n;this.et("Placeholder")}return n},P:function(n){if(this.m!==n){this.m=n;this.et("PersonaViewModel")}return n},a:function(){return this.k},be:function(n){if(this.k!==n&&!this.k.bB(n)){this.k=n;this.et("Location")}return n},bx:function(n){if(this.A!==n){this.A=n;this.j&&this.j.cH(this.A)}return n},d:function(){return this.q},bd:function(n){if(this.q!==n){this.q=n;this.et("IsLocationDirty")}return n},y:function(){return _g.a.a().bj.PolicySettings.PlacesEnabled},bI:function(){return this.v},V:function(n){this.v=n;return n},L:function(){var n=!1;this.r&&this.r.a()&&(n=this.r.a().K().Enabled);return n},bu:function(){if(!this.y())throw Error.invalidOperation("Places must be enabled to use the place picker");if(!this.m&&!_j.i.b(this.j.dh)){this.j.P(!1);this.j.i(!1);var n=this;this.bc(function(t){t.b(n.j.dh,null);n.v.d(t)})}},h:function(n){this.l?n(this.l):this.bc(n)},G:function(n){_j.i.a(n.Q().bj.LocationUri)||this.bl(n);this.be(n.fQ());this.Q(n)},bl:function(n){if(this.L()&&!_j.i.a(n.Q().bj.LocationUri)&&(!n.Q().bj.Latitude||!n.Q().bj.Longitude)){var t;var r=(t=new _gg.bV,t.Id=n.Q().bj.LocationUri,t.MaxResults=1,t.Sources=8,t);var i=new _lw.i(r);i.b(this.T);this.j.dP.a(i)}},bo:function(n){var i=n;if(!i.F&&i.i.x.length===1){var t=i.i.x[0];if(t.Q().bj.Latitude&&t.Q().bj.Longitude){t.cF(this.k.bj.DisplayName);this.G(t)}}},c:function(){if(this.q){if(this.m){if(this.k&&!this.j.dC){this.k.l(this.j.dh);this.et("Location")}}else{if(this.k&&this.k.a().b()==="Resource"&&this.k.bj.DisplayName===this.j.dh)return;this.bg()}this.bd(!1)}},g:function(n,t){var i=n.s();this.b(i)},b:function(n){if(!this.k.bB(n)){var t=n||_dg.d.b();this.k=t.h();this.Q(_pc.a.f(this.k));this.j.cE(!1);this.et("Location")}},f:function(n){if(n&&n.bj.DisplayName){n.a().b()==="Resource"&&(this.o=4);if(this.o){this.w=_a.d.b(_lw.f.a,"LocationSelection",!1);this.w.j=String.format("Location sourced from {0} and selected from {1}. The annotation was {2}used",n.a().b(),_j.t.d(_lw.o,this.o),_j.i.a(n.bj.Annotation)?"not ":"");_a.d.a(this.w);this.w=null}(n.i()||this.o===1)&&this.k.a().b()!=="Resource"&&this.j.cP(_pc.a.f(n))}},i:function(n,t){if(this.j&&_cc.a.C()){var i;this.j.bF=(i=new _gg.di,i.StartTime=n.s().E(),i.DurationInMinutes=t,i)}},bj:function(){var n;n=this.L()?_lw.e.d:_lw.e.e;this.j=new _lw.p(n,_lw.e.g(),this.r,this.s,this.I,this.K,this.D,this.M,this.t,this.E,this.J,this.n,this.p,null);this.j.cH(this.A);this.j.cK("PlaceDetailedView");if(this.y()){this.j.cq();this.j.G(!0)}else this.j.G(!1);this.j.o(!1);this.j.p(!1);this.j.I(0);this.j.cM(100)},ew:function(){this.p&&this.p.c(IDurationChangedEvent,this.F);if(this.j){this.j.dispose();this.j=null}_a.iX.prototype.ew.call(this)},bn:function(n){this.m&&this.m.fB("Unknown");this.i(n.b(),n.a())},bc:function(n){if(this.l){n(this.l);return}var t=this;this.N.a(function(i){t.l=i.a(9,t.O);t.l.g(t.W);t.s.a()!=="Mouse"||t.s.c()||t.l.e(function(){t.l.b(t.l.c(),t.l.a())});t.l.f(t.bb);t.et("PlacePickerViewModel");n(t.l)})},bv:function(){this.eB("OnPlacePickerClosed")},bz:function(){this.j.jL(this.x);this.j.kk(this.Z);this.j.K(this.Y);this.j.apcl("QueryString",this.X);if(this.y()&&this.E){this.j.jF(this.C);this.j.jE(this.C)}else this.j.jF(null)},br:function(n,t){this.bd(!0)},bf:function(n){this.j.j(n);this.q=!1},bm:function(n){this.k=n?n.h():_dg.d.b();this.k.e(this.k.bj.DisplayName||"");this.Q(_pc.a.f(this.k))},Q:function(n){this.j.bl=this.j.dh;n.b()!==4||n.bc()?this.k.i()||this.k.a().b()==="Resource"?this.by(n):this.bh(this.k.g()):this.bh(this.k.g())},bh:function(n){this.j.G(!1);this.bf(n);this.P(null);this.j.G(this.y())},by:function(n){this.j.bf(_lws.CalLWStrings.A);this.j.G(!1);this.bf(this.k.bj.Annotation||"");this.q=!1;this.P(_cc.S.a(n,this.D,this.s,2,this.R,!0))},bp:function(n,t){this.j.bf(this.t?this.z:"")},bk:function(){this.j.bf(this.t?this.z:"");if(this.j.A()&&this.n){var n;var i,t;var r=(t=this.j.cC(i={val:n}),n=i.val,t);this.n.e(r,n)}this.P(null);this.bg();this.j.cE(!1);this.j.gu()},bt:function(n,t){if(this.j.dI){this.n&&this.n.f();return}if(this.n){this.j.ei||_j.i.a(this.j.dh)||this.n.a(4,this.j.dh,this.j.dh,-1,this.j.u,"Explicitly Typing","");this.n.d()}this.c()},bg:function(){this.j.G(this.y());this.be(_dg.d.a(this.j.dh));this.o=1},bs:function(n,t){if(this.j.A()){this.o=2;this.G(this.j.A().a())}},bq:function(n){if(n){this.o=3;this.G(n)}}};_lw.q=function(n,t,i,r,u,f,e){this.e=n;this.i=t;this.g=i;this.c=r;this.b=u;this.f=f;this.d=e};_lw.q.prototype={i:null,g:null,c:null,b:null,f:null,e:null,h:null,d:null,a:function(n,t,i,r,u,f,e){var o=null;f&&(o=_lw.f.b);return new _lw.f(n,t,this.i,this.e,this.g,i,this.h,this.c,this.b,this.f,r,u,o,e,this.d)}};_lw.d=function(n,t){this.q=Function.createDelegate(this,this.bo);this.v=Function.createDelegate(this,this.bd);this.w=Function.createDelegate(this,this.be);this.n=Function.createDelegate(this,this.bg);this.o=Function.createDelegate(this,this.bk);this.p=Function.createDelegate(this,this.s);this.t=_lws.CalLWStrings.D;_lw.d.initializeBase(this,[n]);this.y("LocationWellView");this.a=t;this.e=this.a.a()==="Mouse";this.r=this.a.a()==="Mouse"?2:0};_lw.d.prototype={u:!1,r:0,c:null,i:null,d:null,l:null,h:null,f:null,e:!1,m:!1,k:!1,a:null,j:null,bA:function(n){n=n||"";if(this.t!==n){this.t=n;this.W().bw(n);this.bq("Placeholder")}return n},bL:function(n){if(this.m!==n){this.m=n;this.bq("UseExperimentalFeatures")}return n},g:!1,bC:function(n){if(this.e!==n){this.e=n;this.bq("SingleLineMode")}return n},x:function(){return!!this.W()&&this.W().L()},b:function(){return this.g||this.x()},bw:function(n){if(this.k!==n){this.k=n;this.bq("ExpandedPortraitLayout")}return n},cA:function(){return this.j},T:function(n){if(this.j!==n){this.j=n;this.bq("AriaLabelledBy")}return n},s:function(){var t=this.W();if((this.e||this.b())&&this.C&&t)if(t.m){this.c.J(!1);var i=this.cG().outerWidth(!0);if(this.b())this.h.J(!0);else{this.c.z.style.width=(_j.l.h(this.i.z,!1)+10).toString()+"px";this.d.z.style.display="";_j.l.a(this.d.z,"display","table-cell");var n=_j.l.h(this.l.z,!1);this.d.z.style.width=n.toString()+"px";this.f.z.style.display="none";var u=_j.l.h(this.c.z,!1);var r=i-u-n;r<258&&(this.c.z.style.width=((i-n)/2).toString()+"px");this.f.z.style.display=""}}else{this.c.J(!0);this.d.z.style.display="none";this.b()&&this.h.J(!1)}},Z:function(){_j.h.prototype.Z.call(this);var n=this.W();n&&n.bx(this.m)},I:function(){_j.c.prototype.I.call(this);this.C?this.bc():this.bv()},G:function(){_j.c.prototype.G.call(this);if(!_g.a.a().bj.PolicySettings.PlacesEnabled){this.a.a()==="Mouse"&&(this.d.z.style.display="none");return}this.u=this.b()||this.a.a()!=="Mouse";if(this.b()||this.e&&this.a.a()==="Mouse"){this.s();this.a.h(this.p)}if(this.W()&&(this.b()||this.a.l())){var n=this;_j.o.a().d(this.F(),"OnActivate",function(){n.W().apcl("PlacePickerViewModel",n.o);n.i.apcl("DataContext",n.n)})}this.a.a()==="TouchWide"&&this.X.apcl("IsInExpandedComposeLayoutInPortraitOrientation",this.w);_j.l.b(this.f.z,"keydown",this.v)},M:function(){if(this.W()&&(this.b()||this.a.l())){this.W().rpcl("PlacePickerViewModel",this.o);this.W().rpcl("PersonaViewModel",this.n)}(this.b()||this.e&&this.a.a()==="Mouse")&&this.a.j(this.p);_j.c.prototype.M.call(this)},br:function(){this.Y()&&this.M();_j.c.prototype.br.call(this)},bk:function(n,t){this.W().bi(this.q)},bg:function(n,t){(this.b()||this.a.a()==="Mouse")&&this.s();_j.o.a().a(_a.a.T,"RestoreFocus",this.q,0)},bd:function(n){(n.a()===13||n.a()===27)&&n.c()},bo:function(){this.W()&&this.W().m?this.c.S():this.f.S()},be:function(n,t){this.bw(this.cG().width()<600)},bc:function(){this.h=this.C.a("findViewWrapper");this.c=this.C.a("resolvedLocation");this.i=this.C.a("personaView");this.d=this.C.a("separatorCell");this.l=this.C.a("separatorText");this.f=this.C.a("findPlaceView")},bv:function(){this.c=null;this.h=null;this.i=null;this.d=null;this.l=null;this.f=null}};_lw.a=function(){};_lw.a.$$cctor=function(){_lw.a._I()};_lw.a.n=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_lw_2 ms-bcl-nta ms-bcl-nsa-h'> <span class='_lw_4 ms-fwt-r ms-bg-color-neutralLight'> <span class='_lw_6 ms-fwt-r'></span> <button type='button' class='_lw_b ms-bg-color-neutralLight'></button>  </span>  <span class='_lw_7'> <span class='_lw_8 ms-font-s'></span> </span> <span class='_lw_9'> <div class='_lw_a ms-font-s'></div> </span> </span> </div><div> <span class='_lw_e'></span> </div><div> <span class='_lw_h'></span> </div>";_j.h.a().appendChild(n);return n};_lw.a.v=function(n){return n.e};_lw.a.q=function(n){return n.t};_lw.a.t=function(n){return n.k};_lw.a.b=function(n){return n.b()};_lw.a.g=function(n){return n.m};_lw.a.f=function(n){return n.x};_lw.a.C=function(n){return n.Y()};_lw.a.u=function(n){return n.u};_lw.a.p=function(n){return n.j};_lw.a.r=function(n){return n.r};_lw.a.s=function(n){return n.cA()};_lw.a.o=function(n){return n.bO};_lw.a.k=function(n){return n.cD()};_lw.a.i=function(n,t){n.J(t)};_lw.a.h=function(n,t){n.k=t};_lw.a.l=function(n,t){n.ba(t)};_lw.a.y=function(n,t){n.bn(t)};_lw.a.w=function(n,t){n.bb(t)};_lw.a.x=function(n,t){n.l(t)};_lw.a.z=function(n,t){n.c(t)};_lw.a.B=function(n,t){n.o(t)};_lw.a.A=function(n,t){n.T(t)};_lw.a.m=function(){_lw.a.e||(_lw.a.e=new _fc.l);return _lw.a.e};_lw.a.j=function(){_lw.a.d||(_lw.a.d=new _fc.k);return _lw.a.d};_lw.a._I=function(){var t="LocationWellView";new _j.d(t,function(){_lw.a.a[t]===undefined&&(_lw.a.a[t]=[[[-1,5,["SingleLineMode"],[_lw.a.v],null,"_lw_c",null,null,1,null,null,null],[-1,5,["UseUnifiedForms"],[_lw.a.q],null,"_lw_3",null,null,0,null,null,null],[-1,5,["ExpandedPortraitLayout"],[_lw.a.t],null,"_lw_d",null,null,1,null,null,null],[-1,5,["UseSimpleLayout"],[_lw.a.b],null,"_lw_5",null,null,1,null,null,null]],[[-1,0,["PersonaViewModel"],[_lw.a.g],null,"IsHidden",null,_lw.a.i,1,_lw.a.m(),null,!0],[-1,5,["UseSimpleLayout"],[_lw.a.b],null,"_lw_5",null,null,1,null,null,null],[-1,5,["UseSimpleLayout"],[_lw.a.b],null,"ms-font-color-themePrimary",null,null,1,null,null,null],[-1,5,["UseSimpleLayout"],[_lw.a.b],null,"ms-bg-color-white",null,null,1,null,null,null]],[[-1,0,["PersonaViewModel"],[_lw.a.g],null,"DataContext",null,_lw.a.l,1,null,null,null],[0,5,["UseSimpleLayout"],[_lw.a.b],null,"_lw_5:ms-font-color-neutralSecondary-hover",null,null,1,null,null,null],[0,5,["UseSimpleLayout"],[_lw.a.b],null,"ms-font-color-themeSecondary-hover:ms-font-color-neutralSecondary-hover",null,null,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_lw.a.y,0,null,null,null,_lws.CalLWStrings.C],[-1,4,null,null,null,"ImageId",null,_lw.a.x,0,null,null,null,_n.b.a()],[-1,1,["ShowDeleteButton"],[_lw.a.u],null,"IsHidden",null,_lw.a.i,1,_lw.a.j(),null,!0],[-1,0,["DeletePlace"],[_lw.a.f],null,"ClickCommand",null,_lw.a.w,1,null,null,null],[-1,5,["UseSimpleLayout"],[_lw.a.b],null,"_lw_5",null,null,1,null,null,null],[-1,5,["UseSimpleLayout"],[_lw.a.b],null,"ms-bg-color-white",null,null,1,null,null,null]],[[-1,1,["UseSimpleLayout"],[_lw.a.b],null,"IsHidden",null,_lw.a.i,1,_lw.a.j(),null,!0]],[[-1,4,null,null,null,"FormatString",null,_lw.a.z,0,null,null,null,_wss.i.a]],null,[[-1,1,["AnchorSpacing"],[_lw.a.r],null,"TypedownAnchorSpacing",null,_lw.a.B,1,null,null,0],[-1,1,["AriaLabelledBy"],[_lw.a.s],null,"AriaLabelledBy",null,_lw.a.A,1,null,null,null],[-1,0,["FindPlaceViewModel"],[_lw.a.p],null,"DataContext",null,_lw.a.l,1,null,null,null],[0,5,["UseUnifiedForms"],[_lw.a.o],null,"_lw_3",null,null,0,null,null,null]]]);var n=_lw.a.c.childNodes[0].cloneNode(!0);var i=new _fp.f(_j.a.a(n,[0,2,0]),_j.b.Instance.a(_y.a),_j.b.Instance.a(_j.j));i.l(!0);i.k(!0);var l=new _fc.x(_j.a.a(n,[0,2]));var c=new _b.W(_j.a.a(n,[0,1,0]));var v=new _fc.x(_j.a.a(n,[0,1]));var r=new _fc.b(_j.a.a(n,[0,0,1]));var a=new _fc.g;var f=new _fc.c;f.U(_j.f.a(["DeletePlace"],[_lw.a.f],null,"Command",null,_lw.a.h,1));f.i("ENTER");a.a([f]);r.D([a]);var s=new _pe.d(_j.a.a(n,[0,0,0]),_j.b.Instance.a(_a.q));s.y("PersonaView.LocationBasicDetailsPopup");var u=new _fc.x(_j.a.a(n,[0,0]));var h=new _fc.g;var o=new _fc.c;o.U(_j.f.a(["DeletePlace"],[_lw.a.f],null,"Command",null,_lw.a.h,1));o.i("DELETE");var e=new _fc.c;e.U(_j.f.a(["PersonaViewModel","EnterKeyCommand"],[_lw.a.g,_lw.a.C],null,"Command",null,_lw.a.h,1));e.i("ENTER");h.a([o,e]);u.D([h]);var y=new _j.h(n.children[0]);return new _j.a(n,[y,u,s,r,v,c,l,i]).l({resolvedLocation:u,personaView:s,deleteButton:r,separatorCell:v,separatorText:c,findViewWrapper:l,findPlaceView:i}).b(i)},"",_lw.f,_lw.d,function(n){return new _lw.d(n,_j.b.Instance.a(_y.a))},!1,!1,!1,0,_lw.a.a);var n="PlaceDetailedView";new _j.d(n,function(){_lw.a.a[n]===undefined&&(_lw.a.a[n]=[[[-1,5,["ShowSelectedOrIsTouched"],[_lw.a.k],null,"ms-bg-color-themeLight",null,null,1,null,null,null]]]);var i=_lw.a.c.childNodes[1].cloneNode(!0);var t=new _pe.d(i.children[0],_j.b.Instance.a(_a.q));t.j("_lw_f ms-font-weight-semilight ms-font-color-neutralPrimary bidi");t.bC("_lw_g ms-font-weight-semilight ms-font-color-neutralSecondary bidi");t.y("PersonaView.DisplayPictureTwoLinesDetailsCustomStyle");return new _j.a(i,[t])},"",_pe.h,_fce.e,function(n){return new _fce.e(n)},!1,!1,!1,0,_lw.a.a)};CalendarLocationWellComponent.registerClass("CalendarLocationWellComponent",null,_a.ib,_j.ce);_lw.c.registerClass("_lw.c",_a.dR);_lw.g.registerClass("_lw.g",_a.dR);_lw.b.registerClass("_lw.b",_a.dR);_lw.h.registerClass("_lw.h",_a.dR);_lw.m.registerClass("_lw.m",_h.fc);_lw.n.registerClass("_lw.n",_pc.l);_lw.k.registerClass("_lw.k",_fp.l);_lw.i.registerClass("_lw.i",_h.fb,_pc.u,_pc.E);_lw.p.registerClass("_lw.p",_fp.c);_lw.f.registerClass("_lw.f",_a.bB,_bc.r,_a.iN,_j.bq,Sys.IDisposable,ILocationWellViewModel);_lw.d.registerClass("_lw.d",_j.c);CalendarLocationWellComponent.$$cctor();_lw.c.d=new _a.e("s:streetAddress",String,_lw.c);_lw.c.b=new _a.e("s:addressLocality",String,_lw.c);_lw.c.e=new _a.e("b:addressSubregion",String,_lw.c);_lw.c.c=new _a.e("s:addressRegion",String,_lw.c);_lw.c.a=new _a.e("s:addressCountry",String,_lw.c);_lw.c.$$cctor();_lw.g.a=new _a.e("s:latitude",Number,_lw.g);_lw.g.b=new _a.e("s:longitude",Number,_lw.g);_lw.g.$$cctor();_lw.b.e=new _a.e("@type",String,_lw.b);_lw.b.d=new _a.e("s:url",String,_lw.b);_lw.b.c=new _a.e("s:name",String,_lw.b);_lw.b.b=new _a.e("s:geo",_lw.g,_lw.b);_lw.b.a=new _a.e("s:address",_lw.c,_lw.b);_lw.b.$$cctor();_lw.j.a=_a.a.bY;_lw.h.a=new _a.e("@graph",_j.k,_lw.h);_lw.h.$$cctor();_lw.e.b=new _g.l("PlaceItemQueryTable");_lw.f.a=_a.a.T;_lw.a.c=_lw.a.n();_lw.a.e=null;_lw.a.d=null;_lw.a.a={};_lw.a.$$cctor();
window.scriptsLoaded['microsoft.owa.calendar.locationwell.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.calendar.locationwell.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
